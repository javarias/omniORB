%!PS-Adobe-2.0
%%Creator: dvips(k) 5.78 Copyright 1998 Radical Eye Software (www.radicaleye.com)
%%Title: omniORB2.dvi
%%Pages: 135
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Palatino-Roman Palatino-Italic Helvetica Palatino-Bold
%%+ Courier
%%EndComments
%DVIPSCommandLine: dvips -o omniORB2.ps omniORB2.dvi
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 1999.02.24:1446
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 2 string 0 1 255{IE S dup 360 add 36 4 index cvrs cvn
put}for pop 65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley
X /rulex X V}B /V{}B /RV statusdict begin /product where{pop false[
(Display)(NeXT)(LaserWriter 16/600)]{dup length product length le{dup
length product exch 0 exch getinterval eq{pop true exit}if}{pop}ifelse}
forall}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont cvx]cvx def}def /ObliqueSlant
{dup sin S cos div neg}B /SlantFont{4 index mul add}def /ExtendFont{3 -1
roll mul exch}def /ReEncodeFont{/Encoding exch def}def end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (omniORB2.dvi)
@start /Fa 138[51 28 1[32 3[51 8[42 18[60 2[69 5[32 73[{
TeXBase1Encoding ReEncodeFont}8 83.022 /Palatino-Bold
rf /Fb 138[42 4[37 33 42 58 7[29 37 30 1[33 97[{
TeXBase1Encoding ReEncodeFont}9 74.7198 /Palatino-Italic
rf /Fc 134[45 2[45 45 45 45 45 1[45 45 45 45 45 2[45
3[45 45 45 1[45 14[45 2[45 11[45 45 45 6[45 16[45 45
40[{TeXBase1Encoding ReEncodeFont}24 74.7198 /Courier
rf /Fd 103[50 26[50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 1[50
1[50 50 50 1[50 50 50 50 50 50 50 50 1[50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 1[50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 33[{TeXBase1Encoding ReEncodeFont}89
83.022 /Courier rf /Fe 133[55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55
55 1[55 1[55 55 55 55 55 55 55 55 55 55 1[55 55 55 55
55 55 1[55 55 55 55 55 55 55 55 55 55 1[55 55 55 1[55
1[55 55 55 55 55 55 55 55 55 55 55 55 55 1[55 55 55 55
55 55 55 55 1[55 33[{TeXBase1Encoding ReEncodeFont}81
90.9091 /Courier rf /Ff 166[61 61 91 66 71 56 48 61 71
55 71 76 86 56 66 30 31 76 69 51 56 70 64 56 71 7[45
45 45 45 45 45 45 45 45 45 1[23 30 1[55 1[30 30 40[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}40 90.9091
/Palatino-Roman rf /Fg 134[42 39 62 42 45 24 32 30 42
45 41 43 66 22 42 17 22 43 42 25 36 46 33 41 37 10[54
58 46 39 50 1[45 59 62 71 46 1[25 25 62 57 42 46 58 53
46 58 6[19 1[37 37 37 3[37 37 37 45 19 25 19 45 29 25
25 21 35[45 45 2[{TeXBase1Encoding ReEncodeFont}63 74.7198
/Palatino-Roman rf /Fh 198[25 25 25 25 25 25 25 25 25
25 48[{TeXBase1Encoding ReEncodeFont}10 49.8132 /Palatino-Roman
rf /Fi 134[55 50 83 55 61 33 44 39 61 61 55 61 89 33
61 33 33 61 55 39 50 61 44 61 50 7[66 66 100 78 78 66
61 72 1[61 83 83 100 61 78 1[39 83 83 55 61 83 72 66
78 6[25 50 50 50 50 50 50 50 50 50 50 29 25 8[89 34[61
2[{TeXBase1Encoding ReEncodeFont}63 99.6264 /Palatino-Bold
rf /Fj 133[60 66 60 100 66 73 40 53 47 73 73 66 73 106
40 73 40 40 73 66 47 60 73 53 73 60 7[80 1[120 1[93 80
73 86 100 73 100 100 120 73 93 1[47 100 100 66 73 100
86 80 93 7[60 60 60 60 60 60 60 60 60 60 1[30 40 1[72
40[73 2[{TeXBase1Encoding ReEncodeFont}62 119.552 /Palatino-Bold
rf /Fk 198[33 33 33 33 33 33 33 33 33 33 48[{
TeXBase1Encoding ReEncodeFont}10 66.4176 /Palatino-Roman
rf /Fl 135[86 3[57 1[67 1[105 1[105 4[57 105 2[86 105
2[86 29[124 1[134 7[86 86 86 86 86 86 86 86 86 86 48[{
TeXBase1Encoding ReEncodeFont}22 172.188 /Palatino-Bold
rf /Fm 134[51 45 76 51 56 30 40 35 56 56 51 56 81 30
56 30 30 56 51 35 45 56 40 56 45 10[71 71 61 56 66 1[56
76 76 91 56 2[35 1[76 1[56 76 66 61 71 3[55 3[45 45 45
45 45 45 45 45 45 45 1[23 30 23 55 1[30 30 37[56 2[{
TeXBase1Encoding ReEncodeFont}60 90.9091 /Palatino-Bold
rf /Fn 134[115 103 1[115 126 69 92 80 1[126 115 126 184
69 126 69 69 126 115 80 103 126 92 126 103 10[161 1[138
126 149 1[126 172 1[207 126 2[80 4[172 149 138 161 11[103
2[103 6[125 1[69 69 40[{TeXBase1Encoding ReEncodeFont}41
206.559 /Palatino-Bold rf
%DVIPSBitmapFont: Fo cmsy10 10.95 3
/Fo 3 111 df<EB0FFCEB3FFF90B512C0000314F04880488048804880A2481580A3B712
C0AA6C1580A36C1500A26C5C6C5C6C5C6C5CC614C0013F90C7FCEB0FFC22227BA72D>15
D<19301978A2197C193CA2193E191EA2191F737EA2737E737EA2737E737E1A7C1A7EF21F
80F20FC0F207F0007FBB12FCBDFCA26C1AFCCDEA07F0F20FC0F21F80F27E001A7C624F5A
4F5AA24F5A4F5AA24FC7FC191EA2193E193CA2197C1978A2193050307BAE5B>33
D<126012F07EA21278127CA2123C123EA2121E121FA27E7FA212077FA212037FA212017F
A212007FA21378137CA27FA2131E131FA27F80A2130780A2130380A2130180A2130080A2
1478147CA2143C143EA2141E141FA26E7EA2140781A2140381A2140181A2140081A21578
157CA2153C153EA2151E151FA2811680A2150716C0A21503ED0180225B7BC32D>110
D E
%EndDVIPSBitmapFont
/Fp 134[60 3[66 33 60 40 2[66 66 4[27 66 66 1[66 66 1[66
66 26[73 2[86 1[80 7[66 6[66 66 4[33 44[{TeXBase1Encoding ReEncodeFont}
21 119.552 /Helvetica rf /Fq 134[45 1[66 45 51 30 35
35 42 45 40 51 71 25 40 25 25 45 2[35 45 37 42 40 10[66
1[56 51 61 2[71 71 86 3[30 3[56 71 61 56 66 68 5[23 2[45
45 1[45 45 45 45 45 1[23 4[30 30 37[48 2[{TeXBase1Encoding ReEncodeFont}
48 90.9091 /Palatino-Italic rf /Fr 75[30 31[45 45 24[45
51 47 76 51 55 30 39 36 51 55 50 53 80 26 51 21 26 53
51 30 44 56 40 50 45 3[30 1[30 61 61 61 91 66 71 56 48
61 71 55 71 76 86 56 66 30 31 76 69 51 56 70 64 56 71
68 2[55 1[23 23 45 45 45 45 45 45 45 45 45 45 55 23 30
23 55 35 30 30 25 71 76 1[45 1[25 29[55 55 2[{
TeXBase1Encoding ReEncodeFont}86 90.9091 /Palatino-Roman
rf /Fs 137[68 1[39 51 47 2[65 1[106 3[35 70 66 1[57 73
53 66 60 12[73 63 80 5[73 7[93 85 1[93 19[40 6[93 38[{
TeXBase1Encoding ReEncodeFont}23 119.552 /Palatino-Roman
rf /Ft 137[117 125 1[88 82 2[113 120 182 3[60 120 2[99
126 14[161 127 1[138 2[162 7[158 4[126 10[103 4[103 103
2[52 6[57 39[{TeXBase1Encoding ReEncodeFont}22 206.559
/Palatino-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 561 415 a Ft(The)52 b(omniORB2)h(version)d(2.7.1)1230
673 y(User)15 b('s)51 b(Guide)1594 1795 y Fs(Sai-Lai)28
b(Lo)1269 1945 y Fr(\()p Fq(email:)h(slo@uk.r)n(esear)n(ch.att.com)p
Fr(\))1457 2094 y Fs(David)f(Riddoch)1267 2243 y Fr(\()p
Fq(email:)h(djr@uk.r)n(esear)n(ch.att.com)p Fr(\))1038
2393 y Fs(A)-9 b(T&T)31 b(Laboratories)f(Cambridge)1457
4452 y Fr(22nd)23 b(Febr)o(uary)-10 b(,)22 b(1999)p eop
%%Page: 2 2
2 1 bop 171 356 a Fp(Changes)36 b(and)e(Additions)n(,)h(22nd)g(F)l(ebr)
r(uar)t(y)f(1999)166 568 y Fo(\017)46 b Fr(Chapter)23
b(1)-5 b(1)23 b(-)g(expanded)e(and)i(updated)p eop
%%Page: 3 3
3 2 bop 150 1022 a Fn(Contents)150 1560 y Fm(1)91 b(Introduction)2713
b(1)286 1675 y Fr(1.1)96 b(Featur)n(es)86 b(.)45 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(1)495 1790 y(1.1.1)110 b(CORBA)23 b(2)g(compliant)68
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(1)495 1904
y(1.1.2)110 b(Multithr)n(eading)67 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)125 b(1)495 2019 y(1.1.3)110 b(Portability)53
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(2)495 2133 y(1.1.4)110 b(Missing)23 b(featur)n(es)86
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(2)286
2248 y(1.2)96 b(Setting)22 b(Up)g(Y)-8 b(our)21 b(Envir)n(onment)49
b(.)c(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(2)286 2363 y(1.3)96
b(Platform)24 b(speci\002c)e(variables)51 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)125 b(3)150 2569 y Fm(2)91 b(The)23 b(Basics)2798
b(5)286 2684 y Fr(2.1)96 b(The)22 b(Echo)h(Object)g(Example)81
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(5)286 2799
y(2.2)96 b(Specifying)23 b(the)e(Echo)i(interface)f(in)i(IDL)72
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)125 b(5)286 2913 y(2.3)96 b(Generating)22
b(the)g(C++)i(stubs)77 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(6)286 3028 y(2.4)96 b(A)23 b(Quick)g(T)-8 b(our)22
b(of)g(the)g(C++)i(stubs)81 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(7)495 3143 y(2.4.1)110 b(Object)24 b(Refer)n(ence)76
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(7)495
3257 y(2.4.2)110 b(Object)24 b(Implementation)k(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(9)286 3372 y(2.5)96
b(W)-7 b(riting)23 b(the)f(object)h(implementation)72
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(10)286 3486 y(2.6)96 b(W)-7
b(riting)23 b(the)f(client)72 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)84 b(1)-5 b(1)286 3601 y(2.7)96 b(Example)23
b(1)g(-)g(Colocated)g(Client)g(and)f(Implementation)50
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(12)495 3716 y(2.7.1)110 b(ORB/BOA)23 b(initialisation)58
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(13)495 3830 y(2.7.2)110
b(Object)24 b(initialisation)38 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)79 b(13)495 3945 y(2.7.3)110 b(Client)24 b(invocation)59
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(14)495
4060 y(2.7.4)110 b(Object)24 b(disposal)66 b(.)45 b(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(15)286 4174 y(2.8)96 b(Example)23
b(2)g(-)g(Dif)n(fer)n(ent)h(Addr)n(ess)c(Spaces)77 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)79 b(15)495 4289 y(2.8.1)110 b(Object)24 b(Implementation:)j
(Generating)22 b(a)h(Stringi\002ed)e(Object)i(Refer)n(ence)56
b(15)495 4404 y(2.8.2)110 b(Client:)29 b(Using)22 b(a)h(Stringi\002ed)e
(Object)j(Refer)n(ence)k(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)79 b(16)495 4518 y(2.8.3)110 b(Catching)24 b(System)d
(Exceptions)89 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(16)495 4633 y(2.8.4)110
b(Lifetime)23 b(of)f(an)i(Object)f(Implementation)60
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(17)286 4747 y(2.9)96 b(Example)23 b(3)g(-)g(Using)f(the)g(COS)h
(Naming)g(Service)34 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)79 b(18)495 4862 y(2.9.1)110 b(Obtaining)24
b(the)e(Root)f(Context)h(Object)h(Refer)n(ence)38 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(18)495
4977 y(2.9.2)110 b(The)22 b(Naming)h(Service)g(Interface)34
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)79 b(18)286 5091 y(2.10)51 b(Example)23
b(4)g(-)g(Using)f(tie)g(implementation)h(templates)57
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(19)286 5206 y(2.1)-5 b(1)56 b(Sour)n(ce)23 b(Listing)57
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(20)495 5321 y(2.1)-5 b(1.1)70 b(echo)p 978 5321 28
4 v 33 w(i.cc)60 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(20)495 5435 y(2.1)-5 b(1.2)70 b(gr)n(eeting.cc)42
b(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(21)495 5550 y(2.1)-5 b(1.3)70 b(eg1.cc)30 b(.)45 b(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(22)1820
5778 y(iii)p eop
%%Page: 4 4
4 3 bop 375 356 a Fr(2.1)-5 b(1.4)70 b(eg2)p 811 356
28 4 v 33 w(impl.cc)83 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(24)375 469 y(2.1)-5 b(1.5)70 b(eg2)p 811
469 V 33 w(clt.cc)37 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)79 b(25)375 583 y(2.1)-5 b(1.6)70 b(eg3)p
811 583 V 33 w(impl.cc)83 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(26)375 696 y(2.1)-5 b(1.7)70 b(eg3)p
811 696 V 33 w(clt.cc)37 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(29)375 809 y(2.1)-5 b(1.8)70
b(eg3)p 811 809 V 33 w(tieimpl.cc)51 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(32)375 923 y(2.1)-5 b(1.9)70
b(dir)-7 b(.mk)76 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)79 b(36)30 1127 y Fm(3)91 b(IDL)23 b(to)f(C++)h
(Language)f(Mapping)1889 b(37)30 1332 y(4)91 b(The)23
b(omniORB2)e(API)2359 b(39)166 1445 y Fr(4.1)96 b(ORB)23
b(and)g(BOA)f(initialisation)j(options)82 b(.)45 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(39)166 1558 y(4.2)96 b(Run-time)23 b(T)-8 b(racing)23
b(and)f(Diagnostic)h(Messages)51 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(40)166 1672 y(4.3)96
b(Server)22 b(Name)38 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)79 b(41)166 1785 y(4.4)96 b(Object)24
b(Keys)84 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(41)166 1898 y(4.5)96 b(GIOP)24 b(Message)c(Size)56
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(42)166 2012 y(4.6)96 b(Initial)24 b(Object)f(Refer)n(ence)f
(Bootstrapping)55 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(42)166 2125 y(4.7)96
b(T)-8 b(rapping)22 b(omniORB2)h(Internal)g(Err)n(ors)71
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)79 b(43)30 2330 y Fm(5)91 b(The)23 b(Basic)h(Object)f
(Adaptor)f(\(BOA\))1834 b(45)166 2443 y Fr(5.1)96 b(BOA)23
b(Initialisation)42 b(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(45)166 2556 y(5.2)96 b(Object)24 b(Registration)66
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(47)166 2670 y(5.3)96 b(Object)24 b(Disposal)70 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(47)166 2783 y(5.4)96 b(BOA)23 b(Shutdown)58 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(48)166 2896 y(5.5)96 b(Unsupported)20 b(functions)33
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(49)166
3010 y(5.6)96 b(Loading)22 b(Objects)h(On)g(Demand)74
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(49)30 3214 y Fm(6)91
b(Interface)26 b(T)-8 b(ype)21 b(Checking)2175 b(51)166
3327 y Fr(6.1)96 b(Intr)n(oduction)56 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(51)166 3441
y(6.2)96 b(Basic)24 b(Interface)e(T)-8 b(ype)21 b(Checking)40
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(52)166 3554 y(6.3)96
b(Interface)22 b(Inheritance)75 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)79 b(53)30 3759 y Fm(7)91 b(Connection)22
b(Management)2145 b(57)166 3872 y Fr(7.1)96 b(Backgr)n(ound)73
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)79 b(57)166 3985 y(7.2)96 b(The)22 b(Model)59 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(57)166 4099 y(7.3)96 b(Idle)22 b(Connection)h(Shutdown)h(.)45
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(58)166 4212 y(7.4)96
b(Inter)n(operability)22 b(Considerations)50 b(.)45 b(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)79 b(59)166 4325 y(7.5)96 b(Connection)23 b(Acceptance)i(.)45
b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(59)30
4530 y Fm(8)91 b(Proxy)23 b(Objects)2615 b(61)166 4643
y Fr(8.1)96 b(System)21 b(Exception)h(Handlers)67 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(61)375 4756 y(8.1.1)110
b(CORBA::TRANSIENT)19 b(handlers)25 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(62)375
4870 y(8.1.2)110 b(CORBA::COMM)p 1347 4870 V 33 w(F)-7
b(AILURE)60 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(64)375 4983 y(8.1.3)110
b(CORBA::SystemException)29 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(64)166 5096 y(8.2)96 b(Pr)n(oxy)22 b(Object)i(Factories)73
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(65)375
5210 y(8.2.1)110 b(Backgr)n(ound)55 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)79 b(65)375 5323 y(8.2.2)110 b(An)23
b(Example)46 b(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(66)666 5436 y(8.2.2.1)124 b(De\002ne)22 b(a)h(new)f(pr)n(oxy)g(class)
60 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)79 b(66)666 5550 y(8.2.2.2)124 b(De\002ne)22 b(a)h(new)f(pr)n
(oxy)g(factory)h(class)28 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)79 b(67)p eop
%%Page: 5 5
5 4 bop 495 356 a Fr(8.2.3)110 b(Further)21 b(Considerations)86
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(68)150 562 y Fm(9)91
b(T)-8 b(ype)22 b(Any)g(and)g(T)-8 b(ypeCode)2164 b(69)286
677 y Fr(9.1)96 b(Example)23 b(using)f(type)f(Any)43
b(.)j(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(69)495
791 y(9.1.1)110 b(T)-8 b(ype)21 b(Any)h(in)h(IDL)75 b(.)46
b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(69)495 905
y(9.1.2)110 b(Inserting)21 b(and)i(Extracting)f(Basic)h(T)-8
b(ypes)21 b(fr)n(om)i(an)g(Any)49 b(.)c(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(70)495 1020 y(9.1.3)110 b(Inserting)21 b(and)i(Extracting)f
(Constr)o(ucted)f(T)-8 b(ypes)20 b(fr)n(om)k(an)f(Any)33
b(.)46 b(.)f(.)g(.)g(.)79 b(71)286 1134 y(9.2)96 b(T)-8
b(ype)21 b(Any)h(in)h(omniORB2)81 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(73)286 1248 y(9.3)96 b(T)-8 b(ypeCode)21
b(in)i(omniORB2)64 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(75)286 1363 y(9.4)96 b(Sour)n(ce)23 b(Listing)57 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(77)495 1477 y(9.4.1)110 b(anyExample)p 1293 1477 28
4 v 33 w(impl.cc)62 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(77)495 1592 y(9.4.2)110 b(anyExample)p 1293 1592 V
33 w(clt.cc)85 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(81)150 1798 y Fm(10)46 b(Dynamic)23 b(Management)g(of)g(Any)e(V)-10
b(alues)1638 b(87)286 1912 y Fr(10.1)51 b(C++)24 b(mapping)69
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(87)286 2027 y(10.2)51 b(The)22 b(DynAny)g(Interface)74
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(91)495
2141 y(10.2.1)65 b(Example:)28 b(extract)22 b(data)h(values)g(fr)n(om)g
(an)g(Any)80 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(91)786 2255 y(10.2.1.1)g(Iterate)21 b(thr)n(ough)h(the)f(components)
61 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(92)786 2370 y(10.2.1.2)g(Extract)22 b(basic)i(type)d(components)39
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(92)786 2484 y(10.2.1.3)g(Extract)22 b(complex)h(components)31
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(93)786 2599 y(10.2.1.4)g(Clean-up)74 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(93)495 2713 y(10.2.2)65 b(Example:)28 b(insert)22
b(data)h(values)g(into)f(an)h(Any)h(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(94)786 2827 y(10.2.2.1)g(Insert)21
b(basic)j(type)d(components)i(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)79 b(95)786 2942 y(10.2.2.2)g(Insert)21
b(complex)i(components)83 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)79 b(96)286 3056 y(10.3)51 b(The)22
b(DynStr)o(uct)g(Interface)79 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)79 b(97)286 3170 y(10.4)51 b(The)22 b(DynSequence)f(Interface)76
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(98)286 3285
y(10.5)51 b(The)22 b(DynArray)g(Interface)78 b(.)46 b(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(99)286 3399 y(10.6)51 b(The)22
b(DynEnum)g(Interface)73 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(99)286 3514 y(10.7)51 b(The)22 b(DynUnion)h(Interface)63
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(99)495
3628 y(10.7.1)65 b(Thr)n(ee)22 b(Categories)g(of)g(Union)32
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)34 b(100)495 3742 y(10.7.2)65
b(Example:)28 b(extract)22 b(data)h(values)g(fr)n(om)g(a)g(union)71
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(100)786 3857 y(10.7.2.1)79 b(Explicit)23 b(default)g(union)48
b(.)d(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)34 b(100)786 3971 y(10.7.2.2)79 b(Implicit)24
b(default)e(union)40 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(102)786 4085
y(10.7.2.3)79 b(No)22 b(default)g(union)j(.)45 b(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(102)495 4200 y(10.7.3)65 b(Example:)28 b(insert)22
b(data)h(values)g(into)f(a)h(union)83 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(102)786 4314 y(10.7.3.1)79
b(Ambiguous)22 b(usage)53 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(103)286
4429 y(10.8)51 b(Duplicate)24 b(DynAny)e(Refer)n(ences)27
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(104)286 4543 y(10.9)51
b(Other)23 b(Operations)63 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)34 b(104)150 4749 y Fm(1)m(1)49 b(The)23
b(Dynamic)f(Invocation)g(Interface)1729 b(107)286 4864
y Fr(1)-5 b(1.1)56 b(Overview)29 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(107)286
4978 y(1)-5 b(1.2)56 b(Pseudo)21 b(Objects)85 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(107)495 5092 y(1)-5 b(1.2.1)70 b(Request)85 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(108)495 5207 y(1)-5 b(1.2.2)70 b(NamedV)-8 b(alue)85
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(108)495 5321 y(1)-5 b(1.2.3)70 b(NVList)48 b(.)d(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(109)495
5435 y(1)-5 b(1.2.4)70 b(Context)23 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(109)495 5550
y(1)-5 b(1.2.5)70 b(ContextList)77 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(10)p eop
%%Page: 6 6
6 5 bop 375 356 a Fr(1)-5 b(1.2.6)70 b(ExceptionList)62
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(10)375 469 y(1)g(1.2.7)70 b(UnknownUserException)25
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(10)375 582 y(1)g(1.2.8)70
b(Envir)n(onment)84 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)f(1)-5 b(1)g(1)166 695 y(1)g(1.3)56 b(Cr)n(eating)23
b(Requests)36 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)f(1)-5 b(1)g(1)375 808 y(1)g(1.3.1)70 b(Examples)86
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(12)166 920 y(1)g(1.4)56 b(Invoking)22 b(Operations)68
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(13)166 1033 y(1)g(1.5)56 b(Multiple)23 b(Requests)35
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(14)30 1237 y Fm(12)46 b(The)23 b(Dynamic)f(Skeleton)h
(Interface)1807 b(1)m(15)166 1350 y Fr(12.1)51 b(Overview)29
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)39 b(1)-5 b(15)166 1463 y(12.2)51 b(DSI)23
b(T)-8 b(ypes)87 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(16)375 1576 y(12.2.1)65
b(DynamicImplementation)79 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(16)375 1689 y(12.2.2)65 b(ServerRequest)31 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5
b(16)166 1802 y(12.3)51 b(Cr)n(eating)23 b(Dynamic)i(Implementations)73
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)39 b(1)-5 b(17)375 1915 y(12.3.1)65 b(Operations)22
b(on)h(the)e(ServerRequest)36 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(17)166
2028 y(12.4)51 b(Registering)21 b(Dynamic)j(Objects)80
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(18)166 2141
y(12.5)51 b(Example)75 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(18)30 2344
y Fm(A)65 b(hosts)p 388 2344 28 4 v 33 w(access\(5\))2543
b(121)p eop
%%Page: 1 7
1 6 bop 150 982 a Fl(Chapter)44 b(1)150 1400 y Fn(Introduction)150
1849 y Fr(OmniORB2)30 b(is)f(an)h(Object)f(Request)e(Br)n(oker)h
(\(ORB\))h(that)g(implements)f(the)g(2.0)i(speci\002cation)150
1961 y(of)c(the)f(Common)i(Object)g(Request)d(Br)n(oker)g(Ar)n
(chitectur)n(e)i(\(CORBA\))h([OMG96a)r(])3098 1928 y
Fk(1)3136 1961 y Fr(.)38 b(This)26 b(user)150 2074 y(guide)f(tells)g
(you)g(how)g(to)g(use)g(omniORB2)h(to)f(develop)g(CORBA)g
(applications.)38 b(It)25 b(assumes)g(a)150 2187 y(basic)f
(understanding)c(of)j(CORBA.)291 2303 y(In)i(this)f(chapter)-7
b(,)25 b(we)g(give)g(an)g(overview)g(of)g(the)f(main)i(featur)n(es)e
(of)h(omniORB2)g(and)g(what)150 2416 y(you)d(need)f(to)h(do)g(to)g
(setup)f(your)g(envir)n(onment)i(to)f(r)o(un)g(omniORB2.)150
2735 y Fj(1.1)119 b(Features)150 2956 y Fi(1.1.1)99 b(CORBA)25
b(2)f(compliant)150 3140 y Fr(OmniORB2)19 b(implements)e(the)f
(Internet)g(Inter)n(-ORB)g(Pr)n(otocol)h(\(IIOP\).)h(This)f(pr)n
(otocol)g(pr)n(ovides)150 3253 y(omniORB2)32 b(the)g(means)f(of)h
(achieving)h(inter)n(operability)f(with)g(the)f(ORBs)g(implemented)g
(by)150 3365 y(other)24 b(vendors.)35 b(In)25 b(fact,)i(this)e(is)h
(the)f(native)h(pr)n(otocol)f(used)f(by)h(omniORB2)h(for)g(the)e
(commu-)150 3478 y(nication)30 b(amongst)e(its)h(objects)f(r)n(esiding)
h(in)g(dif)n(fer)n(ent)g(addr)n(ess)f(spaces.)46 b(Mor)n(eover)-7
b(,)30 b(the)e(IDL)150 3591 y(to)e(C++)h(language)f(mapping)h(pr)n
(ovided)e(by)h(omniORB2)h(conforms)f(to)g(the)g(latest)f(r)n(evision)i
(of)150 3704 y(the)i(CORBA)h(speci\002cation.)50 b(T)-8
b(ype)28 b(Any)h(and)h(T)-8 b(ypeCode)27 b(ar)n(e)k(now)e(supported)e
(\(intr)n(oduced)150 3817 y(in)d(version)f(2.5.0\).)31
b(DynAny)22 b(is)i(supported)c(since)j(2.6.0.)31 b(The)23
b(Dynamic)h(Invocation)g(Interface)150 3930 y(and)f(Dynamic)h(Skeleton)
c(Interface)i(ar)n(e)h(supported)d(since)j(2.7.0.)150
4205 y Fi(1.1.2)99 b(Multithreading)150 4388 y Fr(OmniORB2)32
b(is)e(fully)h(multithr)n(eaded.)50 b(T)-8 b(o)29 b(achieve)i(low)g
(IIOP)f(call)i(over)n(head,)f(unnecessary)150 4501 y(call-multiplexing)
26 b(is)f(eliminated.)33 b(At)23 b(any)h(time,)h(ther)n(e)e(is)h(at)h
(most)e(one)g(call)j(in-\003ight)f(in)g(each)150 4614
y(communication)30 b(channel)f(between)e(two)h(addr)n(ess)f(spaces.)44
b(T)-8 b(o)28 b(do)g(so)g(without)f(limiting)j(the)150
4727 y(level)c(of)f(concurr)n(ency)-10 b(,)25 b(new)g(channels)g
(connecting)f(the)h(two)f(addr)n(ess)g(spaces)g(ar)n(e)i(cr)n(eated)e
(on)150 4840 y(demand)i(and)g(cached)g(when)g(ther)n(e)f(ar)n(e)h(mor)n
(e)g(concurr)n(ent)g(calls)i(in)e(pr)n(ogr)n(ess.)37
b(Each)26 b(channel)150 4953 y(is)34 b(served)f(by)h(a)g(dedicated)f
(thr)n(ead.)62 b(This)34 b(arrangement)f(pr)n(ovides)g(maximal)j
(concurr)n(ency)150 5066 y(and)27 b(eliminates)g(any)f(thr)n(ead)g
(switching)g(in)h(either)f(of)h(the)e(addr)n(ess)h(spaces)f(to)h(pr)n
(ocess)f(a)j(call.)150 5179 y(Furthermor)n(e,)k(to)g(maximise)h(the)f
(thr)n(oughput)e(in)j(pr)n(ocessing)e(lar)n(ge)h(call)i(ar)n(guments,)g
(lar)n(ge)p 150 5279 1368 4 v 255 5335 a Fh(1)284 5367
y Fg(The)27 b(DynAny)f(implmentation)g(intr)o(oduced)f(in)h(version)f
(2.6.0)i(implements)e(the)i(facility)e(in)i(the)f(2.2)h(speci\002-)150
5458 y(cation.)41 b(Other)24 b(parts)g(of)g(the)h(2.2)f
(speci\002cation)h(ar)o(e)f(also)f(implemented)h(wher)o(e)g(they)g(do)g
(not)h(clash)g(with)g(the)g(2.0)150 5550 y(speci\002cation.)1837
5778 y Fr(1)p eop
%%Page: 2 8
2 7 bop 30 100 a Fr(2)2062 b Ff(CHAPTER)22 b(1.)51 b(INTRODUCTION)30
356 y Fr(data)30 b(elements)f(ar)n(e)i(sent)e(as)h(soon)f(as)h(they)f
(ar)n(e)i(pr)n(ocessed)d(while)i(the)g(other)e(ar)n(guments)i(ar)n(e)30
469 y(being)22 b(marshalled.)30 730 y Fi(1.1.3)99 b(Portability)30
909 y Fr(At)26 b(A)-7 b(T&T)25 b(Laboratories,)h(the)f(ability)j(to)d
(tar)n(get)h(a)h(single)e(sour)n(ce)h(tr)n(ee)f(to)h(multiple)g
(platforms)30 1022 y(is)33 b(very)g(important.)59 b(This)33
b(is)g(dif)n(\002cult)h(to)f(achieve)h(if)g(the)e(IDL)h(to)g(C++)h
(mapping)f(for)g(these)30 1135 y(platforms)27 b(ar)n(e)h(dif)n(fer)n
(ent.)42 b(W)-8 b(e)27 b(avoid)h(this)f(pr)n(oblem)g(by)h(making)f(sur)
n(e)g(that)g(only)g(one)g(IDL)g(to)30 1248 y(C++)e(mapping)g(is)g
(used.)32 b(W)-8 b(e)24 b(r)o(un)h(several)g(\003avours)f(of)h(Unices,)
g(W)-5 b(indows)23 b(NT)-7 b(,)24 b(W)-5 b(indows)24
b(95)30 1361 y(and)29 b(our)g(in-house)f(developed)f(systems)g(for)i
(our)g(own)g(har)n(dwar)n(e.)48 b(OmniORB2)30 b(have)g(been)30
1474 y(ported)25 b(to)h(all)i(these)c(platforms.)40 b
Fm(The)26 b(IDL)h(to)f(C++)h(mapping)e(for)i(these)h(targets)g(are)g
(all)g(the)30 1587 y(same)p Fr(.)171 1701 y(OmniORB2)22
b(uses)d(r)n(eal)i(C++)g(exceptions)e(and)h(nested)e(classes.)27
b(W)-8 b(e)20 b(stay)f(with)i(the)e(CORBA)30 1814 y(speci\002cation's)
27 b(standar)n(d)f(mapping)h(as)f(much)i(as)e(possible)g(and)h(do)f
(not)g(use)g(the)g(alternative)30 1927 y(mappings)c(for)h(C++)g
(dialects.)28 b(The)22 b(only)g(exception)g(is)g(the)g(mapping)h(of)f
Fm(modules)p Fr(.)171 2041 y(Starting)27 b(with)g(2.6.0,)j(the)c(code)h
(generated)e(by)j(the)e(IDL)h(compiler)h(of)g(omniORB2)g(can)g(be)30
2154 y(compiled)d(using)f Fm(C++)h(classes)i Fr(or)e
Fm(namespaces)h Fr(to)e(r)n(epr)n(esent)f(IDL)i Fm(modules)f
Fr(depending)e(on)30 2267 y(the)g(availability)k(of)d(namespace)f
(support)f(in)i(the)f(compiler)-7 b(.)171 2381 y(OmniORB2)28
b(r)n(elies)e(on)f(the)g(native)i(thr)n(ead)e(libraries)j(to)d(pr)n
(ovide)h(the)f(multithr)n(eading)h(ca-)30 2494 y(pability)-10
b(.)45 b(A)27 b(small)j(class)e(library)h(\(omnithr)n(ead)f([Richar)n
(dson96a)r(]\))g(is)g(used)f(to)g(encapsulated)30 2606
y(the)f(\(possibly)g(dif)n(fer)n(ent\))g(APIs)g(of)g(the)g(native)h
(thr)n(ead)f(libraries.)41 b(In)26 b(the)g(application)h(code,)g(it)30
2719 y(is)f(r)n(ecommended)f(but)h(not)f(mandatory)h(to)f(use)g(this)h
(class)h(library)g(for)f(thr)n(ead)g(management.)30 2832
y(It)g(should)f(be)i(easy)e(to)h(port)g(omnithr)n(ead)g(to)g(any)g
(platform)h(that)f(either)g(supports)e(the)i(POSIX)30
2945 y(thr)n(ead)c(standar)n(d)g(or)g(has)h(a)g(thr)n(ead)f(package)h
(that)f(supports)e(similar)k(capabilities.)30 3207 y
Fi(1.1.4)99 b(Missing)25 b(features)30 3386 y Fr(OmniORB2)d(is)f(not)g
(\(yet\))f(a)h(complete)g(implementation)f(of)h(the)f(CORBA)h(cor)n(e.)
28 b(The)20 b(following)30 3499 y(is)j(a)g(list)g(of)f(the)g(missing)h
(featur)n(es.)166 3717 y Fo(\017)46 b Fr(The)31 b(BOA)g(only)f(support)
f(the)h(persistent)f(server)h(activation)j(policy)-10
b(.)53 b(Other)30 b(dynamic)257 3830 y(activation)24
b(and)f(deactivation)g(policies)g(ar)n(e)g(not)f(supported.)166
4022 y Fo(\017)46 b Fr(OmniORB2)24 b(does)d(not)h(has)h(its)f(own)g
(Interface)g(Repository)-10 b(.)171 4240 y(These)86 b(featur)n(es)g
(may)i(be)f(implemented)f(in)i(the)e(short)g(to)h(medium)g(term.)30
4353 y(It)78 b(is)h(best)f(to)g(check)g(out)g(the)g(latest)g(status)f
(on)i(the)e(omniORB2)j(home)e(page)30 4466 y(\()p Fe(http://www.uk.r)o
(ese)o(ar)o(ch)o(.a)o(tt)o(.co)o(m/)o(om)o(ni)o(OR)o(B/o)o(mn)o(iO)o
(RB)o(.h)o(tml)o Fr(\).)30 4771 y Fj(1.2)119 b(Setting)30
b(Up)g(Y)-9 b(our)29 b(Environment)30 4984 y Fr(At)23
b(A)-7 b(T&T)22 b(Laboratories)h(Cambridge,)g(you)g(should)f(use)g(the)
g(OMNI)h(Development)g(Envir)n(on-)30 5097 y(ment)d(\(ODE\))i([Richar)n
(dson96b)r(])f(and)g(the)f(OMNI)h(tr)n(ee)f(version)g(5.0)i(or)e(above)
h(to)g(compile)g(your)30 5210 y(pr)n(ograms.)42 b(If)27
b(this)g(is)h(the)e(case,)j(ther)n(e)d(is)i(no)f(extra)g(setup)e(you)i
(have)h(to)e(do)h(other)f(than)i(those)30 5323 y(described)21
b(in)j(the)d(ODE)i(documentation.)171 5437 y(If)30 b(you)f(ar)n(e)h(r)o
(unning)g(omniORB2)g(at)g(other)e(sites,)j(you)d(\(or)i(your)f(system)f
(administrator\))30 5550 y(should)22 b(install)h(omniORB2)g(by)g
(following)g(the)f(instr)o(uctions)g(in)h(the)e(installation)j(notes.)p
eop
%%Page: 3 9
3 8 bop 150 100 a Ff(1.3.)51 b(PLA)-7 b(TFORM)22 b(SPECIFIC)g(V)-10
b(ARIABLES)1738 b Fr(3)286 356 y Fo(\017)46 b Fr(On)27
b(Unix)g(platforms,)g(the)f(omniORB2)h(r)o(untime)f(looks)g(for)g(the)g
(envir)n(onment)g(variable)377 469 y Fe(OMNIORB)p 767
469 28 4 v 30 w(CONFIG)p Fr(.)k(If)k(this)f(variable)j(is)d(de\002ned,)
h(it)g(contains)f(the)g(pathname)g(of)h(the)377 582 y(omniORB2)29
b(con\002guration)e(\002le.)44 b(If)28 b(the)g(variable)i(is)e(not)f
(set,)h(omniORB2)h(will)g(use)e(the)377 695 y(compiled-in)d(pathname)e
(to)g(locate)h(the)f(\002le.)286 1010 y Fo(\017)46 b
Fr(On)30 b(ARM/A)-7 b(TMos,)29 b(the)f(omniORB2)h(r)o(untime)g(looks)f
(for)h(con\002guration)f(information)377 1123 y(in)23
b(the)f(\002le)h Fe(omniORB.cfg)p Fr(.)286 1438 y Fo(\017)46
b Fr(On)j(W)-5 b(in32)49 b(platforms)e(\(W)-5 b(indows)47
b(NT)-7 b(,)47 b(W)-5 b(indows)47 b('95\),)55 b(omniORB2)49
b(\002rst)e(checks)377 1551 y(the)32 b(envir)n(onment)h(variable)i(\()p
Fe(OMNIORB2)p 1920 1551 V 29 w(CONFIG)p Fr(\))c(to)h(obtain)h(the)f
(pathname)h(of)g(the)377 1664 y(con\002guration)47 b(\002le.)101
b(If)47 b(this)g(is)g(not)f(set,)52 b(it)47 b(then)g(attempts)e(to)i
(obtain)g(con\002gura-)377 1777 y(tion)k(data)f(in)h(the)f(system)f(r)n
(egistry)-10 b(.)110 b(It)50 b(sear)n(ches)g(for)h(the)e(data)i(under)f
(the)f(key)377 1890 y Fe(HKEY)p 602 1890 V 31 w(LOCAL)p
908 1890 V 31 w(MACHINE)p Fo(n)p Fe(SOFTWARE)o Fo(n)p
Fe(ORL)o Fo(n)p Fe(omn)o(iOR)o(B)p Fo(n)p Fe(2.)o(0)291
2262 y Fr(The)27 b(con\002guration)h(\002le)f(is)h(used)f(to)g(obtain)h
(an)h(object)e(r)n(efer)n(ence)h(for)f(the)g(COSS)i(Naming)150
2375 y(Service.)f(The)22 b(entry)f(in)i(the)f(con\002guration)g(\002le)
h(should)e(be)i(speci\002ed)e(in)i(the)f(following)h(form:)291
2520 y Fe(NAMESERVICE)50 b(<stringified)f(IOR)k(for)g(the)g(COSS)g
(Naming)f(Service>)291 2665 y Fr(Comments)22 b(in)h(the)f
(con\002guration)g(\002le)h(should)e(be)i(pr)n(e\002xed)e(with)i(a)g
(#.)291 2810 y(On)106 b(W)-5 b(in32)107 b(platforms,)126
b(the)105 b(stringi\002ed)f(IOR)h(can)i(be)e(placed)h(in)g(the)150
2923 y(system)c(r)n(egistry)-10 b(,)123 b(in)105 b(the)e(\(string\))h
(value)h Fe(NAMESERVICE)p Fr(,)99 b(under)k(the)g(key)150
3036 y Fe(HKEY)p 375 3036 V 31 w(LOCAL)p 681 3036 V 30
w(MACHINE)p Fo(n)p Fe(SOFTWARE)p Fo(n)p Fe(ORL)o Fo(n)p
Fe(omn)o(iO)o(RB)o Fo(n)p Fe(2.0)o Fr(.)291 3181 y(Since)23
b(2.6.0,)g(two)f(other)f(entries)h(ar)n(e)h(supported:)314
3585 y Fe(ORBInitialHost)48 b(<hostname)i(string>)314
3698 y(ORBInitialPort)e(<port)k(number)g(\(1-65535\)>)291
4070 y Fr(The)25 b(corr)n(esponding)f(entries)h(under)g(the)g(W)-5
b(in32)27 b(system)d(r)n(egistry)h(is)h(the)f(key)g(with)h(name)150
4183 y Fe(ORBInitialHost)16 b Fr(and)23 b Fe(ORBInitialPort)p
Fr(.)291 4328 y(The)31 b(two)g(entries)g(pr)n(ovide)g(information)i(to)
e(the)g(ORB)g(to)h(locate)g(a)g(bootstrap)e(service)i(at)150
4441 y(r)o(untime.)67 b(The)34 b(bootstrap)h(service)g(is)h(able)g(to)f
(r)n(eturn)g(the)g(initial)i(object)e(r)n(efer)n(ence)g(for)h(the)150
4554 y(COSS)31 b(Naming)g(Service)f(and)g(others.)50
b(This)30 b(is)g(now)g(the)g(r)n(ecommended)f(way)h(to)g(con\002gur)n
(e)150 4666 y(omniORB2.)e(Mor)n(e)23 b(details)f(ar)n(e)h(pr)n(ovided)f
(in)h(section)f(4.6.)150 5161 y Fj(1.3)119 b(Platform)29
b(speci\002c)h(variables)150 5437 y Fr(T)-8 b(o)23 b(compile)h
(omniORB2)h(pr)n(ograms)e(corr)n(ectly)-10 b(,)23 b(several)h(C++)h(pr)
n(epr)n(ocessor)c(de\002nes)h Fm(must)i Fr(be)150 5550
y(speci\002ed)d(to)h(identify)g(the)g(tar)n(get)g(platform.)p
eop
%%Page: 4 10
4 9 bop 30 100 a Fr(4)2062 b Ff(CHAPTER)22 b(1.)51 b(INTRODUCTION)p
30 368 3686 4 v 28 480 4 113 v 80 447 a Fr(Platform)p
996 480 V 615 w(CPP)23 b(de\002nes)p 3714 480 V 30 484
3686 4 v 28 597 4 113 v 80 563 a(Sun)f(Solaris)h(2.5)p
996 597 V 383 w Fe(__sparc__)105 b(__sunos__)g(__OSVERSION__=5)p
3714 597 V 30 600 3686 4 v 28 713 4 113 v 80 679 a Fr(Digital)24
b(Unix)f(3.2)p 996 713 V 336 w Fe(__alpha__)105 b(__osf1__)160
b(__OSVERSION__=3)p 3714 713 V 30 716 3686 4 v 28 829
4 113 v 80 795 a Fr(HPUX)21 b(10.x)p 996 829 V 523 w
Fe(__hppa__)106 b(__hpux__)160 b(__OSVERSION__=)o(10)p
3714 829 V 30 832 3686 4 v 28 945 4 113 v 80 912 a Fr(IBM)22
b(AIX)f(4.x)p 996 945 V 473 w Fe(__aix__)106 b(__powerpc__)159
b(__OSVERSION__=4)p 3714 945 V 30 949 3686 4 v 28 1062
4 113 v 80 1028 a Fr(Linux)22 b(2.0)i(\(x86\))p 996 1062
V 374 w Fe(__x86__)215 b(__linux__)105 b(__OSVERSION__=2)p
3714 1062 V 30 1065 3686 4 v 28 1178 4 113 v 80 1144
a Fr(Linux)22 b(2.0)i(\(alpha\))p 996 1178 V 287 w Fe(__alpha__)214
b(__linux__)105 b(__OSVERSION__=2)p 3714 1178 V 30 1181
3686 4 v 28 1294 4 113 v 80 1260 a Fr(W)-5 b(indows/NT)21
b(3.5)p 996 1294 V 260 w Fe(__x86__)215 b(__NT__)270
b(__OSVERSION__=3)103 b(__WIN32__)p 3714 1294 V 30 1297
3686 4 v 28 1410 4 113 v 80 1376 a Fr(W)-5 b(indows/NT)21
b(4.0)p 996 1410 V 260 w Fe(__x86__)215 b(__NT__)270
b(__OSVERSION__=4)103 b(__WIN32__)p 3714 1410 V 30 1414
3686 4 v 28 1527 4 113 v 80 1493 a Fr(W)-5 b(indows/95)p
996 1527 V 436 w Fe(__x86__)52 b(__WIN32__)p 3714 1527
V 30 1530 3686 4 v 28 1643 4 113 v 80 1609 a Fr(OpenVMS)21
b(6.x)i(\(alpha\))p 996 1643 V 101 w Fe(__alpha__)214
b(__vms)271 b(__OSVERSION__=6)p 3714 1643 V 30 1646 3686
4 v 28 1759 4 113 v 80 1725 a Fr(OpenVMS)21 b(6.x)i(\(vax\))p
996 1759 V 182 w Fe(__vax__)215 b(__vms)271 b(__OSVERSION__=)o(6)p
3714 1759 V 30 1762 3686 4 v 28 1875 4 113 v 80 1841
a Fr(SGI)22 b(Irix)h(6.2)p 996 1875 V 521 w Fe(__mips__)215
b(__irix__)269 b(__OSVERSION__=6)p 3714 1875 V 30 1879
3686 4 v 28 1991 4 113 v 80 1958 a Fr(Reliant)23 b(Unix)f(5.43)p
996 1991 V 282 w Fe(__mips__)215 b(__SINIX__)269 b(__OSVERSION__=)o(5)p
3714 1991 V 30 1995 3686 4 v 28 2108 4 113 v 80 2074
a Fr(A)-7 b(TMos)21 b(4.0)p 996 2108 V 538 w Fe(__arm__)215
b(__atmos__)105 b(__OSVERSION__=4)p 3714 2108 V 30 2111
3686 4 v 28 2224 4 113 v 80 2190 a Fr(NextStep)20 b(3.x)p
996 2224 V 458 w Fe(__m68k__)106 b(__nextstep__)158 b(__OSVERSION__=3)p
3714 2224 V 30 2227 3686 4 v 171 2401 a Fr(The)24 b(pr)n(epr)n(ocessor)
f(de\002nes)g(for)h(new)g(platform)i(ports)d(not)h(listed)g(above)h
(can)h(be)f(found)f(in)30 2514 y(the)h(corr)n(esponding)f(platform)i
(con\002guration)f(\002les.)37 b(For)25 b(instance,)h(the)f(platform)h
(con\002gura-)30 2627 y(tion)18 b(\002le)g(for)g(Sun)g(Solaris)h(2.6)g
(is)f(in)h Fe(mk/platforms/s)o(un4)p 2198 2627 28 4 v
26 w(sosV)p 2445 2627 V 31 w(5.6.mk)p Fr(.)k(The)18 b(pr)n(epr)n(ocess)
30 2740 y(de\002nes)j(to)h(identify)g(a)h(platform)g(is)g(the)f(value)h
(of)g(the)e(make)i(variable)i Fe(IMPORT)p 2883 2740 V
30 w(CPPFLAGS)p Fr(.)171 2853 y(In)f(a)g(single)f(sour)n(ce)g
(multi-tar)n(get)h(envir)n(onment,)g(you)f(can)h(put)f(the)g(pr)n(epr)n
(ocessor)f(de\002nes)30 2966 y(as)k(the)f(command-line)i(ar)n(guments)e
(for)h(the)f(compiler)-7 b(.)38 b(Alternately)-10 b(,)25
b(you)g(could)h(cr)n(eate)g(a)g(sit-)30 3079 y(edef.h)i(\002le)h(in)h
(the)f(same)g(dir)n(ectory)f(as)i Fe(omniORB2/CORBA.)o(h)p
Fr(.)42 b(W)-7 b(rite)29 b(into)g(the)g(\002le)g(the)g(ap-)30
3192 y(pr)n(opriate)21 b(set)g(of)h(pr)n(epr)n(ocessor)e(de\002nes)g
(and)i(add)g Fe(#include)51 b(<omniORB2/sited)o(ef)o(.h)o(>)30
3305 y Fr(at)23 b(the)f(beginning)g(of)h Fe(omniORB2/CORBA)p
1583 3305 V 26 w(sysdep.h)p Fr(.)p eop
%%Page: 5 11
5 10 bop 150 983 a Fl(Chapter)44 b(2)150 1402 y Fn(The)52
b(Basics)150 1851 y Fr(In)29 b(this)g(chapter)-7 b(,)31
b(we)e(go)f(thr)n(ough)h(thr)n(ee)f(examples)h(to)g(illustrate)g(the)g
(practical)i(steps)c(to)i(use)150 1964 y(omniORB2.)f(By)21
b(going)g(thr)n(ough)g(the)g(sour)n(ce)h(code)f(of)h(each)g(example,)g
(the)f(essential)g(concepts)150 2077 y(and)g(APIs)e(ar)n(e)i(intr)n
(oduced.)26 b(If)21 b(you)f(have)h(no)g(pr)n(evious)f(experience)f
(with)h(using)h(CORBA,)f(you)150 2190 y(should)28 b(study)f(this)i
(chapter)g(in)g(detail.)47 b(Ther)n(e)28 b(ar)n(e)i(pointers)d(to)i
(other)e(essential)i(documents)150 2303 y(you)22 b(should)f(be)i
(familiar)i(with.)291 2420 y(If)32 b(you)f(have)h(experience)e(with)i
(using)f(other)g(ORBs,)i(you)e(should)f(still)j(go)e(thr)n(ough)f(this)
150 2533 y(chapter)f(because)g(it)h(pr)n(ovides)e(important)h
(information)h(about)f(the)g(featur)n(es)g(and)g(APIs)f(that)150
2646 y(ar)n(e)g(necessarily)f(omniORB2)h(speci\002c.)42
b(For)27 b(instance,)h(the)f(object)g(implementation)g(skeleton)150
2759 y(is)c(cover)n(ed)f(in)h(section)f(2.4.2.)150 3083
y Fj(2.1)119 b(The)29 b(Echo)i(Object)e(Example)150 3303
y Fr(Our)e(example)f(is)g(an)h(object)f(which)h(has)f(only)g(one)f
(method.)38 b(The)25 b(method)g(simply)i(echos)e(the)150
3416 y(ar)n(gument)d(string.)27 b(W)-8 b(e)22 b(have)h(to:)264
3649 y(1.)45 b(de\002ne)22 b(the)f(object)i(interface)g(in)g(IDL;)264
3854 y(2.)45 b(use)22 b(the)g(IDL)g(compiler)h(to)f(generate)f(the)h
(stub)g(code)2250 3821 y Fk(1)2286 3854 y Fr(;)264 4058
y(3.)45 b(pr)n(ovide)22 b(the)g(object)h(implementation;)264
4263 y(4.)45 b(write)22 b(the)g(client)h(code.)291 4497
y(The)43 b(sour)n(ce)g(code)f(of)i(this)f(example)g(is)h(included)f(in)
h(the)f(last)g(section)g(of)g(this)g(chap-)150 4609 y(ter)-7
b(.)87 b(A)42 b(make\002le)g(written)f(to)h(be)g(used)f(under)h(the)f
(OMNI)h(Development)g(Envir)n(onment)150 4722 y(\(ODE\))24
b([Richar)n(dson96b)q(])f(is)g(also)f(included.)150 5047
y Fj(2.2)119 b(Specifying)30 b(the)f(Echo)i(interface)d(in)i(IDL)150
5266 y Fr(W)-8 b(e)22 b(de\002ne)f(an)i(object)g(interface,)f(called)i
(Echo,)e(as)g(follows:)p 150 5370 1368 4 v 255 5427 a
Fh(1)284 5458 y Fg(The)e(stub)g(code)f(is)f(the)i(C++)g(code)f(that)i
(pr)o(ovides)c(the)k(object)f(mapping)f(as)h(de\002ned)f(in)g(the)h
(CORBA)f(2.0)h(speci-)150 5550 y(\002cation.)1837 5778
y Fr(5)p eop
%%Page: 6 12
6 11 bop 30 100 a Fr(6)2269 b Ff(CHAPTER)21 b(2.)52 b(THE)21
b(BASICS)30 456 y Fd(interface)48 b(Echo)h({)229 555
y(string)g(echoString\(in)e(string)i(mesg\);)30 655 y(};)171
1025 y Fr(If)26 b(you)f(ar)n(e)h(new)g(to)f(IDL,)g(you)g(can)i(learn)f
(about)g(its)g(syntax)f(in)h(Chapter)g(3)g(of)g(the)f(CORBA)30
1138 y(speci\002cation)e(2.0)g([OMG96a)s(].)171 1263
y(For)35 b(the)h(moment,)i(you)d(only)h(need)f(to)g(know)g(that)h(the)f
(interface)h(consists)f(of)h(a)h(single)30 1375 y(operation,)25
b(echoString,)f(which)i(takes)e(a)i(string)f(as)g(an)h(ar)n(gument)f
(and)g(r)n(eturns)f(a)i(copy)f(of)g(the)30 1488 y(same)e(string.)171
1613 y(The)j(interface)h(is)f(written)g(in)h(a)g(\002le,)g(called)g
Fe(echo.idl)p Fr(.)36 b(If)27 b(you)e(ar)n(e)i(using)f(ODE,)h(all)g
(IDL)30 1726 y(\002les)20 b(should)g(have)h(the)f(same)h(extension-)e
Fe(.idl)g Fr(and)i(should)f(be)h(placed)f(in)i(the)e
Fe(idl)f Fr(dir)n(ectory)30 1839 y(of)j(your)f(export)g(tr)n(ee.)27
b(This)22 b(is)g(done)f(so)g(that)h(the)g(stub)f(code)h(will)h(be)f
(generated)e(automatically)30 1952 y(and)j(kept)e(up-to-date)g(with)h
(your)g(IDL)g(\002le.)171 2076 y(For)j(simplicity)-10
b(,)26 b(the)f(interface)g(is)h(de\002ned)d(in)j(the)f(global)h(IDL)f
(namespace.)36 b(This)25 b(practice)30 2189 y(should)g(be)h(avoided)f
(for)h(the)f(sake)g(of)h(object)g(r)n(eusuability)-10
b(.)38 b(If)26 b(every)f(CORBA)g(developer)g(de-)30 2302
y(\002nes)i(their)g(interfaces)g(in)i(the)e(global)h(IDL)f(namespace,)i
(ther)n(e)e(is)h(a)g(danger)e(of)i(name)g(clashes)30
2415 y(between)d(two)g(independently)e(de\002ned)i(interfaces.)38
b(Ther)n(efor)n(e,)26 b(it)g(is)g(better)f(to)h(qualify)h(your)30
2528 y(interfaces)d(by)h(de\002ning)e(them)h(inside)h
Fe(module)d Fr(names.)33 b(Of)25 b(course,)f(this)g(does)f(not)h
(eliminate)30 2641 y(the)c(chance)h(of)g(a)g(name)g(clash)g(unless)f
(some)f(form)i(of)g(naming)g(convention)f(is)h(agr)n(eed)f(globally)-10
b(.)30 2754 y(Nevertheless,)20 b(a)j(well-chosen)f(module)g(name)h(can)
g(help)g(a)g(lot.)30 3124 y Fj(2.3)119 b(Generating)28
b(the)i(C++)h(stubs)30 3358 y Fr(Fr)n(om)23 b(the)g(IDL)g(\002le,)h(we)
f(use)f(the)h(IDL)g(compiler)h(to)f(pr)n(oduce)f(the)h(C++)h(mapping)g
(of)f(the)g(inter)n(-)30 3471 y(face.)28 b(The)22 b(IDL)g(compiler)h
(for)g(omniORB2)g(is)f(called)i Fe(omniidl2)p Fr(.)g(Given)f(the)f(IDL)
g(\002le,)g Fe(omni-)30 3584 y(idl2)i Fr(pr)n(oduces)h(two)g(stub)g
(\002les:)34 b(a)27 b(C++)f(header)f(\002le)h(and)g(a)h(C++)f(sour)n
(ce)g(\002le.)37 b(For)25 b(example,)30 3697 y(fr)n(om)e(the)f(\002le)h
Fe(echo.idl)p Fr(,)c(the)i(following)i(\002les)g(ar)n(e)g(pr)n(oduced:)
166 3967 y Fo(\017)46 b Fe(echo.hh)166 4202 y Fo(\017)g
Fe(echoSK.cc)171 4472 y Fr(If)20 b(you)e(ar)n(e)i(using)f(ODE,)g(you)g
(don't)g(need)f(to)g(invoke)h(omniidl2)i(explicitly)-10
b(.)27 b(In)20 b(the)e(example)30 4585 y(\002le)23 b
Fe(dir.mk)p Fr(,)c(we)k(have)g(the)e(following)i(line:)30
4954 y Fd(CORBA_INTERFACES)47 b(=)i(echo)171 5324 y Fr(That)28
b(is)f(all)i(we)f(need)e(to)h(instr)o(uct)g(ODE)h(to)f(generate)f(the)h
(stubs.)42 b(Remember)-7 b(,)28 b(you)f(won't)30 5437
y(\002nd)h(the)f(stubs)g(in)h(your)f(working)g(dir)n(ectory)g(because)h
(all)h(stubs)e(ar)n(e)i(written)e(into)h(the)f Fe(stub)30
5550 y Fr(dir)n(ectory)22 b(at)g(the)g(top)g(level)h(of)g(your)e(build)
j(tr)n(ee.)p eop
%%Page: 7 13
7 12 bop 150 100 a Ff(2.4.)51 b(A)23 b(QUICK)g(T)n(OUR)f(OF)h(THE)f
(C++)h(STUBS)1658 b Fr(7)150 356 y Fj(2.4)119 b(A)30
b(Quick)f(T)-13 b(our)30 b(of)g(the)f(C++)i(stubs)150
573 y Fr(The)20 b(C++)h(stubs)e(conform)i(to)f(the)f(mapping)i
(de\002ned)d(in)j(the)f(CORBA)g(2.0)i(speci\002cation)e(\(chap-)150
686 y(ter)32 b(16-18\).)59 b(It)32 b(is)h(important)f(to)g(understand)e
(the)i(mapping)g(befor)n(e)g(you)g(start)g(writing)g(any)150
799 y(serious)21 b(CORBA)i(applications.)291 915 y(Befor)n(e)f(going)f
(any)i(further)-7 b(,)22 b(it)h(is)f(worth)g(knowing)g(what)g(the)g
(mapping)h(looks)e(like.)150 1190 y Fi(2.4.1)99 b(Object)25
b(Reference)150 1374 y Fr(The)i(use)h(of)g(an)g(object)g(interface)g
(denotes)e(an)j(object)f(r)n(efer)n(ence.)43 b(For)28
b(the)f(example)h(interface)150 1487 y(Echo,)j(the)e(C++)h(mapping)g
(for)f(its)h(object)f(r)n(efer)n(ence)g(is)h Fe(Echo)p
2408 1487 28 4 v 31 w(ptr)p Fr(.)48 b(The)29 b(type)f(is)i(de\002ned)e
(in)150 1599 y(echo.hh.)f(The)22 b(r)n(elevant)h(section)f(of)g(the)g
(code)g(is)h(r)n(epr)n(oduced)d(below:)150 1918 y Fd(class)49
b(Echo;)150 2017 y(typedef)g(Echo*)f(Echo_ptr;)150 2217
y(class)h(Echo)g(:)h(public)e(virtual)h(omniObject,)f(public)g(vir-)150
2316 y(tual)h(CORBA::Object)e({)150 2416 y(public:)250
2615 y(virtual)h(char)h(*)100 b(echoString)48 b(\()h(const)g(char)g(*)
100 b(mesg)49 b(\))g(=)h(0;)250 2715 y(static)e(Echo_ptr)h(_nil\(\);)
250 2814 y(static)f(Echo_ptr)h(_duplicate\(Echo_ptr\);)250
2914 y(static)f(Echo_ptr)h(_narrow\(CORBA::Object_ptr\);)250
3113 y(...)g(//)g(methods)g(generated)f(for)h(internal)g(use)150
3213 y(};)291 3541 y Fr(In)33 b(a)h(compliant)h(application,)i(the)c
(operations)e(de\002ned)h(in)i(an)g(object)f(interface)h(should)150
3654 y Fm(only)e Fr(be)g(invoked)g(via)i(an)f(object)f(r)n(efer)n
(ence.)57 b(This)32 b(is)h(done)e(by)i(using)f(arr)n(ow)g(\(\223)p
Fo(!)p Fr(\224\))i(on)f(an)150 3767 y(object)19 b(r)n(efer)n(ence.)26
b(For)19 b(example,)h(the)f(call)i(to)e(the)f(operation)h
Fe(echoString)c Fr(would)k(be)g(written)150 3880 y(as)k
Fe(obj)p Fo(!)p Fe(echoString\()o(me)o(sg)o(\))p Fr(.)291
3996 y(It)h(should)g(be)h(noted)e(that)h(the)g(concr)n(ete)g(type)f(of)
i(an)g(object)g(r)n(efer)n(ence)f(is)h(opaque,)f(i.e.)34
b(you)150 4109 y(must)f(not)f(make)i(any)f(assumption)g(about)g(how)g
(an)h(object)f(r)n(efer)n(ence)g(is)g(implemented.)59
b(In)150 4222 y(our)21 b(example,)g(even)h(though)e Fe(Echo)p
1448 4222 V 31 w(ptr)g Fr(is)i(implemented)e(as)i(a)g(pointer)e(to)h
(the)g(class)h Fe(Echo)p Fr(,)e(it)150 4335 y(should)26
b(not)h(be)g(used)f(as)i(a)f(C++)i(pointer)-7 b(,)27
b(i.e.)42 b(conversion)26 b(to)h(void*,)i(arithmetic)f(operations,)150
4448 y(and)f(r)n(elational)i(operations,)e(including)h(test)e(for)h
(equality)g(using)g Fm(operation==)h Fr(must)f(not)f(be)150
4561 y(performed)21 b(on)h(the)g(type.)291 4677 y(In)28
b(addition)f(to)h Fe(echoString)p Fr(,)c(the)j(mapping)h(also)g
(de\002nes)e(thr)n(ee)h(static)i(member)e(func-)150 4790
y(tions)e(in)h(the)f(class)h(Echo:)p 1106 4790 V 67 w
Fe(nil)p Fr(,)p 1352 4790 V 57 w Fe(duplicate)p Fr(,)d(and)p
2105 4790 V 58 w Fe(narrow)p Fr(.)35 b(Note)24 b(that)h(these)f(ar)n(e)
j(opera-)150 4903 y(tions)22 b(on)g(an)h(object)g(r)n(efer)n(ence.)291
5019 y(The)p 466 5019 V 49 w Fe(nil)17 b Fr(function)g(r)n(eturns)f(a)i
(nil)g(object)f(r)n(efer)n(ence)g(of)h(the)e(Echo)h(interface.)26
b(The)17 b(following)150 5132 y(call)24 b(is)f(guaranteed)e(to)h(r)n
(eturn)g(TRUE:)150 5450 y Fd(CORBA::Boolean)47 b(true_result)h(=)i
(CORBA::is_nil\(Echo::_nil\(\)\);)p eop
%%Page: 8 14
8 13 bop 30 100 a Fr(8)2269 b Ff(CHAPTER)21 b(2.)52 b(THE)21
b(BASICS)171 356 y Fr(Remember)-7 b(,)37 b Fe(CORBA::is)p
1163 356 28 4 v 28 w(nil\(\))c Fr(is)h(the)g(only)g(compliant)h(way)g
(to)f(check)g(if)h(an)g(object)30 469 y(r)n(efer)n(ence)22
b(is)h(nil.)28 b(Y)-8 b(ou)22 b(should)g(not)f(use)h(the)g(equality)g
(operator==.)171 582 y(The)p 364 582 V 67 w Fe(duplicate)30
b Fr(function)35 b(r)n(eturns)f(a)h(new)f(object)g(r)n(efer)n(ence)g
(of)h(the)f(Echo)g(interface.)30 695 y(The)22 b(new)h(object)g(r)n
(efer)n(ence)f(can)i(be)f(used)f(inter)n(changeably)h(with)g(the)g(old)
f(object)h(r)n(efer)n(ence)g(to)30 808 y(perform)f(an)h(operation)f(on)
g(the)g(same)g(object.)171 920 y(All)90 b(CORBA)e(objects)g(inherit)h
(fr)n(om)g(the)f(generic)h(object)f Fe(CORBA::Object)p
Fr(.)30 1033 y Fe(CORBA::Object)p 750 1033 V 27 w(ptr)49
b Fr(is)i(the)e(object)i(r)n(efer)n(ence)e(for)i Fe(CORBA::Object)p
Fr(.)105 b(Any)50 b(object)30 1146 y(r)n(efer)n(ence)36
b(is)h(ther)n(efor)n(e)e(conceptually)i(inherited)e(fr)n(om)j
Fe(CORBA::Object)p 2840 1146 V 26 w(ptr)p Fr(.)69 b(In)36
b(other)30 1259 y(wor)n(ds,)60 b(an)55 b(object)e(r)n(efer)n(ence)h
(such)f(as)h Fe(Echo)p 1833 1259 V 31 w(ptr)f Fr(can)i(be)f(used)e(in)i
(places)g(wher)n(e)g(a)30 1372 y Fe(CORBA::Object)p 750
1372 V 27 w(ptr)21 b Fr(is)i(expected.)171 1485 y(The)p
358 1485 V 61 w Fe(narrow)j Fr(function)j(takes)e(an)j(ar)n(gument)e
(of)h(the)f(type)f Fe(CORBA::Object)p 3082 1485 V 27
w(ptr)g Fr(and)30 1598 y(r)n(eturns)21 b(a)i(new)e(object)h(r)n(efer)n
(ence)g(of)g(the)f(Echo)h(interface.)28 b(If)22 b(the)f(actual)j(\(r)o
(untime\))e(type)f(of)h(the)30 1711 y(ar)n(gument)j(object)g(r)n(efer)n
(ence)g(can)i(be)e(widened)f(to)h Fe(Echo)p 2092 1711
V 31 w(ptr)p Fr(,)p 2336 1711 V 57 w Fe(narrow)e Fr(will)k(r)n(eturn)e
(a)h(valid)30 1824 y(object)c(r)n(efer)n(ence.)28 b(Otherwise)21
b(it)i(will)h(r)n(eturn)e(a)h(nil)g(object)g(r)n(efer)n(ence.)171
1937 y(T)-8 b(o)32 b(indicate)i(that)f(an)g(object)g(r)n(efer)n(ence)f
(will)j(no)d(longer)h(be)g(accessed,)h(you)e(can)i(call)h(the)30
2050 y Fe(CORBA::release)16 b Fr(operation.)27 b(Its)22
b(signatur)n(e)g(is)g(as)h(follows:)30 2345 y Fd(class)49
b(CORBA)g({)179 2445 y(static)g(void)g(release\(CORBA::Object_ptr)c
(obj\);)179 2544 y(...)50 b(//)f(other)g(methods)30 2644
y(};)171 2853 y Fr(Y)-8 b(ou)28 b(should)f(not)h(use)g(an)h(object)g(r)
n(efer)n(ence)f(once)g(you)g(have)h(called)h Fe(CORBA::release)o
Fr(.)30 2966 y(This)e(is)h(because)f(the)g(associated)g(r)n(esour)n
(ces)f(may)i(have)g(been)f(deallocated.)45 b(Notice)28
b(that)h(we)30 3079 y(ar)n(e)f(r)n(eferring)f(to)g(the)g(r)n(esour)n
(ces)g(associated)g(with)g(the)g(object)h(r)n(efer)n(ence)f(and)g
Fm(not)g(the)i(object)30 3192 y(implementation)p Fr(.)50
b(Her)n(e)29 b(is)h(a)g(concr)n(ete)f(example,)i(if)g(the)e
(implementation)g(of)h(an)g(object)g(r)n(e-)30 3305 y(sides)d(in)i(a)g
(dif)n(fer)n(ent)f(addr)n(ess)f(space,)i(then)f(a)h(call)h(to)e
Fe(CORBA::release)22 b Fr(will)30 b(only)e(caused)30
3418 y(the)h(r)n(esour)n(ces)f(associated)h(with)h(the)f(object)g(r)n
(efer)n(ence)g(in)h(the)f(curr)n(ent)h(addr)n(ess)e(space)h(to)g(be)30
3531 y(deallocated.)f(The)21 b(object)i(implementation)f(in)i(the)d
(other)h(addr)n(ess)f(space)h(is)h(unaf)n(fected.)171
3644 y(As)35 b(described)g(above,)40 b(the)35 b(equality)h(operator==)e
(should)h(not)h(be)g(used)e(on)i(object)g(r)n(ef-)30
3757 y(er)n(ences.)114 b(T)-8 b(o)51 b(test)g(if)h(two)f(object)h(r)n
(efer)n(ences)f(ar)n(e)h(equivalent,)59 b(the)51 b(member)h(function)p
30 3869 V 57 3869 a Fe(is)p 172 3869 V 32 w(equivalent)22
b Fr(of)27 b(the)f(generic)g(object)g Fe(CORBA::Object)21
b Fr(can)27 b(be)g(used.)38 b(Her)n(e)26 b(is)g(an)h(ex-)30
3982 y(ample)c(of)g(its)f(usage:)30 4278 y Fd(Echo_ptr)48
b(A;)30 4378 y(...)597 b(//)50 b(initialised)d(A)j(to)f(a)h(valid)f
(object)g(reference)30 4477 y(Echo_ptr)f(B)i(=)g(A;)30
4577 y(CORBA::Boolean)d(true_result)h(=)i(A->_is_equivalent\(B\);)30
4676 y(//)f(Note:)g(the)h(above)e(call)i(is)f(guaranteed)f(to)h(be)h
(TRUE)171 4985 y Fr(Y)-8 b(ou)36 b(have)i(now)f(been)g(intr)n(oduced)f
(to)h(most)f(of)i(the)e(operations)g(that)h(can)i(be)e(invoked)30
5098 y(via)29 b Fe(Echo)p 406 5098 V 30 w(ptr)p Fr(.)41
b(The)26 b(generic)g(object)h Fe(CORBA::Object)22 b Fr(pr)n(ovides)k(a)
i(few)f(mor)n(e)g(operations)30 5211 y(and)33 b(all)i(of)e(them)g(can)h
(be)f(invoked)f(via)j Fe(Echo)p 1746 5211 V 31 w(ptr)p
Fr(.)58 b(These)32 b(operations)f(deal)j(mainly)g(with)30
5324 y(CORBA)-7 b('s)21 b(dynamic)h(interfaces.)27 b(Y)-8
b(ou)19 b(do)h(not)h(have)g(to)f(understand)f(them)h(in)i(or)n(der)e
(to)g(use)g(the)30 5437 y(C++)28 b(mapping)g(pr)n(ovided)e(via)j(the)d
(stubs.)42 b(For)26 b(details,)i(please)f(r)n(ead)g(the)g(CORBA)g
(speci\002ca-)30 5550 y(tion)22 b([OMG96a)s(])h(chapter)f(17.)p
eop
%%Page: 9 15
9 14 bop 150 100 a Ff(2.4.)51 b(A)23 b(QUICK)g(T)n(OUR)f(OF)h(THE)f
(C++)h(STUBS)1658 b Fr(9)291 356 y(Since)20 b(object)g(r)n(efer)n
(ences)f(must)h(be)g(r)n(eleased)f(explicitly)-10 b(,)20
b(their)g(usage)f(is)h(pr)n(one)f(to)h(err)n(or)f(and)150
469 y(can)k(lead)g(to)f(memory)g(leakage.)27 b(The)22
b(mapping)h(de\002nes)d(the)i Fm(object)h(reference)j(variable)e
Fr(type)150 582 y(to)e(make)h(life)g(easier)-7 b(.)28
b(In)22 b(our)g(example,)g(the)g(variable)j(type)c Fe(Echo)p
2500 582 28 4 v 31 w(var)g Fr(is)i(de\002ned)3108 549
y Fk(2)3143 582 y Fr(.)291 695 y(The)k Fe(Echo)p 696
695 V 31 w(var)f Fr(is)i(mor)n(e)f(convenient)g(to)g(use)f(because)i
(it)f(will)i(automatically)g(r)n(elease)e(its)150 808
y(object)g(r)n(efer)n(ence)g(when)f(it)i(is)f(deallocated)g(or)g(when)g
(assigned)f(a)i(new)f(object)g(r)n(efer)n(ence.)41 b(For)150
920 y(many)30 b(operations,)f(mixing)i(data)f(of)f(type)f
Fe(Echo)p 1951 920 V 31 w(var)h Fr(and)g Fe(Echo)p 2579
920 V 31 w(ptr)g Fr(is)g(possible)g(without)150 1033
y(any)24 b(explicit)h(operations)e(or)h(castings)1550
1000 y Fk(3)1587 1033 y Fr(.)33 b(For)23 b(instance,)i(the)e(operation)
g Fe(echoString)d Fr(can)25 b(be)150 1146 y(called)f(using)e(the)f(arr)
n(ow)i(\(\223)p Fo(!)p Fr(\224\))h(on)f(a)g Fe(Echo)p
1753 1146 V 31 w(var)p Fr(,)e(as)h(one)g(can)i(do)e(with)g(a)h
Fe(Echo)p 3053 1146 V 31 w(ptr)p Fr(.)291 1259 y(The)f(usage)g(of)g
Fe(Echo)p 1049 1259 V 31 w(var)g Fr(is)g(illustrated)g(below:)150
1551 y Fd(Echo_var)48 b(a;)150 1651 y(Echo_ptr)g(p)i(=)g(...)248
b(//)50 b(somehow)e(obtain)h(an)g(object)g(reference)150
1850 y(a)h(=)f(p;)747 b(//)50 b(a)f(assumes)g(ownership)f(of)h(p,)h
(must)f(not)g(use)g(p)h(anymore)150 2049 y(Echo_var)e(b)i(=)g(a;)298
b(//)50 b(implicit)e(_duplicate)150 2249 y(p)i(=)f(...)697
b(//)50 b(somehow)e(obtain)h(another)f(object)h(reference)150
2448 y(a)h(=)f(Echo::_duplicate\(p\);)246 b(//)49 b(release)g(old)g
(object)f(reference)1595 2547 y(//)h(a)h(now)f(holds)g(a)g(copy)g(of)h
(p.)150 2801 y Fi(2.4.2)99 b(Object)25 b(Implementation)150
2978 y Fr(Unlike)i(the)f(client)i(side)f(of)g(an)g(object,)h(i.e.)42
b(the)26 b(use)h(of)g(object)g(r)n(efer)n(ences,)g(the)f(CORBA)i(spec-)
150 3091 y(i\002cation)e(2.0)g(deliberately)f(leave)h(many)f(of)h(the)e
(necessary)g(functionalities)i(to)f(implement)g(an)150
3204 y(object)i(unspeci\002ed.)38 b(As)27 b(a)g(consequence,)f(it)h(is)
g(very)f(unlikely)g(the)g(implementation)h(code)f(of)150
3317 y(an)21 b(object)f(on)g(top)f(of)i(two)e(dif)n(fer)n(ent)h(ORBs)g
(can)h(be)g(identical.)27 b(However)-7 b(,)20 b(most)f(of)i(the)e(code)
h(ar)n(e)150 3430 y(expected)26 b(to)i(be)g(portable.)44
b(In)28 b(particular)-7 b(,)30 b(the)e(body)f(of)h(an)h(operation)e
(implementation)h(can)150 3543 y(normally)23 b(be)g(ported)e(with)h(no)
g(or)h(little)g(modi\002cation.)291 3655 y(OmniORB2)34
b(uses)d(C++)i(inheritance)g(to)e(pr)n(ovide)h(the)g(skeleton)e(code)i
(for)g(object)g(imple-)150 3768 y(mentation.)52 b(For)30
b(each)h(object)g(interface,)i(a)e(skeleton)e(class)i(is)g(generated.)
51 b(In)30 b(our)g(example,)150 3881 y(the)23 b(skeleton)f(class)p
878 3881 V 58 w Fe(sk)p 1021 3881 V 32 w(Echo)g Fr(is)i(generated)e
(for)i(the)f(Echo)h(IDL)g(interface.)33 b(An)23 b(object)h(imple-)150
3994 y(mentation)29 b(can)i(be)e(written)g(by)g(cr)n(eating)h(an)g
(implementation)g(class)g(that)f(derives)g(fr)n(om)h(the)150
4107 y(skeleton)21 b(class.)291 4220 y(The)30 b(skeleton)e(class)p
1065 4220 V 64 w Fe(sk)p 1207 4220 V 32 w(Echo)h Fr(is)h(de\002ned)f
(in)i Fe(echo.hh)p Fr(.)48 b(The)30 b(r)n(elevant)h(section)e(of)i(the)
150 4333 y(code)22 b(is)h(r)n(epr)n(oduced)d(below)-8
b(.)150 4625 y Fd(class)49 b(_sk_Echo)f(:)100 b(public)48
b(virtual)h(Echo)g({)150 4725 y(public:)250 4824 y(_sk_Echo\(const)e
(omniORB::objectKey&)f(k\);)250 4924 y(virtual)i(char)h(*)100
b(echoString)48 b(\()h(const)g(char)g(*)100 b(mesg)49
b(\))g(=)h(0;)250 5023 y(Echo_ptr)397 b(_this\(\);)p
150 5095 1368 4 v 255 5151 a Fh(2)284 5183 y Fg(In)52
b(omniORB2,)59 b(all)51 b(object)h(r)o(efer)o(ence)d(variable)i(types)f
(ar)o(e)h(instantiated)h(fr)o(om)e(the)i(template)f(type)p
150 5274 23 4 v 172 5274 a(CORBA)p 442 5274 V 27 w(ObjRef)p
697 5274 V 27 w(V)-7 b(ar)h(.)255 5335 y Fh(3)284 5367
y Fg(However)g(,)33 b(the)d(implementation)g(of)f(the)h(type)f
(conversion)h(operator\(\))e(between)i(Echo)p 2963 5367
V 27 w(var)g(and)g(Echo)p 3448 5367 V 27 w(ptr)150 5458
y(varies)15 b(slightly)f(among)i(dif)o(fer)o(ent)e(C++)i(compilers,)f
(you)g(may)g(need)g(to)h(do)f(an)i(explicit)d(casting)i(when)h(the)f
(compiler)150 5550 y(complains)j(about)g(the)g(conversion)g(being)f
(ambiguous.)p eop
%%Page: 10 16
10 15 bop 30 100 a Fr(10)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fd(void)597 b(_obj_is_ready\(BOA_ptr\);)130
456 y(void)g(_dispose\(\);)130 555 y(BOA_ptr)447 b(_boa\(\);)130
655 y(omniORB::objectKey)46 b(_key\(\);)130 754 y(...)j(//)g(methods)g
(generated)f(for)h(internal)g(use)30 854 y(};)171 1187
y Fr(The)26 b(code)h(fragment)f(shows)g(the)g(only)h(member)g
(functions)g(that)g(can)g(be)g(used)f(in)i(the)e(ob-)30
1300 y(ject)18 b(implementation)g(code.)25 b(Other)18
b(member)f(functions)h(ar)n(e)g(generated)e(for)i(internal)g(use)f
(only)-10 b(.)30 1413 y Fm(Unless)25 b(speci\002ed)g(otherwise,)g(the)g
(description)g(below)f(is)g(omniORB2)f(speci\002c.)34
b Fr(The)23 b(func-)30 1525 y(tions)f(ar)n(e:)30 1759
y Fm(echoString)45 b Fr(it)24 b(is)g(thr)n(ough)e(this)i(abstract)g
(function)g(that)f(an)h(implementation)g(class)g(pr)n(ovides)257
1871 y(the)k(implementation)h(of)f(the)g Fe(echoString)c
Fr(operation.)45 b(Notice)27 b(that)i(its)f(signatur)n(e)g(is)257
1984 y(the)j(same)h(as)g(the)f Fe(echoString)c Fr(function)32
b(that)f(can)i(be)f(invoked)e(via)k(the)c Fe(Echo)p 3260
1984 28 4 v 31 w(ptr)257 2097 y Fr(object)k(r)n(efer)n(ence.)63
b Fm(The)34 b(signature)h(of)f(this)h(function)f(is)h(speci\002ed)g(by)
f(the)h(CORBA)257 2210 y(speci\002cation)p Fr(.)p 35
2414 V 63 2414 a Fm(this)46 b Fr(this)20 b(function)h(r)n(eturns)e(an)i
(object)f(r)n(efer)n(ence)g(for)h(the)f(tar)n(get)g(object.)27
b(The)19 b(r)n(eturned)g(value)257 2527 y(must)25 b(be)g(deallocated)g
(via)i Fe(CORBA::release)o Fr(.)j(See)24 b(2.7)i(for)g(an)f(example)g
(of)h(how)e(this)257 2640 y(function)f(is)g(used.)p 35
2844 V 63 2844 a Fm(obj)p 205 2844 V 32 w(is)p 307 2844
V 33 w(ready)46 b Fr(this)34 b(function)g(tells)g(the)g(Basic)h(Object)
f(Adaptor)2400 2811 y Fk(4)2471 2844 y Fr(\(BOA\))g(that)g(the)g
(object)g(is)257 2957 y(r)n(eady)c(to)f(serve.)49 b(Until)30
b(this)g(function)g(is)g(called,)i(the)d(BOA)h(would)f(not)g(serve)g
(any)h(in-)257 3070 y(coming)23 b(calls)h(to)e(this)g(object.)28
b(See)22 b(2.7)h(for)g(an)g(example)f(of)h(how)f(this)g(function)h(is)g
(used.)p 35 3274 V 63 3274 a Fm(dispose)45 b Fr(this)23
b(function)f(tells)h(the)f(BOA)g(to)g(dispose)f(of)h(the)g(object.)28
b(The)22 b(BOA)g(will)i(stop)d(serv-)257 3387 y(ing)32
b(incoming)h(calls)g(of)f(this)f(object)h(and)g(r)n(emove)g(any)g(r)n
(esour)n(ces)e(associated)h(with)h(it.)257 3500 y(See)22
b(2.7)h(for)g(an)g(example)f(of)h(how)f(this)g(function)h(is)g(used.)p
35 3704 V 63 3704 a Fm(boa)45 b Fr(this)22 b(function)h(r)n(eturns)e(a)
i(r)n(efer)n(ence)f(to)g(the)g(BOA)h(that)f(serves)f(this)h(object.)p
35 3908 V 63 3908 a Fm(key)45 b Fr(this)37 b(function)h(r)n(eturns)f
(the)g(key)g(that)g(the)g(ORB)h(used)e(to)i(identify)f(this)g(object.)
74 b(The)257 4021 y(type)27 b Fe(omniORB::object)o(Ke)o(y)22
b Fr(is)29 b(opaque)e(to)h(application)h(code.)44 b(The)28
b(function)g Fe(om-)257 4134 y(niORB::keyToOct)o(etS)o(eq)o(ue)o(nc)o
(e)20 b Fr(can)26 b(be)g(used)e(to)h(convert)g(the)g(key)g(to)g(a)h
(sequence)257 4246 y(of)d(octets.)30 4570 y Fj(2.5)119
b(W)-9 b(riting)29 b(the)h(object)f(implementation)30
4790 y Fr(Y)-8 b(ou)30 b(de\002ne)g(an)i(implementation)f(class)h(to)e
(pr)n(ovide)h(the)g(object)g(implementation.)54 b(Ther)n(e)30
b(is)30 4902 y(little)23 b(constraint)e(on)h(how)g(you)f(design)g(your)
g(implementation)h(class)h(except)e(that)h(it)h(has)f(to)f(in-)30
5015 y(herit)e(fr)n(om)i(the)d(stubs')h(skeleton)f(class)i(and)g(to)f
(implement)g(all)j(the)c(abstract)j(functions)e(de\002ned)30
5128 y(in)27 b(the)e(skeleton)f(class.)40 b(Each)26 b(of)h(these)d
(abstract)j(functions)f(corr)n(esponds)e(to)h(an)i(operation)e(of)30
5241 y(the)c(interface.)28 b(They)21 b(ar)n(e)i(hooks)d(for)i(the)g
(ORB)g(to)f(perform)h(upcalls)h(to)e(your)g(implementation.)171
5358 y(Her)n(e)h(is)h(a)g(simple)f(implementation)h(of)g(the)e(Echo)i
(object.)p 30 5462 1368 4 v 135 5518 a Fh(4)164 5550
y Fg(The)c(interface)g(of)f(a)h(BOA)g(is)f(described)f(in)i(chapter)g
(8)g(of)f(the)i(CORBA)e(speci\002cation.)p eop
%%Page: 11 17
11 16 bop 150 100 a Ff(2.6.)51 b(WRITING)22 b(THE)f(CLIENT)2162
b Fr(1)-5 b(1)150 356 y Fd(class)49 b(Echo_i)g(:)g(public)g(virtual)f
(_sk_Echo)h({)150 456 y(public:)250 555 y(Echo_i\(\))f({})250
655 y(virtual)g(\230Echo_i\(\))g({})250 754 y(virtual)g(char)h(*)h
(echoString\(const)d(char)i(*mesg\);)150 854 y(};)150
1053 y(char)g(*)150 1153 y(Echo_i::echoString\(const)c(char)k(*mesg\))g
({)250 1253 y(char)g(*p)g(=)h(CORBA::string_dup\(mesg\);)250
1352 y(return)e(p;)150 1452 y(})291 1666 y Fr(Ther)n(e)22
b(ar)n(e)h(thr)n(ee)e(points)h(to)g(note)f(her)n(e:)150
1855 y Fm(Storage)i(Responsibilities)47 b Fr(A)28 b(string,)h(which)g
(is)g(used)e(as)i(an)g(IN)f(ar)n(gument)g(and)h(the)f(r)n(eturn)377
1968 y(value)g(of)f Fe(echoString)p Fr(,)c(is)k(a)g(variable)i(size)e
(data)g(type.)39 b(Other)27 b(examples)f(of)h(variable)377
2081 y(size)33 b(data)g(types)d(include)j(sequences,)f(type)f
(\223any\224,)36 b(etc.)57 b(For)32 b(these)f(data)h(types,)h(you)377
2194 y(must)24 b(be)g(clear)h(about)f(who's)f(r)n(esponsibility)h(to)f
(allocate)i(and)g(r)n(elease)e(their)h(associated)377
2307 y(storage.)k(As)22 b(a)i(r)o(ule)f(of)g(thumb,)g(the)f(client)h
(\(or)g(the)g(caller)h(to)e(the)g(implementation)h(func-)377
2419 y(tions\))29 b(owns)e(the)h(storage)f(of)i(all)h(IN)e(ar)n
(guments,)h(the)f(object)h(implementation)f(\(or)h(the)377
2532 y(callee\))e(must)e(copy)g(the)g(data)h(if)g(it)g(wants)f(to)g(r)n
(etain)h(a)h(copy)-10 b(.)36 b(For)25 b(OUT)g(ar)n(guments)g(and)377
2645 y(r)n(eturn)34 b(values,)k(the)c(object)h(implementation)f
(allocates)i(the)e(storage)f(and)i(passes)e(the)377 2758
y(ownership)25 b(to)h(the)f(client.)40 b(The)26 b(client)g(must)g(r)n
(elease)g(the)g(storage)e(when)i(the)g(variables)377
2871 y(will)33 b(no)e(longer)g(be)h(used.)53 b(For)31
b(details,)i(please)e(r)n(efer)g(to)g(T)-8 b(able)32
b(24-27)i(of)d(the)g(CORBA)377 2984 y(speci\002cation.)150
3173 y Fm(Multi-threading)46 b Fr(As)18 b(omniORB2)h(is)f(fully)h
(multithr)n(eaded,)f(multiple)h(thr)n(eads)e(may)i(perform)377
3286 y(the)f(same)g(upcall)i(to)e(your)g(implementation)g(concurr)n
(ently)-10 b(.)26 b(It)18 b(is)g(up)g(to)g(your)g(implemen-)377
3399 y(tation)26 b(to)g(synchr)n(onise)f(the)h(thr)n(eads')f(accesses)h
(to)f(shar)n(ed)h(data.)39 b(In)26 b(our)g(simple)h(exam-)377
3512 y(ple,)20 b(we)g(have)g(no)g(shar)n(ed)f(data)i(to)e(pr)n(otect)g
(so)g(no)h(thr)n(ead)g(synchr)n(onisation)f(is)h(necessary)-10
b(.)150 3701 y Fm(Instantiation)47 b Fr(Y)-8 b(ou)20
b(must)h(not)g(instantiate)g(an)h(implementation)f(as)h(automatic)g
(variables.)29 b(In-)377 3814 y(stead,)19 b(you)g(should)g(always)h
(instantiate)f(an)i(implementation)e(using)h(the)e(new)i(operator)-7
b(,)377 3926 y(i.e.)45 b(its)29 b(storage)d(is)j(allocated)g(on)f(the)g
(heap.)45 b(The)28 b(r)n(eason)g(behind)g(this)g(r)n(estriction)g(will)
377 4039 y(become)23 b(clear)g(in)g(section)f(2.7.)150
4340 y Fj(2.6)119 b(W)-9 b(riting)29 b(the)h(client)150
4552 y Fr(Her)n(e)22 b(is)g(an)i(example)e(of)h(how)f(a)h
Fe(Echo)p 1539 4552 28 4 v 31 w(ptr)e Fr(object)i(r)n(efer)n(ence)f(is)
g(used.)150 4753 y Fd(void)150 4852 y(hello\(CORBA::Object_ptr)46
b(obj\))150 4952 y({)250 5052 y(Echo_var)i(e)i(=)f
(Echo::_narrow\(obj\);)794 b(//)49 b(line)g(1)250 5251
y(if)g(\(CORBA::is_nil\(e\)\))e({)1245 b(//)49 b(line)g(2)349
5351 y(cerr)g(<<)h("hello:)e(cannot)h(invoke)g(on)g(a)h(nil)f(object)g
(refer-)150 5450 y(ence.\\n")f(<<)i(endl;)349 5550 y(return;)p
eop
%%Page: 12 18
12 17 bop 30 100 a Fr(12)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fd(})130 555 y(CORBA::String_var)46
b(src)k(=)f(\(const)g(char*\))g("Hello!";)97 b(//)50
b(line)f(3)130 655 y(CORBA::String_var)d(dest;)1294 b(//)50
b(line)f(4)130 854 y(dest)g(=)g(e->echoString\(src\);)1142
b(//)50 b(line)f(5)130 1053 y(cerr)g(<<)g("I)h(said,\\"")e(<<)h(src)h
(<<)f("\\".")379 1153 y(<<)g(")h(The)f(Object)g(said,\\"")f(<<)h(dest)h
(<<"\\"")e(<<)i(endl;)30 1253 y(})171 1426 y Fr(Brie\003y)-10
b(,)22 b(the)f(function)i Fe(hello)e Fr(accepts)h(a)h(generic)f(object)
g(r)n(efer)n(ence.)27 b(The)22 b(object)h(r)n(efer)n(ence)30
1539 y(\()p Fe(obj)p Fr(\))i(is)h(narr)n(owed)f(to)g
Fe(Echo)p 1120 1539 28 4 v 30 w(ptr)p Fr(.)36 b(If)26
b(the)f(object)g(r)n(efer)n(ence)g(r)n(eturned)f(by)i
Fe(Echo::)p 3098 1539 V 30 w(narrow)30 1652 y Fr(is)j(not)e(nil,)k(the)
d(operation)f Fe(echoString)d Fr(is)29 b(invoked.)45
b(Finally)-10 b(,)30 b(both)e(the)g(ar)n(gument)g(to)g(and)30
1765 y(the)22 b(r)n(eturn)g(value)h(of)g Fe(echoString)18
b Fr(ar)n(e)23 b(printed)e(to)h(cerr)-7 b(.)171 1878
y(The)24 b(example)g(also)g(illustrates)g(how)g(T)p 1581
1878 V 32 w(var)h(types)d(ar)n(e)j(used.)31 b(As)24 b(it)g(was)g
(explained)g(in)h(the)30 1991 y(pr)n(evious)d(section,)f(T)p
793 1991 V 32 w(var)j(types)c(take)h(car)n(e)i(of)g(storage)d
(allocation)k(and)f(r)n(elease)e(automatically)30 2104
y(when)h(variables)i(of)f(the)f(type)f(ar)n(e)i(assigned)e(to)h(or)g
(when)g(the)g(variables)i(go)e(out)g(of)g(scope.)171
2217 y(In)g(line)g(1,)h(the)e(variable)j Fe(e)d Fr(takes)g(over)h(the)f
(storage)f(r)n(esponsibility)i(of)g(the)f(object)h(r)n(efer)n(ence)30
2330 y(r)n(eturned)31 b(by)i Fe(Echo::)p 882 2330 V 30
w(narrow)p Fr(.)56 b(The)33 b(object)g(r)n(efer)n(ence)f(is)h(r)n
(eleased)f(by)h(the)f(destr)o(uctor)f(of)30 2443 y Fe(e)p
Fr(.)55 b(It)31 b(is)h(called)h(automatically)g(when)e(the)g(function)h
(r)n(eturns.)54 b(Line)31 b(2)i(and)f(5)g(shows)e(how)i(a)30
2556 y Fe(Echo)p 255 2556 V 31 w(var)25 b Fr(variable)j(is)f(used.)37
b(As)26 b(said)g(earlier)-7 b(,)28 b Fe(Echo)p 2022 2556
V 31 w(var)d Fr(type)g(can)i(be)f(used)f(inter)n(change-)30
2668 y(ably)e(with)g Fe(Echo)p 658 2668 V 31 w(ptr)e
Fr(type.)171 2781 y(The)90 b(ar)n(gument)f(and)i(the)e(r)n(eturn)h
(value)g(of)h Fe(echoString)86 b Fr(ar)n(e)k(stor)n(ed)f(in)30
2894 y Fe(CORBA::String)p 750 2894 V 27 w(var)26 b Fr(variable)j
Fe(src)d Fr(and)h Fe(dest)e Fr(r)n(espectively)-10 b(.)40
b(The)27 b(strings)e(managed)i(by)30 3007 y(the)h(variables)i(ar)n(e)f
(deallocated)g(by)f(the)g(destr)o(uctor)f(of)i Fe(CORBA::String)p
2775 3007 V 26 w(var)p Fr(.)45 b(It)28 b(is)h(called)30
3120 y(automatically)k(when)e(the)f(function)i(r)n(eturns.)52
b(Line)31 b(5)h(shows)e(how)h Fe(CORBA::String)p 3265
3120 V 26 w(var)30 3233 y Fr(variables)36 b(ar)n(e)g(used.)63
b(They)34 b(can)i(be)e(used)g(in)h(place)h(of)f(a)g(string)f(\(for)h
(which)h(the)e(mapping)30 3346 y(is)39 b Fe(char*)52
b Fr(\))491 3313 y Fk(5)529 3346 y Fr(.)78 b(As)38 b(used)g(in)h(line)h
(3,)j(assigning)c(a)h(constant)e(string)g(\()p Fe(const)53
b(char*)p Fr(\))37 b(to)i(a)30 3459 y Fe(CORBA::String)p
750 3459 V 27 w(var)25 b Fr(causes)h(the)g(string)g(to)g(be)h(copied.)
39 b(On)27 b(the)f(other)n(hand,)g(assigning)h(a)30 3572
y Fe(char*)g Fr(to)i(a)h Fe(CORBA::String)p 1236 3572
V 27 w(var)p Fr(,)f(as)h(used)e(in)i(line)g(5,)h(causes)e(the)f(latter)
h(to)g(assume)g(the)30 3685 y(ownership)21 b(of)i(the)f(string)970
3652 y Fk(6)1006 3685 y Fr(.)171 3798 y(Under)c(the)h(C++)i(mapping,)f
(T)p 1259 3798 V 32 w(var)g(types)e(ar)n(e)i(pr)n(ovided)f(for)g(all)i
(the)e(non-basic)i(data)e(types.)30 3910 y(It)h(is)h(obvious)g(that)f
(one)h(should)e(use)h(automatic)i(variables)g(whenever)e(possible)g
(both)g(to)h(avoid)30 4023 y(memory)i(leak)h(and)g(to)f(maximise)i
(performance.)31 b(However)-7 b(,)23 b(when)g(one)g(has)h(to)f
(allocate)i(data)30 4136 y(items)33 b(on)f(the)g(heap,)j(it)e(is)h(a)f
(good)e(practice)j(to)e(use)g(the)g(T)p 2187 4136 V 33
w(var)i(types)d(to)h(manage)h(the)f(heap)30 4249 y(storage.)30
4541 y Fj(2.7)119 b(Example)29 b(1)h(-)g(Colocated)g(Client)g(and)f
(Implementation)30 4752 y Fr(Having)35 b(intr)n(oduced)e(the)g(client)i
(and)f(the)f(object)h(implementation,)j(we)c(can)i(now)f(describe)30
4865 y(how)23 b(to)g(link)h(up)f(the)f(two)h(via)i(the)d(ORB.)h(In)g
(this)g(section,)g(we)g(describe)f(an)i(example)g(in)g(which)30
4978 y(both)29 b(the)g(client)h(and)f(the)g(object)g(implementation)g
(ar)n(e)h(in)g(the)f(same)g(addr)n(ess)f(space.)48 b(In)29
b(the)30 5091 y(next)g(two)g(sections,)h(we)g(shall)h(describe)e(the)g
(case)h(wher)n(e)f(the)g(two)g(ar)n(e)h(in)h(dif)n(fer)n(ent)f(addr)n
(ess)30 5204 y(spaces.)p 30 5278 1368 4 v 135 5334 a
Fh(5)164 5365 y Fg(A)19 b(conversion)g(operator\(\))e(of)i
(CORBA::String)p 1567 5365 23 4 v 25 w(var)g(converts)g(a)g
(CORBA::String)p 2580 5365 V 25 w(var)g(to)g(a)g(char*.)135
5427 y Fh(6)164 5458 y Fg(Please)i(r)o(efer)f(to)h(the)i(CORBA)d
(speci\002cation)i(16.7)g(for)f(the)h(details)f(of)g(the)h(String)p
2552 5458 V 27 w(var)f(mapping.)31 b(Other)21 b(T)p 3318
5458 V 27 w(var)30 5550 y(types)d(ar)o(e)g(also)g(cover)o(ed)f(in)i
(chapter)h(16.)p eop
%%Page: 13 19
13 18 bop 150 100 a Ff(2.7.)51 b(EXAMPLE)21 b(1)i(-)g(COLOCA)-7
b(TED)24 b(CLIENT)d(AND)h(IMPLEMENT)-7 b(A)g(TION)515
b Fr(13)291 356 y(The)22 b(code)g(for)g(this)h(example)f(is)h(r)n(epr)n
(oduced)e(below:)150 556 y Fd(int)150 656 y(main\(int)48
b(argc,)h(char)g(**argv\))150 755 y({)250 855 y(CORBA::ORB_ptr)e(orb)i
(=)h(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)143
b(//)49 b(line)h(1)250 955 y(CORBA::BOA_ptr)d(boa)i(=)h
(orb->BOA_init\(argc,argv,"omniORB2_)o(BOA"\))o(;)44
b(//)49 b(line)h(2)250 1154 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)
1642 b(//)49 b(line)h(3)250 1254 y(myobj->_obj_is_ready\(boa\);)1788
b(//)49 b(line)h(4)250 1453 y(boa->impl_is_ready\(0,1\);)1888
b(//)49 b(line)h(5)250 1652 y(Echo_ptr)e(myobjRef)g(=)i
(myobj->_this\(\);)1342 b(//)49 b(line)h(6)250 1752 y
(hello\(myobjRef\);)2288 b(//)49 b(line)h(7)250 1851
y(CORBA::release\(myobjRef\);)1838 b(//)49 b(line)h(8)250
2051 y(myobj->_dispose\(\);)2188 b(//)49 b(line)h(9)250
2150 y(return)e(0;)150 2250 y(})291 2463 y Fr(The)25
b(example)g(illustrates)g(several)g(important)g(interactions)f(among)i
(the)e(ORB,)h(the)f(object)150 2576 y(implementation)f(and)f(the)g
(client.)28 b(Her)n(e)22 b(ar)n(e)h(the)f(details:)150
2832 y Fi(2.7.1)99 b(ORB/BOA)26 b(initialisation)150
3009 y Fm(line)d(1)46 b Fr(The)30 b(ORB)h(is)f(initialised)i(by)f
(calling)h(the)e Fe(CORBA::ORB)p 2494 3009 28 4 v 28
w(init)f Fr(function.)52 b(The)30 b(func-)377 3122 y(tion)k(uses)f(the)
g(3r)n(d)h(ar)n(gument)g(to)f(determine)g(which)h(ORB)g(should)f(be)h
(r)n(eturned.)60 b(T)-8 b(o)377 3235 y(use)36 b(omniORB2,)k(this)c(ar)n
(gument)g(must)g(either)f(be)h(\223omniORB2\224)i(or)e(NULL.)f(If)h(it)
h(is)377 3348 y(NULL,)32 b(ther)n(e)g(must)g(be)h(an)h(ar)n(gument,)h
(-ORBid)e(\223omniORB2\224,)k(in)d Fe(argv)p Fr(.)58
b(Like)32 b(any)377 3461 y(command-line)23 b(ar)n(guments)d(understood)
e(by)k(the)e(ORB,)h(it)h(will)g(be)g(r)n(emoved)e(fr)n(om)i(ar)n(gv)377
3574 y(when)28 b Fe(CORBA::ORB)p 1186 3574 V 28 w(init)f
Fr(r)n(eturns.)45 b(Ther)n(efor)n(e,)29 b(an)g(application)h(is)f(not)f
(r)n(equir)n(ed)g(to)377 3687 y(handle)22 b(any)g(command-line)i(ar)n
(guments)d(it)h(does)f(not)g(understand.)26 b(If)c(the)f(ORB)h(identi-)
377 3799 y(\002er)k(is)g(not)g(\223omniORB2\224,)i(the)e
(initialisation)i(will)g(fail)g(and)e(a)h(nil)g Fe(ORB)p
2944 3799 V 31 w(ptr)e Fr(will)j(be)e(r)n(e-)377 3912
y(turned.)k(If)24 b(supplied,)e(omniORB2)i(also)g(r)n(eads)f(the)g
(con\002guration)g(\002le)h Fe(omniORB.cfg)p Fr(.)377
4025 y(Among)i(other)g(things,)h(the)f(\002le)h(pr)n(ovides)f(a)i(list)
f(of)g(initial)i(object)e(r)n(efer)n(ences.)39 b(One)27
b(ex-)377 4138 y(ample)f(of)f(these)e(object)i(r)n(efer)n(ences)f(is)h
(the)f(naming)h(service.)35 b(Its)24 b(use)g(will)i(be)f(discussed)377
4251 y(in)30 b(section)f(2.9.1.)51 b(If)29 b(any)h(err)n(or)f(occurs)h
(during)f(the)g(pr)n(ocessing)f(of)i(the)f(con\002guration)377
4364 y(\002le,)23 b(the)f(system)e(exception)i(CORBA::INITIALIZE)c(is)
23 b(raised.)150 4552 y Fm(line)g(2)46 b Fr(The)38 b(BOA)h(is)g
(initialised)i(by)d(calling)j(the)d(ORB's)h Fe(BOA)p
2468 4552 V 32 w(init)p Fr(.)75 b(The)38 b(3r)n(d)i(ar)n(gument)377
4665 y(must)23 b(either)f(be)i(\223omniORB2)p 1469 4665
V 33 w(BOA)-7 b(\224)24 b(or)f(NULL.)f(If)h(it)h(is)f(NULL,)f(then)g
Fe(argv)g Fr(must)h(con-)377 4778 y(tain)j(an)g(ar)n(gument,)f(-BOAid)g
(\223omniORB2)p 1948 4778 V 34 w(BOA)-7 b(\224.)25 b(If)h(the)e(BOA)h
(identi\002er)g(is)g(not)f(\223om-)377 4891 y(niORB2)p
694 4891 V 34 w(BOA)-7 b(\224,)36 b(the)f(initialisation)j(will)g(fail)
f(and)f(a)h(nil)g(BOA)p 2692 4891 V 32 w(ptr)f(will)h(be)f(r)n
(eturned.)377 5004 y(Like)20 b Fe(ORB)p 744 5004 V 31
w(init)p Fr(,)f(any)i(command-line)h(ar)n(guments)d(understood)f(by)i
Fe(BOA)p 3035 5004 V 32 w(init)e Fr(will)k(be)377 5117
y(r)n(emoved)g(fr)n(om)h Fe(argv)p Fr(.)150 5373 y Fi(2.7.2)99
b(Object)25 b(initialisation)150 5550 y Fm(line)e(3)46
b Fr(An)23 b(instance)f(of)h(the)f(Echo)g(object)g(is)h(initialised)h
(using)e(the)f Fe(new)h Fr(operator)-7 b(.)p eop
%%Page: 14 20
14 19 bop 30 100 a Fr(14)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fm(line)i(4)46 b Fr(The)23
b(object's)p 809 356 28 4 v 57 w Fe(obj)p 1007 356 V
31 w(is)p 1148 356 V 32 w(ready)e Fr(is)j(called.)33
b(This)23 b(function)h(informs)g(the)f(BOA)h(that)f(this)257
469 y(object)e(is)f(r)n(eady)h(to)f(serve.)26 b(Until)21
b(this)f(function)h(is)f(called,)i(the)e(BOA)g(will)i(not)e(accept)h
(any)257 582 y(invocation)j(on)e(the)g(object)g(and)h(will)h(not)e
(perform)g(any)g(upcall)i(to)e(the)g(object.)30 786 y
Fm(line)h(5)46 b Fr(The)30 b(BOA)-7 b('s)31 b Fe(impl)p
999 786 V 31 w(is)p 1140 786 V 31 w(ready)e Fr(is)i(called.)53
b(This)30 b(function)h(tells)f(the)g(BOA)g(the)g(imple-)257
899 y(mentation)22 b(is)g(r)n(eady)-10 b(.)27 b(After)22
b(this)g(call,)h(the)f(BOA)g(will)h(accept)g(IIOP)e(r)n(equests)g(fr)n
(om)h(other)257 1012 y(addr)n(ess)f(spaces.)27 b(Ther)n(e)22
b(ar)n(e)h(2)g(points)f(to)g(note)f(her)n(e:)344 1217
y(1.)45 b Fe(boa)p Fo(!)p Fe(impl)p 938 1217 V 30 w(is)p
1078 1217 V 32 w(ready)16 b Fr(can)k(be)f(called)h(any)f(time)g(after)g
Fe(BOA)p 2665 1217 V 32 w(init)e Fr(is)i(called)h(\(line)457
1330 y(2\).)34 b(In)24 b(other)g(wor)n(ds,)f(object)i(instances)e(can)j
(be)e(initialised)i(and)e(advertised)f(to)h(the)457 1443
y(BOA)f(befor)n(e)f(or)g(after)h(this)f(function)h(is)g(called.)344
1597 y(2.)45 b(The)c(2nd)g(ar)n(gument)1238 1564 y Fk(7)1316
1597 y Fr(to)g Fe(impl)p 1662 1597 V 31 w(is)p 1803 1597
V 32 w(ready)e Fr(tells)i(the)g(ORB)g(whether)e(this)i(call)457
1710 y(should)31 b(be)h(non-blocking.)55 b(The)31 b(default)h(value)g
(of)g(this)f(ar)n(gument)h(is)g(F)-7 b(ALSE\(0\))457
1823 y(and)23 b(the)e(call)j(will)g(block)e(inde\002nitely)g(within)g
(the)g(ORB.)g(If)g(ther)n(e)f(ar)n(e)i(mor)n(e)f(things)457
1936 y(the)31 b(main)h(thr)n(ead)f(should)g(do)f(after)i(it)f(calls)i
Fe(impl)p 2328 1936 V 31 w(is)p 2469 1936 V 32 w(ready)p
Fr(,)e(as)g(it)h(is)f(the)g(case)457 2049 y(in)36 b(this)g(example,)i
(the)d(non-blocking)g(option)g(\(TRUE=1\))h(should)e(be)i(speci\002ed.)
457 2162 y(Whether)24 b(the)h(main)i(thr)n(ead)e(blocks)h(in)g(this)f
(call)i(or)f(not,)f(the)g(ORB)g(is)h(not)f(af)n(fected)457
2275 y(because)36 b(its)h(functions)f(ar)n(e)h(pr)n(ovided)f(by)g
(other)f(thr)n(eads)h(spawned)f(internally)-10 b(.)457
2388 y(Notice)32 b(that)g(the)f(signatur)n(e)h(of)g Fe(impl)p
1849 2388 V 31 w(is)p 1990 2388 V 32 w(ready)e Fr(in)i(the)g(CORBA)g
(speci\002cation)457 2501 y(does)22 b(not)h(have)h(the)e(2nd)i(ar)n
(gument)1760 2468 y Fk(8)1796 2501 y Fr(.)31 b(Ther)n(efor)n(e,)22
b(calling)j Fe(impl)p 2801 2501 V 31 w(is)p 2942 2501
V 32 w(ready)c Fr(with)457 2614 y(the)h(non-blocking)h(option)e(is)i
(omniORB2)g(speci\002c.)30 2895 y Fi(2.7.3)99 b(Client)25
b(invocation)30 3080 y Fm(line)e(6)46 b Fr(The)36 b(object)h(r)n(efer)n
(ence)f(is)g(obtained)h(fr)n(om)g(the)f(implementation)g(by)h(calling)p
3182 3080 V 71 w Fe(this)p Fr(.)257 3193 y(Like)53 b(any)h(object)g(r)n
(efer)n(ence,)61 b(the)53 b(r)n(eturn)g(value)i(of)p
2330 3193 V 87 w(this)e(must)g(be)h(r)n(eleased)f(by)257
3306 y Fe(CORBA::release)17 b Fr(when)22 b(it)g(is)h(no)f(longer)g
(needed.)30 3511 y Fm(line)h(7)46 b Fr(Call)30 b Fe(hello)c
Fr(with)i(this)f(object)h(r)n(efer)n(ence.)43 b(The)27
b(ar)n(gument)h(is)g(widened)e(implicitly)k(to)257 3624
y(the)22 b(generic)g(object)h(r)n(efer)n(ence)f Fe(CORBA::Object)p
2089 3624 V 26 w(ptr)p Fr(.)30 3828 y Fm(line)h(8)46
b Fr(Release)22 b(the)g(object)g(r)n(efer)n(ence.)171
4062 y(One)f(of)g(the)f(important)h(characteristic)h(of)f(an)g(object)g
(r)n(efer)n(ence)f(is)i(that)e(it)h(is)g(completely)g(lo-)30
4175 y(cation)h(transpar)n(ent.)k(A)c(client)f(can)i(invoke)d(on)i(the)
e(object)h(using)g(its)g(object)g(r)n(efer)n(ence)g(without)30
4288 y(any)f(need)e(to)h(know)g(whether)f(the)h(object)g(is)h
(colocated)f(in)h(the)f(same)h(addr)n(ess)e(space)h(or)h(r)n(esided)30
4401 y(in)j(a)g(dif)n(fer)n(ent)g(addr)n(ess)e(space.)171
4518 y(In)k(case)g(of)h(colocated)f(client)g(and)h(object)f
(implementation,)g(omniORB2)h(is)f(able)h(to)f(short-)30
4631 y(cir)n(cuit)31 b(the)d(client)h(calls)i(to)d(dir)n(ect)h(calls)i
(on)d(the)h(implementation)g(methods.)45 b(The)28 b(cost)h(of)g(an)30
4744 y(invocation)k(is)f(r)n(educed)f(to)h(that)f(of)i(a)f(function)h
(call.)58 b(This)32 b(optimisation)f(is)i(applicable)h
Fm(not)30 4857 y(only)d Fr(to)g(object)h(r)n(efer)n(ences)f(r)n
(eturned)f(by)i(the)p 1743 4857 V 64 w(this)g(function)g(but)g(to)f
(any)h(object)g(r)n(efer)n(ences)30 4970 y(that)22 b(ar)n(e)h(passed)f
(ar)n(ound)g(within)h(the)f(same)g(addr)n(ess)g(space)g(or)g(r)n
(eceived)h(fr)n(om)g(other)f(addr)n(ess)30 5083 y(spaces)g(via)i(IIOP)e
(calls.)p 30 5187 1368 4 v 135 5242 a Fh(7)164 5274 y
Fg(The)c(1st)g(ar)o(gument)f(is)g(a)h(pointer)e(to)i(the)g
(implementation)g(de\002nition)g(and)g(is)e(always)i(ignor)o(ed)d(by)j
(omniORB2.)135 5335 y Fh(8)164 5367 y Fg(The)d(CORBA)f(speci\002cation)
h(does)f(not)h(specify)f(when)i Fc(impl)p 1937 5367 23
4 v 26 w(is)p 2053 5367 V 26 w(ready)e Fg(should)g(r)o(eturn.)21
b(Many)15 b(ORB)f(vendors)30 5458 y(choose)19 b(to)h(implement)g
Fc(impl)p 924 5458 V 26 w(is)p 1040 5458 V 27 w(ready)f
Fg(as)h(blocking)f(until)h(a)g(certain)g(time-out)g(value)g(is)f
(exceeded.)24 b(In)d(a)f(single)30 5550 y(thr)o(eaded)e(implementation)
h(this)g(is)f(necessary)g(to)h(give)f(the)h(ORB)f(the)h(time)g(to)g
(serve)e(incoming)i(r)o(equests.)p eop
%%Page: 15 21
15 20 bop 150 100 a Ff(2.8.)51 b(EXAMPLE)21 b(2)i(-)g(DIFFERENT)d
(ADDRESS)i(SP)-8 b(ACES)1251 b Fr(15)150 356 y Fi(2.7.4)99
b(Object)25 b(disposal)150 536 y Fm(line)e(9)46 b Fr(T)-8
b(o)21 b(dispose)f(of)i(an)g(object)g(implementation)g(and)g(r)n
(elease)f(all)i(the)e(r)n(esour)n(ces)g(associated)377
649 y(with)31 b(it,)i(the)p 867 649 28 4 v 62 w Fe(dispose)28
b Fr(function)j(is)g(called.)53 b(In)30 b(fact,)k(this)c(is)h(the)f
Fm(only)f Fr(clean)j(way)f(to)377 762 y(get)i(rid)h(of)g(an)h(object)f
(implementation.)62 b(Even)33 b(though)g(the)g(object)h(is)g(cr)n
(eated)g(using)377 875 y(the)27 b(new)g(operator)f(in)i(the)e
(application)j(code,)f(the)f(application)h(should)f(never)g(call)i(the)
377 988 y(delete)21 b(operator)g(on)i(the)e(object)i(dir)n(ectly)-10
b(.)291 1208 y(Once)30 b(an)g(application)h(calls)p 1352
1208 V 64 w Fe(dispose)c Fr(on)i(an)h(object)g(implementation,)h(the)e
(pointer)g(to)150 1321 y(the)22 b(object)i(should)e(not)g(be)i(used)e
(any)h(mor)n(e.)29 b(At)23 b(the)g(time)g(the)p 2412
1321 V 55 w Fe(dispose)d Fr(call)26 b(is)d(made,)g(ther)n(e)150
1434 y(may)31 b(be)g(other)e(thr)n(eads)h(invoking)g(on)g(the)g
(object,)i(omniORB2)f(ensur)n(es)e(that)i(all)h(these)d(calls)150
1547 y(ar)n(e)k(completed)f(befor)n(e)g(r)n(emoving)h(the)f(object)g
(fr)n(om)h(its)g(internal)g(tables)g(and)f(r)n(eleasing)h(the)150
1660 y(r)n(esour)n(ces)i(associated)g(with)h(it.)68 b(The)35
b(storage)f(associated)h(with)h(the)f(object)h(is)g(r)n(eleased)f(by)
150 1773 y(omniORB2)22 b(using)e(the)g(delete)g(operator)-7
b(.)26 b(This)21 b(is)g(why)g(all)h(object)f(implementation)g(should)f
(be)150 1886 y(initialised)k(using)e(the)f(new)h(operator)g(\(section)g
(2.5\).)291 2000 y(The)38 b(disposal)f(of)h(an)h(object)f
(implementation)g(by)g(omniORB2)h(may)f(also)h(be)f(deferr)n(ed)150
2113 y(when)28 b Fm(colocated)i Fr(clients)f(continue)f(to)g(hold)h(on)
f(to)h(copies)f(of)h(the)f(object's)g(r)n(efer)n(ence)3290
2080 y Fk(9)3327 2113 y Fr(.)46 b(This)150 2226 y(behavior)23
b(is)g(to)f(pr)n(event)g(the)f(short-cir)n(cuited)i(calls)h(fr)n(om)f
(the)f(clients)g(to)g(fail)j(unpr)n(edictably)-10 b(.)291
2341 y(T)i(o)31 b(summarise,)j(an)e(application)i(can)e(make)g(no)g
(assumption)f(as)h(to)f(when)g(the)g(object)h(is)150
2454 y(disposed)h(by)i(omniORB2)h(after)g(the)p 1550
2454 V 67 w Fe(dispose)d Fr(call)k(r)n(eturns.)65 b(If)36
b(it)f(is)h(necessary)e(to)h(have)150 2566 y(better)28
b(contr)n(ol)g(on)h(when)f(to)g(stop)g(serving)g(incoming)i(r)n
(equests,)e(the)g(work)g(should)g(be)g(done)150 2679
y(by)j(the)f(object)h(implementation)g(itself,)i(such)e(as)g(by)g
(keeping)e(track)i(of)g(the)f(curr)n(ent)h(serving)150
2792 y(state.)150 3101 y Fj(2.8)119 b(Example)29 b(2)h(-)g(Dif)n
(ferent)d(Address)i(Spaces)150 3315 y Fr(In)f(this)g(example,)h(the)f
(client)h(and)f(the)f(object)i(implementation)f(r)n(eside)f(in)i(two)e
(dif)n(fer)n(ent)i(ad-)150 3428 y(dr)n(ess)e(spaces.)45
b(The)28 b(code)g(of)h(this)f(example)h(is)g(almost)f(the)g(same)h(as)g
(the)e(pr)n(evious)h(example.)150 3541 y(The)20 b(only)h(dif)n(fer)n
(ence)g(is)g(the)f(extra)h(work)e(need)h(to)g(be)h(done)f(to)g(pass)g
(the)g(object)h(r)n(efer)n(ence)g(fr)n(om)150 3654 y(the)h(object)g
(implementation)h(to)f(the)g(client.)291 3768 y(The)30
b(simplest)g(\(and)i(quite)e(primitive\))i(way)f(to)f(pass)g(an)i
(object)e(r)n(efer)n(ence)h(between)e(two)150 3881 y(addr)n(ess)e
(spaces)g(is)h(to)g(pr)n(oduce)f(a)h(stringi\002ed)f(version)h(of)g
(the)f(object)h(r)n(efer)n(ence)f(and)h(to)g(pass)150
3994 y(this)c(string)g(to)f(the)h(client)h(as)f(a)h(command-line)h(ar)n
(gument.)33 b(The)24 b(string)f(is)i(then)e(converted)g(by)150
4107 y(the)j(client)h(into)g(a)g(pr)n(oper)f(object)g(r)n(efer)n(ence.)
40 b(This)27 b(method)e(is)i(used)e(in)j(this)e(example.)40
b(In)27 b(the)150 4220 y(next)j(example,)i(we)e(shall)h(intr)n(oduce)f
(a)h(better)e(way)i(of)f(passing)g(the)g(object)g(r)n(efer)n(ence)g
(using)150 4333 y(the)22 b(COS)h(Naming)g(Service.)150
4598 y Fi(2.8.1)99 b(Object)25 b(Implementation:)30 b(Generating)24
b(a)h(Stringi\002ed)g(Object)g(Reference)150 4778 y Fr(The)30
b Fe(main)e Fr(function)i(of)h(the)e(object)h(implementation)g(side)g
(is)g(r)n(epr)n(oduced)e(below)-8 b(.)50 b(The)30 b(full)150
4891 y(listing)23 b(\()p Fe(eg2)p 624 4891 V 31 w(impl.cc)p
Fr(\))d(can)k(be)e(found)g(at)h(the)f(end)f(of)i(this)f(chapter)-7
b(.)150 5100 y Fd(int)150 5199 y(main\(int)48 b(argc,)h(char)g
(**argv\))p 150 5280 1368 4 v 255 5335 a Fh(9)284 5367
y Fg(Object)21 b(r)o(efer)o(ences)c(held)j(by)f(clients)h(in)g(other)g
(addr)o(ess)d(spaces)j(will)f(not)h(pr)o(event)g(the)g(object)g
(implementation)150 5458 y(fr)o(om)j(being)i(disposed)d(of.)40
b(If)24 b(these)h(clients)f(invoke)g(on)h(the)g(object)h(after)e(it)g
(is)g(disposed,)g(the)h(system)e(exception)150 5550 y(INV)p
295 5550 23 4 v 27 w(OBJREF)17 b(is)h(raised.)p eop
%%Page: 16 22
16 21 bop 30 100 a Fr(16)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fd({)130 456 y(CORBA::ORB_ptr)47
b(orb)i(=)h(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130
555 y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 754 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
854 y(myobj->_obj_is_ready\(boa\);)130 1053 y({)229 1153
y(Echo_var)g(myobjRef)f(=)i(myobj->_this\(\);)229 1253
y(CORBA::String_var)d(p;)229 1452 y(p)j(=)f
(orb->object_to_string\(myobjRef\);)592 b(//line)49 b(1)229
1651 y(cerr)g(<<)h("'")f(<<)g(\(char*\)p)g(<<)g("'")g(<<)h(endl;)130
1751 y(})130 1950 y(boa->impl_is_ready\(\);)195 b(//)49
b(block)g(here)g(indefinitely)1375 2050 y(//)g(See)h(the)f(explanation)
f(in)h(example)g(1)130 2149 y(return)f(0;)30 2249 y(})171
2423 y Fr(The)60 b(stringi\002ed)g(object)g(r)n(efer)n(ence)g(is)h
(obtained)f(by)h(calling)i(the)d(ORB's)g(function)p 30
2536 28 4 v 57 2536 a Fe(object)p 392 2536 V 30 w(to)p
532 2536 V 32 w(string)28 b Fr(\(line)k(1\).)53 b(This)30
b(is)h(a)g(sequence)e(starting)h(with)h(the)f(signatur)n(e)g
(\223IOR:\224)30 2649 y(and)i(followed)f(by)h(a)g(hexadecimal)h
(string.)54 b(All)33 b(CORBA)f(2.0)g(compliant)h(ORBs)e(ar)n(e)h(able)h
(to)30 2762 y(convert)d(the)f(string)g(into)h(its)g(internal)g(r)n(epr)
n(esentation)e(of)j(a)f(so-called)h(Inter)n(operable)d(Object)30
2875 y(Refer)n(ence)34 b(\(IOR\).)h(The)f(IOR)h(contains)g(the)f
(location)i(information)f(and)g(a)h(key)d(to)i(uniquely)30
2988 y(identify)27 b(the)f(object)h(implementation)g(in)g(its)g(own)f
(addr)n(ess)g(space)2452 2955 y Fk(10)2522 2988 y Fr(.)41
b(Fr)n(om)27 b(the)g(IOR,)f(an)i(ob-)30 3101 y(ject)23
b(r)n(efer)n(ence)f(can)h(be)g(constr)o(ucted.)30 3349
y Fi(2.8.2)99 b(Client:)31 b(Using)25 b(a)g(Stringi\002ed)f(Object)i
(Reference)30 3526 y Fr(The)j(stringi\002ed)f(object)i(r)n(efer)n(ence)
f(is)h(passed)e(to)h(the)g(client)i(as)f(a)g(command-line)h(ar)n
(gument.)30 3639 y(The)g(client)h(uses)f(the)g(ORB's)g(function)h
Fe(string)p 1818 3639 V 30 w(to)p 1958 3639 V 32 w(object)d
Fr(to)i(convert)g(the)g(string)g(into)h(a)30 3752 y(generic)d(object)g
(r)n(efer)n(ence)g(\()p Fe(CORBA::Object)p 1763 3752
V 27 w(ptr)p Fr(\).)48 b(The)29 b(r)n(elevant)h(section)f(of)g(the)g
(code)g(is)30 3865 y(r)n(epr)n(oduced)18 b(below)-8 b(.)27
b(The)19 b(full)i(listing)f(\()p Fe(eg2)p 1605 3865 V
32 w(clt.cc)p Fr(\))d(can)k(be)f(found)f(at)h(the)g(end)f(of)h(this)f
(chap-)30 3977 y(ter)-7 b(.)30 4139 y Fd(try)49 b({)130
4238 y(CORBA::Object_var)d(obj)k(=)f(orb->string_to_object\(argv[1]\);)
130 4338 y(hello\(obj\);)30 4438 y(})30 4537 y
(catch\(CORBA::COMM_FAILURE&)c(ex\))k({)130 4637 y(...)g(//)g(code)g
(to)h(handle)f(communication)e(failure)30 4736 y(})30
4985 y Fi(2.8.3)99 b(Catching)25 b(System)g(Exceptions)30
5162 y Fr(When)33 b(omniORB2)i(detects)d(an)j(err)n(or)e(condition,)j
(it)f(may)f(raise)g(a)h(system)d(exception.)61 b(The)30
5274 y(CORBA)26 b(speci\002cation)h(de\002nes)d(a)j(series)e(of)i
(exceptions)d(covering)j(most)e(of)i(the)e(err)n(or)h(condi-)30
5387 y(tions)31 b(that)h(an)g(ORB)g(may)g(encounter)-7
b(.)54 b(The)31 b(client)h(may)g(choose)f(to)g(catch)i(these)d
(exceptions)p 30 5462 1368 4 v 111 5518 a Fh(10)164 5550
y Fg(Notice)19 b(that)h(the)g(object)f(key)f(is)g(not)h(globally)f
(unique)g(acr)o(oss)g(addr)o(ess)f(spaces.)p eop
%%Page: 17 23
17 22 bop 150 100 a Ff(2.8.)51 b(EXAMPLE)21 b(2)i(-)g(DIFFERENT)d
(ADDRESS)i(SP)-8 b(ACES)1251 b Fr(17)150 356 y(and)21
b(r)n(ecover)f(fr)n(om)h(the)f(err)n(or)g(condition)1610
323 y Fk(1)l(1)1677 356 y Fr(.)27 b(For)20 b(instance,)g(the)g(code)g
(fragment,)h(shown)e(in)i(sec-)150 469 y(tion)27 b(2.8.2,)j(catches)d
(the)g(system)e(exception)i(COMM)p 2078 469 28 4 v 33
w(F)-7 b(AILURE)26 b(which)i(indicates)f(that)g(com-)150
582 y(munication)d(with)e(the)g(object)g(implementation)h(in)g(another)
f(addr)n(ess)f(space)h(has)h(failed.)291 718 y(All)30
b(system)d(exceptions)h(inherit)h(fr)n(om)h(the)e(class)i
Fe(CORBA::SystemE)o(xc)o(ep)o(ti)o(on)p Fr(.)41 b(W)-5
b(ith)150 831 y(compilers)42 b(that)g(support)e(R)m(TTI)1349
798 y Fk(12)s(13)1488 831 y Fr(,)i(a)h(single)f(catch)h
Fe(CORBA::SystemE)o(xc)o(ep)o(tio)o(n)36 b Fr(will)150
944 y(catch)23 b(all)i(the)c(dif)n(fer)n(ent)i(system)e(exceptions)g
(thr)n(own)h(by)g(omniORB2.)291 1080 y(When)f(omniORB2)i(detects)d(an)i
(internal)h(inconsistency)e(that)g(is)h(most)f(likely)i(to)e(be)h
(caused)150 1193 y(by)g(a)h(bug)f(in)h(the)e(r)o(untime,)h(it)g(raises)
g(the)f(exception)g Fe(omniORB::fatalEx)o(ce)o(pt)o(io)o(n)p
Fr(.)h(When)150 1306 y(this)j(exception)f(is)i(raised,)f(it)h(is)f(not)
g(sensible)g(to)f(pr)n(oceed)h(with)g(any)g(operation)g(that)g
(involves)150 1419 y(the)20 b(ORB's)h(r)o(untime.)27
b(It)20 b(is)h(best)f(to)g(exit)g(the)g(pr)n(ogram)h(immediately)-10
b(.)27 b(The)21 b(exception)e(str)o(uctur)n(e)150 1532
y(carries)34 b(by)g Fe(omniORB::fatalE)o(xc)o(ep)o(tio)o(n)28
b Fr(contains)34 b(the)f(exact)h(location)g(\(the)g(\002le)g(name)150
1644 y(and)22 b(the)f(line)h(number\))g(wher)n(e)f(the)g(exception)f
(is)i(raised.)27 b(Y)-8 b(ou)21 b(ar)n(e)h(str)n(ongly)e(encourage)h
(to)g(\002le)150 1757 y(a)i(bug)g(r)n(eport)e(and)i(point)f(out)f(the)h
(location.)150 2155 y Fi(2.8.4)99 b(Lifetime)24 b(of)h(an)g(Object)g
(Implementation)150 2379 y Fr(It)c(may)g(be)g(obvious)h(but)f(it)g(has)
g(to)g(stated)f(that)h(an)h(object)f(implementation)g(exists)f(only)h
(for)g(the)150 2492 y(duration)29 b(of)g(the)g(pr)n(ocess's)f
(lifetime.)49 b(When)28 b(the)h(same)g(pr)n(ogram)h(is)f(r)o(un)g
(again,)j(a)e(dif)n(fer)n(ent)150 2605 y(instance)35
b(of)g(the)f(object)h(implementation)g(is)g(cr)n(eated.)64
b(Mor)n(e)35 b(signi\002cantly)-10 b(,)38 b Fm(the)d(IOR,)f(and)150
2718 y(hence)e(the)h(object)f(reference,)37 b(of)32 b(this)h(instance)g
(is)g(dif)n(ferent)h(from)e(that)h(of)f(the)g(previous)150
2831 y(run)p Fr(.)291 2967 y(For)e(instance,)i(if)g(you)d(look)h(at)h
(the)f(stringi\002ed)f(object)i(r)n(efer)n(ence)f(pr)n(oduced)f(by)h
(the)g(pr)n(o-)150 3080 y(gram)g Fe(eg2)p 562 3080 V
31 w(impl)f Fr(in)h(dif)n(fer)n(ent)g(r)o(uns,)g(they)f(ar)n(e)h(all)h
(dif)n(fer)n(ent.)50 b(The)29 b(implication)j(is)d(that)h(you)150
3193 y(cannot)23 b(stor)n(e)f(away)i(the)e(stringi\002ed)g(object)h(r)n
(efer)n(ence)g(and)g(expect)f(to)h(be)g(able)h(to)f(use)f(it)h(again)
150 3305 y(later)g(when)f(the)f(original)j(pr)n(ogram)e(r)o(un)h(has)g
(terminated.)291 3442 y(For)31 b(system)f(services)i(and)g(other)e
(applications,)35 b(it)d(may)g(be)g(desirable)g(to)f(have)i
(\223persis-)150 3555 y(tent\224)27 b(object)h(implementations.)43
b(The)27 b(objects)h(ar)n(e)g(\223persistent\224)e(in)j(the)e(sense)f
(that)i(they)e(can)150 3667 y(be)18 b(contacted)g(using)f(the)h(same)g
(IOR)g(when)g(they)f(ar)n(e)h(instantiated)g(in)h(dif)n(fer)n(ent)f(pr)
n(ogram)g(r)o(uns.)150 3780 y(T)-8 b(o)25 b(pr)n(ovide)g(this)g
(functionality)-10 b(,)27 b(omniORB2)f(needs)e(to)h(be)g(pr)n(ovided)g
(with)g(two)g(pieces)g(of)g(in-)150 3893 y(formation:)39
b(the)28 b(\(network\))e(location)j(and)f(the)g(object)g(key)-10
b(.)43 b(The)28 b(details)f(of)i(how)e(this)h(can)h(be)150
4006 y(done)21 b(will)j(be)f(described)e(in)i(the)f(later)h(part)f(of)h
(this)f(manual.)291 4142 y(Alternatively)-10 b(,)35 b(an)e(indir)n
(ection)g(fr)n(om)g(textual)g(pathnames)f(to)g(object)h(r)n(efer)n
(ences)f(can)h(be)150 4255 y(used.)49 b(Applications)31
b(can)g(r)n(egister)d(object)j(implementations)e(at)i(r)o(untime)f(to)g
(a)g(naming)h(ser)n(-)150 4368 y(vice)g(and)e(bind)h(them)f(to)g
(\002xed)g(pathnames.)49 b(Clients)30 b(can)g(bind)g(to)f(the)g(object)
h(implementa-)150 4481 y(tions)c(at)g(r)o(untime)g(by)g(asking)g(the)g
(naming)h(service)f(to)f(r)n(esolve)h(the)f(pathnames)h(to)g(the)f
(object)150 4594 y(r)n(efer)n(ences.)37 b(CORBA)26 b(de\002nes)f(a)h
(naming)h(service,)g(which)g(is)f(a)h(component)d(of)i(the)g(Common)150
4707 y(Object)f(Services)g(\(COS\))h([OMG96b)r(],)g(that)e(can)i(be)e
(used)g(for)g(this)h(purpose.)32 b(The)24 b(next)g(section)150
4820 y(describes)d(an)j(example)e(of)h(how)f(to)g(use)f(the)h(COS)i
(Naming)f(Service.)p 150 5000 1368 4 v 233 5056 a Fh(1)m(1)284
5088 y Fg(If)17 b(a)f(system)g(exception)f(is)h(not)h(caught,)g(the)g
(C++)g(r)o(untime)f(will)g(call)h(the)f Fc(terminate)f
Fg(function.)23 b(This)16 b(function)150 5179 y(is)i(defaulted)g(to)h
(abort)g(the)g(whole)g(pr)o(ocess)e(and)i(on)g(some)f(system)g(will)g
(cause)h(a)g(cor)o(e)e(\002le)i(to)g(be)f(pr)o(oduced.)231
5242 y Fh(12)284 5273 y Fg(Run)i(T)l(ime)e(T)-7 b(ype)18
b(Identi\002cation)231 5335 y Fh(13)284 5367 y Fg(A)j(noticeable)f
(exception)g(is)f(the)i(GNU)g(C++)f(compiler)f(\(version)g(2.7.2\).)27
b(It)21 b(doesn't)f(support)f(R)m(TTI)h(unless)f(the)150
5458 y(compilation)i(\003ag)g(-frtti)f(is)h(speci\002ed.)28
b(The)20 b(omniORB2)h(r)o(untime)g(is)f(not)i(compiled)d(with)j(the)f
(-frtti)g(\003ag.)29 b(It)21 b(is)g(said)150 5550 y(that)f(R)m(TTI)f
(will)f(be)h(pr)o(operly)d(supported)h(in)i(the)g(upcoming)g(version)f
(2.8.)p eop
%%Page: 18 24
18 23 bop 30 100 a Fr(18)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fj(2.9)119 b(Example)29 b(3)h(-)g(Using)g
(the)g(COS)f(Naming)h(Service)30 568 y Fr(In)c(this)f(example,)i(the)e
(object)h(implementation)g(uses)f(the)g(COS)i(Naming)f(Service)g
([OMG96b)s(])30 681 y(to)36 b(pass)f(on)h(the)f(object)h(r)n(efer)n
(ence)g(to)g(the)f(client.)69 b(This)36 b(method)f(is)h(by-far)h(mor)n
(e)f(practical)30 794 y(than)27 b(using)g(stringi\002ed)f(object)h(r)n
(efer)n(ences.)40 b(The)27 b(full)h(listing)f(of)h(the)e(object)h
(implementation)30 907 y(\()p Fe(eg3)p 230 907 28 4 v
32 w(impl.cc)p Fr(\))19 b(and)k(the)f(client)h(\()p Fe(eg3)p
1459 907 V 32 w(clt.cc)p Fr(\))d(can)j(be)g(found)f(at)h(the)e(end)h
(of)h(this)f(chapter)-7 b(.)171 1020 y(The)23 b(object)h(r)n(efer)n
(ence)f(is)h(bound)f(to)g(the)f(pathname)i(\223)p Fm(test)p
Fr(/)p Fm(Echo)p Fr(\224)2546 987 y Fk(14)2618 1020 y
Fr(.)31 b(The)23 b(pathname)h(con-)30 1133 y(sists)17
b(of)h(the)f(context)g Fm(test)i Fr(and)f(the)f(object)h(name)h
Fm(Echo)p Fr(.)25 b(Both)17 b(the)g(context)g(and)h(the)f(object)h
(name)30 1246 y(has)24 b(an)h(attribute)e Fm(kind)p Fr(.)31
b(This)24 b(attribute)f(is)i(a)f(string)f(that)h(is)g(intended)e(to)i
(be)g(used)e(to)i(describe)30 1359 y(the)19 b(name)h(in)h(a)f
(syntax-independent)d(way)-10 b(.)27 b(The)19 b(naming)i(service)e
(does)g(not)g(interpr)n(et,)g(assign,)30 1472 y(or)26
b(manage)h(these)d(values.)39 b(However)25 b(both)h(the)g(name)g(and)h
(the)e(kind)h(attribute)g(must)f(match)30 1585 y(for)g(a)h(name)f
(lookup)f(to)g(succeed.)34 b(In)25 b(this)f(example,)i(the)e
Fm(kind)g Fr(values)h(for)g Fm(test)i Fr(and)e Fm(Echo)f
Fr(ar)n(e)30 1698 y(chosen)k(to)g(be)g(\223my)p 748 1698
V 33 w(context\224)g(and)h(\223Object\224)h(r)n(espectively)-10
b(.)45 b(This)29 b(is)g(an)g(arbitrary)g(choice)g(for)30
1811 y(ther)n(e)22 b(is)g(no)h(standar)n(dised)e(set)g(of)i(kind)f
(values.)30 2069 y Fi(2.9.1)99 b(Obtaining)25 b(the)g(Root)h(Context)f
(Object)g(Reference)30 2247 y Fr(The)d(initial)j(contact)e(with)g(the)f
(Naming)h(Service)g(can)g(be)g(established)f(via)i(what)f(we)f(called)i
(the)30 2360 y Fm(root)17 b Fr(context.)25 b(The)16 b(object)h(r)n
(efer)n(ence)g(to)g(the)f(r)n(oot)h(context)f(is)h(pr)n(ovided)f(by)h
(the)g(ORB)g(and)g(can)h(be)30 2473 y(obtained)26 b(by)h(calling)i
Fe(resolve)p 1224 2473 V 29 w(initial)p 1638 2473 V 30
w(references)p Fr(.)35 b(The)26 b(following)h(code)f(fragment)30
2586 y(shows)21 b(how)h(it)h(is)g(used:)30 2889 y Fd(CORBA::ORB_ptr)47
b(orb)i(=)h(CORBA::ORB_init\(argc,argv,"omniORB2")o(\);)30
3088 y(CORBA::Object_var)d(initServ;)30 3187 y(initServ)h(=)i
(orb->resolve_initial_references\("Na)o(meSer)o(vice"\))o(;)30
3387 y(CosNaming::NamingContext_var)45 b(rootContext;)30
3486 y(rootContext)j(=)h(CosNaming::NamingContext::_narrow\(ini)o
(tServ\))o(;)171 3802 y Fr(Remember)-7 b(,)57 b(omniORB2)51
b(constr)o(ucts)e(its)i(internal)g(list)f(of)h(initial)i(r)n(efer)n
(ences)c(at)i(ini-)30 3914 y(tialisation)62 b(time)e(using)g(the)g
(information)h(pr)n(ovided)e(in)i(the)f(con\002guration)g(\002le)g
Fe(om-)30 4027 y(niORB.cfg)p Fr(.)88 b(If)44 b(this)f(\002le)h(is)h
(not)e(pr)n(esent,)k(the)c(internal)h(list)h(will)g(be)f(empty)e(and)i
Fe(re-)30 4140 y(solve)p 310 4140 V 30 w(initial)p 725
4140 V 30 w(references)18 b Fr(will)24 b(raise)f(a)g
(CORBA::ORB::InvalidName)f(exception.)30 4399 y Fi(2.9.2)99
b(The)25 b(Naming)g(Service)g(Interface)30 4577 y Fr(It)17
b(is)i(beyond)d(the)i(scope)e(of)j(this)e(chapter)h(to)f(describe)h(in)
g(detail)g(the)g(Naming)g(Service)g(interface.)30 4690
y(Y)-8 b(ou)20 b(should)h(consult)g(the)f(CORBAservices)h
(speci\002cation)h([OMG96b)r(])g(\(chapter)f(3\).)28
b(The)21 b(code)30 4803 y(listed)e(in)i Fe(eg3)p 540
4803 V 31 w(impl.cc)c Fr(and)j Fe(eg3)p 1312 4803 V 31
w(clt.cc)d Fr(ar)n(e)k(good)d(examples)h(of)h(how)g(the)f(service)g
(can)i(be)30 4916 y(used.)26 b(Please)d(spend)d(time)j(to)f(study)f
(the)h(examples)g(car)n(efully)-10 b(.)p 30 5005 1368
4 v 111 5061 a Fh(14)164 5093 y Fg(A)29 b(pathname,)i(or)d(in)g(the)h
(Naming)f(Service's)f(terminology-)f(a)j Fb(compound)f(name)p
Fg(,)i(is)e(a)g(sequence)g(of)g(textual)30 5185 y(names.)38
b(Each)24 b(name)g(component)h(except)e(the)h(last)g(one)g(is)f(bound)h
(to)f(a)h(naming)g(context.)39 b(A)23 b(naming)h(context)h(is)30
5276 y(analogous)h(to)g(a)g(dir)o(ectory)e(in)i(a)g(\002ling)g(system,)
g(it)h(can)f(contain)i(names)e(of)g(object)h(r)o(efer)o(ences)c(or)j
(other)f(naming)30 5367 y(contexts.)44 b(The)26 b(last)g(name)g
(component)h(is)e(bound)h(to)g(an)h(object)g(r)o(efer)o(ence.)42
b(Note:)37 b('/')25 b(is)h(pur)o(ely)e(a)i(notation)h(to)30
5458 y(separate)c(two)i(components)f(in)g(the)g(pathname.)40
b(It)24 b(does)f(not)h(appear)g(in)g(the)g Fb(compound)g(name)g
Fg(that)h(is)e(r)o(egister)o(ed)30 5550 y(with)d(the)f(Naming)g
(Service.)p eop
%%Page: 19 25
19 24 bop 150 100 a Ff(2.10.)52 b(EXAMPLE)20 b(4)k(-)f(USING)e(TIE)h
(IMPLEMENT)-7 b(A)g(TION)20 b(TEMPLA)-7 b(TES)630 b Fr(19)150
356 y Fj(2.10)119 b(Example)29 b(4)h(-)g(Using)g(tie)f(implementation)h
(templates)150 567 y Fr(Since)19 b(2.6.0,)i(a)f(new)f(command-line)h
(option)f(\()p Fe(-t)p Fr(\))g(has)g(been)g(added)f(to)h
Fe(omniidl2)p Fr(.)k(When)18 b(this)150 680 y(\003ag)26
b(is)f(speci\002ed,)g Fe(omniidl2)d Fr(generates)h(an)j(extra)f
(template)g(class)h(for)f(each)h(interface.)36 b(This)150
793 y(template)22 b(class)h(can)g(be)g(used)e(to)h(tie)h(a)g(C++)g
(class)g(to)f(the)g(skeleton)f(class)i(of)f(the)g(interface.)291
906 y(The)e(sour)n(ce)g(code)g(in)i Fe(eg3)p 1227 906
28 4 v 31 w(tieimpl.cc)16 b Fr(at)22 b(the)e(end)f(of)i(this)g(chapter)
f(illustrates)h(how)f(the)150 1019 y(template)j(class)h(can)g(be)g
(used.)29 b(The)23 b(code)g(is)h(almost)f(identical)i(to)e
Fe(eg3)p 2681 1019 V 31 w(impl.cc)e Fr(with)i(only)h(a)150
1131 y(few)e(changes.)291 1244 y(Firstly)-10 b(,)32 b(the)f
(implementation)g(class)h Fe(Echo)p 1872 1244 V 31 w(i)f
Fr(does)e(not)i(inherit)g(fr)n(om)h(any)f(stub)g(classes.)150
1357 y(This)c(is)h(the)f(main)i(bene\002t)e(of)h(using)f(the)g
(template)g(class)h(because)f(ther)n(e)g(ar)n(e)h(applications)h(in)150
1470 y(which)j(it)g(is)g(dif)n(\002cult)g(to)f(r)n(equir)n(e)h(every)f
(implementation)g(class)h(to)f(subclass)h(fr)n(om)g(CORBA)150
1583 y(classes.)291 1696 y(Secondly)-10 b(,)28 b(the)g(instantiation)g
(of)h(a)g(CORBA)f(object)g(now)g(involves)h(cr)n(eating)f(an)h
(instance)150 1809 y(of)22 b(the)f(implementation)g(class)i
Fm(and)e Fr(an)h(instance)g(of)g(the)e(template.)27 b(Her)n(e)21
b(is)h(the)f(r)n(elevant)h(code)150 1922 y(fragment:)349
2121 y Fd(class)49 b(Echo_i)g({)g(...)h(};)349 2320 y(Echo_i)f(*myimpl)
f(=)i(new)f(Echo_i\(\);)349 2420 y(_tie_Echo<Echo_i,1>)e(*myobj)h(=)i
(new)f(_tie_Echo<Echo_i,1>\(myimpl\);)349 2520 y
(myobj->_obj_is_ready\(boa\);)291 2732 y Fr(For)19 b(interface)i
Fe(Echo)p Fr(,)d(the)h(name)i(of)f(its)f(tie)h(implementation)g
(template)f(is)p 2926 2732 V 53 w Fe(tie)p 3123 2732
V 32 w(Echo)p Fr(.)25 b(The)150 2845 y(\002rst)e(template)g(parameter)g
(is)h(the)e(implementation)i(class)g(that)f(contains)h(an)g
(implementation)150 2958 y(of)k(each)g(of)g(the)f(operations)f
(de\002ned)g(in)i(the)f(interface.)43 b(The)27 b(second)g(template)g
(parameter)g(is)150 3071 y(a)32 b(boolean)f(\003ag.)53
b(When)31 b(the)f(\003ag)i(is)f(TRUE)f(\(1\),)k(as)d(it)g(is)g(in)h
(this)f(example,)i(the)d(ORB)h(would)150 3184 y(call)g
Fe(delete)c Fr(on)i(the)f(implementation)i(object)f(\()p
Fe(myimpl)p Fr(\))e(when)p 2575 3184 V 61 w Fe(dispose)g
Fr(is)i(invoked)f(on)150 3297 y Fe(myobj)p Fr(.)43 b(When)28
b(the)f(\003ag)i(is)f(F)-7 b(ALSE)27 b(\(0\),)k Fe(delete)25
b Fr(would)j(not)g(be)g(called.)46 b(Instantiating)27
b(this)150 3410 y(template)33 b(with)g(the)g(\003ag)h(set)e(to)h(F)-7
b(ALSE)32 b(is)h(useful)g(when)g(the)g(same)g(implementation)h(class)
150 3523 y(is)27 b(used)e(to)h(implement)h(multiple)g(interfaces.)40
b(In)27 b(this)f(situation,)h(the)f(same)h(implementation)150
3635 y(would)f(be)g(used)f(as)h(the)g(ar)n(gument)g(to)f(a)i(number)f
(of)h(tie)f(template)f(instantiations.)39 b(Pr)n(ovided)150
3748 y(that)25 b(only)f(one)h(of)g(the)f(instantiation)h(has)g(the)f
(\003ag)h(set)f(to)h(TRUE,)e(the)h(object)h(implementation)150
3861 y(would)d(not)g(be)g(deleted)f(mor)n(e)h(than)h(once!)p
eop
%%Page: 20 26
20 25 bop 30 100 a Fr(20)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fj(2.1)l(1)118 b(Source)30
b(Listing)30 570 y Fi(2.1)l(1.1)99 b(echo)p 591 570 30
4 v 36 w(i.cc)30 728 y Fd(//)49 b(echo_i.cc)g(-)g(This)g(source)g(code)
g(demonstrates)f(an)h(implmentation)e(of)j(the)30 828
y(//)647 b(object)49 b(interface)f(Echo.)h(It)g(is)h(part)f(of)g(the)h
(three)e(examples)30 928 y(//)647 b(used)49 b(in)h(Chapter)e(2)i("The)f
(Basics")f(of)i(the)f(om-)30 1027 y(niORB2)g(user)g(guide.)30
1127 y(//)30 1226 y(#include)f(<string.h>)30 1326 y(#include)g
("echo.hh")30 1525 y(class)h(Echo_i)g(:)g(public)g(virtual)f(_sk_Echo)h
({)30 1625 y(public:)130 1725 y(Echo_i\(\))f({})130 1824
y(virtual)g(\230Echo_i\(\))g({})130 1924 y(virtual)g(char)h(*)h
(echoString\(const)d(char)i(*mesg\);)30 2023 y(};)30
2223 y(char)g(*)30 2322 y(Echo_i::echoString\(const)c(char)k(*mesg\))g
({)130 2422 y(char)g(*p)g(=)h(CORBA::string_dup\(mesg\);)130
2522 y(return)e(p;)30 2621 y(})p eop
%%Page: 21 27
21 26 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(21)150 356 y Fi(2.1)l(1.2)99 b(greeting.cc)150 514
y Fd(//)49 b(greeting.cc)f(-)i(This)f(source)g(code)g(demonstrates)e
(the)i(use)h(of)f(an)h(object)150 614 y(//)747 b(reference)48
b(by)h(a)h(client)f(to)g(perform)g(an)g(operation)f(on)i(an)150
713 y(//)747 b(object.)48 b(It)i(is)f(part)g(of)h(the)f(three)g
(examples)f(used)150 813 y(//)747 b(in)49 b(Chapter)g(2)g("The)g
(Basics")g(of)g(the)h(om-)150 912 y(niORB2)f(user)g(guide.)150
1012 y(//)150 1112 y(#include)f(<iostream.h>)150 1211
y(#include)g("echo.hh")150 1411 y(void)150 1510 y
(hello\(CORBA::Object_ptr)e(obj\))150 1610 y({)250 1709
y(Echo_var)i(e)i(=)f(Echo::_narrow\(obj\);)250 1909 y(if)g
(\(CORBA::is_nil\(e\)\))e({)349 2008 y(cerr)i(<<)h("hello:)e(cannot)h
(invoke)g(on)g(a)h(nil)f(object)g(refer-)150 2108 y(ence.\\n")f(<<)i
(endl;)349 2208 y(return;)250 2307 y(})250 2507 y(CORBA::String_var)c
(src)k(=)f(\(const)g(char*\))g("Hello!";)250 2606 y(CORBA::String_var)d
(dest;)250 2805 y(dest)j(=)g(e->echoString\(src\);)250
3005 y(cerr)g(<<)g("I)h(said,\\"")e(<<)h(src)h(<<)f("\\".")499
3104 y(<<)g(")h(The)f(Object)g(said,\\"")f(<<)h(dest)h(<<"\\"")e(<<)i
(endl;)150 3204 y(})p eop
%%Page: 22 28
22 27 bop 30 100 a Fr(22)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fi(2.1)l(1.3)99 b(eg1.cc)30
568 y Fd(//)49 b(eg1.cc)g(-)h(This)f(is)g(the)h(source)e(code)h(of)h
(example)e(1)i(used)f(in)g(Chapter)g(2)30 668 y(//)498
b("The)49 b(Basics")f(of)i(the)f(omniORB2)f(user)h(guide.)30
768 y(//)30 867 y(//)498 b(In)49 b(this)g(example,)g(both)g(the)g
(object)g(implementation)e(and)i(the)30 967 y(//)498
b(client)48 b(are)i(in)f(the)g(same)g(process.)30 1067
y(//)30 1166 y(//)g(Usage:)g(eg1)30 1266 y(//)30 1365
y(#include)f(<iostream.h>)30 1465 y(#include)g("echo.hh")30
1664 y(#include)g("echo_i.cc")30 1764 y(#include)g("greeting.cc")30
1963 y(int)30 2063 y(main\(int)g(argc,)h(char)g(**argv\))30
2163 y({)130 2262 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 2362
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 2561 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
2661 y(//)g(Note:)g(all)g(implementation)e(objects)i(must)g(be)g
(instantiated)f(on)h(the)130 2760 y(//)g(heap)g(using)g(the)g(new)h
(operator.)130 2960 y(myobj->_obj_is_ready\(boa\);)130
3059 y(//)f(Tell)g(the)g(BOA)h(the)f(object)g(is)g(ready)g(to)g(serve.)
130 3159 y(//)g(This)g(call)g(is)h(omniORB2)e(specific.)130
3258 y(//)130 3358 y(//)h(This)g(call)g(is)h(equivalent)e(to)h(the)g
(following)f(call)h(sequence:)130 3458 y(//)248 b(Echo_ptr)49
b(myobjRef)f(=)i(myobj->_this\(\);)130 3557 y(//)248
b(boa->obj_is_ready\(myobjRef\);)130 3657 y(//)g
(CORBA::release\(myobjRef\);)130 3856 y(boa->impl_is_ready\(0,1\);)130
3956 y(//)49 b(Tell)g(the)g(BOA)h(we)f(are)g(ready)g(and)g(to)h(return)
f(immediately)e(once)i(it)h(has)130 4055 y(//)f(done)g(its)g(stuff.)g
(It)h(is)f(omniORB2)f(specific)h(to)g(call)g(impl_is_ready\(\))130
4155 y(//)g(with)g(the)g(extra)g(2nd)h(argument-)e(CORBA::Boolean)f
(NonBlocking,)130 4255 y(//)i(which)g(is)g(set)h(to)f(TRUE)g(\(1\))g
(in)h(this)f(case.)130 4454 y(Echo_ptr)f(myobjRef)g(=)i
(myobj->_this\(\);)130 4554 y(//)f(Obtain)g(an)g(object)g(reference.)
130 4653 y(//)g(Note:)g(always)g(use)g(_this\(\))f(to)i(obtain)f(an)g
(object)g(reference)f(from)h(the)130 4753 y(//)348 b(object)49
b(implementation.)130 4952 y(hello\(myobjRef\);)130 5151
y(CORBA::release\(myobjRef\);)130 5251 y(//)g(Dispose)g(of)g(the)g
(object)g(reference.)130 5450 y(myobj->_dispose\(\);)130
5550 y(//)g(Dispose)g(of)g(the)g(object)g(implementation.)p
eop
%%Page: 23 29
23 28 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(23)250 356 y Fd(//)49 b(This)g(call)g(is)h(omniORB2)e(specific.)
250 456 y(//)h(Note:)g(*never*)f(call)i(the)f(delete)f(operator)h(or)g
(the)g(dtor)h(of)f(the)g(object)250 555 y(//)348 b(directly)48
b(because)h(the)g(BOA)g(needs)g(to)h(be)f(informed.)250
655 y(//)250 754 y(//)g(This)g(call)g(is)h(equivalent)e(to)h(the)g
(following)f(call)h(sequence:)250 854 y(//)248 b(Echo_ptr)49
b(myobjRef)f(=)i(myobj->_this\(\);)250 954 y(//)248 b
(boa->dispose\(myobjRef\);)250 1053 y(//)g(CORBA::release\(myobjRef\);)
250 1253 y(return)48 b(0;)150 1352 y(})p eop
%%Page: 24 30
24 29 bop 30 100 a Fr(24)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fi(2.1)l(1.4)99 b(eg2)p 536
356 30 4 v 36 w(impl.cc)30 514 y Fd(//)49 b(eg2_impl.cc)f(-)i(This)f
(is)g(the)h(source)e(code)h(of)h(example)e(2)i(used)f(in)g(Chap-)30
614 y(ter)g(2)30 713 y(//)747 b("The)49 b(Basics")f(of)i(the)f
(omniORB2)f(user)h(guide.)30 813 y(//)30 912 y(//)747
b(This)49 b(is)g(the)h(object)e(implementation.)30 1012
y(//)30 1112 y(//)h(Usage:)g(eg2_impl)30 1211 y(//)30
1311 y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(printed)g(to)g(cerr)g(as)h(a)30 1411 y(//)398 b(stringified)48
b(IOR.)h(This)g(string)g(should)f(be)i(used)f(as)g(the)h(argu-)30
1510 y(ment)f(to)30 1610 y(//)398 b(eg2_clt.)30 1709
y(//)30 1809 y(#include)48 b(<iostream.h>)30 1909 y(#include)g
("omnithread.h")30 2008 y(#include)g("echo.hh")30 2208
y(#include)g("echo_i.cc")30 2407 y(int)30 2507 y(main\(int)g(argc,)h
(char)g(**argv\))30 2606 y({)130 2706 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 2805
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 3005 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
3104 y(myobj->_obj_is_ready\(boa\);)130 3304 y({)229
3403 y(Echo_var)g(myobjRef)f(=)i(myobj->_this\(\);)229
3503 y(CORBA::String_var)d(p)j(=)f(orb->object_to_string\(myobjRef\);)
229 3602 y(cerr)g(<<)h("'")f(<<)g(\(char*\)p)g(<<)g("'")g(<<)h(endl;)
130 3702 y(})130 3901 y(boa->impl_is_ready\(\);)130 4001
y(//)f(Tell)g(the)g(BOA)h(we)f(are)g(ready.)g(The)g(BOA's)g(default)g
(be-)30 4101 y(haviour)f(is)i(to)f(block)130 4200 y(//)g(on)g(this)h
(call)f(indefinitely.)130 4399 y(return)f(0;)30 4499
y(})p eop
%%Page: 25 31
25 30 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(25)150 356 y Fi(2.1)l(1.5)99 b(eg2)p 656 356 30
4 v 36 w(clt.cc)150 568 y Fd(//)49 b(eg2_clt.cc)f(-)i(This)f(is)h(the)f
(source)f(code)i(of)f(example)f(2)i(used)f(in)h(Chap-)150
668 y(ter)f(2)150 768 y(//)697 b("The)49 b(Basics")g(of)g(the)g
(omniORB2)g(user)g(guide.)150 867 y(//)150 967 y(//)697
b(This)49 b(is)h(the)f(client.)f(The)i(object)e(refer-)150
1067 y(ence)h(is)h(given)e(as)i(a)150 1166 y(//)697 b(stringified)48
b(IOR)h(on)g(the)h(command)e(line.)150 1266 y(//)150
1365 y(//)h(Usage:)g(eg2_clt)g(<object)f(reference>)150
1465 y(//)150 1565 y(#include)g(<iostream.h>)150 1664
y(#include)g("echo.hh")150 1864 y(#include)g("greeting.cc")150
2063 y(extern)h(void)g(hello\(CORBA::Object_ptr)c(obj\);)150
2262 y(int)150 2362 y(main)k(\(int)g(argc,)g(char)g(**argv\))150
2461 y({)250 2561 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 2661
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 2860 y(if)f(\(argc)g(<)h(2\))f({)349
2960 y(cerr)g(<<)h("usage:)e(eg2_clt)h(<object)f(reference>")g(<<)h
(endl;)349 3059 y(return)g(1;)250 3159 y(})250 3358 y(try)g({)349
3458 y(CORBA::Object_var)e(obj)i(=)h(orb->string_to_object\(argv[1]\);)
349 3557 y(hello\(obj\);)250 3657 y(})250 3757 y
(catch\(CORBA::COMM_FAILURE&)45 b(ex\))k({)349 3856 y(cerr)g(<<)h
("Caught)e(system)h(exception)f(COMM_FAILURE,)f(unable)i(to)h(con-)150
3956 y(tact)f(the)g(")598 4055 y(<<)h("object.")e(<<)h(endl;)250
4155 y(})250 4255 y(catch\(omniORB::fatalException&)44
b(ex\))49 b({)349 4354 y(cerr)g(<<)h("Caught)e(omniORB2)h
(fatalException.)e(This)i(indi-)150 4454 y(cates)g(a)h(bug)f(is)g
(caught)g(")598 4554 y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h
(bug)f(report.\\n")598 4653 y(<<)h("The)f(exception)f(was)h(thrown)g
(in)g(file:)g(")h(<<)f(ex.file\(\))f(<<)i("\\n")598 4753
y(<<)g(")1394 b(line:)49 b(")h(<<)f(ex.line\(\))f(<<)i("\\n")598
4852 y(<<)g("The)f(error)g(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)
j(endl;)250 4952 y(})250 5052 y(catch\(...\))e({)349
5151 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception.")e(<<)j(endl;)250
5251 y(})250 5450 y(return)e(0;)150 5550 y(})p eop
%%Page: 26 32
26 31 bop 30 100 a Fr(26)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fi(2.1)l(1.6)99 b(eg3)p 536
356 30 4 v 36 w(impl.cc)30 568 y Fd(//)49 b(eg3_impl.cc)f(-)i(This)f
(is)g(the)h(source)e(code)h(of)h(example)e(3)i(used)f(in)g(Chap-)30
668 y(ter)g(2)30 768 y(//)747 b("The)49 b(Basics")f(of)i(the)f
(omniORB2)f(user)h(guide.)30 867 y(//)30 967 y(//)747
b(This)49 b(is)g(the)h(object)e(implementation.)30 1067
y(//)30 1166 y(//)h(Usage:)g(eg3_impl)30 1266 y(//)30
1365 y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(registered)f(with)h(the)30 1465 y(//)398 b(COS)49 b(naming)g(service.)
f(The)i(client)e(uses)h(the)h(naming)e(service)h(to)30
1565 y(//)398 b(locate)49 b(this)g(object.)30 1664 y(//)30
1764 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i(bound)f(to)
g(is)g(as)h(follows:)30 1864 y(//)697 b(root)99 b([context])30
1963 y(//)747 b(|)30 2063 y(//)697 b(text)99 b([context])48
b(kind)h([my_context])30 2163 y(//)747 b(|)30 2262 y(//)697
b(Echo)99 b([object])f(kind)49 b([Object])30 2362 y(//)30
2561 y(#include)f(<iostream.h>)30 2661 y(#include)g("omnithread.h")30
2760 y(#include)g("echo.hh")30 2960 y(#include)g("echo_i.cc")30
3159 y(static)h(CORBA::Boolean)e(bindObjectToName\(CORBA::ORB_ptr,COR)o
(BA::O)o(bject)o(_ptr\);)30 3358 y(int)30 3458 y(main\(int)h(argc,)h
(char)g(**argv\))30 3557 y({)130 3657 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 3757
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 3956 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
4055 y(myobj->_obj_is_ready\(boa\);)130 4255 y({)229
4354 y(Echo_var)g(myobjRef)f(=)i(myobj->_this\(\);)229
4454 y(if)g(\(!bindObjectToName\(orb,myobjRef\)\))43
b({)329 4554 y(return)49 b(1;)229 4653 y(})130 4753 y(})130
4952 y(boa->impl_is_ready\(\);)130 5052 y(//)g(Tell)g(the)g(BOA)h(we)f
(are)g(ready.)g(The)g(BOA's)g(default)g(be-)30 5151 y(haviour)f(is)i
(to)f(block)130 5251 y(//)g(on)g(this)h(call)f(indefinitely.)130
5450 y(return)f(0;)30 5550 y(})p eop
%%Page: 27 33
27 32 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(27)150 555 y Fd(static)150 655 y(CORBA::Boolean)150
754 y(bindObjectToName\(CORBA::ORB_ptr)44 b(orb,CORBA::Object_ptr)i
(obj\))150 854 y({)250 954 y(CosNaming::NamingContext_var)e
(rootContext;)250 1153 y(try)49 b({)349 1253 y(//)h(Obtain)e(a)i
(reference)e(to)i(the)f(root)g(context)f(of)i(the)f(Name)g(service:)349
1352 y(CORBA::Object_var)e(initServ;)349 1452 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)349
1651 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))349 1751 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)349 1850 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)349
1950 y(if)g(\(CORBA::is_nil\(rootContext\)\))449 2050
y({)549 2149 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)549 2249 y(return)e(0;)449 2348 y(})250 2448
y(})250 2548 y(catch\(CORBA::ORB::InvalidName&)c(ex\))49
b({)349 2647 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)e([does)h
(not)g(exist].")g(<<)g(endl;)349 2747 y(return)g(0;)250
2847 y(})250 3145 y(try)g({)349 3245 y(//)h(Bind)f(a)g(context)g
(called)g("test")f(to)i(the)f(root)g(context:)349 3444
y(CosNaming::Name)e(contextName;)349 3544 y(contextName.length\(1\);)
349 3644 y(contextName[0].id)147 b(=)49 b(\(const)g(char*\))g("test";)
197 b(//)50 b(string)f(copied)349 3743 y(contextName[0].kind)e(=)i
(\(const)g(char*\))g("my_context";)e(//)i(string)g(copied)349
3843 y(//)h(Note)f(on)g(kind:)g(The)g(kind)g(field)g(is)h(used)f(to)g
(indicate)g(the)g(type)349 3942 y(//)h(of)f(the)g(object.)g(This)g(is)g
(to)h(avoid)f(conventions)e(such)j(as)f(that)g(used)349
4042 y(//)h(by)f(files)g(\(name.type)f(--)h(e.g.)g(test.ps)g(=)h
(postscript)e(etc.\))349 4241 y(CosNaming::NamingContext_var)d
(testContext;)349 4341 y(try)50 b({)449 4441 y(//)f(Bind)g(the)h
(context)e(to)i(root,)e(and)i(assign)e(testContext)g(to)i(it:)449
4540 y(testContext)e(=)h(rootContext->bind_new_context\(context)o
(Name\))o(;)349 4640 y(})349 4740 y
(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)449 4839 y(//)g(If)h(the)f(context)g(already)f(exists,)h
(this)g(excep-)150 4939 y(tion)g(will)g(be)h(raised.)449
5038 y(//)f(In)h(this)f(case,)g(just)g(resolve)f(the)i(name)f(and)g
(assign)g(testContext)449 5138 y(//)g(to)h(the)f(object)g(returned:)449
5238 y(CORBA::Object_var)e(tmpobj;)449 5337 y(tmpobj)i(=)g
(rootContext->resolve\(contextName\);)449 5437 y(testContext)f(=)h
(CosNaming::NamingContext::_narrow\(tmp)o(obj\);)449
5537 y(if)g(\(CORBA::is_nil\(testContext\)\))c({)p eop
%%Page: 28 34
28 33 bop 30 100 a Fr(28)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)428 356 y Fd(cerr)50 b(<<)f("Failed)g(to)g(narrow)g
(naming)f(context.")g(<<)i(endl;)428 456 y(return)f(0;)329
555 y(})229 655 y(})229 854 y(//)h(Bind)f(the)g(object)g(\(obj\))g(to)g
(testContext,)f(naming)g(it)i(Echo:)229 954 y(CosNaming::Name)d
(objectName;)229 1053 y(objectName.length\(1\);)229 1153
y(objectName[0].id)147 b(=)49 b(\(const)g(char*\))g("Echo";)148
b(//)49 b(string)g(copied)229 1253 y(objectName[0].kind)e(=)i(\(const)g
(char*\))g("Object";)f(//)h(string)g(copied)229 1551
y(//)h(Bind)f(obj)g(with)g(name)g(Echo)g(to)h(the)f(testContext:)229
1651 y(try)g({)329 1751 y(testContext->bind\(objectName,obj\);)229
1850 y(})229 1950 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o
(nd&)44 b(ex\))49 b({)329 2050 y(testContext->rebind\(objectName,obj\))
o(;)229 2149 y(})229 2249 y(//)h(Note:)f(Using)f(rebind\(\))h(will)g
(overwrite)f(any)h(Object)g(previ-)30 2348 y(ously)g(bound)229
2448 y(//)349 b(to)49 b(/test/Echo)f(with)h(obj.)229
2548 y(//)349 b(Alternatively,)47 b(bind\(\))h(can)i(be)f(used,)g
(which)g(will)g(raise)g(a)229 2647 y(//)349 b
(CosNaming::NamingContext::Already)o(Bound)43 b(excep-)30
2747 y(tion)49 b(if)g(the)h(name)229 2847 y(//)349 b(supplied)48
b(is)h(already)g(bound)g(to)g(an)h(object.)229 3046 y(//)g(Amendment:)e
(When)h(using)g(OrbixNames,)e(it)j(is)f(neces-)30 3145
y(sary)g(to)g(first)g(try)h(bind)229 3245 y(//)g(and)f(then)g(rebind,)g
(as)g(rebind)g(on)g(it's)g(own)g(will)g(throw)g(a)h(Not-)30
3345 y(Foundexception)d(if)229 3444 y(//)j(the)f(Name)g(has)g(not)h
(already)e(been)h(bound.)g([This)g(is)g(incorrect)f(be-)30
3544 y(haviour)g(-)229 3644 y(//)i(it)f(should)g(just)g(bind].)130
3743 y(})130 3843 y(catch)f(\(CORBA::COMM_FAILURE&)e(ex\))k({)229
3942 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)30 4042 y(tact)f(the)g(")478 4142
y(<<)h("naming)e(service.")g(<<)i(endl;)229 4241 y(return)f(0;)130
4341 y(})130 4441 y(catch)f(\(omniORB::fatalException&)e(ex\))j({)229
4540 y(throw;)130 4640 y(})130 4740 y(catch)f(\(...\))h({)229
4839 y(cerr)g(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)30 4939 y(vice."<<)g(endl;)229 5038
y(return)h(0;)130 5138 y(})130 5238 y(return)f(1;)30
5337 y(})p eop
%%Page: 29 35
29 34 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(29)150 356 y Fi(2.1)l(1.7)99 b(eg3)p 656 356 30
4 v 36 w(clt.cc)150 568 y Fd(//)49 b(eg3_clt.cc)f(-)i(This)f(is)h(the)f
(source)f(code)i(of)f(example)f(3)i(used)f(in)h(Chap-)150
668 y(ter)f(2)150 768 y(//)697 b("The)49 b(Basics")g(of)g(the)g
(omniORB2)g(user)g(guide.)150 867 y(//)150 967 y(//)697
b(This)49 b(is)h(the)f(client.)f(It)i(uses)f(the)g(COSS)g(naming)g
(service)150 1067 y(//)697 b(to)49 b(obtain)g(the)g(object)g
(reference.)150 1166 y(//)150 1266 y(//)g(Usage:)g(eg3_clt)150
1365 y(//)150 1465 y(//)150 1565 y(//)398 b(On)50 b(startup,)e(the)h
(client)g(lookup)g(the)g(object)f(refer-)150 1664 y(ence)h(from)g(the)
150 1764 y(//)398 b(COS)49 b(naming)g(service.)150 1864
y(//)150 1963 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i
(bound)f(to)g(is)g(as)h(follows:)150 2063 y(//)697 b(root)99
b([context])150 2163 y(//)747 b(|)150 2262 y(//)697 b(text)99
b([context])48 b(kind)h([my_context])150 2362 y(//)747
b(|)150 2461 y(//)697 b(Echo)99 b([object])f(kind)49
b([Object])150 2561 y(//)150 2760 y(#include)f(<iostream.h>)150
2860 y(#include)g("echo.hh")150 3059 y(#include)g("greeting.cc")150
3258 y(extern)h(void)g(hello\(CORBA::Object_ptr)c(obj\);)150
3458 y(static)k(CORBA::Object_ptr)d(getObjectReference\(CORBA::ORB_ptr)
e(orb\);)150 3657 y(int)150 3757 y(main)49 b(\(int)g(argc,)g(char)g
(**argv\))150 3856 y({)250 3956 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 4055
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 4255 y(try)f({)349 4354 y(CORBA::Object_var)e(obj)i(=)h
(getObjectReference\(orb\);)349 4454 y(hello\(obj\);)250
4554 y(})250 4653 y(catch\(CORBA::COMM_FAILURE&)45 b(ex\))k({)349
4753 y(cerr)g(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 4852 y(tact)f(the)g(")598 4952
y(<<)h("object.")e(<<)h(endl;)250 5052 y(})250 5151 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)349
5251 y(cerr)g(<<)h("Caught)e(omniORB2)h(fatalException.)e(This)i(indi-)
150 5351 y(cates)g(a)h(bug)f(is)g(caught)g(")598 5450
y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h(bug)f(report.\\n")598
5550 y(<<)h("The)f(exception)f(was)h(thrown)g(in)g(file:)g(")h(<<)f
(ex.file\(\))f(<<)i("\\n")p eop
%%Page: 30 36
30 35 bop 30 100 a Fr(30)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)478 356 y Fd(<<)50 b(")1394 b(line:)49
b(")h(<<)f(ex.line\(\))f(<<)i("\\n")478 456 y(<<)g("The)f(error)g
(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)j(endl;)130
555 y(})130 655 y(catch\(...\))e({)229 754 y(cerr)h(<<)h("Caught)e(a)i
(system)f(exception.")e(<<)j(endl;)130 854 y(})130 1053
y(return)e(0;)30 1153 y(})30 1352 y(static)30 1452 y(CORBA::Object_ptr)
30 1551 y(getObjectReference\(CORBA::ORB_ptr)c(orb\))30
1651 y({)130 1751 y(CosNaming::NamingContext_var)g(rootContext;)130
1950 y(try)49 b({)229 2050 y(//)h(Obtain)e(a)i(reference)e(to)i(the)f
(root)g(context)f(of)i(the)f(Name)g(service:)229 2149
y(CORBA::Object_var)e(initServ;)229 2249 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)229
2448 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))229 2548 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)229 2647 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)229
2747 y(if)g(\(CORBA::is_nil\(rootContext\)\))329 2847
y({)428 2946 y(cerr)g(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)428 3046 y(return)f(CORBA::Object::_nil\(\);)329
3145 y(})130 3245 y(})130 3345 y(catch\(CORBA::ORB::InvalidName&)44
b(ex\))49 b({)229 3444 y(cerr)g(<<)h("Service)e(required)g(is)i
(invalid)e([does)h(not)g(exist].")g(<<)g(endl;)229 3544
y(return)g(CORBA::Object::_nil\(\);)130 3644 y(})130
3942 y(//)g(Create)g(a)g(name)g(object,)g(containing)f(the)h(name)g
(test/context:)130 4042 y(CosNaming::Name)e(name;)130
4142 y(name.length\(2\);)130 4341 y(name[0].id)147 b(=)50
b(\(const)f(char*\))f("test";)348 b(//)49 b(string)g(copied)130
4441 y(name[0].kind)e(=)j(\(const)f(char*\))f("my_context";)g(//)h
(string)g(copied)130 4540 y(name[1].id)147 b(=)50 b(\(const)f(char*\))f
("Echo";)130 4640 y(name[1].kind)f(=)j(\(const)f(char*\))f("Object";)
130 4740 y(//)h(Note)g(on)h(kind:)e(The)i(kind)f(field)g(is)g(used)g
(to)h(indicate)e(the)h(type)130 4839 y(//)g(of)g(the)h(object.)e(This)h
(is)h(to)f(avoid)g(conventions)f(such)h(as)g(that)g(used)130
4939 y(//)g(by)g(files)g(\(name.type)f(--)i(e.g.)f(test.ps)f(=)i
(postscript)e(etc.\))130 5238 y(CORBA::Object_ptr)e(obj;)130
5337 y(try)j({)229 5437 y(//)h(Resolve)e(the)h(name)h(to)f(an)g(object)
g(reference,)f(and)h(as-)30 5537 y(sign)g(the)g(reference)p
eop
%%Page: 31 37
31 36 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(31)349 356 y Fd(//)50 b(returned)e(to)h(a)h(CORBA::Object:)349
456 y(obj)g(=)f(rootContext->resolve\(name\);)250 555
y(})250 655 y(catch\(CosNaming::NamingContext::N)o(otFoun)o(d&)44
b(ex\))349 754 y({)449 854 y(//)49 b(This)g(exception)g(is)g(thrown)g
(if)g(any)g(of)h(the)f(components)f(of)h(the)449 954
y(//)g(path)g([contexts)g(or)g(the)g(object])g(aren't)f(found:)449
1053 y(cerr)h(<<)g("Context)g(not)g(found.")f(<<)i(endl;)449
1153 y(return)f(CORBA::Object::_nil\(\);)349 1253 y(})250
1352 y(catch)g(\(CORBA::COMM_FAILURE&)c(ex\))50 b({)349
1452 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 1551 y(tact)f(the)g(")598 1651
y(<<)h("naming)e(service.")g(<<)i(endl;)349 1751 y(return)f
(CORBA::Object::_nil\(\);)250 1850 y(})250 1950 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)349
2050 y(throw;)250 2149 y(})250 2249 y(catch)g(\(...\))f({)349
2348 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)150 2448 y(vice."<<)g(endl;)349
2548 y(return)h(CORBA::Object::_nil\(\);)250 2647 y(})250
2747 y(return)f(obj;)150 2847 y(})p eop
%%Page: 32 38
32 37 bop 30 100 a Fr(32)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fi(2.1)l(1.8)99 b(eg3)p 536
356 30 4 v 36 w(tieimpl.cc)30 568 y Fd(//)49 b(eg3_tieimpl.cc)f(-)h
(This)g(example)g(is)g(similar)g(to)g(eg3_impl.cc)f(ex-)30
668 y(cept)h(that)30 768 y(//)896 b(the)50 b(tie)f(implementation)e
(skeleton)h(is)i(used.)30 867 y(//)30 967 y(//)747 b(This)49
b(is)g(the)h(object)e(implementation.)30 1067 y(//)30
1166 y(//)h(Usage:)g(eg3_tieimpl)30 1266 y(//)30 1365
y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(registered)f(with)h(the)30 1465 y(//)398 b(COS)49 b(naming)g(service.)
f(The)i(client)e(uses)h(the)h(naming)e(service)h(to)30
1565 y(//)398 b(locate)49 b(this)g(object.)30 1664 y(//)30
1764 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i(bound)f(to)
g(is)g(as)h(follows:)30 1864 y(//)697 b(root)99 b([context])30
1963 y(//)747 b(|)30 2063 y(//)697 b(text)99 b([context])48
b(kind)h([my_context])30 2163 y(//)747 b(|)30 2262 y(//)697
b(Echo)99 b([object])f(kind)49 b([Object])30 2362 y(//)30
2561 y(#include)f(<iostream.h>)30 2661 y(#include)g("omnithread.h")30
2760 y(#include)g("echo.hh")30 3059 y(//)h(Real)g(implementation,)f
(notice)g(that)h(it)h(does)f(not)g(in-)30 3159 y(herit)g(from)g(any)g
(stub)g(class)30 3258 y(class)g(Echo_i)g({)30 3358 y(public:)130
3458 y(Echo_i\(\))f({})130 3557 y(virtual)g(\230Echo_i\(\))g({})130
3657 y(virtual)g(char)h(*)h(echoString\(const)d(char)i(*mesg\);)30
3757 y(};)30 3956 y(char)g(*)30 4055 y(Echo_i::echoString\(const)c
(char)k(*mesg\))g({)130 4155 y(char)g(*p)g(=)h
(CORBA::string_dup\(mesg\);)130 4255 y(return)e(p;)30
4354 y(})30 4653 y(static)h(CORBA::Boolean)e
(bindObjectToName\(CORBA::ORB_ptr,COR)o(BA::O)o(bject)o(_ptr\);)30
4852 y(int)30 4952 y(main\(int)h(argc,)h(char)g(**argv\))30
5052 y({)130 5151 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 5251
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 5450 y(Echo_i)e(*myimpl)h(=)g(new)h(Echo_i\(\);)130
5550 y(_tie_Echo<Echo_i,1>)c(*myobj)j(=)g(new)g
(_tie_Echo<Echo_i,1>\(myimpl\);)p eop
%%Page: 33 39
33 38 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(33)250 356 y Fd(myobj->_obj_is_ready\(boa\);)250
555 y({)349 655 y(Echo_var)49 b(myobjRef)f(=)i(myobj->_this\(\);)349
754 y(if)g(\(!bindObjectToName\(orb,myobjRef\)\))43 b({)449
854 y(return)49 b(1;)349 954 y(})250 1053 y(})250 1253
y(boa->impl_is_ready\(\);)250 1352 y(//)g(Tell)g(the)g(BOA)h(we)f(are)g
(ready.)g(The)g(BOA's)g(default)g(be-)150 1452 y(haviour)g(is)g(to)g
(block)250 1551 y(//)g(on)h(this)f(call)g(indefinitely.)250
1751 y(return)f(0;)150 1850 y(})150 2149 y(static)150
2249 y(CORBA::Boolean)150 2348 y(bindObjectToName\(CORBA::ORB_ptr)c
(orb,CORBA::Object_ptr)i(obj\))150 2448 y({)250 2548
y(CosNaming::NamingContext_var)e(rootContext;)250 2747
y(try)49 b({)349 2847 y(//)h(Obtain)e(a)i(reference)e(to)i(the)f(root)g
(context)f(of)i(the)f(Name)g(service:)349 2946 y(CORBA::Object_var)e
(initServ;)349 3046 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)349
3245 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))349 3345 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)349 3444 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)349
3544 y(if)g(\(CORBA::is_nil\(rootContext\)\))449 3644
y({)549 3743 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)549 3843 y(return)e(0;)449 3942 y(})250 4042
y(})250 4142 y(catch\(CORBA::ORB::InvalidName&)c(ex\))49
b({)349 4241 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)e([does)h
(not)g(exist].")g(<<)g(endl;)349 4341 y(return)g(0;)250
4441 y(})250 4740 y(try)g({)349 4839 y(//)h(Bind)f(a)g(context)g
(called)g("test")f(to)i(the)f(root)g(context:)349 5038
y(CosNaming::Name)e(contextName;)349 5138 y(contextName.length\(1\);)
349 5238 y(contextName[0].id)147 b(=)49 b(\(const)g(char*\))g("test";)
197 b(//)50 b(string)f(copied)349 5337 y(contextName[0].kind)e(=)i
(\(const)g(char*\))g("my_context";)e(//)i(string)g(copied)349
5437 y(//)h(Note)f(on)g(kind:)g(The)g(kind)g(field)g(is)h(used)f(to)g
(indicate)g(the)g(type)349 5537 y(//)h(of)f(the)g(object.)g(This)g(is)g
(to)h(avoid)f(conventions)e(such)j(as)f(that)g(used)p
eop
%%Page: 34 40
34 39 bop 30 100 a Fr(34)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)229 356 y Fd(//)50 b(by)f(files)g(\(name.type)f(--)h
(e.g.)g(test.ps)g(=)h(postscript)e(etc.\))229 555 y
(CosNaming::NamingContext_var)d(testContext;)229 655
y(try)k({)329 754 y(//)g(Bind)g(the)h(context)e(to)i(root,)e(and)i
(assign)e(testContext)g(to)i(it:)329 854 y(testContext)e(=)h
(rootContext->bind_new_context\(context)o(Name\))o(;)229
954 y(})229 1053 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o
(nd&)44 b(ex\))49 b({)329 1153 y(//)g(If)h(the)f(context)g(already)f
(exists,)h(this)g(excep-)30 1253 y(tion)g(will)g(be)h(raised.)329
1352 y(//)f(In)h(this)f(case,)g(just)g(resolve)f(the)i(name)f(and)g
(assign)g(testContext)329 1452 y(//)g(to)h(the)f(object)g(returned:)329
1551 y(CORBA::Object_var)e(tmpobj;)329 1651 y(tmpobj)i(=)g
(rootContext->resolve\(contextName\);)329 1751 y(testContext)f(=)h
(CosNaming::NamingContext::_narrow\(tmp)o(obj\);)329
1850 y(if)g(\(CORBA::is_nil\(testContext\)\))c({)428
1950 y(cerr)50 b(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g(<<)i
(endl;)428 2050 y(return)f(0;)329 2149 y(})229 2249 y(})229
2448 y(//)h(Bind)f(the)g(object)g(\(obj\))g(to)g(testContext,)f(naming)
g(it)i(Echo:)229 2548 y(CosNaming::Name)d(objectName;)229
2647 y(objectName.length\(1\);)229 2747 y(objectName[0].id)147
b(=)49 b(\(const)g(char*\))g("Echo";)148 b(//)49 b(string)g(copied)229
2847 y(objectName[0].kind)e(=)i(\(const)g(char*\))g("Object";)f(//)h
(string)g(copied)229 3145 y(//)h(Bind)f(obj)g(with)g(name)g(Echo)g(to)h
(the)f(testContext:)229 3245 y(try)g({)329 3345 y
(testContext->bind\(objectName,obj\);)229 3444 y(})229
3544 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)329 3644 y(testContext->rebind\(objectName,obj\))o(;)229
3743 y(})229 3843 y(//)h(Note:)f(Using)f(rebind\(\))h(will)g(overwrite)
f(any)h(Object)g(previ-)30 3942 y(ously)g(bound)229 4042
y(//)349 b(to)49 b(/test/Echo)f(with)h(obj.)229 4142
y(//)349 b(Alternatively,)47 b(bind\(\))h(can)i(be)f(used,)g(which)g
(will)g(raise)g(a)229 4241 y(//)349 b
(CosNaming::NamingContext::Already)o(Bound)43 b(excep-)30
4341 y(tion)49 b(if)g(the)h(name)229 4441 y(//)349 b(supplied)48
b(is)h(already)g(bound)g(to)g(an)h(object.)229 4640 y(//)g(Amendment:)e
(When)h(using)g(OrbixNames,)e(it)j(is)f(neces-)30 4740
y(sary)g(to)g(first)g(try)h(bind)229 4839 y(//)g(and)f(then)g(rebind,)g
(as)g(rebind)g(on)g(it's)g(own)g(will)g(throw)g(a)h(Not-)30
4939 y(Foundexception)d(if)229 5038 y(//)j(the)f(Name)g(has)g(not)h
(already)e(been)h(bound.)g([This)g(is)g(incorrect)f(be-)30
5138 y(haviour)g(-)229 5238 y(//)i(it)f(should)g(just)g(bind].)130
5337 y(})130 5437 y(catch)f(\(CORBA::COMM_FAILURE&)e(ex\))k({)229
5537 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)p eop
%%Page: 35 41
35 40 bop 150 100 a Ff(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(35)150 356 y Fd(tact)49 b(the)g(")598 456 y(<<)h("naming)e
(service.")g(<<)i(endl;)349 555 y(return)f(0;)250 655
y(})250 754 y(catch)g(\(omniORB::fatalException&)c(ex\))k({)349
854 y(throw;)250 954 y(})250 1053 y(catch)g(\(...\))f({)349
1153 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)150 1253 y(vice."<<)g(endl;)349
1352 y(return)h(0;)250 1452 y(})250 1551 y(return)f(1;)150
1651 y(})p eop
%%Page: 36 42
36 41 bop 30 100 a Fr(36)2224 b Ff(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fi(2.1)l(1.9)99 b(dir)-5 b(.mk)30
514 y Fd(#)50 b(dir.mk)e(-)i(This)f(is)g(the)h(makefile)e(to)h(compile)
g(all)g(the)g(example)g(pro-)30 614 y(grams)g(used)g(in)30
713 y(#)498 b(Chapter)48 b(2)i(The)f(Basics.)30 813 y(#)498
b(This)49 b(makefile)f(is)i(to)f(be)h(used)f(under)g(the)g(OMNI)g
(develop-)30 912 y(ment)g(environment.)30 1012 y(#)30
1112 y(CXXSRCS)f(=)i(greeting.cc)e(eg1.cc)h(\\)528 1211
y(eg2_impl.cc)f(eg2_clt.cc)g(\\)528 1311 y(eg3_impl.cc)g(eg3_clt.cc)30
1510 y(DIR_CPPFLAGS)g(=)h($\(CORBA_CPPFLAGS\))30 1709
y(CORBA_INTERFACES)e(=)i(echo)30 1909 y(eg1)398 b(=)50
b($\(patsubst)e(\045,$\(BinPattern\),eg1\))30 2008 y(eg2_impl)148
b(=)50 b($\(patsubst)e(\045,$\(BinPattern\),eg2_impl\))30
2108 y(eg2_clt)198 b(=)50 b($\(patsubst)e
(\045,$\(BinPattern\),eg2_clt\))30 2208 y(eg3_impl)148
b(=)50 b($\(patsubst)e(\045,$\(BinPattern\),eg3_impl\))30
2307 y(eg3_clt)198 b(=)50 b($\(patsubst)e
(\045,$\(BinPattern\),eg3_clt\))30 2507 y(all::)h($\(eg1\))g
($\(eg2_impl\))e($\(eg2_clt\))98 b($\(eg3_impl\))48 b($\(eg3_clt\))30
2706 y(clean::)428 2805 y($\(RM\))h($\(eg1\))g($\(eg2_impl\))f
($\(eg2_clt\))g($\(eg3_impl\))g($\(eg3_clt\))30 3005
y($\(eg1\):)g(eg1.o)h($\(CORBA_STUB_OBJS\))e($\(CORBA_LIB_DEPEND\))428
3104 y(@\(libs="$\(CORBA_LIB\)";)f($\(CXXExecutable\)\))30
3304 y($\(eg2_impl\):)i(eg2_impl.o)g($\(CORBA_STUB_OBJS\))e
($\(CORBA_LIB_DEPEND\))428 3403 y(@\(libs="$\(CORBA_LIB\)";)g
($\(CXXExecutable\)\))30 3602 y($\(eg2_clt\):)i(eg2_clt.o)g
($\(CORBA_STUB_OBJS\))e($\(CORBA_LIB_DEPEND\))428 3702
y(@\(libs="$\(CORBA_LIB\)";)g($\(CXXExecutable\)\))30
3901 y($\(eg3_impl\):)i(eg3_impl.o)g($\(CORBA_STUB_OBJS\))e
($\(CORBA_LIB_DEPEND\))428 4001 y(@\(libs="$\(CORBA_LIB\)";)g
($\(CXXExecutable\)\))30 4200 y($\(eg3_clt\):)i(eg3_clt.o)g
($\(CORBA_STUB_OBJS\))e($\(CORBA_LIB_DEPEND\))428 4300
y(@\(libs="$\(CORBA_LIB\)";)g($\(CXXExecutable\)\))p
eop
%%Page: 37 43
37 42 bop 150 979 a Fl(Chapter)44 b(3)150 1394 y Fn(IDL)52
b(to)g(C++)g(Language)g(Mapping)150 1855 y Fr(Now)24
b(that)h(you)f(ar)n(e)i(familiar)i(with)d(the)f(basics,)i(it)g(is)f
(important)g(to)f(familiar)k(yourselves)23 b(with)150
1968 y(the)30 b(IDL)g(to)g(C++)h(language.)51 b(The)30
b(mapping)h(is)f(described)g(in)h(detail)f(in)h([OMG96a)s(].)51
b(If)31 b(you)150 2081 y(have)36 b(not)g(done)f(so,)j(you)d(should)h
(obtain)g(a)h(copy)e(of)h(the)g(document)f(and)h(use)f(that)h(as)g(the)
150 2194 y(pr)n(ogramming)23 b(guide)e(to)h(omniORB2.)1815
5778 y(37)p eop
%%Page: 38 44
38 43 bop 30 100 a Fr(38)1223 b Ff(CHAPTER)22 b(3.)51
b(IDL)22 b(T)n(O)h(C++)h(LANGUAGE)d(MAPPING)p eop
%%Page: 39 45
39 44 bop 150 981 a Fl(Chapter)44 b(4)150 1398 y Fn(The)52
b(omniORB2)f(API)150 1845 y Fr(In)19 b(this)g(chapter)-7
b(,)19 b(we)f(intr)n(oduce)h(the)f(omniORB2)i(API.)e(The)h(purpose)d
(of)k(this)e(API)h(is)g(to)g(pr)n(ovide)150 1958 y(access)h(points)g
(to)f(omniORB2)i(speci\002c)g(functionalities)g(that)f(ar)n(e)h(not)e
(cover)n(ed)h(by)g(the)g(CORBA)150 2071 y(speci\002cation.)61
b(Obviously)-10 b(,)36 b(if)f(you)d(use)h(this)g(API)g(in)h(your)f
(application,)k(that)c(part)h(of)f(your)150 2184 y(code)24
b(is)i(not)e(going)h(to)f(be)i(portable)f(to)f(r)o(un)h(unchanged)g(on)
g(other)f(vendors')g(ORBs.)35 b(T)-8 b(o)24 b(make)150
2297 y(it)29 b(easier)g(to)g(identify)g(omniORB2)h(dependent)c(code,)k
(this)f(API)f(is)i(de\002ned)d(under)h(the)h(name)150
2409 y(space)22 b(\223omniORB\224)882 2376 y Fk(1)921
2409 y Fr(.)150 2721 y Fj(4.1)119 b(ORB)30 b(and)f(BOA)g
(initialisation)g(options)150 2936 y Fe(CORBA::ORB)p
705 2936 28 4 v 28 w(init)21 b Fr(accepts)h(the)g(following)h
(command-line)h(ar)n(guments:)150 3159 y Fe(-ORBid)52
b(``omniORB2'')40 b Fr(The)22 b(identi\002er)f(supplied)h(must)g(be)g
(\223omniORB2\224.)150 3354 y Fe(-ORBtraceLevel)48 b(<level>)42
b Fr(See)22 b(section)g(4.2.)150 3550 y Fe(-ORBserverName)48
b(<string>)42 b Fr(See)22 b(section)f(4.3.)150 3746 y
Fe(-ORBtcAliasExpa)o(nd)48 b(<0)53 b(or)h(1>)45 b Fr(See)21
b(section)h(9.2.)150 3942 y Fe(-ORBgiopMaxMsgS)o(iz)o(e)48
b(<size)53 b(in)g(bytes>)43 b Fr(See)22 b(section)f(4.5.)150
4138 y Fe(-ORBInitialHost)48 b(<string>)42 b Fr(See)21
b(section)h(4.6.)150 4333 y Fe(-ORBInitialPort)48 b(<1-65535>)41
b Fr(See)22 b(section)f(4.6.)150 4529 y Fe(-ORBdiiThrowsSy)o(sE)o(xc)o
(ep)o(tio)o(ns)48 b(<0)53 b(or)h(1>)45 b Fr(See)21 b(section)h(1)-5
b(1.4.)150 4725 y Fe(-ORBinConScanPe)o(ri)o(od)48 b(<0-65535>)41
b Fr(See)22 b(section)g(7.3.)150 4921 y Fe(-ORBoutConScanP)o(er)o(io)o
(d)48 b(<0-65535>)42 b Fr(See)21 b(section)h(7.3.)291
5144 y Fe(BOA)p 461 5144 V 32 w(init)e Fr(accepts)j(the)e(following)i
(command-line)h(ar)n(guments:)150 5366 y Fe(-BOAid)52
b(``omniORB2)p 1087 5366 V 28 w(BOA'')43 b Fr(The)22
b(identi\002er)g(supplied)f(must)h(be)h(\223omniORB2)p
3207 5366 V 33 w(BOA)-7 b(\224.)p 150 5462 1368 4 v 255
5518 a Fh(1)284 5550 y Fg(omniORB)18 b(is)h(a)g(class)f(name)h(if)g
(the)g(C++)g(compiler)e(does)h(not)h(support)f(the)i(namespace)f
(keywor)o(d.)1815 5778 y Fr(39)p eop
%%Page: 40 46
40 45 bop 30 100 a Fr(40)1865 b Ff(CHAPTER)21 b(4.)52
b(THE)21 b(OMNIORB2)i(API)30 356 y Fe(-BOAiiop)p 475
356 28 4 v 29 w(port)53 b(<port)f(number>)42 b Fr(This)23
b(option)f(tells)h(the)f(BOA)h(which)h(TCP/IP)f(port)f(to)257
469 y(use)35 b(to)g(accept)h(IIOP)f(calls.)69 b(If)35
b(this)h(option)e(is)i(not)f(speci\002ed,)j(the)c(BOA)i(will)h(use)e
(an)257 582 y(arbitrary)24 b(port)d(assigned)g(by)i(the)f(operating)f
(system.)30 814 y Fe(-BOAno)p 365 814 V 30 w(bootstrap)p
890 814 V 29 w(agent)43 b Fr(See)21 b(section)h(4.6.)171
1082 y(By)d(default,)h(the)f(BOA)h(can)g(work)f(out)g(the)g(IP)g(addr)n
(ess)g(of)h(the)f(host)f(machine.)28 b(This)20 b(addr)n(ess)30
1195 y(is)28 b(r)n(ecor)n(ded)f(in)i(the)e(object)h(r)n(efer)n(ences)f
(of)h(the)f(local)j(objects.)43 b(However)-7 b(,)28 b(when)g(the)f
(host)g(has)30 1308 y(multiple)35 b(network)e(interfaces)h(and)h
(multiple)g(IP)g(addr)n(esses,)g(it)g(may)g(be)g(desirable)f(for)h(the)
30 1420 y(application)21 b(to)e(contr)n(ol)g(what)h(addr)n(ess)e(the)h
(BOA)g(should)g(use.)26 b(This)19 b(can)i(be)e(done)g(by)g(de\002ning)
30 1533 y(the)f(envir)n(onment)f(variable)k Fe(OMNIORB)p
1444 1533 V 29 w(USEHOSTNAME)14 b Fr(to)j(contain)i(the)f(pr)n(eferr)n
(ed)f(host)g(name)30 1646 y(or)22 b(IP)h(addr)n(ess)e(in)i(dot-numeric)
f(form.)171 1770 y(As)d(de\002ned)g(in)h(the)f(CORBA)h
(speci\002cation,)g(any)g(command-line)h(ar)n(guments)e(understood)30
1883 y(by)g(the)f(ORB/BOA)h(will)h(be)f(r)n(emoved)f(fr)n(om)i
Fe(argv)d Fr(when)h(the)h(initialisation)i(functions)d(r)n(eturn.)30
1996 y(Ther)n(efor)n(e,)32 b(an)f(application)h(is)f(not)f(r)n(equir)n
(ed)h(to)f(handle)h(any)g(command-line)h(ar)n(guments)e(it)30
2109 y(does)21 b(not)h(understand.)30 2476 y Fj(4.2)119
b(Run-time)30 b(T)-13 b(racing)29 b(and)h(Diagnostic)f(Messages)30
2709 y Fr(OmniORB2)j(uses)d(the)h(C++)h(iostr)n(eam)g
Fe(cerr)e Fr(to)h(output)f(any)h(tracing)h(and)g(diagnostic)f(mes-)30
2822 y(sages.)63 b(Some)34 b(or)h(all)h(of)f(these)e(messages)g(can)j
(be)e(turned-on/of)n(f)g(by)h(setting)e(the)h(variable)30
2935 y Fe(omniORB::traceL)o(ev)o(el)o Fr(.)22 b(The)g(type)f
(de\002nition)h(of)h(the)f(variable)i(is:)30 3201 y Fd(CORBA::ULong)48
b(omniORB::traceLevel)e(=)j(1;)100 b(//)49 b(The)g(default)g(value)g
(is)g(1)171 3469 y Fr(At)22 b(the)g(moment,)g(the)g(following)g(trace)h
(levels)g(ar)n(e)g(de\002ned:)30 3737 y Fm(level)h(0)46
b Fr(turn)22 b(of)n(f)h(all)h(tracing)f(and)g(informational)h(messages)
30 3969 y Fm(level)g(1)46 b Fr(informational)24 b(messages)d(only)30
4201 y Fm(level)j(2)46 b Fr(the)21 b(above)i(plus)g(con\002guration)f
(information)30 4433 y Fm(level)i(5)46 b Fr(the)28 b(above)h(plus)g
(noti\002cations)f(when)h(server)f(thr)n(eads)g(ar)n(e)h(cr)n(eated)g
(or)f(communica-)257 4545 y(tion)23 b(endpoints)d(ar)n(e)j(shutdown)30
4777 y Fm(level)h(10-20)47 b Fr(the)22 b(above)h(plus)f(execution)g
(traces)171 5045 y(The)d(variable)j(can)f(be)f(changed)f(by)h
(assignment)f(inside)g(your)g(applications.)28 b(It)19
b(can)i(also)f(be)30 5158 y(changed)26 b(by)g(specifying)g(the)g
(command-line)i(option:)34 b Fe(-ORBtraceLevel)48 b(<level>)p
Fr(.)37 b(For)30 5271 y(instance:)30 5537 y Fd($)50 b(eg2_impl)e
(-ORBtraceLevel)f(5)p eop
%%Page: 41 47
41 46 bop 150 100 a Ff(4.3.)51 b(SER)-5 b(VER)21 b(NAME)2489
b Fr(41)150 356 y Fj(4.3)119 b(Server)29 b(Name)150 567
y Fr(Applications)18 b(can)i(optionally)e(speci\002ed)f(a)i(name)g(to)f
(identify)g(the)g(server)f(pr)n(ocess.)25 b(At)18 b(the)g(mo-)150
680 y(ment,)k(this)h(name)g(is)h(only)e(used)g(by)h(the)f(host-based)g
(access)h(contr)n(ol)g(module.)28 b(See)22 b(section)g(7.5)150
793 y(for)h(details.)291 906 y(The)f(name)h(is)g(stor)n(ed)e(in)i(the)e
(variable)k Fe(omniORB::server)o(Na)o(me)o Fr(.)150 1100
y Fd(CORBA::String_var)47 b(omniORB::serverName;)291
1309 y Fr(The)28 b(variable)j(can)e(be)f(changed)g(by)h(assignment)e
(inside)i(your)e(applications.)47 b(It)28 b(can)h(also)150
1421 y(be)23 b(changed)f(by)g(specifying)g(the)g(command-line)i
(option:)j Fe(-ORBserverName)48 b(<string>)p Fr(.)150
1719 y Fj(4.4)119 b(Object)29 b(Keys)150 1930 y Fr(OmniORB2)24
b(uses)d(a)i(data)g(type)e Fe(omniORB::object)o(Ke)o(y)16
b Fr(to)22 b(uniquely)g(identify)g(each)h(object)150
2043 y(implementation.)59 b(This)33 b(is)g(an)g(opaque)f(data)i(type)d
(and)i(can)h(only)f(be)g(manipulated)g(by)g(the)150 2156
y(following)23 b(functions:)150 2351 y Fd(void)49 b
(omniORB::generateNewKey\(omniORB::obj)o(ectKe)o(y)44
b(&k\);)291 2559 y Fe(omniORB::genera)o(te)o(Ne)o(wKe)o(y)29
b Fr(r)n(eturns)34 b(a)i(new)e Fe(objectKey)p Fr(.)62
b(The)35 b(r)n(eturn)f(value)i(is)150 2672 y(guaranteed)e(to)g(be)h
(unique)g(among)g(the)f(keys)f(generated)g(during)i(this)f(pr)n(ogram)h
(r)o(un.)66 b(On)150 2785 y(the)34 b(platforms)h(that)f(have)h(a)h(r)n
(ealtime)f(clock)h(and)f(unique)f(pr)n(ocess)f(identi\002ers,)k(a)e
(str)n(onger)150 2898 y(assertion)23 b(can)j(be)f(made,)g(i.e.)34
b(the)23 b(keys)g(ar)n(e)j(guaranteed)d(to)h(be)h(unique)f(among)g(all)
j(keys)c(ever)150 3011 y(generated)d(on)j(the)e(same)i(machine.)150
3205 y Fd(const)49 b(unsigned)f(int)h(omniORB::hash_table_size;)150
3305 y(int)g(omniORB::hash\(omniORB::objectKey&)44 b(k\);)291
3513 y Fe(omniORB::hash)14 b Fr(r)n(eturns)19 b(the)g(hash)g(value)i
(of)f(an)g Fe(objectKey)p Fr(.)j(The)c(value)h(r)n(eturned)e(by)150
3626 y(this)j(function)g(is)g(always)h(between)d(0)j(and)f
Fe(omniORB:hash)p 2334 3626 28 4 v 27 w(table)p 2636
3626 V 31 w(size)53 b(-)h(1)20 b Fr(inclusively)-10 b(.)150
3821 y Fd(omniORB::objectKey)46 b(omniORB::nullkey\(\);)291
4029 y Fe(omniORB::nullke)o(y)32 b Fr(always)39 b(r)n(eturns)e(the)g
(same)h Fe(objectKey)d Fr(value.)75 b(This)38 b(key)f(is)150
4142 y(guaranteed)21 b(to)h(hash)h(to)f(0.)150 4337 y
Fd(int)49 b(operator==\(const)e(omniORB::objectKey)g(&k1,const)h(om-)
150 4436 y(niORB::objectKey)f(&k2\);)150 4536 y(int)i
(operator!=\(const)e(omniORB::objectKey)g(&k1,const)h(om-)150
4636 y(niORB::objectKey)f(&k2\);)291 4844 y Fe(ObjectKeys)27
b Fr(can)32 b(be)f(tested)d(for)j(equality)g(using)f(the)h(overloaded)e
Fe(operator==)e Fr(and)150 4957 y Fe(operator!=)p Fr(.)150
5151 y Fd(omniORB::seqOctets*)150 5251 y
(omniORB::keyToOctetSequence\(const)44 b(omniORB::objectKey)i(&k1\);)
150 5450 y(omniORB::objectKey)150 5550 y
(omniORB::octetSequenceToKey\(const)e(omniORB::seqOctets&)i(seq\);)p
eop
%%Page: 42 48
42 47 bop 30 100 a Fr(42)1865 b Ff(CHAPTER)21 b(4.)52
b(THE)21 b(OMNIORB2)i(API)171 356 y Fe(omniORB::keyToO)o(ct)o(et)o(Seq)
o(ue)o(nc)o(e)29 b Fr(takes)k(an)i Fe(objectKey)c Fr(and)j(r)n(eturns)f
(its)i(exter)n(-)30 469 y(nalised)25 b(r)n(epr)n(esentation)e(in)j(the)
e(form)h(of)g(a)h(sequence)d(of)i(octets.)34 b(The)24
b(same)h(sequence)e(can)j(be)30 582 y(converted)i(back)i(to)f(an)h
Fe(objectKey)c Fr(using)j Fe(omniORB::octetS)o(eq)o(ue)o(nc)o(eT)o(oKe)
o(y)p Fr(.)42 b(If)30 b(the)30 695 y(supplied)25 b(sequence)g(is)h(not)
g(an)h Fe(objectKey)p Fr(,)c Fe(omniORB::octetS)o(equ)o(en)o(ce)o(To)o
(Ke)o(y)e Fr(raises)30 808 y(a)i Fe(CORBA::MARSHAL)17
b Fr(exception.)30 1144 y Fj(4.5)119 b(GIOP)29 b(Message)g(Size)30
1355 y Fr(omniORB2)j(sets)d(a)j(limit)g(on)f(the)f(GIOP)h(message)f
(size)h(that)g(can)h(be)f(sent)e(or)i(r)n(eceived.)53
b(The)30 1454 y(value)23 b(can)h(be)e(obtained)h(by)f(calling:)30
1660 y Fd(size_t)49 b(omniORB::MaxMessageSize\(\);)30
1872 y Fr(and)23 b(can)g(be)g(changed)f(by:)30 2109 y
Fd(void)49 b(omniORB::MaxMessageSize\(size_t)44 b(newvalue\);)30
2352 y Fr(or)22 b(by)h(the)f(command-line)h(option)f
Fe(-ORBgiopMaxMsgS)o(iz)o(e)p Fr(.)171 2471 y(The)32
b(exact)g(value)h(is)f(somewhat)f(arbitrary)-10 b(.)57
b(The)31 b(r)n(eason)h(such)f(a)i(limit)h(exists)c(is)j(to)e(pr)n(o-)30
2584 y(vide)c(some)f(way)h(to)g(pr)n(otect)f(the)g(server)g(side)g(fr)n
(om)i(r)n(esour)n(ce)e(exhaustion.)40 b(Think)27 b(about)g(the)30
2697 y(case)22 b(when)g(the)f(server)g(r)n(eceives)h(a)h(r)n(ogue)e
(GIOP\(IIOP\))i(r)n(equest)e(message)g(that)h(contains)g(a)h(se-)30
2810 y(quence)j(length)f(\002eld)h(set)g(to)f(2**31.)42
b(W)-5 b(ith)26 b(a)h(r)n(easonable)g(message)e(size)i(limit,)h(the)e
(server)f(can)30 2923 y(r)n(eject)d(this)h(r)n(ogue)e(message)g
(straight)h(away)-10 b(.)30 3260 y Fj(4.6)119 b(Initial)28
b(Object)h(Reference)g(Bootstrapping)30 3483 y Fr(Starting)e(fr)n(om)h
(2.6.0,)h(a)f(new)f(mechanism)h(is)f(available)k(for)c(the)g(ORB)g(r)o
(untime)g(to)g(obtain)h(the)30 3596 y(initial)22 b(object)e(r)n(efer)n
(ences)f(to)g(CORBA)i(services.)26 b(Pr)n(eviously)-10
b(,)20 b(it)g(is)g(necessary)f(to)g(write)h(the)f(IOR)30
3709 y(string)g(of)g(these)f(services)g(in)i(the)f(con\002guration)g
(\002le)g(\(section)g(1.2\).)28 b(Now)18 b(the)h(object)g(r)n(efer)n
(ences)30 3822 y(can)i(be)f(obtained)f(fr)n(om)i(a)f(bootstrap)e
(service.)27 b(The)19 b(bootstrap)g(service)g(is)h(a)h(special)f
(object)g(with)30 3935 y(the)i(object)g(key)g('INIT')f(and)i(the)f
(following)h(interface)1954 3902 y Fk(2)1991 3935 y Fr(.:)279
4172 y Fd(//)49 b(IDL)279 4271 y(module)g(CORBA)g({)428
4371 y(interface)g(InitialReferences)d({)628 4470 y(Object)i(get\(in)h
(ORB::ObjectId)f(id\);)628 4570 y(//)h(returns)g(the)g(initial)f
(object)h(reference)f(of)i(the)f(service)628 4670 y(//)g(identified)f
(by)i(<id>.)e(For)i(example)e(the)h(id)h(for)f(the)g(COSS)628
4769 y(//)g(Naming)g(service)f(is)i("NameService".)628
4969 y(ORB::ObjectIdList)c(list\(\);)628 5068 y(//)j(returns)g(the)g
(list)g(of)g(service)g(id)g(that)g(this)h(agent)e(knows)h(of)628
5168 y(//)g(their)g(initial)g(object)f(reference.)428
5267 y(};)279 5367 y(};)p 30 5462 1368 4 v 135 5518 a
Fh(2)164 5550 y Fg(This)19 b(interface)g(is)f(\002rst)g(de\002ned)g(by)
h(Sun's)g(NEO)f(and)h(is)f(in)h(used)f(in)h(Sun's)g(JavaIDL)p
eop
%%Page: 43 49
43 48 bop 150 100 a Ff(4.7.)51 b(TRAPPING)22 b(OMNIORB2)g(INTERNAL)e
(ERRORS)1266 b Fr(43)291 356 y(By)44 b(default,)49 b(all)d(omniORB2)f
(servers,)j(i.e.)92 b(those)43 b(applications)i(with)f(the)g(BOA)g
(ini-)150 469 y(tialised,)36 b(contains)e(an)g(instance)g(of)g(this)f
(object)h(and)g(is)f(able)i(to)e(r)n(esponds)f(to)h(r)n(emote)f(invo-)
150 582 y(cations.)41 b(T)-8 b(o)26 b(pr)n(event)g(the)h(ORB)f(fr)n(om)
i(instantiating)f(this)g(object,)h(the)e(command-line)i(option)150
695 y Fe(-BOAno)p 485 695 28 4 v 30 w(bootstrap)p 1010
695 V 29 w(agent)20 b Fr(should)i(be)g(speci\002ed.)291
808 y(In)45 b(particular)-7 b(,)51 b(the)45 b(Naming)g(Service)g
(omniNames)f(is)h(able)h(to)e(r)n(espond)f(to)i(a)g(query)150
920 y(thr)n(ough)32 b(this)g(interface)h(and)g(r)n(eturns)e(the)h
(object)h(r)n(efer)n(ence)f(of)h(its)g(r)n(oot)f(context.)57
b(In)32 b(ef)n(fect,)150 1033 y(the)e(bootstrap)f(agent)h(pr)n(ovides)g
(a)h(level)h(of)e(indir)n(ection.)53 b(All)31 b(omniORB2)h(clients)e
(still)i(have)150 1146 y(to)c(be)g(supplied)g(with)g(the)g(addr)n(ess)f
(of)h(the)g(bootstrap)f(agent.)45 b(However)27 b(the)h(information)h
(is)150 1259 y(much)34 b(easier)f(to)g(specify)h(than)f(a)i
(stringi\002ed)d(IOR!)i(Another)e(advantage)i(of)f(this)h(appr)n(oach)
150 1372 y(is)29 b(that)g(it)g(is)g(completely)f(compatiable)i(with)f
(JavaIDL.)g(This)g(makes)f(it)h(possible)f(for)h(a)h(client)150
1485 y(written)22 b(in)h(JavaIDL)h(to)e(shar)n(e)g(with)h(a)g(omniORB2)
g(server)e(the)h(same)h(Naming)g(Service.)291 1598 y(The)51
b(addr)n(ess)f(of)i(the)f(bootstrap)f(agent)h(is)h(given)f(by)h(the)f
Fe(ORBInitialHost)45 b Fr(and)150 1711 y Fe(ORBInitialPort)28
b Fr(parameter)34 b(in)h(the)f(omniORB)h(con\002guration)f(\002le)g
(\(section)g(1.2\).)65 b(The)150 1824 y(parameters)35
b(can)h(also)g(be)f(speci\002ed)f(as)i(command-line)h(options)d
(\(section)h(4.1\).)67 b Fe(ORBIni-)150 1937 y(tialHost)22
b Fr(is)k(the)f(host)f(name)i(and)f Fe(ORBInitialPort)20
b Fr(is)25 b(the)g(TCP/IP)h(port)e(number)-7 b(.)37 b(The)150
2050 y(parameter)27 b Fe(ORBInitialPort)21 b Fr(is)27
b(optional.)42 b(If)28 b(it)f(is)h(not)e(speci\002ed,)h(port)g(number)g
(900)i(will)150 2163 y(be)23 b(used.)291 2275 y(During)33
b(initialisation,)38 b(the)32 b(ORB)h(r)n(eads)g(the)f(parameters)g(in)
i(the)e(omniORB)h(con\002gura-)150 2388 y(tion)e(\002le.)56
b(If)31 b(the)g(parameter)g Fe(NAMESERVICE)c Fr(is)32
b(speci\002ed,)g(the)f(stringi\002ed)g(IOR)g(would)g(be)150
2501 y(used)21 b(as)h(the)g(object)g(r)n(efer)n(ence)g(of)g(the)g(r)n
(oot)g(naming)h(context.)j(If)c(the)g(parameter)g(is)g(absent)g(and)150
2614 y(the)35 b(parameter)f Fe(ORBInitialHost)29 b Fr(is)36
b(pr)n(esent,)g(the)f(ORB)g(would)g(contact)g(the)g(bootstrap)150
2727 y(agent)22 b(at)h(the)g(addr)n(ess)e(speci\002ed)h(to)g(obtain)i
(the)e(r)n(oot)g(naming)i(context)d(when)i(the)f(application)150
2840 y(calls)28 b Fe(resolve)p 744 2840 V 29 w(initial)p
1158 2840 V 30 w(reference\(\))p Fr(.)34 b(If)27 b(neither)e(the)h
Fe(NAMESERVICE)21 b Fr(nor)26 b Fe(ORBIni-)150 2953 y(tialHost)17
b Fr(is)k(pr)n(esent,)e(a)i(call)i(to)d Fe(resolve)p
1750 2953 V 29 w(initial)p 2164 2953 V 30 w(reference\(\))15
b Fr(r)n(eturns)20 b(a)h(nil)h(object.)150 3066 y(Finally)-10
b(,)35 b(the)30 b(command)j(line)f(ar)n(gument)f Fe(-ORBInitialHost)25
b Fr(overrides)30 b(any)i(parameters)150 3179 y(in)f(the)f
(con\002guration)f(\002le.)52 b(The)30 b(ORB)g(would)g(always)g
(contact)h(the)f(bootstrap)f(agent)g(at)i(the)150 3292
y(addr)n(ess)21 b(speci\002ed)h(to)g(obtain)h(the)e(r)n(oot)h(naming)i
(context.)291 3405 y(Now)e(we)g(ar)n(e)h(r)n(eady)f(to)g(describe)g(a)h
(simple)g(way)f(to)g(set)g(up)g(omniNames.)264 3609 y(1.)45
b(Start)22 b(omniNames)h(for)f(the)g(\002rst)g(time)h(on)f(a)h(machine)
h(\(e.g.)j(wobble\):)377 3758 y Fe($)54 b(omniNames)d(-start)h(1234)264
3943 y Fr(2.)45 b(Add)22 b(to)g(omniORB.cfg:)377 4092
y Fe(ORBInitialHost)48 b(wobble)377 4241 y(ORBInitialPort)g(1234)264
4425 y Fr(3.)d(All)24 b(omniORB2)f(applications)g(will)h(now)e(be)h
(able)g(to)f(contact)h(omniNames.)291 4630 y(Alternatively)-10
b(,)22 b(the)g(command)h(line)g(options)e(can)j(be)e(used,)f(for)i
(example:)291 4743 y Fe($)54 b(eg3)p 570 4743 V 32 w(impl)e
(-ORBInitialHost)c(wobble)k(-ORBInitialPor)o(t)d(1234)j(&)291
4856 y($)i(eg3)p 570 4856 V 32 w(clt)f(-ORBInitialHos)o(t)48
b(wobble)k(-ORBInitialPort)c(1234)150 5153 y Fj(4.7)119
b(T)-13 b(rapping)29 b(omniORB2)h(Internal)e(Errors)150
5351 y Fd(class)49 b(fatalException)e({)150 5450 y(public:)349
5550 y(const)i(char)g(*file\(\))g(const;)p eop
%%Page: 44 50
44 49 bop 30 100 a Fr(44)1865 b Ff(CHAPTER)21 b(4.)52
b(THE)21 b(OMNIORB2)i(API)229 356 y Fd(int)49 b(line\(\))g(const;)229
456 y(const)g(char)g(*errmsg\(\))f(const;)30 555 y(};)171
768 y Fr(When)21 b(omniORB2)i(detects)d(an)i(internal)h(inconsistency)e
(that)g(is)h(most)f(likely)h(to)g(be)g(caused)30 881
y(by)g(a)h(bug)f(in)h(the)e(r)o(untime,)h(it)g(raises)g(the)f
(exception)g Fe(omniORB::fatalEx)o(ce)o(pt)o(io)o(n)p
Fr(.)h(When)30 994 y(this)j(exception)f(is)i(raised,)f(it)h(is)f(not)g
(sensible)g(to)f(pr)n(oceed)h(with)g(any)g(operation)g(that)g(involves)
30 1106 y(the)20 b(ORB's)h(r)o(untime.)27 b(It)20 b(is)h(best)f(to)g
(exit)g(the)g(pr)n(ogram)h(immediately)-10 b(.)27 b(The)21
b(exception)e(str)o(uctur)n(e)30 1219 y(carries)34 b(by)g
Fe(omniORB::fatalE)o(xc)o(ep)o(tio)o(n)28 b Fr(contains)34
b(the)f(exact)h(location)g(\(the)g(\002le)g(name)30 1332
y(and)22 b(the)f(line)h(number\))g(wher)n(e)f(the)g(exception)f(is)i
(raised.)27 b(Y)-8 b(ou)21 b(ar)n(e)h(str)n(ongly)e(encourage)h(to)g
(\002le)30 1445 y(a)i(bug)g(r)n(eport)e(and)i(point)f(out)f(the)h
(location.)p eop
%%Page: 45 51
45 50 bop 150 983 a Fl(Chapter)44 b(5)150 1402 y Fn(The)52
b(Basic)f(Object)g(Adaptor)h(\(BOA\))150 1868 y Fr(This)32
b(chapter)g(describes)g(the)g(BOA)g(implementation)g(in)i(omniORB2.)58
b(The)32 b(CORBA)g(speci-)150 1981 y(\002cation)f(de\002nes)d(the)i
(Basic)g(Object)h(Adaptor)e(as)h(the)f(entity)h(that)f(mediates)h
(between)e(object)150 2094 y(implementations)35 b(and)h(the)f(ORB.)g
(Unfortunately)-10 b(,)37 b(the)e(BOA)g(speci\002cation)h(is)g
(incomplete)150 2206 y(and)25 b(does)e(not)i(addr)n(ess)e(the)h
(multi-thr)n(eading)i(issues)d(appr)n(opriately)-10 b(.)34
b(The)25 b(end)f(r)n(esult)g(is)h(that)150 2319 y(dif)n(fer)n(ent)g
(ORB)h(vendors)d(implement)j(dif)n(fer)n(ent)f(extensions)e(to)i(their)
g(BOAs.)35 b(W)-8 b(orse,)24 b(the)h(im-)150 2432 y(plementation)31
b(of)g(the)f(operations)g(de\002ned)g(in)h(the)g(speci\002cation)g(ar)n
(e)h(dif)n(fer)n(ent)f(in)h(dif)n(fer)n(ent)150 2545
y(ORBs.)62 b(Recently)-10 b(,)35 b(a)g(new)e(Object)i(Adaptor)d
(speci\002cation)j(\(the)e(Portable)h(Object)h(Adaptor)n(-)150
2658 y(POA\))26 b(has)g(been)g(adopted)e(and)i(will)h(r)n(eplace)g(the)
e(BOA)h(as)g(the)f(standar)n(d)g(Object)i(Adaptor)e(in)150
2771 y(CORBA.)19 b(The)f(new)g(speci\002cation)h(r)n(ecognises)e(the)h
(compatibility)j(pr)n(oblems)d(of)h(BOA)g(and)g(r)n(ec-)150
2884 y(ommends)25 b(that)g(all)i(BOAs)f(should)e(be)i(consider)n(ed)e
(pr)n(opriety)h(extensions.)35 b(OmniORB2)27 b(will)150
2997 y(support)c(POA)i(in)h(futur)n(e)e(r)n(eleases.)34
b(Until)26 b(then,)e(you)g(have)i(to)e(use)g(the)g(BOA)h(to)g(attach)g
(object)150 3110 y(implementations)d(to)g(the)g(ORB.)291
3227 y(The)g(r)n(est)f(of)h(this)g(chapter)g(describes)f(the)h
(interface)g(of)g(the)g(BOA)g(in)h(detail.)k(It)22 b(is)g(important)150
3340 y(to)30 b(r)n(ecognise)g(that)h(the)f(interface)i(described)e
(below)h(is)g(omniORB2)g(speci\002c)g(and)g(hence)g(the)150
3453 y(code)22 b(using)g(this)g(interface)h(is)g(unlikely)f(to)g(be)h
(portable)f(to)g(other)f(ORBs.)291 3570 y(Unless)f(it)h(is)g(stated)f
(otherwise,)f(the)h(term)h(\223object\224)g(will)i(be)d(used)g(below)h
(to)f(r)n(efer)h(to)f(object)150 3683 y(implementations.)66
b(This)35 b(should)f(not)h(be)h(confused)e(with)h(\223object)h(r)n
(efer)n(ences\224)f(which)h(ar)n(e)150 3796 y(handles)22
b(held)g(by)h(clients.)150 4120 y Fj(5.1)119 b(BOA)29
b(Initialisation)150 4339 y Fr(It)h(takes)f(two)g(steps)g(to)g(put)h
(the)f(BOA)i(into)f(service.)50 b(The)30 b(BOA)g(has)g(to)g(be)g
(initialised)i(using)150 4452 y Fe(BOA)p 320 4452 28
4 v 31 w(init)21 b Fr(and)i(activated)g(using)f Fe(impl)p
1625 4452 V 31 w(is)p 1766 4452 V 32 w(ready)p Fr(.)150
4569 y Fe(BOA)p 320 4569 V 31 w(init)f Fr(is)i(a)g(member)g(of)f(the)g
Fe(CORBA::ORB)c Fr(class.)29 b(Its)21 b(signatur)n(e)h(is:)150
4793 y Fd(BOA_ptr)49 b(BOA_init\(int)e(&)j(argc,)997
4893 y(char)f(**)g(argv,)997 4993 y(const)g(char)g(*)g
(boa_identifier\);)150 5226 y Fr(T)-8 b(ypically)e(,)23
b(it)g(is)f(used)g(in)h(the)e(startup)h(code)g(as)g(follows:)150
5450 y Fd(CORBA::ORB_ptr)47 b(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB2")o(\);)143 b(//)50
b(line)f(1)150 5550 y(CORBA::BOA_ptr)e(boa)i(=)h
(orb->BOA_init\(argc,argv,"omniORB2_BO)o(A"\);)43 b(//)50
b(line)f(2)1815 5778 y Fr(45)p eop
%%Page: 46 52
46 51 bop 30 100 a Fr(46)1159 b Ff(CHAPTER)22 b(5.)51
b(THE)21 b(BASIC)h(OBJECT)h(ADAPT)n(OR)g(\(BOA\))171
356 y Fr(The)k Fe(argv)e Fr(parameters)i(may)h(contain)f(BOA)h
(options.)40 b(These)26 b(options)g(will)j(be)e(r)n(emoved)30
469 y(fr)n(om)i(the)f Fe(argv)f Fr(list)i(when)f Fe(BOA)p
1229 469 28 4 v 31 w(init)f Fr(r)n(eturns.)45 b(Other)28
b(parameters)g(in)h Fe(argv)e Fr(will)j(r)n(emain.)30
582 y(The)22 b(supported)e(options)h(ar)n(e:)30 779 y
Fm(-BOAiiop)p 440 779 V 32 w(port)h Fe(<port)52 b(number)g
(\(0-65535\)>)41 b Fr(Use)28 b(the)g(port)f(number)i(to)f(r)n(eceive)g
(IIOP)257 892 y(r)n(equests.)38 b(This)27 b(option)e(can)j(be)f
(speci\002ed)e(multiple)i(times)g(in)g(the)f(command)h(line)g(and)257
1004 y(the)22 b(BOA)h(would)f(be)g(initialised)i(to)e(listen)g(on)g
(all)i(of)f(the)f(ports.)30 1187 y Fm(-BOAid)g Fe(<id)53
b(\(string\)>)41 b Fr(If)23 b(this)f(option)g(is)h(used)e(the)h(id)g
(must)g(be)h(\223omniORB2)p 3061 1187 V 34 w(BOA)-7 b(\224.)171
1384 y(If)26 b(the)g(thir)n(d)g(ar)n(gument)g(of)g Fe(BOA)p
1330 1384 V 31 w(init)f Fr(is)h(non-nil,)i(it)e(must)g(be)g(the)g
(string)f(constant)g(\223om-)30 1497 y(niORB2)p 347 1497
V 33 w(BOA)-7 b(\224.)23 b(If)g(the)f(ar)n(gument)g(is)h(nil,)g(-BOAid)
g(must)f(be)g(pr)n(esent)f(in)i Fe(argv)p Fr(.)171 1609
y(If)30 b(ther)n(e)g(is)g(any)h(pr)n(oblem)f(in)h(the)f(initialisation)
i(pr)n(ocess,)f(a)g Fe(CORBA::INITIAL)o(IZ)o(E)24 b Fr(ex-)30
1722 y(ception)e(would)g(be)g(raised.)171 1835 y(T)-8
b(o)26 b(r)n(egister)g(an)h(object)g(with)g(the)f(BOA,)g(the)g(method)p
2121 1835 V 59 w Fe(obj)p 2319 1835 V 31 w(is)p 2460
1835 V 32 w(ready)e Fr(should)i(be)h(called)30 1948 y(with)c(the)e(r)n
(eturn)h(value)i(of)e Fe(BOA)p 1177 1948 V 32 w(init)e
Fr(as)j(the)f(ar)n(gument.)171 2061 y Fe(BOA)p 341 2061
V 31 w(init)29 b Fr(is)i(thr)n(ead-safe.)51 b(It)30 b(can)h(be)f
(called)i(multiple)e(times)g(and)h(the)f(same)g Fe(BOA)p
3260 2061 V 31 w(ptr)30 2174 y Fr(will)f(be)f(r)n(eturned.)41
b(However)-7 b(,)28 b(only)g(the)f Fe(argv)f Fr(in)i(the)f(\002rst)g
(call)j(will)f(be)e(scanned,)i(the)e(ar)n(gu-)30 2287
y(ment)22 b(is)h(ignor)n(ed)e(in)j(subsequent)c(calls.)171
2400 y Fe(BOA)p 341 2400 V 31 w(init)57 b Fr(r)n(eturns)h(a)h(pseudo)e
(object)h(of)h(type)e Fe(CORBA::BOA)p 2677 2400 V 28
w(ptr)p Fr(.)135 b(Similar)61 b(to)30 2513 y Fe(CORBA::Object)p
750 2513 V 27 w(ptr)p Fr(,)76 b(the)66 b(pointer)g(can)h(be)g(managed)f
(using)g Fe(CORBA::BOA)p 3240 2513 V 29 w(var)p Fr(,)30
2626 y Fe(BOA::)p 310 2626 V 30 w(duplicate)55 b Fr(and)j
Fe(CORBA::release)o Fr(.)129 b(The)57 b(pointer)g(can)i(be)f(tested)e
(using)30 2739 y Fe(CORBA::is)p 530 2739 V 29 w(nil)31
b Fr(which)h(r)n(eturns)f(tr)o(ue)h(if)h(the)e(pointer)g(is)i
(equivalent)f(to)g(the)f(r)n(eturn)g(value)30 2851 y(of)23
b Fe(BOA::)p 413 2851 V 30 w(nil)p Fr(.)171 2964 y(After)28
b Fe(BOA)p 580 2964 V 31 w(init)f Fr(is)h(called,)j(objects)d(can)h(be)
f(r)n(egister)n(ed.)43 b(However)-7 b(,)29 b(incoming)g(IIOP)f(r)n(e-)
30 3077 y(quests)21 b(would)h(not)g(be)g(despatched)f(until)i
Fe(impl)p 1786 3077 V 31 w(is)p 1927 3077 V 31 w(ready)e
Fr(is)i(called.)30 3261 y Fd(class)49 b(BOA)g({)30 3360
y(public:)179 3460 y(impl_is_ready\(CORBA::ImplementationDef)o(_ptr)43
b(p)50 b(=)g(0,)877 3560 y(CORBA::Boolean)d(NonBlocking)h(=)h(0\);)30
3659 y(};)171 3856 y Fr(One)21 b(of)g(the)f(common)h(pitfall)h(in)f
(using)f(the)g(BOA)h(is)f(to)h(for)n(get)e(to)h(call)j(impl)p
2848 3856 V 34 w(is)p 2947 3856 V 32 w(r)n(eady)-10 b(.)27
b(Until)30 3969 y(this)c(call)j(r)n(eturns,)c(ther)n(e)g(is)i(no)f(thr)
n(ead)g(listening)g(on)h(the)e(port)h(fr)n(om)h(which)g(IIOP)f(r)n
(equests)f(ar)n(e)30 4082 y(r)n(eceived.)28 b(The)21
b(r)n(emote)h(client)h(may)g(hang)g(because)f(of)h(this.)171
4195 y(When)28 b Fe(impl)p 665 4195 V 31 w(is)p 806 4195
V 32 w(ready)e Fr(is)i(called)i(with)e(no)g(ar)n(gument.)45
b(The)27 b(calling)k(thr)n(ead)c(would)h(be)30 4308 y(blocked)e
(inde\002nitely)g(in)i(the)e(function)h(until)g Fe(impl)p
1929 4308 V 31 w(shutdown)c Fr(\(see)j(below\))h(is)g(called.)42
b(The)30 4421 y(thr)n(ead)33 b(that)g(is)g(calling)i
Fe(impl)p 1141 4421 V 31 w(is)p 1282 4421 V 32 w(ready)c
Fr(is)i(not)f(used)g(by)h(the)g(BOA)g(to)f(perform)h(its)g(inter)n(-)30
4534 y(nal)40 b(functions.)78 b(The)39 b(BOA)g(has)h(its)f(own)g(set)f
(of)i(thr)n(eads)e(to)h(pr)n(ocess)f(incoming)i(r)n(equests)30
4647 y(and)34 b(general)f(housekeeping.)57 b(Ther)n(efor)n(e,)35
b(it)f(is)g(not)e(necessary)g(to)h(have)h(a)h(thr)n(ead)e(blocked)30
4759 y(in)27 b(the)e(call)k(if)e(it)f(can)h(be)g(put)e(into)h(use)g
(elsewher)n(e.)37 b(For)26 b(example,)h(the)e(main)j(thr)n(ead)e(may)g
(call)30 4872 y Fe(impl)p 255 4872 V 31 w(is)p 396 4872
V 32 w(ready)17 b Fr(once)h(in)i(non-blocking)f(mode)f(\(see)g(below\))
h(and)g(then)f(enter)f(the)i(event)f(loop)30 4985 y(to)k(handle)h(the)e
(GUI)i(fr)n(ontend.)171 5098 y(If)29 b(non-blocking)g(behaviour)g(is)g
(needed,)f(the)g Fe(NonBlocking)c Fr(ar)n(gument)29 b(should)e(be)i
(set)30 5211 y(to)k(1.)62 b(For)33 b(instance,)j(if)f(you)e(cr)n(eates)
g(a)h(callback)j(object,)f(you)d(might)g(call)j(impl)p
2981 5211 V 34 w(is)p 3080 5211 V 32 w(r)n(eady)e(in)30
5324 y(non-blocking)22 b(mode)e(to)h(tell)h(the)f(BOA)g(to)g(start)g(r)
n(eceiving)h(IIOP)f(r)n(equests)f(befor)n(e)h(sending)f(the)30
5437 y(callback)k(object)e(to)f(the)g(r)n(emote)g(object.)27
b(The)21 b(\002rst)g(ar)n(gument)g Fe(ImplementationDe)o(f)p
3178 5437 V 26 w(ptr)g Fr(is)30 5550 y(ignor)n(ed)h(by)g(the)g(BOA.)g
(Just)g(set)g(the)f(ar)n(gument)i(to)f(nil.)p eop
%%Page: 47 53
47 52 bop 150 100 a Ff(5.2.)51 b(OBJECT)23 b(REGISTRA)-7
b(TION)2106 b Fr(47)291 356 y Fe(impl)p 516 356 28 4
v 31 w(is)p 657 356 V 32 w(ready)22 b Fr(is)i(thr)n(ead)f(safe)h(and)g
(can)h(be)f(called)h(multiple)f(times.)32 b(Multiple)24
b(thr)n(eads)150 469 y(can)f(be)g(blocked)f(in)h Fe(impl)p
1094 469 V 31 w(is)p 1235 469 V 32 w(ready)p Fr(.)150
766 y Fj(5.2)119 b(Object)29 b(Registration)150 977 y
Fr(Once)d(the)e(BOA)h(is)g(initialised,)i(objects)e(can)h(be)f(r)n
(egister)n(ed.)33 b(The)25 b(purpose)e(of)i(object)g(r)n(egistra-)150
1090 y(tion)g(is)g(to)f(let)h(the)f(BOA)h(know)f(of)h(the)f(existence)f
(of)i(the)g(object)f(and)h(to)g(dispatch)f(r)n(equests)f(for)150
1203 y(the)f(object)g(as)h(upcalls)g(into)g(the)f(object.)291
1316 y(T)-8 b(o)85 b(r)n(egister)e(an)j(object,)101 b(the)p
1621 1316 V 117 w Fe(obj)p 1818 1316 V 31 w(is)p 1959
1316 V 32 w(ready)83 b Fr(function)j(should)e(be)h(called.)p
150 1429 V 177 1429 a Fe(obj)p 347 1429 V 32 w(is)p 489
1429 V 31 w(ready)39 b Fr(is)i(a)h(member)f(function)g(of)g(the)f
(implementation)h(skeleton)e(class.)84 b(The)150 1542
y(function)33 b(should)f(be)g(called)i(only)e(once)g(for)h(each)g
(object.)58 b(The)32 b(call)i(should)e(be)h(made)f(only)150
1654 y(after)23 b(the)e(object)i(is)g(fully)g(initialised.)291
1767 y(The)i(member)h(function)g Fe(obj)p 1362 1767 V
32 w(is)p 1504 1767 V 31 w(ready)e Fr(of)i(the)f(BOA)h(may)g(also)g(be)
g(used)f(to)g(r)n(egister)g(an)150 1880 y(object.)49
b(However)-7 b(,)30 b(this)f(function)h(has)f(been)g(superseded)d(by)p
2440 1880 V 63 w Fe(obj)p 2638 1880 V 31 w(is)p 2779
1880 V 32 w(ready)h Fr(and)j(should)150 1993 y(not)22
b(be)g(used)g(in)h(new)f(application)i(code.)150 2290
y Fj(5.3)119 b(Object)29 b(Disposal)150 2501 y Fr(Once)f(an)h(object)f
(is)g(r)n(egister)n(ed,)f(it)i(is)f(under)f(the)g(management)h(of)g
(the)f(BOA.)h(T)-8 b(o)27 b(r)n(emove)h(the)150 2614
y(object)23 b(fr)n(om)h(the)e(BOA)i(and)f(to)g(delete)e(it)j(\(when)f
(it)g(is)g(safe)h(to)e(do)h(so\),)g(the)p 2801 2614 V
55 w Fe(dispose)d Fr(function)150 2727 y(should)33 b(be)i(called.)p
921 2727 V 97 w Fe(dispose)c Fr(is)k(a)g(member)f(function)h(of)f(the)g
(implementation)g(skeleton)150 2840 y(class.)28 b(The)22
b(function)h(should)f(be)g(called)i(only)e(once)g(for)h(each)g(object.)
291 2953 y(Notice)33 b(the)g(asymmetry)f(in)i(object)f(instantiation)h
(and)g(destr)o(uction.)59 b(T)-8 b(o)32 b(instantiate)i(an)150
3066 y(object,)f(the)e(application)h(code)f(has)g(to)g(call)i(the)e
Fm(new)g Fr(operator)-7 b(.)53 b(T)-8 b(o)30 b(r)n(emove)h(the)g
(object,)i(the)150 3179 y(application)24 b(should)d(never)h(call)j(the)
d(delete)f(operator)g(on)h(the)g(object)g(dir)n(ectly)-10
b(.)291 3292 y(At)20 b(the)f(time)i(the)p 910 3292 V
52 w Fe(dispose)c Fr(call)22 b(is)e(made,)h(ther)n(e)e(may)h(be)h
(other)e(thr)n(eads)g(invoking)h(on)g(the)150 3405 y(object,)27
b(the)e(BOA)h(ensur)n(es)f(that)g(all)j(these)d(calls)i(ar)n(e)g
(completed)e(befor)n(e)h(r)n(emoving)g(the)f(object)150
3517 y(fr)n(om)e(its)g(internal)g(tables)f(and)h(calling)h(the)e
Fm(delete)i Fr(operator)-7 b(.)291 3630 y(Internally)d(,)25
b(the)g(BOA)g(keeps)e(a)j(r)n(efer)n(ence)e(count)h(on)g(each)g
(object.)36 b(Initially)-10 b(,)26 b(the)f(r)n(efer)n(ence)150
3743 y(count)d(is)h(0.)29 b(After)21 b(a)j(call)g(to)p
1155 3743 V 55 w Fe(obj)p 1352 3743 V 31 w(is)p 1493
3743 V 32 w(ready)p Fr(,)c(the)i(r)n(efer)n(ence)g(count)h(is)f(1.)29
b(The)22 b(BOA)g(incr)n(eases)150 3856 y(the)32 b(r)n(efer)n(ence)g
(count)g(by)h(1)g(befor)n(e)f(an)h(upcall)h(into)f(the)f(object)g(is)h
(made.)58 b(The)32 b(count)g(is)h(de-)150 3969 y(cr)n(eased)22
b(by)g(1)g(when)g(the)f(upcall)i(r)n(eturns.)p 1676 3969
V 60 w Fe(dispose)c Fr(decr)n(eases)h(the)i(r)n(efer)n(ence)f(count)h
(by)g(1,)g(if)150 4082 y(the)c(r)n(efer)n(ence)g(count)f(is)i(0,)h(the)
d(delete)g(operator)g(is)i(called.)27 b(If)19 b(the)e(count)h(is)h
(non-zer)n(o,)g(the)e(object)150 4195 y(is)j(marked)g(as)g(disposed.)25
b(The)19 b(object)h(will)i(be)e(deleted)e(when)i(the)f(r)n(efer)n(ence)
h(count)f(eventually)150 4308 y(goes)i(to)h(zer)n(o.)291
4421 y(The)35 b(r)n(efer)n(ence)g(count)g(is)g(also)h(incr)n(eased)f
(by)h(1)g(for)f(each)h(object)f(r)n(efer)n(ence)g(held)g(in)h(the)150
4534 y(same)e(addr)n(ess)g(space.)63 b(Hence,)36 b(the)e
Fm(delete)i Fr(operator)d(will)j(not)d(be)i(called)g(when)f(ther)n(e)g
(ar)n(e)150 4647 y(outstanding)28 b(object)h(r)n(efer)n(ences)f(in)i
(the)f(same)h(addr)n(ess)e(space.)48 b(T)-8 b(o)28 b(ensur)n(e)g(that)i
(an)g(object)f(is)150 4759 y(deleted,)h(all)h(its)f(object)g(r)n(efer)n
(ences)f(in)h(the)f(same)h(addr)n(ess)f(space)h(should)f(be)h(r)n
(eleased)f(using)150 4872 y Fe(CORBA::release)p Fr(.)291
4985 y(Unlike)41 b(colocated)h(object)f(r)n(efer)n(ences,)k(r)n(efer)n
(ences)40 b(held)h(by)h(clients)f(in)h(other)f(addr)n(ess)150
5098 y(spaces)24 b(would)g(not)h(pr)n(event)e(the)i(deletion)e(of)i
(objects.)34 b(If)25 b(these)e(clients)i(invoke)g(on)f(the)g(object)150
5211 y(after)30 b(it)g(is)g(disposed,)e(the)h(system)f(exception)h(INV)
p 2025 5211 V 31 w(OBJREF)g(would)g(be)h(raised.)49 b(The)29
b(dif)n(fer)n(-)150 5324 y(ence)j(in)h(semantics)f(is)h(an)f
(undesirable)g(side-ef)n(fect)g(of)h(the)e(curr)n(ent)h(BOA)g
(implementation.)150 5437 y(In)24 b(futur)n(e,)g(colocated)g(r)n(efer)n
(ences)g(will)h(have)g(the)f(same)g(semantics)g(as)h(r)n(emote)e(r)n
(efer)n(ences,)h(i.e.)150 5550 y(their)e(pr)n(esence)f(will)j(not)e
(delay)g(the)g(deletion)g(of)g(the)g(objects.)p eop
%%Page: 48 54
48 53 bop 30 100 a Fr(48)1159 b Ff(CHAPTER)22 b(5.)51
b(THE)21 b(BASIC)h(OBJECT)h(ADAPT)n(OR)g(\(BOA\))171
356 y Fr(Instead)28 b(of)p 611 356 28 4 v 61 w Fe(dispose)p
Fr(,)g(it)h(may)g(be)g(useful)g(to)g(have)g(a)h(method)d(to)i
(deactivate)g(the)f(object)30 469 y(but)22 b(not)g(deleting)g(it.)28
b(This)22 b(featur)n(e)g(is)h(not)f(supported)e(in)j(the)f(curr)n(ent)g
(BOA)g(implementation.)30 802 y Fj(5.4)119 b(BOA)29 b(Shutdown)30
1025 y Fr(The)f(BOA)h(can)i(be)e(withdrawn)f(fr)n(om)i(service)f(using)
g(member)g(functions)g Fe(impl)p 2988 1025 V 31 w(shutdown)30
1138 y Fr(and)23 b Fe(destroy)p Fr(.)30 1371 y Fd(class)49
b(BOA)g({)30 1470 y(public:)179 1570 y(void)g(impl_shutdown\(\);)179
1670 y(void)g(destroy\(\);)30 1769 y(};)171 2010 y Fe(impl)p
396 2010 V 31 w(shutdown)19 b Fr(and)j Fe(destroy)d Fr(ar)n(e)j(the)g
(inverse)f(of)i Fe(impl)p 2397 2010 V 30 w(is)p 2537
2010 V 32 w(ready)d Fr(and)i Fe(BOA)p 3205 2010 V 32
w(init)30 2123 y Fr(r)n(espectively)-10 b(.)171 2241
y Fe(impl)p 396 2241 V 31 w(shutdown)49 b Fr(deactivates)k(the)f(BOA.)g
(When)g(the)g(call)j(r)n(eturns,)k(all)54 b(the)e(inter)n(-)30
2354 y(nal)41 b(thr)n(eads)e(and)h(network)e(connections)i(will)h(be)f
(shutdown.)78 b(Any)40 b(thr)n(ead)f(blocking)i(in)30
2467 y Fe(impl)p 255 2467 V 31 w(is)p 396 2467 V 32 w(ready)26
b Fr(would)j(be)g(unblocked.)45 b(After)28 b(the)h(call,)j(no)c(r)n
(equest)f(fr)n(om)j(other)e(addr)n(ess)30 2580 y(spaces)19
b(will)i(be)f(pr)n(ocessed.)k(In)19 b(other)g(wor)n(ds,)g(the)g(BOA)g
(will)i(be)f(in)g(the)f(same)h(state)e(as)i(it)g(was)g(in)30
2693 y(befor)n(e)g Fe(impl)p 527 2693 V 31 w(is)p 668
2693 V 32 w(ready)e Fr(was)i(called.)28 b(For)19 b(example,)i(a)g(r)n
(emote)e(client)i(may)f(hang)h(if)g(it)f(tries)g(to)30
2806 y(connect)k(to)g(the)f(server)g(after)i Fe(impl)p
1326 2806 V 31 w(shutdown)c Fr(was)j(called)h(because)f(no)g(thr)n(ead)
g(is)h(listening)30 2919 y(on)d(the)g(IIOP)g(port.)171
3038 y Fe(impl)p 396 3038 V 31 w(shutdown)f Fr(does)i(not)h(wait)i(for)
e(incoming)i(r)n(equests)c(to)j(complete)f(befor)n(e)g(it)h(closes)30
3150 y(the)j(network)f(connections.)46 b(The)28 b(r)n(emote)g(clients)h
(will)h(see)e(the)g(network)f(connections)h(shut-)30
3263 y(down)h(and)g(the)g(r)n(eplies)g(may)h(not)f(r)n(each)i(them)e
(even)g(if)h(the)f(upcalls)i(have)f(been)f(completed.)30
3376 y(Ther)n(efor)n(e,)22 b(if)h(the)f(application)i(is)f(to)g
(de\002ne)e(an)j(operation)d(in)j(an)f(IDL)g(interface)g(to)f(shutdown)
30 3489 y(the)g(BOA,)g(the)g(operation)f(should)h(be)h(de\002ned)d(as)j
(an)g(oneway)f(operation.)171 3608 y Fe(impl)p 396 3608
V 31 w(shutdown)14 b Fr(is)j(thr)n(ead-safe)g(and)h(can)g(be)f(called)i
(multiple)e(times.)26 b(The)17 b(call)i(is)e(silently)30
3721 y(ignor)n(ed)24 b(if)i(the)f(BOA)g(has)g(alr)n(eady)h(been)f
(shutdown.)34 b(After)24 b Fe(impl)p 2459 3721 V 31 w(shutdown)e
Fr(is)j(called,)i(the)30 3834 y(BOA)22 b(can)i(be)e(r)n(eactivated)h
(by)g(another)f(call)i(to)e Fe(impl)p 1941 3834 V 31
w(is)p 2082 3834 V 32 w(ready)p Fr(.)171 3952 y(It)e(should)f(be)g
(noted)g(that)h Fe(impl)p 1318 3952 V 30 w(shutdown)d
Fr(does)h(not)i(af)n(fect)h(outgoing)d(network)g(connec-)30
4065 y(tions.)26 b(That)19 b(is,)g(clients)g(in)g(the)g(same)f(addr)n
(ess)g(space)h(will)h(still)f(be)g(able)h(to)e(make)h(calls)h(to)f
(objects)30 4178 y(in)k(other)e(addr)n(ess)h(spaces.)171
4296 y(While)28 b(r)n(emote)e(r)n(equests)g(ar)n(e)i(not)f(deliver)n
(ed)f(after)i Fe(impl)p 2265 4296 V 31 w(shutdown)c Fr(is)j(called,)j
(the)c(cur)n(-)30 4409 y(r)n(ent)19 b(implementation)h(does)f(not)g
(stop)g(colocated)g(clients)h(fr)n(om)h(calling)h(the)d(objects.)26
b(In)20 b(futur)n(e,)30 4522 y(colocated)i(clients)h(will)h(exhibit)f
(the)f(same)g(behaviour)h(as)g(r)n(emote)f(clients.)171
4641 y Fe(destroy)17 b Fr(permanently)j(r)n(emoved)g(the)f(BOA.)h(This)
g(function)h(will)g(call)i Fe(impl)p 2988 4641 V 31 w(shutdown)30
4754 y Fr(implicitly)33 b(if)g(it)e(has)h(not)e(been)h(called.)55
b(When)31 b(this)g(call)j(r)n(eturns,)e(the)f(IIOP)g(port\(s\))f(held)h
(by)30 4867 y(the)22 b(BOA)h(will)i(be)e(fr)n(eed.)29
b(Remote)21 b(clients)j(will)g(see)e(their)h(r)n(equests)e(r)n(efused)h
(by)h(the)f(operating)30 4980 y(system)f(when)h(they)f(try)h(to)g(open)
f(a)j(connection)e(to)g(the)f(IIOP)i(port\(s\).)171 5098
y(After)j Fe(destroy)e Fr(is)j(called,)h(the)e(BOA)h(should)f(not)g(be)
h(used.)39 b(If)27 b(ther)n(e)e(is)i(any)g(objects)f(still)30
5211 y(r)n(egister)n(ed)h(with)j(the)e(BOA,)h(the)g(objects)g(should)f
(not)h(be)g(invoked)f(afterwar)n(ds.)48 b(The)29 b(objects)30
5324 y(ar)n(e)g(not)f(disposed.)44 b(Invoking)27 b(on)i(the)f(objects)g
(after)g Fe(destroy)e Fr(would)i(r)n(esult)g(in)h(unde\002ned)30
5437 y(behaviour)-7 b(.)46 b(Initialisation)30 b(of)e(another)g(BOA)g
(using)g Fe(BOA)p 2133 5437 V 31 w(init)f Fr(is)h(not)g(supported.)42
b(The)28 b(be-)30 5550 y(haviour)23 b(of)g Fe(BOA)p 642
5550 V 31 w(init)e Fr(after)i(this)f(call)i(is)f(unde\002ned.)p
eop
%%Page: 49 55
49 54 bop 150 100 a Ff(5.5.)51 b(UNSUPPOR)m(TED)21 b(FUNCTIONS)1890
b Fr(49)150 356 y Fj(5.5)119 b(Unsupported)30 b(functions)150
567 y Fr(The)21 b(following)g(member)g(functions)g(ar)n(e)h(not)e
(implemented.)27 b(Calling)c(these)c(functions)i(do)g(not)150
680 y(have)i(any)g(ef)n(fect.)286 892 y Fo(\017)46 b
Fe(Object)p 712 892 28 4 v 30 w(ptr)53 b(create\(...\))286
1080 y Fo(\017)46 b Fe(ReferenceData*)i(get)p 1365 1080
V 32 w(id\(Object)p 1892 1080 V 28 w(ptr\))286 1268 y
Fo(\017)e Fe(Principal)p 877 1268 V 29 w(ptr)53 b(get)p
1289 1268 V 31 w(principal\(Object)p 2199 1268 V 26 w(ptr,Environment)p
3050 1268 V 26 w(ptr\))286 1455 y Fo(\017)46 b Fe(void)53
b(change)p 985 1455 V 30 w(implementation\()o(Ob)o(je)o(ct)p
2166 1455 V 26 w(ptr,)g(Implementation-)377 1568 y(Def)p
547 1568 V 32 w(ptr\))286 1756 y Fo(\017)46 b Fe(void)53
b(deactivate)p 1205 1756 V 28 w(impl\(Implementa)o(ti)o(onD)o(ef)p
2439 1756 V 26 w(ptr\))286 1943 y Fo(\017)46 b Fe(void)53
b(deactivate)p 1205 1943 V 28 w(obj\(Object)p 1783 1943
V 28 w(ptr\))150 2242 y Fj(5.6)119 b(Loading)31 b(Objects)e(On)g
(Demand)150 2453 y Fr(Since)i(2.5.0,)j(ther)n(e)c(is)h(limited)h
(support)d(for)i(loading)g(objects)g(on)f(demand.)53
b(An)31 b(application)150 2566 y(can)e(r)n(egister)d(a)i(handler)g(for)
f(loading)h(objects)f(dynamically)-10 b(.)45 b(The)27
b(handler)g(should)g(have)h(the)150 2679 y(signatur)n(e)22
b Fe(omniORB::loader)o(::)o(ma)o(pK)o(ey)o(ToO)o(bj)o(ec)o(t)p
2251 2679 V 27 w(t)p Fr(:)250 2878 y Fd(namespace)48
b(omniORB)g({)349 2978 y(...)349 3077 y(class)h(loader)g({)349
3177 y(public:)449 3277 y(typedef)f(CORBA::Object_ptr)f
(\(*mapKeyToObject_t\))f(\(const)j(objec-)150 3376 y(tKey&)g(key\);)449
3476 y(static)g(void)g(set\(mapKeyToObject_t)d(NewKeyToObject\);)349
3576 y(};)250 3675 y(};)291 3888 y Fr(When)34 b(the)f(ORB)h(cannot)g
(locate)g(the)g(tar)n(get)f(object)h(in)g(this)g(addr)n(ess)f(space,)j
(it)e(calls)i(the)150 4001 y(handler)30 b(with)g(the)f(object)h(key)e
(of)i(the)g(tar)n(get.)49 b(The)29 b(handler)h(is)g(expected)e(to)h
(instantiate)h(the)150 4114 y(object,)24 b(either)e(in)i(this)g(addr)n
(ess)e(space)h(or)h(in)g(another)f(addr)n(ess)f(space,)h(and)h(r)n
(eturns)e(the)h(object)150 4226 y(r)n(efer)n(ence)33
b(to)f(the)g(newly)h(instantiated)f(object.)60 b(The)32
b(ORB)h(will)i(then)d(r)n(eply)h(with)g(a)h(LOCA-)150
4339 y(TION)p 389 4339 V 32 w(FOR)m(W)-8 b(ARD)35 b(message)f(to)h
(instr)o(uct)g(the)g(client)h(to)f(r)n(etry)g(using)g(the)g(object)h(r)
n(efer)n(ence)150 4452 y(r)n(eturned)27 b(by)h(the)f(handler)-7
b(.)45 b(When)28 b(the)f(handler)h(r)n(eturns,)h(the)e(ORB)h(assumes)f
(ownership)g(of)150 4565 y(the)j(r)n(eturned)f(value.)53
b(It)30 b(will)i(call)g(CORBA::r)n(elease\(\))e(on)h(the)f(r)n(eturned)
f(value)i(when)f(it)h(has)150 4678 y(\002nished)22 b(with)g(it.)291
4791 y(The)17 b(handler)h(may)g(be)f(called)i(concurr)n(ently)e(by)h
(multi-thr)n(eads.)26 b(Hence)17 b(it)h(must)f(be)g(thr)n(ead-)150
4904 y(safe.)291 5017 y(If)22 b(the)e(handler)i(cannot)f(load)h(the)e
(tar)n(get)h(object,)g(it)h(should)e(r)n(eturn)h(CORBA::Object::)p
3354 5017 V 32 w(nil\(\).)150 5130 y(The)h(object)g(will)i(be)f(tr)n
(eated)e(as)i(non-existing.)291 5243 y(The)55 b(application)i(r)n
(egisters)d(the)h(handler)h(with)f(the)g(ORB)h(at)g(r)o(untime)g(using)
f(om-)150 5356 y(niORB::loader::set\(\).)34 b(This)25
b(function)h(is)f(not)g(thr)n(ead-safe.)36 b(Calling)27
b(this)e(function)g(again)i(will)150 5468 y(r)n(eplace)c(the)f(old)g
(handler)h(with)f(the)g(new)g(one.)p eop
%%Page: 50 56
50 55 bop 30 100 a Fr(50)1159 b Ff(CHAPTER)22 b(5.)51
b(THE)21 b(BASIC)h(OBJECT)h(ADAPT)n(OR)g(\(BOA\))p eop
%%Page: 51 57
51 56 bop 150 981 a Fl(Chapter)44 b(6)150 1398 y Fn(Interface)53
b(T)-19 b(ype)52 b(Checking)150 1861 y Fr(This)21 b(chapter)g
(describes)g(the)g(mechanism)h(used)e(by)i(omniORB2)g(to)f(ensur)n(e)f
(type)g(safety)h(when)150 1974 y(object)i(r)n(efer)n(ences)f(ar)n(e)h
(exchanged)f(acr)n(oss)h(the)f(network.)27 b(This)22
b(mechanism)i(is)f(handled)f(com-)150 2087 y(pletely)k(within)h(the)e
(ORB.)i(Ther)n(e)f(is)g(no)h(pr)n(ogramming)f(interface)h(visible)h(at)
f(the)f(application)150 2200 y(level.)i(However)-7 b(,)20
b(for)g(the)h(sake)f(of)h(diagnosing)f(the)g(pr)n(oblem)h(when)f(ther)n
(e)g(is)h(a)h(type)d(violation,)150 2313 y(it)32 b(is)g(useful)g(to)f
(understand)f(the)h(underlying)g(mechanism)h(in)h(or)n(der)e(to)g
(interpr)n(et)g(the)g(err)n(or)150 2426 y(conditions)22
b(r)n(eported)e(by)j(the)f(ORB.)150 2737 y Fj(6.1)119
b(Introduction)150 2952 y Fr(In)34 b(GIOP/IIOP)-12 b(,)35
b(an)f(object)g(r)n(efer)n(ence)g(is)h(encoded)d(as)j(an)f(Inter)n
(operable)f(Object)i(Refer)n(ence)150 3065 y(\(IOR\))f(when)e(it)h(is)h
(sent)e(acr)n(oss)h(a)g(network)f(connection.)58 b(The)33
b(IOR)g(contains)g(a)h(Repository)150 3178 y(ID)27 b(\(REPOID\))g(and)g
(one)f(or)h(mor)n(e)g(communication)h(pr)n(o\002les.)40
b(The)26 b(communication)i(pr)n(o\002les)150 3291 y(describe)f(wher)n
(e)h(and)g(how)f(the)h(object)g(can)h(be)f(contacted.)43
b(The)28 b(REPOID)f(is)i(a)f(string)g(which)150 3404
y(uniquely)22 b(identi\002es)g(the)f(IDL)i(interface)f(of)h(the)f
(object.)291 3519 y(Unless)17 b(the)g Fm(ID)h Fr(pragma)g(is)g
(speci\002ed)e(in)i(the)f(IDL,)g(the)g(ORB)h(generates)e(the)h(REPOID)g
(string)150 3632 y(in)27 b(the)e(so-called)i(OMG)g(IDL)f(Format)1519
3599 y Fk(1)1556 3632 y Fr(.)39 b(For)25 b(instance,)i(the)f(REPOID)g
(for)g(the)f Fe(Echo)g Fr(interface)150 3745 y(used)c(in)i(the)f
(examples)g(of)h(chapter)f(2)h(is)g Fe(IDL:Echo:1.0)p
Fr(.)291 3859 y(When)g(interface)g(inheritance)h(is)f(used)f(in)h(the)g
(IDL,)f(the)h(ORB)g(always)h(sends)d(the)h(REPOID)150
3972 y(of)h(the)e(most)h(derived)g(interface.)28 b(For)22
b(example:)150 4184 y Fd(//)49 b(IDL)299 4283 y(interface)g(A)g({)399
4383 y(...)299 4483 y(};)299 4582 y(interface)g(B)g(:)h(A)f({)399
4682 y(...)299 4782 y(};)299 4881 y(interface)g(C)g({)449
4981 y(void)g(op\(in)g(A)g(arg\);)299 5080 y(};)150 5280
y(//)g(C++)299 5379 y(C_ptr)g(server;)p 150 5462 1368
4 v 255 5518 a Fh(1)284 5550 y Fg(For)18 b(further)g(details)g(of)h
(the)g(r)o(epository)d(ID)j(formats,)f(see)g(section)g(6.6)h(in)g(the)h
(CORBA)e(speci\002cation.)1815 5778 y Fr(51)p eop
%%Page: 52 58
52 57 bop 30 100 a Fr(52)1464 b Ff(CHAPTER)21 b(6.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)179 356 y Fd(B_ptr)49
b(objB;)179 456 y(A_ptr)g(objA)g(=)h(objB;)179 555 y
(server->op\(objA\);)296 b(//)50 b(Send)f(B)g(as)h(A)171
767 y Fr(In)23 b(the)g(example,)h(the)e(operation)h(C::op)g(accepts)g
(an)h(object)g(r)n(efer)n(ence)f(of)g(type)f(A.)h(The)g(r)n(eal)30
880 y(type)34 b(of)h(the)f(r)n(efer)n(ence)g(passed)g(to)g(C::op)h(is)g
(B,)f(which)i(inherits)e(fr)n(om)i(A.)f(In)f(this)h(case,)j(the)30
993 y(REPOID)22 b(of)h(B,)f(and)h(not)f(that)g(of)h(A,)f(is)g(sent)g
(acr)n(oss)g(the)g(network.)171 1106 y(The)k(GIOP/IIOP)h
(speci\002cation)g(allows)g(an)g(ORB)f(to)g(send)f(a)i(null)h(string)d
(in)j(the)d(REPOID)30 1219 y(\002eld)30 b(of)g(an)g(IOR.)g(It)f(is)h
(up)g(to)f(the)g(r)n(eceiving)i(end)e(to)g(work)g(out)g(the)g(r)n(eal)i
(type)d(of)i(the)g(object.)30 1332 y(OmniORB2)36 b(never)d(sends)f(out)
i(null)h(strings)e(as)h(REPOID.)f(However)-7 b(,)36 b(it)e(may)h(r)n
(eceive)f(null)30 1445 y(REPOID)23 b(fr)n(om)i(other)d(ORBs.)30
b(In)23 b(that)h(case,)f(it)h(will)h(use)e(the)f(mechanism)j(described)
d(below)i(to)30 1558 y(ensur)n(e)d(type)g(safety)-10
b(.)30 1856 y Fj(6.2)119 b(Basic)29 b(Interface)f(T)-11
b(ype)30 b(Checking)30 2067 y Fr(The)22 b(ORB)g(is)h(pr)n(ovided)f
(with)g(the)g(interface)h(information)g(by)f(the)g(stubs)f(via)j(the)e
(pr)n(oxyObject-)30 2180 y(Factory)f(class.)28 b(For)21
b(an)h(interface)f(A,)h(the)e(stub)h(of)h(A)f(contains)h(a)g(A)p
2394 2180 28 4 v 33 w(pr)n(oxyObjectFactory)e(class.)30
2293 y(This)h(class)h(is)f(derived)g(fr)n(om)h(the)e(pr)n
(oxyObjectFactory)g(class.)28 b(The)21 b(pr)n(oxyObjectFactory)f(is)i
(an)30 2406 y(abstract)h(class)g(which)g(contains)g(3)g(virtual)h
(functions.)30 2705 y Fd(class)49 b(proxyObjectFactory)d({)30
2804 y(public:)130 3004 y(virtual)i(const)h(char)g(*irRepoId\(\))f
(const)h(=)g(0;)130 3203 y(virtual)f(_CORBA_Boolean)97
b(is_a\(const)48 b(char)h(*base_repoId\))f(const)g(=)i(0;)130
3402 y(virtual)e(CORBA::Object_ptr)f(newProxyObject\(Rope)f(*r,)2172
3502 y(CORBA::Octet)i(*key,)2172 3601 y(size_t)h(keysize,)2172
3701 y(IOP::TaggedProfileList)2172 3801 y(*profiles,)2172
3900 y(CORBA::Boolean)e(re-)30 4000 y(lease\))i(=)g(0;)30
4199 y(};)166 4511 y Fo(\017)d Fe(irRepoId)19 b Fr(r)n(eturns)j(the)g
(REPOID)g(of)h(the)e(interface.)166 4698 y Fo(\017)46
b Fe(is)p 372 4698 V 32 w(a)24 b Fr(r)n(eturns)g(tr)o(ue\(1\))h(if)h
(the)e(ar)n(gument)g(is)h(the)f(REPOID)g(of)h(the)f(interface)h(itself)
g(or)f(it)h(is)257 4811 y(that)e(of)f(its)h(base)f(interfaces.)166
4999 y Fo(\017)46 b Fe(newProxyObject)29 b Fr(r)n(eturns)35
b(an)h(object)f(r)n(efer)n(ence)g(based)g(on)g(the)g(information)h
(sup-)257 5112 y(plied)23 b(in)g(the)f(ar)n(guments.)171
5324 y(A)33 b(single)g(instance)g(of)g(every)f(*)p 1321
5324 V 33 w(pr)n(oxyObjectFactory)g(is)h(instantiated)f(at)i(r)o
(untime.)59 b(The)30 5437 y(instances)31 b(ar)n(e)h(enter)n(ed)d(into)i
(a)h(list)g(inside)f(the)f(ORB.)h(The)g(list)g(constitutes)f(all)i(the)
f(interface)30 5550 y(information)23 b(known)f(to)g(the)g(ORB.)p
eop
%%Page: 53 59
53 58 bop 150 100 a Ff(6.3.)51 b(INTERF)-7 b(ACE)21 b(INHERIT)-7
b(ANCE)1959 b Fr(53)291 356 y(When)26 b(the)f(ORB)h(r)n(eceives)g(an)h
(IOR)f(fr)n(om)h(the)e(network,)g(it)i(unmarshals)f(and)h(extracts)e
(the)150 469 y(REPOID)d(fr)n(om)i(the)d(IOR.)i(At)f(this)g(point,)g
(the)g(ORB)g(has)h(two)e(pieces)h(of)h(information)g(in)g(hand:)264
709 y(1.)45 b(The)22 b(REPOID)h(of)f(the)g(object)g(r)n(efer)n(ence)g
(r)n(eceived)h(fr)n(om)g(the)f(network.)264 920 y(2.)45
b(The)18 b(REPOID)h(the)e(ORB)i(is)g(expecting.)25 b(This)18
b(comes)g(fr)n(om)h(the)f(unmarshal)i(function)e(that)377
1032 y(tells)23 b(the)e(ORB)i(to)f(r)n(eceive)h(the)f(object)g(r)n
(efer)n(ence.)291 1273 y(Using)29 b(the)h(REPOID)f(r)n(eceived,)j(the)d
(ORB)h(sear)n(ches)f(its)h(pr)n(oxyObjectFactory)f(list)h(for)g(an)150
1386 y(exact)i(match.)55 b(If)32 b(ther)n(e)f(is)h(an)g(exact)f(match,)
k(all)e(is)f(well)g(because)f(the)g(r)o(untime)h(can)g(use)f(the)150
1499 y Fe(is)p 265 1499 28 4 v 32 w(a)24 b Fr(method)f(of)h(the)g(pr)n
(oxyFactory)f(to)g(check)i(if)g(the)f(expected)e(REPOID)i(is)g(the)g
(same)g(as)h(the)150 1612 y(r)n(eceived)d(REPOID)f(or)h(if)g(it)g(is)g
(that)g(of)g(its)f(base)h(interfaces.)27 b(If)22 b(the)f(answer)g(is)h
(positive,)f(the)g(IOR)150 1725 y(passes)g(the)g(type)g(checking)h
(test)e(and)i(the)g(ORB)g(can)h(pr)n(oceed)e(to)g(cr)n(eate)h(an)h
(object)f(r)n(efer)n(ence)g(in)150 1838 y(its)g(own)g(addr)n(ess)g
(space)g(to)g(r)n(epr)n(esent)f(the)g(IOR.)291 1956 y(However)-7
b(,)33 b(the)f(ORB)f(may)i(fail)h(to)d(\002nd)h(a)h(match)g(in)f(its)g
(pr)n(oxyObjectFactory)f(list.)56 b(This)150 2069 y(means)25
b(that)g(the)f(ORB)h(has)g(no)g(local)i(knowledge)c(of)i(the)f(REPOID.)
h(Ther)n(e)f(ar)n(e)i(thr)n(ee)e(possible)150 2182 y(causes:)264
2422 y(1.)45 b(The)22 b(r)n(emote)g(end)g(is)g(another)g(ORB)g(and)h
(it)g(sends)e(a)i(null)g(string)f(as)h(the)f(REPOID.)264
2633 y(2.)45 b(The)27 b(ORB)h(is)g(expecting)f(an)h(object)g(r)n(efer)n
(ence)f(of)h(interface)g(A.)g(The)f(r)n(emote)g(end)g(sends)377
2745 y(the)j(REPOID)h(of)g(B)f(which)i(is)f(an)g(interface)g(that)g
(inherits)f(fr)n(om)i(A.)e(The)h(stubs)e(of)i(A)g(is)377
2858 y(linked)22 b(into)h(the)f(executable)g(but)g(the)g(stubs)g(of)g
(B)h(is)f(not.)264 3068 y(3.)45 b(The)22 b(r)n(emote)g(end)g(has)g
(sent)g(a)h(duf)n(f)g(IOR.)291 3309 y(T)-8 b(o)22 b(handle)g(this)g
(situation,)g(the)f(ORB)h(must)g(\002nd)g(out)g(the)f(type)g
(information)i(dynamically)-10 b(.)150 3422 y(This)22
b(is)h(explained)f(in)h(the)f(next)g(section.)150 3755
y Fj(6.3)119 b(Interface)28 b(Inheritance)150 3977 y
Fr(When)22 b(the)h(ORB)f(r)n(eceives)h(an)h(IOR)e(of)h(interface)h
(type)d(B)i(when)f(it)h(expects)e(the)i(type)e(to)h(be)h(A,)g(it)150
4090 y(must)g(\002nd)g(out)f(if)i(B)f(inherits)g(fr)n(om)h(A.)f(When)f
(the)h(ORB)g(has)g(no)g(local)i(knowledge)c(of)i(the)g(type)150
4203 y(B,)f(it)h(must)f(work)f(out)h(the)g(type)f(of)i(B)f(dynamically)
-10 b(.)291 4322 y(The)23 b(CORBA)h(speci\002cation)f(de\002nes)f(an)i
(Interface)f(Repository)e(\(IR\))j(fr)n(om)g(which)g(IDL)f(in-)150
4435 y(terfaces)d(can)h(be)g(queried)e(dynamically)-10
b(.)29 b(In)20 b(the)g(above)g(situation,)h(the)e(ORB)i(could)f
(contact)h(the)150 4547 y(IR)d(to)f(\002nd)h(out)g(the)f(type)g(of)h
(B.)g(However)-7 b(,)17 b(this)h(appr)n(oach)h(assumes)e(that)h(an)h
(IR)f(is)g(always)h(avail-)150 4660 y(able)25 b(and)f(contains)g(the)f
(up-to-date)g(information)h(of)g(all)i(the)d(interfaces)h(used)e(in)j
(the)e(domain.)150 4773 y(This)f(assumption)g(may)h(not)f(be)g(valid)i
(in)g(many)e(applications.)291 4892 y(An)c(alternative)h(is)f(to)g(use)
f(the)p 1368 4892 V 50 w Fe(is)p 1510 4892 V 32 w(a)h
Fr(operation)f(to)g(work)h(out)f(the)g(actual)j(type)d(of)h(an)h
(object.)150 5005 y(This)i(appr)n(oach)h(is)g(simpler)f(and)h(mor)n(e)f
(r)n(obust)g(than)g(the)g(pr)n(evious)g(one)g(because)g(no)g(3r)n(d)h
(party)150 5118 y(is)h(involved.)150 5351 y Fd(class)49
b(Object{)349 5450 y(CORBA::Boolean)e(_is_a\(const)h(char*)h
(type_id\);)150 5550 y(};)p eop
%%Page: 54 60
54 59 bop 30 100 a Fr(54)1464 b Ff(CHAPTER)21 b(6.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)171 356 y Fr(The)p
354 356 28 4 v 57 w Fe(is)p 496 356 V 32 w(a)k Fr(operation)f(is)h
(part)g(of)g(the)g Fe(CORBA::Object)19 b Fr(interface)26
b(and)f(must)f(be)h(imple-)30 469 y(mented)17 b(by)h(every)f(object.)26
b(The)17 b(input)h(ar)n(gument)f(is)h(a)h(REPOID.)f(The)f(function)h(r)
n(eturns)f(tr)o(ue\(1\))30 582 y(if)k(the)f(object)g(is)h(r)n(eally)g
(an)g(instance)g(of)f(that)h(type,)e(including)i(if)g(that)f(type)f(is)
i(a)g(base)f(type)f(of)i(the)30 695 y(most)h(derived)f(type)h(of)g
(that)h(object.)171 808 y(In)30 b(the)f(situation)h(above,)i(the)e(ORB)
g(would)f(invoke)h(the)p 2254 808 V 62 w Fe(is)p 2396
808 V 32 w(a)g Fr(operation)f(on)h(the)f(object)30 920
y(and)22 b(ask)g(if)i(the)d(object)i(is)f(of)g(type)f(A)i
Fm(before)g Fr(it)f(pr)n(ocesses)f(any)h(application)i(invocation)f(on)
f(the)30 1033 y(object.)171 1146 y(Notice)30 b(that)g(the)p
817 1146 V 62 w Fe(is)p 959 1146 V 32 w(a)g Fr(call)i(is)e
Fm(not)g Fr(performed)f(when)g(the)h(IOR)g(is)g(unmarshalled.)51
b(It)30 b(is)30 1259 y(performed)h(just)h(prior)h(to)f(the)g(\002rst)g
(application)i(invocation)g(on)e(the)g(object.)59 b(This)32
b(leads)h(to)30 1372 y(some)26 b(inter)n(esting)g(failur)n(e)i(mode)e
(if)i(B)f(r)n(eports)e(that)i(it)g(is)g(not)f(an)i(A.)e(Consider)h(the)
f(following)30 1485 y(example:)30 1781 y Fd(\\\\)49 b(IDL)179
1881 y(interface)g(A)g({)h(...)f(};)179 1980 y(interface)g(B)g(:)h(A)f
({)h(...)f(};)179 2080 y(interface)g(D)g({)h(...)f(};)179
2180 y(interface)g(C)g({)279 2279 y(A)299 b(op1\(\);)279
2379 y(Object)49 b(op2\(\);)179 2478 y(};)30 2678 y(\\\\)g(C++)179
2877 y(C_ptr)g(objC;)179 2977 y(A_ptr)g(objA;)179 3076
y(CORBA::Object_ptr)e(objR;)179 3275 y(objA)i(=)100 b(objC->op1\(\);)
695 b(//)50 b(line)f(1)179 3375 y(\(void\))g(objA->_non_existent\(\);)
245 b(//)50 b(line)f(2)179 3574 y(objR)g(=)100 b(objC->op2\(\);)695
b(//)50 b(line)f(3)179 3674 y(objA)g(=)100 b(A::_narrow\(objR\);)445
b(//)50 b(line)f(4)30 3983 y Fr(If)23 b(the)e(stubs)h(of)h(A,B,C,D)f
(ar)n(e)h(linked)f(into)g(the)g(executable)g(and:)30
4193 y Fm(Case)i(1)46 b Fe(C::op1)27 b Fr(and)k Fe(C::op2)d
Fr(r)n(eturns)h(a)i(B.)f(Line)g(1-4)i(complete)d(successful.)51
b(The)30 b(r)n(emote)257 4306 y(object)23 b(is)f(only)h(contacted)f(at)
g(line)h(2.)30 4492 y Fm(Case)h(2)46 b Fe(C::op1)19 b
Fr(and)j Fe(C::op2)e Fr(r)n(eturns)h(a)i(D.)f(This)g(condition)g(only)g
(occurs)g(if)h(the)f(r)o(untime)g(of)257 4605 y(the)i(r)n(emote)f(end)h
(is)h(buggy)-10 b(.)32 b(The)24 b(ORB)g(raises)g(a)h(CORBA::Marshal)g
(exception)e(at)i(line)g(1)257 4718 y(because)e(it)f(knows)g(it)g(has)h
(r)n(eceived)f(an)h(interface)g(of)g(the)f(wr)n(ong)g(type.)30
4928 y(If)h(only)f(the)g(stub)g(of)g(A)h(is)g(linked)f(into)g(the)g
(executable)g(and:)30 5137 y Fm(Case)i(1)46 b Fr(C::op1)22
b(and)g(C::op2)g(r)n(eturns)g(a)h(B.)e(Line)h(1-4)i(completes)d
(successful.)27 b(When)22 b(line)h(2)g(and)257 5250 y(4)g(is)g
(executed,)e(the)g(object)i(is)g(contacted)e(to)h(ask)h(if)g(it)g(is)g
(a)g(A.)30 5437 y Fm(Case)h(2)46 b Fr(C::op1)21 b(and)g(C::op2)g(r)n
(eturns)f(a)i(D.)g(This)f(condition)g(only)g(occurs)g(if)h(the)e(r)o
(untime)i(of)f(the)257 5550 y(r)n(emote)i(end)g(is)h(buggy)-10
b(.)30 b(Line)23 b(1)h(completes)f(and)h(no)f(exception)f(is)i(raised.)
31 b(At)23 b(line)i(2,)f(the)p eop
%%Page: 55 61
55 60 bop 150 100 a Ff(6.3.)51 b(INTERF)-7 b(ACE)21 b(INHERIT)-7
b(ANCE)1959 b Fr(55)377 356 y(object)23 b(is)f(contacted)g(to)g(ask)g
(if)i(it)f(is)f(a)i(A.)e(If)g(the)g(answer)g(is)h(no,)f(a)h(CORBA::INV)
p 3220 356 28 4 v 31 w(OBJREF)377 469 y(exception)f(is)h(raised.)28
b(The)23 b(application)h(will)g(also)f(see)f(a)h(CORBA::INV)p
2949 469 V 31 w(OBJREF)f(at)i(line)377 582 y(4.)p eop
%%Page: 56 62
56 61 bop 30 100 a Fr(56)1464 b Ff(CHAPTER)21 b(6.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)p eop
%%Page: 57 63
57 62 bop 150 982 a Fl(Chapter)44 b(7)150 1401 y Fn(Connection)52
b(Management)150 1866 y Fr(This)22 b(chapter)h(describes)e(how)h
(omniORB2)h(manages)g(network)d(connections.)150 2186
y Fj(7.1)119 b(Background)150 2404 y Fr(In)27 b(CORBA,)g(the)f(ORB)i
(is)f(the)f(\223middlewar)n(e\224)j(that)e(allows)g(a)h(client)g(to)f
(invoke)f(an)i(operation)150 2517 y(on)f(an)h(object)g(without)e(r)n
(egar)n(d)i(to)e(its)i(implementation)f(or)g(location.)44
b(In)27 b(or)n(der)g(to)g(invoke)g(an)150 2630 y(operation)j(on)g(an)h
(object,)i(a)e(client)g(needs)e(to)i(\223bind\224)h(to)e(the)g(object)g
(by)h(acquiring)h(its)e(object)150 2743 y(r)n(efer)n(ence.)38
b(Such)27 b(a)g(r)n(efer)n(ence)f(may)g(be)h(obtained)f(as)g(the)g(r)n
(esult)f(of)i(an)g(operation)e(on)h(another)150 2856
y(object)k(\(such)g(as)f(a)i(naming)f(service\))g(or)g(by)g(conversion)
f(fr)n(om)h(a)h(stringi\002ed)d(r)n(epr)n(esentation)150
2969 y(pr)n(eviously)20 b(generated)d(by)k(the)e(same)h(ORB.)g(If)g
(the)f(object)h(is)h(in)f(a)h(dif)n(fer)n(ent)f(addr)n(ess)f(space,)h
(the)150 3082 y(binding)f(pr)n(ocess)f(involves)h(the)f(ORB)g(building)
i(a)f(pr)n(oxy)f(object)h(in)g(the)f(client's)h(addr)n(ess)f(space.)150
3194 y(The)24 b(ORB)h(arranges)g(for)g(invocations)g(on)g(the)f(pr)n
(oxy)g(object)h(to)f(be)h(transpar)n(ently)f(mapped)h(to)150
3307 y(equivalent)e(invocations)g(on)f(the)g(implementation)h(object.)
291 3424 y(For)29 b(the)g(sake)f(of)i(inter)n(operability)-10
b(,)31 b(CORBA)e(mandates)g(that)h(all)h(ORBs)e(should)f(support)150
3537 y(IIOP)35 b(as)h(the)f(means)g(to)g(communicate)h(r)n(emote)f
(invocations)g(over)h(a)g(TCP/IP)f(connection.)150 3650
y(IIOP)21 b(is)h(asymmetric)f(with)h(r)n(espect)e(to)h(the)f(r)n(oles)h
(of)h(the)f(parties)f(at)i(the)f(two)f(ends)g(of)i(a)g(connec-)150
3763 y(tion.)32 b(At)23 b(one)g(end)g(is)h(the)f(client)i(which)f(can)h
(only)f(initiate)g(r)n(emote)f(invocations.)33 b(At)23
b(the)g(other)150 3875 y(end)f(is)g(the)g(server)g(which)h(can)g(only)g
(r)n(eceive)g(r)n(emote)e(invocations.)291 3992 y(Notice)33
b(that)h(in)g(CORBA,)g(as)g(in)g(most)f(distributed)g(systems,)h(r)n
(emote)f(bindings)g(ar)n(e)i(es-)150 4105 y(tablished)27
b(implicitly)i(without)e(application)h(intervention.)41
b(This)27 b(pr)n(ovides)g(the)f(illusion)i(that)150 4218
y(all)h(objects)e(ar)n(e)h(local,)i(a)e(pr)n(operty)e(known)g(as)i
(\223location)h(transpar)n(ency\224.)42 b(CORBA)28 b(does)e(not)150
4331 y(specify)20 b(when)g(such)g(bindings)g(should)g(be)g(established)
g(or)g(how)g(they)f(should)g(be)i(multiplexed)150 4443
y(over)29 b(the)h(underlying)e(network)g(connections.)49
b(Instead,)30 b(ORBs)f(ar)n(e)h(fr)n(ee)g(to)f(implement)h(im-)150
4556 y(plicit)24 b(binding)f(by)f(a)h(variety)g(of)g(means.)291
4673 y(The)28 b(r)n(est)f(of)i(this)f(chapter)g(describes)f(how)h
(omniORB2)h(manages)g(network)d(connections)150 4786
y(and)d(the)e(pr)n(ogramming)i(interface)g(to)f(\002ne)g(tune)g(the)g
(management)g(policy)-10 b(.)150 5106 y Fj(7.2)119 b(The)29
b(Model)150 5324 y Fr(OmniORB2)34 b(is)e(designed)f(fr)n(om)i(the)e(gr)
n(ound)h(up)g(to)g(be)g(fully)h(multi-thr)n(eaded.)57
b(The)32 b(objec-)150 5437 y(tive)k(is)f(to)g(maximise)h(the)f(degr)n
(ee)f(of)h(concurr)n(ency)g(and)h(at)f(the)g(same)g(time)h(eliminate)g
(any)150 5550 y(unnecessary)30 b(thr)n(ead)i(over)n(head.)56
b(Another)31 b(objective)h(is)h(to)e(minimise)i(the)f(interfer)n(ence)f
(by)1815 5778 y(57)p eop
%%Page: 58 64
58 63 bop 30 100 a Fr(58)1387 b Ff(CHAPTER)21 b(7.)51
b(CONNECTION)22 b(MANAGEMENT)30 356 y Fr(the)h(activities)i(of)f(other)
f(thr)n(eads)g(on)h(the)f(pr)n(ogr)n(ess)f(of)i(a)h(r)n(emote)e
(invocation.)33 b(In)24 b(other)e(wor)n(ds,)30 469 y(thr)n(ead)h
(\223cr)n(oss-talk\224)g(should)f(be)h(minimised)h(within)f(the)g(ORB.)
f(T)-8 b(o)22 b(achieve)i(these)e(objectives,)30 582
y(the)g(degr)n(ee)f(of)h(multiplexing)h(at)g(every)e(level)j(is)e(kept)
f(to)h(a)i(minimum.)171 696 y(On)f(the)e(client)h(side)f(of)h(a)g
(connection,)g(the)f(thr)n(ead)g(that)h(invokes)f(on)g(a)i(pr)n(oxy)e
(object)h(drives)30 809 y(the)28 b(IIOP)h(pr)n(otocol)g(dir)n(ectly)g
(and)g(blocks)g(on)g(the)f(connection)g(to)h(r)n(eceive)g(the)g(r)n
(eply)-10 b(.)46 b(On)30 b(the)30 922 y(server)20 b(side,)g(a)h
(dedicated)e(thr)n(ead)i(blocks)f(on)g(the)g(connection.)27
b(When)20 b(it)h(r)n(eceives)f(a)i(r)n(equest,)d(it)30
1034 y(performs)k(the)g(up-call)j(to)d(the)g(object)h(and)g(sends)e
(the)i(r)n(eply)f(when)h(the)f(upcall)i(r)n(eturns.)31
b(Ther)n(e)30 1147 y(is)23 b(no)f(thr)n(ead)g(switching)g(along)h(the)f
(call)i(chain.)171 1261 y(W)-5 b(ith)27 b(this)f(design,)g(ther)n(e)g
(is)h(at)g(most)f(one)g(call)i(in-\003ight)g(at)f(any)f(time)h(in)g(a)g
(connection.)40 b(If)30 1374 y(ther)n(e)19 b(is)h(only)f(one)g
(connection,)g(concurr)n(ent)h(invocations)g(to)f(the)g(same)g(r)n
(emote)g(addr)n(ess)f(space)30 1487 y(would)32 b(have)h(to)f(be)h
(serialised.)57 b(T)-8 b(o)32 b(eliminate)i(this)e(limitation,)k
(omniORB2)d(implements)g(a)30 1600 y(dynamic)d(policy-)g(multiple)g
(connections)f(to)g(the)g(same)g(r)n(emote)g(addr)n(ess)f(space)i(ar)n
(e)g(cr)n(eated)30 1713 y(on)22 b(demand)g(and)h(cached)g(when)f(ther)n
(e)f(ar)n(e)i(concurr)n(ent)f(invocations)i(in)f(pr)n(ogr)n(ess.)171
1827 y(T)-8 b(o)26 b(be)g(mor)n(e)h(pr)n(ecise,)g(a)g(network)e
(connection)h(to)g(another)g(addr)n(ess)f(space)h(is)h(only)f(estab-)30
1940 y(lished)d(when)h(a)g(r)n(emote)f(invocation)i(is)f(about)g(to)f
(be)h(made.)31 b(Ther)n(efor)n(e,)23 b(ther)n(e)g(may)h(be)g(one)f(or)
30 2053 y(mor)n(e)e(object)g(r)n(efer)n(ences)f(in)h(one)f(addr)n(ess)g
(space)h(that)f(r)n(efers)h(to)f(objects)g(in)i(a)g(dif)n(fer)n(ent)f
(addr)n(ess)30 2166 y(space)30 b(but)g(unless)f(the)h(application)h
(invokes)e(on)h(these)f(objects,)i(no)f(network)e(connection)i(is)30
2279 y(made.)53 b(The)31 b(maximum)i(number)e(of)g(connections)f
(opened)f(to)h(another)h(addr)n(ess)e(space)i(is)h(5)30
2392 y(by)i(default.)61 b(Since)34 b(2.6.0,)k(this)33
b(parameter)g(can)i(be)f(changed)f(by)h(setting)e(the)h(variable)j
Fe(om-)30 2504 y(niORB::maxTcpCo)o(nn)o(ec)o(ti)o(onP)o(er)o(Se)o(rv)o
(er)16 b Fm(before)24 b Fr(calling)g Fe(ORB)p 2550 2504
28 4 v 31 w(init)p Fr(.)171 2618 y(It)35 b(is)h(wasteful)f(to)g(leave)h
(a)g(connection)g(opened)d(when)i(it)h(has)f(been)g(left)h(unused)e
(for)i(a)30 2731 y(considerable)28 b(time.)43 b(T)-8
b(oo)27 b(many)h(idle)g(connections)f(could)h(block)g(out)f(new)g
(connections)g(to)h(a)30 2844 y(server)i(when)g(it)h(r)o(uns)f(out)g
(of)h(spar)n(e)f(communication)i(channels.)53 b(For)29
b(example,)k(most)d(unix)30 2957 y(platforms)22 b(has)g(a)g(limit)i(on)
e(the)f(number)h(of)g(\002le)g(handles)f(a)i(pr)n(ocess)d(can)j(open.)k
(64)c(is)f(the)f(usual)30 3070 y(default)31 b(limit.)56
b(The)31 b(value)h(can)g(be)g(incr)n(eased)f(to)g(a)h(maximum)h(of)f(a)
g(thousand)e(or)h(mor)n(e)g(by)30 3183 y(changing)23
b(the)f(\223ulimit\224)i(in)f(the)f(shell.)30 3488 y
Fj(7.3)119 b(Idle)29 b(Connection)i(Shutdown)30 3701
y Fr(Inside)24 b(the)f(ORB,)i(two)f(separate)f(thr)n(eads)h(ar)n(e)h
(dedicated)f(to)g(scan)h(for)g(idle)g(connections.)33
b(One)30 3814 y(thr)n(ead)19 b(is)g(r)n(esponsible)g(for)g(outgoing)f
(connections)g(and)h(the)g(other)f(looks)g(after)i(incoming)g(con-)30
3927 y(nections.)45 b(The)28 b(thr)n(ead)g(for)g(incoming)i
(connections)d(is)i(only)f(cr)n(eated)g(when)g(the)g(BOA)g(is)h(ini-)30
4040 y(tialised)23 b(because)f(only)g(then)g(will)i(ther)n(e)e(be)g
(any)h(incoming)g(connections.)171 4154 y(The)30 b(thr)n(eads)g(scan)h
(all)h(opened)c(connections)i(once)g(every)g(\223scan)h(period\224.)51
b(If)31 b(a)g(connec-)30 4267 y(tion)i(is)g(found)f(to)g(be)h(idle)g
(for)g(two)f(consecutive)h(periods,)g(it)h(will)g(be)f(closed.)58
b(The)32 b(thr)n(eads)30 4380 y(use)22 b(mark-and-swipe)h(to)f(detect)g
(if)i(a)g(connection)e(is)h(idle.)30 b(When)22 b(a)i(connection)e(is)i
(checked,)e(a)30 4493 y(status)j(\003ag)h(attached)f(to)h(the)f
(connection)g(is)h(set.)36 b(Every)25 b(r)n(emote)g(invocation)i(using)
e(that)h(con-)30 4606 y(nection)f(would)h(clear)g(the)f(\003ag.)38
b(So)26 b(if)g(a)h(connection's)e(status)f(\003ag)j(is)f(found)f(to)g
(be)h(set)f(in)h(two)30 4719 y(consecutive)c(scans,)g(the)g(connection)
g(has)h(been)f(idled)g(during)g(the)g(scan)h(period.)171
4833 y(The)j(scan)g(period)f(for)h(incoming)h(and)f(outgoing)f
(connections)g(can)i(be)f(individually)i(con-)30 4946
y(tr)n(olled)22 b(by)h(the)f(following)h(API:)30 5251
y Fd(class)49 b(omniORB)f({)30 5450 y(public:)p eop
%%Page: 59 65
59 64 bop 150 100 a Ff(7.4.)51 b(INTEROPERABILITY)18
b(CONSIDERA)-7 b(TIONS)1416 b Fr(59)250 356 y Fd(enum)49
b(idleConnType)e({)j(idleIncoming,)d(idleOutgoing)h(};)250
555 y(static)g(void)h(idleConnectionScanPeriod\(idleConnType)43
b(direction,)2093 655 y(CORBA::ULong)k(sec\);)250 854
y(static)h(CORBA::ULong)g(idleConnectionScanPeriod\(idleConnTy)o(pe)c
(direction\);)150 1053 y(};)291 1366 y Fr(The)36 b(curr)n(ent)g(value)h
(of)f(the)g(scan)h(period)e(\(in)i(seconds\))e(is)i(r)n(eturned)d(by)j
(the)e(r)n(ead-only)150 1479 y Fe(idleConnectionS)o(ca)o(nP)o(er)o(iod)
o Fr(.)k(The)27 b(scan)i(period)e(can)i(be)f(changed)f(by)h(the)g
(write-only)150 1592 y Fe(idleConnectionS)o(ca)o(nP)o(er)o(iod)o
Fr(.)22 b(The)g(scan)h(period)e(can)i(be)g(changed)f(at)g(any)h(time)g
(but)f(the)150 1705 y(write)34 b(function)h(is)g(non-thr)n(ead)e(safe.)
64 b(Concurr)n(ent)34 b(calls)i(to)e(this)g(function)h(could)g(r)n
(esult)f(in)150 1818 y(unde\002ned)27 b(behaviour)-7
b(.)50 b(The)29 b(scan)h(periods)e(may)h(also)h(be)g(speci\002ed)e(on)h
(the)g(command-line)150 1931 y(by)h(using)f(the)g(options)f
Fe(-ORBinConScanPer)o(io)o(d)c Fr(and)30 b Fe(-ORBoutConScan)o(Pe)o(ri)
o(od)p Fr(.)43 b(See)150 2044 y(section)22 b(4.1.)291
2157 y(The)h(default)h(value)h(for)f(both)f(incoming)i(and)f(outgoing)e
(connections)h(is)h(30)h(seconds.)30 b(The)150 2270 y(scan)23
b(can)g(be)g(disabled)g(completely)e(by)i(setting)e(the)h(scan)h
(period)e(to)h(0.)150 2569 y Fj(7.4)119 b(Interoperability)28
b(Considerations)150 2780 y Fr(The)j(IIOP)g(speci\002cation)h(allows)g
(both)g(the)f(client)h(and)f(the)g(server)g(to)g(shutdown)f(a)i
(connec-)150 2893 y(tion)26 b(unilaterally)-10 b(.)41
b(When)25 b(one)h(end)g(is)g(about)h(to)e(shutdown)g(a)i(connection,)f
(it)h(should)e(send)h(a)150 3006 y(closeConnection)d(message)f(to)g
(the)h(other)f(end.)30 b(It)22 b(should)h(also)h(make)f(sur)n(e)g(that)
g(the)g(message)150 3119 y(will)h(r)n(each)f(the)f(other)f(end)h(befor)
n(e)g(it)h(pr)n(oceeds)e(to)h(shutdown)f(the)g(connection.)291
3232 y(The)36 b(client)h(should)e(distinguish)h(between)f(an)i(or)n
(derly)e(and)i(an)g(abnormal)h(connection)150 3345 y(shutdown.)25
b(When)20 b(a)h(client)g(r)n(eceives)f(a)h(closeConnection)e(message)g
(befor)n(e)h(the)g(connection)g(is)150 3458 y(closed,)k(the)g
(condition)g(is)h(an)g(or)n(derly)f(shutdown.)31 b(If)25
b(the)f(message)f(is)i(not)e(r)n(eceived,)i(the)f(con-)150
3571 y(dition)j(is)g(an)h(abnormal)g(shutdown.)39 b(In)27
b(an)h(abnormal)g(shutdown,)e(the)g(ORB)h(should)f(raise)i(a)150
3684 y Fe(COMM)p 375 3684 28 4 v 31 w(FAILURE)19 b Fr(exception)h(wher)
n(eas)h(in)i(an)f(or)n(derly)f(shutdown,)e(the)i(ORB)h(should)f
Fm(not)g Fr(raise)150 3797 y(an)i(exception)e(and)i(should)f(try)g(to)g
(r)n(e-establish)g(a)h(new)f(connection)g(transpar)n(ently)-10
b(.)291 3910 y(OmniORB2)40 b(implements)d(this)h(semantics)g
(completely)-10 b(.)74 b(However)-7 b(,)41 b(it)d(is)g(known)f(that)150
4023 y(some)18 b(ORBs)g(ar)n(e)i(not)e(\(yet\))g(able)i(to)e
(distinguish)g(between)f(an)i(or)n(derly)f(and)h(an)g(abnormal)i(shut-)
150 4136 y(down.)30 b(Usually)23 b(this)g(is)h(manifested)f(as)h(the)e
(client)i(in)g(these)e(ORBs)h(seeing)f(a)i Fe(COMM)p
3162 4136 V 31 w(FAILURE)150 4249 y Fr(occasionally)33
b(when)e(connected)g(to)g(an)i(omniORB2)f(server)-7 b(.)55
b(The)31 b(workar)n(ound)g(is)h(either)f(to)150 4362
y(catch)d(the)f(exception)f(in)h(the)g(application)h(code)f(and)g(r)n
(etries)f(or)h(to)g(turn)f(of)n(f)i(the)f(idle)g(connec-)150
4474 y(tion)22 b(shutdown)f(inside)h(the)g(omniORB2)h(server)-7
b(.)150 4774 y Fj(7.5)119 b(Connection)31 b(Acceptance)150
4985 y Fr(OmniORB2)h(pr)n(ovides)e(the)f(hook)h(to)f(implement)i(a)g
(connection)f(acceptance)h(policy)-10 b(.)51 b(Inside)150
5098 y(the)24 b(ORB)g(r)o(untime,)h(a)g(thr)n(ead)f(is)h(dedicated)e
(to)h(r)n(eceive)h(new)f(connections.)33 b(When)24 b(the)g(thr)n(ead)
150 5211 y(is)31 b(given)f(the)g(handle)h(of)g(a)g(new)f(connection)g
(by)h(the)f(operating)f(system,)i(it)g(calls)h(the)e(policy)150
5324 y(module)22 b(to)g(decide)f(if)j(the)d(connection)h(can)i(be)e
(accepted.)27 b(If)c(the)e(answer)h(is)h(yes,)e(the)g(ORB)i(will)150
5437 y(start)29 b(serving)f(r)n(equests)g(coming)h(in)h(fr)n(om)g(that)
f(connection.)48 b(Otherwise,)30 b(the)e(connection)h(is)150
5550 y(shutdown)21 b(immediately)-10 b(.)p eop
%%Page: 60 66
60 65 bop 30 100 a Fr(60)1387 b Ff(CHAPTER)21 b(7.)51
b(CONNECTION)22 b(MANAGEMENT)171 356 y Fr(Ther)n(e)35
b(can)i(be)f(a)h(number)f(of)g(policy)g(module)f(implementations.)68
b(The)35 b(basic)i(one)e(is)i(a)30 469 y(dummy)22 b(module)g(which)h
(just)f(accepts)h(every)e(connection.)171 582 y(In)35
b(addition,)i(a)f(host-based)d(access)i(contr)n(ol)g(module)f(is)h
(available)j(on)c(unix)h(platforms.)30 695 y(The)d(module)f(uses)g(the)
h(IP)g(addr)n(ess)f(of)h(the)g(client)h(to)e(decide)h(if)h(the)f
(connection)f(can)j(be)e(ac-)30 808 y(cepted.)g(The)24
b(module)h(is)f(implemented)g(using)g Fq(tcp)p 1883 808
28 4 v 34 w(wrappers)j(7.6)p Fr(.)35 b(The)24 b(access)g(contr)n(ol)h
(policy)30 920 y(can)i(be)f(de\002ned)f(as)h(r)o(ules)g(in)h(two)f
(access)g(contr)n(ol)g(\002les:)35 b Fe(hosts.allow)21
b Fr(and)27 b Fe(hosts.deny)p Fr(.)30 1033 y(The)32 b(syntax)g(of)h
(the)f(r)o(ules)g(is)h(described)f(in)h(the)f(manual)i(page)e
Fe(hosts)p 2652 1033 V 31 w(access\(5\))d Fr(which)30
1146 y(can)23 b(be)f(found)g(in)h(appendix)e(A.)h(The)g(syntax)f
(de\002nes)g(a)h(simple)h(access)f(contr)n(ol)g(language)g(that)30
1259 y(is)32 b(based)f(on)h(client)g(\(host)f(name/addr)n(ess,)i(user)e
(name\),)j(and)e(server)f(\(pr)n(ocess)g(name,)j(host)30
1372 y(name/addr)n(ess\))e(patterns.)58 b(When)32 b(sear)n(ching)h(for)
g(a)h(match)f(on)g(the)f(server)g(pr)n(ocess)g(name,)30
1485 y(the)e(ORB)i(uses)d(the)i(value)h(of)f Fe(omniORB::server)o(Na)o
(me)o Fr(.)48 b Fe(ORB)p 2418 1485 V 32 w(init)29 b Fr(uses)h(the)h(ar)
n(gument)30 1598 y Fe(argv[0])24 b Fr(to)j(set)f(the)g(default)h(value)
h(of)g(this)e(variable.)44 b(This)27 b(can)h(be)f(overridden)f(by)h
(the)g(ap-)30 1711 y(plication)d(by)e(passing)g(the)g(option:)27
b Fe(-ORBserverName)48 b(<string>)19 b Fr(to)j Fe(ORB)p
2870 1711 V 31 w(init)p Fr(.)171 1824 y(The)i(default)h(location)g(of)g
(the)f(access)h(contr)n(ol)f(\002les)h(is)g Fe(/etc)p
Fr(.)32 b(This)25 b(can)g(be)g(overridden)e(by)30 1937
y(the)f(extra)g(options)f(in)i Fe(omniORB.cfg)p Fr(.)g(For)f(instance:)
30 2136 y Fd(#)50 b(omniORB)e(configuration)g(file)h(-)g(extra)g
(options)30 2236 y(#)30 2435 y(GATEKEEPER_ALLOWFILE)146
b(/project/omni/var/hosts.allow)30 2634 y(GATEKEEPER_DENYFILE)196
b(/project/omni/var/hosts.deny)171 2946 y Fr(As)28 b(each)g(policy)h
(module)e(is)i(implemented)e(as)h(a)h(separate)e(library)-10
b(,)31 b(the)c(choice)i(of)f(policy)30 3059 y(module)22
b(is)h(determined)d(at)j(pr)n(ogram)g(linkage)f(time.)171
3172 y(For)g(instance,)g(if)i(the)d(host-based)h(access)g(contr)n(ol)h
(module)f(is)g(in)i(use:)30 3371 y Fd(\045)50 b(eg1)f(-ORBtraceLevel)e
(2)30 3471 y(omniORB2)h(gateKeeper)g(is)i(tcpwrapGK)e(1.0)h(-)h(based)f
(on)g(tcp_wrappers_7.6)30 3571 y(I)h(said,"Hello!".)d(The)i(Object)g
(said,"Hello!")171 3783 y Fr(Wher)n(eas)22 b(if)h(the)f(dummy)g(module)
g(is)h(in)g(use:)30 3982 y Fd(\045)50 b(eg1)f(-ORBtraceLevel)e(2)30
4082 y(omniORB2)h(gateKeeper)g(is)i(not)f(installed.)f(All)h(incoming)f
(are)i(accepted.)30 4182 y(I)g(said,"Hello!".)d(The)i(Object)g
(said,"Hello!")p eop
%%Page: 61 67
61 66 bop 150 980 a Fl(Chapter)44 b(8)150 1397 y Fn(Proxy)52
b(Objects)150 1860 y Fr(When)27 b(a)i(client)g(acquir)n(es)f(a)h(r)n
(efer)n(ence)e(to)h(an)g(object)g(in)h(another)e(addr)n(ess)g(space,)i
(omniORB2)150 1973 y(cr)n(eates)i(a)g(local)i(r)n(epr)n(esentation)c
(of)i(the)g(object)g(and)g(r)n(eturns)f(a)i(pointer)e(to)g(this)h
(object)g(as)g(its)150 2086 y(object)22 b(r)n(efer)n(ence.)28
b(The)22 b(local)i(r)n(epr)n(esentation)c(is)j(known)f(as)g(the)g(pr)n
(oxy)g(object.)291 2201 y(The)30 b(pr)n(oxy)g(object)g(maps)h(each)g
(IDL)f(operation)g(into)g(a)i(method)d(to)h(deliver)h(invocations)150
2314 y(to)c(the)h(r)n(emote)f(object.)44 b(The)27 b(method)g
(implements)g(ar)n(gument)h(marshalling)i(using)d(the)g(ORB)150
2426 y(r)o(untime.)60 b(When)33 b(the)f(ORB)h(r)o(untime)g(detects)f
(an)h(err)n(or)g(condition,)i(it)f(may)g(raise)f(a)h(system)150
2539 y(exception.)45 b(These)28 b(exceptions)f(will)j(normally)g(be)f
(pr)n(opagated)e(by)i(the)f(pr)n(oxy)g(object)h(to)f(the)150
2652 y(application)f(code.)36 b(However)-7 b(,)25 b(ther)n(e)f(may)i
(be)g(applications)g(that)f(pr)n(efer)g(to)g(have)h(the)f(system)150
2765 y(exceptions)f(trapped)g(in)h(the)g(pr)n(oxy)g(object.)36
b(For)24 b(these)g(applications,)j(it)e(is)h(possible)e(to)h(install)
150 2878 y(exception)c(handlers)g(for)h(individual)i(pr)n(oxy)d(object)
h(or)g(all)h(pr)n(oxy)f(objects.)27 b(The)21 b(API)h(to)f(do)g(this)150
2991 y(will)j(be)e(explained)h(in)g(this)f(chapter)-7
b(.)291 3106 y(As)31 b(described)g(in)h(section)f(6.2,)k(pr)n(oxy)c
(objects)g(ar)n(e)h(cr)n(eated)f(by)h(instances)f(of)h(the)f(pr)n(oxy-)
150 3218 y(ObjectFactory)25 b(class.)35 b(For)24 b(each)i(IDL)e
(interface)i(A,)e(the)g(stubs)g(of)h(A)g(contains)g(a)h(derived)e
(class)150 3331 y(of)29 b(pr)n(oxyObjectFactory)e(\(A)p
1188 3331 28 4 v 33 w(pr)n(oxyObjectFactory\).)46 b(This)28
b(derived)g(class)h(is)g(r)n(esponsible)f(for)150 3444
y(cr)n(eating)34 b(pr)n(oxy)e(objects)h(for)h(A.)f(This)g(pr)n(ocess)f
(is)i(completely)e(transpar)n(ent)h(to)g(the)f(applica-)150
3557 y(tion.)k(However)-7 b(,)25 b(ther)n(e)g(may)h(be)f(applications)i
(that)e(r)n(equir)n(e)h(gr)n(eater)e(contr)n(ol)i(on)f(the)g(cr)n
(eation)150 3670 y(of)d(pr)n(oxy)f(objects)g(or)h(even)f(want)h(to)f
(change)h(the)f(behavior)h(of)g(the)f(pr)n(oxy)g(objects.)27
b(T)-8 b(o)21 b(cater)h(for)150 3783 y(this)28 b(r)n(equir)n(ement,)g
(applications)h(can)g(override)f(the)f(default)h(pr)n
(oxyObjectFactories)f(and)h(in-)150 3896 y(stall)23 b(their)e(own)h
(versions)f(of)h(pr)n(oxyObjectFactories.)k(The)c(way)g(to)f(do)g(this)
h(will)i(be)e(explained)150 4009 y(in)h(this)f(chapter)-7
b(.)150 4318 y Fj(8.1)119 b(System)30 b(Exception)g(Handlers)150
4532 y Fr(By)51 b(default,)60 b(all)54 b(system)c(exceptions,)58
b(with)52 b(the)f(exception)g(of)i(CORBA::TRANSIENT)-7
b(,)150 4645 y(ar)n(e)43 b(pr)n(opagated)e(by)i(the)f(pr)n(oxy)f
(objects)h(to)h(the)e(application)j(code.)87 b(Some)42
b(applications)150 4758 y(may)f(pr)n(efer)f(to)f(trap)i(these)d
(exceptions)h(within)i(the)e(pr)n(oxy)h(objects)g(so)f(that)i(the)e
(applica-)150 4871 y(tion)h(logic)i(does)d(not)h(have)h(to)f(deal)h
(with)g(the)f(err)n(or)g(condition.)82 b(For)40 b(example,)45
b(when)40 b(a)150 4984 y(CORBA::COMM)p 831 4984 V 33
w(F)-7 b(AILURE)26 b(is)i(r)n(eceived,)i(an)e(application)i(may)e(just)
g(want)g(to)g(r)n(etry)f(the)g(in-)150 5097 y(vocation)20
b(until)g(it)g(\002nally)h(succeeds.)k(This)20 b(appr)n(oach)g(is)g
(useful)f(for)h(objects)f(that)h(ar)n(e)g(persistent)150
5209 y(and)j(their)f(operations)f(ar)n(e)i(idempotent.)291
5324 y(OmniORB2)33 b(pr)n(ovides)e(a)i(set)e(of)h(functions)f(to)g
(install)i(exception)e(handlers.)55 b(Once)32 b(they)150
5437 y(ar)n(e)48 b(installed,)54 b(pr)n(oxy)47 b(objects)g(will)i(call)
g(these)d(handlers)i(when)f(the)f(tar)n(get)h(system)f(ex-)150
5550 y(ceptions)38 b(ar)n(e)i(raised)f(by)g(the)f(ORB)h(r)o(untime.)78
b(Exception)38 b(handlers)h(can)h(be)f(installed)g(for)1815
5778 y(61)p eop
%%Page: 62 68
62 67 bop 30 100 a Fr(62)2039 b Ff(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)30 356 y Fr(CORBA::TRANSIENT)-7
b(,)55 b(CORBA::COMM)p 1682 356 28 4 v 33 w(F)-7 b(AILURE)56
b(and)j(CORBA::SystemException.)30 469 y(The)26 b(last)g(handler)h
(covers)f(all)i(system)c(exceptions)h(other)g(than)i(the)e(two)h(cover)
n(ed)g(by)g(the)g(\002rst)30 582 y(two)e(handlers.)35
b(An)25 b(exception)f(handler)h(can)h(be)f(installed)h(for)f
(individual)i(pr)n(oxy)d(object)h(or)g(it)30 695 y(can)e(be)g
(installed)g(for)f(all)i(pr)n(oxy)e(objects)g(in)h(the)f(addr)n(ess)f
(space.)30 948 y Fi(8.1.1)99 b(CORBA::TRANSIENT)24 b(handlers)30
1125 y Fr(When)46 b(a)i(CORBA::TRANSIENT)43 b(exception)j(is)h(raised)g
(by)g(the)f(ORB)h(r)o(untime,)52 b(the)47 b(de-)30 1238
y(fault)k(behaviour)f(of)g(the)g(pr)n(oxy)f(objects)g(is)i(to)e(r)n
(etry)g(inde\002nitely)g(until)i(the)e(operation)30 1351
y(succeeds.)100 b(Successive)46 b(r)n(etries)h(will)h(be)f(delayed)f
(pr)n(ogr)n(essively)g(by)h(multiples)g(of)g Fe(om-)30
1463 y(niORB::defaultT)o(ra)o(ns)o(ie)o(ntR)o(et)o(ry)o(De)o(la)o(yIn)o
(cr)o(em)o(en)o(t)p Fr(.)54 b(The)33 b(delay)g(will)i(be)f(limited)30
1576 y(to)21 b(a)h(maximum)h(speci\002ed)e(by)g Fe(omniORB::default)o
(Tr)o(an)o(si)o(en)o(tRe)o(tr)o(yD)o(el)o(ay)o(Max)o(im)o(um)o
Fr(.)30 1689 y(The)h(unit)g(of)h(both)f(values)h(ar)n(e)g(in)g
(seconds.)171 1802 y(The)33 b(ORB)h(r)o(untime)g(will)i(raised)d
(CORBA::TRANSIENT)d(under)j(the)h(following)g(condi-)30
1915 y(tions:)144 2118 y(1.)45 b(When)20 b(a)g Fm(cached)h
Fr(network)d(connection)i(is)g(br)n(oken)g(while)g(an)h(invocation)g
(is)f(in)g(pr)n(ogr)n(ess.)257 2231 y(The)i(ORB)h(will)h(try)d(to)h
(open)g(a)h(new)f(connection)g(at)h(the)f(next)f(invocation.)144
2415 y(2.)45 b(When)32 b(the)f(pr)n(oxy)g(object)h(has)g(been)g(r)n
(edir)n(ected)f(by)h(a)h(location)f(forwar)n(d)g(message)f(by)257
2528 y(the)23 b(r)n(emote)g(object)h(to)f(a)i(new)e(location)i(and)e
(the)h(object)f(at)h(the)f(new)h(location)g(cannot)g(be)257
2641 y(contacted.)38 b(In)25 b(addition)h(to)g(the)f(CORBA::TRANSIENT)d
(exception,)k(the)f(pr)n(oxy)g(object)257 2754 y(also)33
b(r)n(esets)e(its)i(internal)g(state)f(so)g(that)g(the)h(next)e
(invocation)j(will)g(be)f(dir)n(ected)f(at)h(the)257
2867 y(original)24 b(location)f(of)g(the)f(r)n(emote)f(object.)144
3052 y(3.)45 b(When)22 b(the)g(r)n(emote)g(object)g(r)n(eports)f
(CORBA::TRANSIENT)-7 b(.)171 3255 y(Applications)23 b(can)h(override)d
(the)h(default)h(behaviour)g(by)g(installing)h(their)e(own)g(exception)
30 3368 y(handler)-7 b(.)28 b(The)22 b(API)g(to)g(do)g(so)g(is)g
(summarised)g(below:)30 3657 y Fd(class)49 b(omniORB)f({)30
3856 y(public:)30 4055 y(typedef)g(CORBA::Boolean)g
(\(*transientExceptionHandler_t\)\(voi)o(d*)c(cookie,)2421
4155 y(CORBA::ULong)k(n_retries,)2421 4255 y(const)h(CORBA::TRANSIENT&)
e(ex\);)30 4454 y(static)i(void)g(installTransientExceptionHandler\(v)o
(oid*)43 b(cookie,)2272 4554 y(transientExceptionHan-)30
4653 y(dler_t)49 b(fn\);)30 4852 y(static)g(void)g
(installTransientExceptionHandler\(C)o(ORBA:)o(:Objec)o(t_ptr)43
b(obj,)2272 4952 y(void*)48 b(cookie,)2272 5052 y
(transientExceptionHan-)30 5151 y(dler_t)h(fn\);)30 5351
y(static)g(CORBA::ULong)e(defaultTransientRetryDelayIncrement;)30
5450 y(static)i(CORBA::ULong)e(defaultTransientRetryDelayMaximum;)p
eop
%%Page: 63 69
63 68 bop 150 100 a Ff(8.1.)51 b(SYSTEM)21 b(EXCEPTION)h(HANDLERS)1704
b Fr(63)150 356 y Fd(})291 661 y Fr(The)20 b(overloaded)f(functions)i
Fe(installTransie)o(nt)o(Ex)o(ce)o(pti)o(on)o(Ha)o(nd)o(le)o(r)15
b Fr(can)21 b(be)g(used)150 774 y(to)h(install)i(the)d(exception)h
(handlers)g(for)g(CORBA::TRANSIENT)-7 b(.)291 887 y(T)f(wo)18
b(overloaded)g(forms)h(ar)n(e)h(available.)30 b(The)18
b(\002rst)h(form)g(install)h(an)g(exception)e(handler)h(for)150
1000 y(all)k(object)e(r)n(efer)n(ences)g(except)f(for)h(those)f(which)i
(have)g(an)g(exception)f(handler)g(installed)g(by)h(the)150
1113 y(second)e(form,)h(which)h(takes)e(an)i(addition)e(ar)n(gument)h
(to)g(identify)f(the)h(tar)n(get)f(object)h(r)n(efer)n(ence.)150
1226 y(The)d(ar)n(gument)g Fe(cookie)d Fr(is)k(an)g(opaque)e(pointer)h
(which)h(will)g(be)g(passed)e(on)h(by)g(the)g(ORB)g(when)150
1339 y(it)23 b(calls)h(the)e(exception)f(handler)-7 b(.)291
1452 y(An)29 b(exception)e(handler)i(will)h(be)f(called)g(by)g(pr)n
(oxy)f(objects)g(with)h(thr)n(ee)e(ar)n(guments.)46 b(The)150
1565 y Fe(cookie)30 b Fr(is)i(the)g(opaque)f(pointer)g(r)n(egister)n
(ed)g(by)h Fe(installTransien)o(tE)o(xce)o(pt)o(io)o(nH)o(an)o(-)150
1678 y(dler)p Fr(.)25 b(The)20 b(ar)n(gument)g Fe(n)p
1063 1678 28 4 v 32 w(retries)d Fr(is)k(the)e(number)i(of)f(times)g
(the)f(pr)n(oxy)h(has)g(called)h(this)f(han-)150 1791
y(dler)27 b(for)h(the)f(same)h(invocation.)44 b(The)27
b(ar)n(gument)g Fe(ex)g Fr(is)h(the)f(value)h(of)g(the)f(exception)g
(caught.)150 1903 y(The)17 b(exception)g(handler)h(is)g(expected)e(to)h
(do)h(whatever)f(is)h(appr)n(opriate)g(and)g(r)n(eturns)e(a)j(boolean)
150 2016 y(value.)27 b(If)19 b(the)e(r)n(eturn)h(value)h(is)g
(TRUE\(1\),)g(the)e(pr)n(oxy)h(object)g(would)g(r)n(etry)f(the)h
(operation)f(again.)150 2129 y(If)23 b(the)g(r)n(eturn)f(value)j(is)e
(F)-7 b(ALSE\(0\),)23 b(the)f(CORBA::TRANSIENT)e(exception)i(would)h
(be)g(pr)n(opa-)150 2242 y(gated)e(into)i(the)f(application)h(code.)291
2355 y(The)j(following)h(sample)f(code)g(installs)h(a)g(simple)f
(exception)g(handler)g(for)g(all)i(objects)e(and)150
2468 y(for)d(a)g(speci\002c)f(object:)150 2760 y Fd(CORBA::Boolean)47
b(my_transient_handler1)f(\(void*)j(cookie,)2043 2860
y(CORBA::ULong)e(retries,)2043 2960 y(const)i(CORBA::TRANSIENT&)d(ex\))
150 3059 y({)299 3159 y(cerr)k(<<)f(''transient)f(handler)g(1)i
(called.'')e(<<)h(endl;)299 3258 y(return)g(1;)548 b(//)49
b(retry)g(immediately.)150 3358 y(})150 3557 y(CORBA::Boolean)e
(my_transient_handler2)f(\(void*)j(cookie,)2043 3657
y(CORBA::ULong)e(retries,)2043 3757 y(const)i(CORBA::TRANSIENT&)d(ex\))
150 3856 y({)299 3956 y(cerr)k(<<)f(''transient)f(handler)g(2)i
(called.'')e(<<)h(endl;)299 4055 y(return)g(1;)548 b(//)49
b(retry)g(immediately.)150 4155 y(})150 4454 y(static)g(Echo_ptr)f
(myobj;)150 4653 y(void)h(installhandlers\(\))150 4753
y({)299 4852 y(omniORB::installTransientExceptionHand)o(ler\(0)o(,my_t)
o(ransie)o(nt_ha)o(ndler)o(1\);)299 4952 y(//)h(All)f(proxy)g(objects)g
(will)g(call)g(my_transient_handler1)d(from)j(now)g(on.)299
5151 y(omniORB::installTransientExceptionHand)o(ler\(m)o(yobj,)o
(0,my_t)o(ransi)o(ent_h)o(andler)o(2\);)299 5251 y(//)h(The)f(proxy)g
(object)g(of)g(myobj)g(will)g(call)g(my_transient_handler2)d(from)j
(now)g(on.)150 5351 y(})p eop
%%Page: 64 70
64 69 bop 30 100 a Fr(64)2039 b Ff(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)30 356 y Fi(8.1.2)99 b(CORBA::COMM)p
1111 356 30 4 v 35 w(F)-5 b(AILURE)30 533 y Fr(When)17
b(the)g(ORB)g(r)o(untime)h(fails)h(to)e(establish)g(a)h(network)e
(connection)h(to)g(the)g(r)n(emote)g(object)g(and)30
646 y(none)26 b(of)h(the)f(conditions)g(listed)g(above)i(for)e(raising)
i(a)f(CORBA::TRANSIENT)d(is)j(applicable,)30 759 y(it)c(raises)f(a)h
(CORBA::COMM)p 1109 759 28 4 v 33 w(F)-7 b(AILURE)21
b(exception.)171 872 y(The)32 b(default)g(behaviour)h(of)f(the)g(pr)n
(oxy)f(objects)h(is)h(to)f(pr)n(opagate)f(this)h(exception)f(to)h(the)
30 984 y(application.)171 1097 y(Applications)23 b(can)h(override)d
(the)h(default)h(behaviour)g(by)g(installing)h(their)e(own)g(exception)
30 1210 y(handlers.)27 b(The)22 b(API)g(to)g(do)g(so)g(is)h(summarised)
f(below:)30 1495 y Fd(class)49 b(omniORB)f({)30 1695
y(public:)30 1894 y(typedef)g(CORBA::Boolean)g
(\(*commFailureExceptionHan-)30 1993 y(dler_t\)\(void*)f(cookie,)2421
2093 y(CORBA::ULong)h(n_retries,)2421 2193 y(const)h
(CORBA::COMM_FAILURE&)d(ex\);)30 2392 y(static)j(void)g
(installCommFailureExceptionHandler)o(\(void)o(*)44 b(cookie,)2272
2492 y(commFailureException-)30 2591 y(Handler_t)k(fn\);)30
2790 y(static)h(void)g(installCommFailureExceptionHandler)o(\(CORB)o
(A::Obj)o(ect_p)o(tr)44 b(obj,)2272 2890 y(void*)k(cookie,)2272
2990 y(commFailureExceptionHandler_t)2272 3089 y(fn\);)30
3189 y(})171 3388 y Fr(The)22 b(functions)g(ar)n(e)h(equivalent)g(to)f
(their)g(counterparts)f(for)i(CORBA::TRANSIENT)-7 b(.)30
3640 y Fi(8.1.3)99 b(CORBA::SystemException)30 3817 y
Fr(T)-8 b(o)26 b(r)n(eport)g(an)i(err)n(or)f(condition,)h(the)e(ORB)h
(r)o(untime)h(may)f(raise)h(other)e(SystemExceptions.)38
b(If)30 3930 y(the)17 b(exception)g(is)i(neither)e(CORBA::TRANISENT)e
(nor)i(CORBA::COMM)p 2719 3930 V 33 w(F)-7 b(AILURE,)16
b(the)i(de-)30 4043 y(fault)23 b(behaviour)g(of)g(the)f(pr)n(oxy)g
(objects)g(is)g(to)g(pr)n(opagate)g(this)g(exception)f(to)h(the)g
(application.)171 4156 y(Application)27 b(can)h(override)d(the)h
(default)h(behaviour)g(by)f(installing)i(their)e(own)g(exception)30
4269 y(handlers.)h(The)22 b(API)g(to)g(do)g(so)g(is)h(summarised)f
(below:)30 4554 y Fd(class)49 b(omniORB)f({)30 4753 y(public:)30
4952 y(typedef)g(CORBA::Boolean)g(\(*systemExceptionHandler_t\)\(void*)
43 b(cookie,)2222 5052 y(CORBA::ULong)k(n_retries,)2222
5151 y(const)i(CORBA::SystemException&)c(ex\);)30 5351
y(static)k(void)g(installSystemExceptionHandler\(void)o(*)44
b(cookie,)2122 5450 y(systemExceptionHan-)30 5550 y(dler_t)49
b(fn\);)p eop
%%Page: 65 71
65 70 bop 150 100 a Ff(8.2.)51 b(PROXY)22 b(OBJECT)h(F)-7
b(ACT)n(ORIES)1955 b Fr(65)150 456 y Fd(static)49 b(void)g
(installSystemExceptionHandler\(CORB)o(A::Ob)o(ject_p)o(tr)44
b(obj,)2242 555 y(void*)49 b(cookie,)2242 655 y(systemExceptionHan-)150
754 y(dler_t)g(fn\);)150 854 y(})291 1073 y Fr(The)22
b(functions)g(ar)n(e)h(equivalent)g(to)f(their)g(counterparts)f(for)i
(CORBA::TRANSIENT)-7 b(.)150 1379 y Fj(8.2)119 b(Proxy)30
b(Object)f(Factories)150 1593 y Fr(This)f(section)g(describes)f(how)h
(an)h(application)h(can)f(contr)n(ol)g(the)f(cr)n(eation)h(or)f(change)
g(the)g(be-)150 1706 y(haviour)23 b(of)g(pr)n(oxy)f(objects.)150
1968 y Fi(8.2.1)99 b(Background)150 2148 y Fr(For)126
b(each)i(interface)f(A,)g(its)g(stub)g(contains)g(a)h(pr)n(oxy)e
(factory)h(class-)150 2261 y Fe(A)p 210 2261 28 4 v 32
w(proxyObjectFact)o(ory)o Fr(.)c(This)56 b(class)h(is)g(derived)e(fr)n
(om)i Fe(proxyObjectFact)o(or)o(y)150 2374 y Fr(and)23
b(implements)f(thr)n(ee)f(virtual)j(functions:)150 2680
y Fd(class)49 b(A_proxyObjectFactory)d(:)k(public)e(virtual)h
(proxyObjectFactory)d({)150 2780 y(public:)250 2979 y(virtual)i(const)h
(char)g(*irRepoId\(\))f(const;)250 3178 y(virtual)g(_CORBA_Boolean)97
b(is_a\(const)48 b(char)h(*base_repoId\))f(const;)250
3377 y(virtual)g(CORBA::Object_ptr)f(newProxyObject\(Rope)f(*r,)2292
3477 y(CORBA::Octet)i(*key,)2292 3577 y(size_t)h(keysize,)2292
3676 y(IOP::TaggedProfileList)2292 3776 y(*profiles,)2292
3875 y(CORBA::Boolean)e(release\);)150 4075 y(};)291
4393 y Fr(As)29 b(described)e(in)j(chapter)e(6,)j(the)d(functions)h
(allow)h(the)e(ORB)h(r)o(untime)g(to)f(perform)h(type)150
4506 y(checking.)49 b(The)29 b(function)h Fe(newProxyObject)23
b Fr(cr)n(eates)30 b(a)g(pr)n(oxy)f(object)g(for)h(A)g(based)f(on)g
(its)150 4619 y(input)k(ar)n(guments.)58 b(The)32 b(r)n(eturn)g(value)i
(is)f(a)g(pointer)f(to)g(the)h(class)p 2639 4619 V 66
w Fe(proxy)p 2947 4619 V 30 w(A)g Fr(which)g(is)g(au-)150
4732 y(tomatically)d(r)n(e-casted)e(into)g(a)h Fe(CORBA::Object)p
2000 4732 V 26 w(ptr)p Fr(.)p 2259 4732 V 77 w Fe(proxy)p
2566 4732 V 31 w(A)f Fr(implements)f(the)h(pr)n(oxy)150
4845 y(object)22 b(for)h(A:)150 5052 y Fd(class)49 b(_proxy_A)f(:)100
b(public)48 b(virtual)h(A)g({)150 5151 y(public:)250
5351 y(_proxy_A)f(\(Rope)h(*r,)748 5450 y(CORBA::Octet)e(*key,)748
5550 y(size_t)h(keysize,IOP::TaggedProfileList)d(*profiles,)p
eop
%%Page: 66 72
66 71 bop 30 100 a Fr(66)2039 b Ff(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)628 356 y Fd(CORBA::Boolean)47 b(release\);)130
456 y(virtual)h(\230_proxy_A\(\);)130 655 y(//)h(plus)g(other)g
(internal)f(functions.)30 854 y(};)171 1062 y Fr(The)28
b(stub)h(of)g(A)g(guarantees)e(that)i(exactly)g Fm(one)g
Fr(instance)g(of)g Fe(A)p 2441 1062 28 4 v 32 w(proxyObjectFact)o(or)o
(y)30 1175 y Fr(is)92 b(instantiated)f(when)f(an)j(application)f(is)g
(executed.)233 b(The)91 b(constr)o(uctor)f(of)30 1288
y Fe(A)p 90 1288 V 32 w(proxyObjectFact)o(ory)o Fr(,)65
b(via)e(its)e(base)g(class)h Fe(proxyObjectFact)o(or)o(y)55
b Fr(links)62 b(the)30 1401 y(instance)23 b(into)f(the)g(ORB's)g(pr)n
(oxy)g(factory)g(list.)171 1514 y(Newly)33 b(instantiated)g(pr)n(oxy)g
(object)h(factories)g(ar)n(e)g(always)g(enter)n(ed)e(at)i(the)f(fr)n
(ont)h(of)g(the)30 1627 y(ORB's)41 b(pr)n(oxy)f(factory)h(list.)83
b(Mor)n(eover)-7 b(,)45 b(when)40 b(the)h(ORB)f(sear)n(ches)h(for)g(a)g
(match)h(on)f(the)30 1740 y(type,)34 b(it)f(always)g(stops)e(at)i(the)f
(\002rst)g(match.)59 b(In)32 b(other)g(wor)n(ds,)i(when)e(additional)i
(instances)30 1853 y(of)23 b Fe(A)p 193 1853 V 32 w(proxyObjectFacto)o
(ry)16 b Fr(or)23 b(derived)f(classes)h(of)g(it)g(ar)n(e)h(cr)n(eated,)
e(the)h(last)g(instantiation)30 1966 y(will)h(override)e(earlier)i
(instantiations)e(to)h(be)g(the)f(pr)n(oxy)g(factory)h(selected)e(to)i
(cr)n(eate)g(pr)n(oxy)f(ob-)30 2079 y(jects)i(of)h(A.)g(This)g(pr)n
(operty)e(can)j(be)e(used)g(by)h(an)g(application)i(to)d(install)i(its)
f(own)f(pr)n(oxy)g(object)30 2192 y(factories.)30 2446
y Fi(8.2.2)99 b(An)24 b(Example)30 2622 y Fr(Using)e(the)g
Fe(Echo)e Fr(example)j(in)g(chapter)f(2)h(as)g(the)f(basis,)g(one)g
(can)h(tell)g(the)f(ORB)g(to)g(use)g(a)h(modi-)30 2735
y(\002ed)f(pr)n(oxy)g(object)g(class)h(to)f(cr)n(eate)h(pr)n(oxy)e
(objects.)28 b(The)21 b(steps)g(involved)i(ar)n(e)g(as)g(follows:)30
2986 y Fm(8.2.2.1)92 b(De\002ne)22 b(a)i(new)e(proxy)g(class)30
3163 y Fr(W)-8 b(e)21 b(de\002ne)f(a)i(new)f(pr)n(oxy)g(class)h(to)f
(cache)h(the)f(r)n(esult)g(of)h(the)f(last)h(invocation)g(of)g
Fe(echoString)p Fr(.)30 3358 y Fd(class)49 b(_new_proxy_Echo)e(:)j
(public)e(virtual)h(_proxy_Echo)e({)30 3458 y(public:)130
3557 y(_new_proxy_Echo)g(\(Rope)i(*r,)927 3657 y(CORBA::Octet)e(*key,)
927 3757 y(size_t)h(keysize,IOP::TaggedProfileList)d(*profiles,)927
3856 y(CORBA::Boolean)i(release\))478 3956 y(:)j
(_proxy_Echo\(r,key,keysize,profiles,)o(relea)o(se\),)578
4055 y(omniObject\(Echo_IntfRepoID,r,key,ke)o(ysize)o(,profi)o(les,r)o
(eleas)o(e\))179 4155 y({)279 4255 y(//)f(You)h(have)f(to)g(look)g(at)h
(the)f(_proxy_Echo)f(class)h(and)g(copy)g(from)g(its)279
4354 y(//)g(ctor)h(all)f(the)g(explicit)f(ctor)h(calls)g(to)h(its)f
(base)g(member.)179 4454 y(})179 4554 y(virtual)g
(\230_new_proxy_Echo\(\))d({})179 4852 y(virtual)j(char*)g
(echoString\(const)e(char*)i(mesg\))f({)279 4952 y(//)279
5052 y(//)h(Only)h(calls)e(the)i(remote)e(object)h(if)h(the)f(argument)
f(is)i(differ-)30 5151 y(ent)f(from)g(the)279 5251 y(//)g(last)h
(invocation.)279 5450 y(omni_mutex_lock)d(sync\(lock\);)279
5550 y(if)i(\(\(char*\)last_arg\))e({)p eop
%%Page: 67 73
67 72 bop 150 100 a Ff(8.2.)51 b(PROXY)22 b(OBJECT)h(F)-7
b(ACT)n(ORIES)1955 b Fr(67)499 356 y Fd(if)49 b
(\(strcmp\(mesg,\(char*\)last_arg\))c(==)k(0\))g({)648
456 y(return)g(CORBA::string_dup\(last_result\);)499
555 y(})399 655 y(})399 754 y(char*)g(res)g(=)h
(_proxy_Echo::echoString\(mesg\);)399 854 y(last_arg)e(=)i(mesg;)399
954 y(last_result)e(=)h(\(const)g(char*\))g(res;)399
1053 y(return)g(res;)299 1153 y(})150 1352 y(private:)250
1452 y(omni_mutex)396 b(lock;)250 1551 y(CORBA::String_var)46
b(last_arg;)250 1651 y(CORBA::String_var)g(last_result;)150
1751 y(};)150 2013 y Fm(8.2.2.2)92 b(De\002ne)22 b(a)i(new)e(proxy)g
(factory)i(class)150 2193 y Fr(Next,)j(we)g(de\002ne)g(a)h(new)f(pr)n
(oxy)g(factory)g(class)h(to)f(instantiate)p 2447 2193
28 4 v 61 w Fe(new)p 2645 2193 V 31 w(proxy)p 2951 2193
V 30 w(Echo)f Fr(as)i(pr)n(oxy)150 2306 y(objects)22
b(for)h Fe(Echo)p Fr(.)150 2516 y Fd(class)49 b
(_new_Echo_proxyObjectFactory)44 b(:)50 b(public)f(vir-)150
2615 y(tual)g(Echo_proxyObjectFactory)150 2715 y({)150
2814 y(public:)299 2914 y(_new_Echo_proxyObjectFactory)c(\(\))k({})299
3014 y(virtual)g(\230_new_Echo_proxyObjectFactory\(\))44
b({})299 3213 y(//)50 b(Only)f(have)g(to)g(override)g(newProxyObject)
299 3313 y(virtual)g(CORBA::Object_ptr)e(newProxyObject\(Rope)f(*r,)
2342 3412 y(CORBA::Octet)h(*key,)2342 3512 y(size_t)h(keysize,)2342
3611 y(IOP::TaggedProfileList)d(*pro-)150 3711 y(files,)2342
3811 y(CORBA::Boolean)i(re-)150 3910 y(lease\))i({)449
4010 y(_new_proxy_Echo)e(*p)i(=)h(new)f
(_new_proxy_Echo\(r,key,keysize,profil)o(es,rel)o(ease\))o(;)449
4110 y(return)g(p;)299 4209 y(})150 4309 y(};)291 4530
y Fr(Finally)-10 b(,)36 b(we)c(have)h(to)f(instantiate)g(a)h(single)f
(instance)h(of)f(the)g(new)g(pr)n(oxy)f(factory)i(in)g(the)150
4643 y(application)24 b(code.)150 4852 y Fd(int)49 b(main\(int)g(argc,)
f(char**)h(argv\))150 4952 y({)299 5052 y(//)h(Other)f(initialisation)e
(steps)299 5251 y(_new_Echo_proxyObjectFactory*)e(f)k(=)100
b(new)49 b(_new_Echo_proxyObjectFactory;)299 5450 y(//)h(Use)f(the)g
(new)h(operator)e(to)h(instantiate)f(the)h(proxy)g(fac-)150
5550 y(tory)g(and)g(never)p eop
%%Page: 68 74
68 73 bop 30 100 a Fr(68)2039 b Ff(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)179 356 y Fd(//)50 b(call)f(the)g(delete)g
(operator)f(on)i(this)f(instance.)179 555 y(//)h(From)f(this)g(point)g
(onwards,)f(_new_proxy_Echo)f(will)i(be)h(used)f(to)g(create)179
655 y(//)h(proxy)f(objects)f(for)i(Echo.)30 854 y(})30
1109 y Fi(8.2.3)99 b(Further)24 b(Considerations)30 1286
y Fr(Notice)17 b(that)h(the)g(ORB)g(may)g(call)i Fe(newProxyObject)12
b Fr(multiple)18 b(times)g(to)f(cr)n(eate)i(pr)n(oxy)e(objects)30
1399 y(for)33 b(the)f(same)g(r)n(emote)g(object.)58 b(In)32
b(other)g(wor)n(ds,)i(the)e(ORB)g(does)f(not)h(guarantee)g(that)g(only)
30 1512 y(one)c(pr)n(oxy)f(object)i(is)f(cr)n(eated)g(for)h(each)g(r)n
(emote)e(object.)46 b(For)27 b(applications)j(that)e(r)n(equir)n(e)g
(this)30 1624 y(guarantee,)f(it)g(is)g(necessary)f(to)g(check)h(within)
g Fe(newProxyObject)21 b Fr(whether)26 b(a)h(pr)n(oxy)f(object)30
1737 y(has)34 b(alr)n(eady)g(been)f(cr)n(eated)h(for)g(the)f(curr)n
(ent)g(r)n(equest.)60 b(If)34 b(the)f(ar)n(gument)g Fe(Rope*)53
b(r)33 b Fr(points)30 1850 y(to)e(the)f(same)h(str)o(uctur)n(e)f(and)h
(the)f(content)g(of)h(the)g(sequence)e Fe(CORBA::Octet*)49
b(key)30 b Fr(is)h(the)30 1963 y(same,)24 b(then)g(an)g(existing)g(pr)n
(oxy)f(object)h(can)h(be)f(r)n(eturned)f(to)g(satisfy)h(the)f(curr)n
(ent)h(r)n(equest.)31 b(Do)30 2076 y(not)22 b(for)n(get)g(to)g(call)i
Fe(CORBA::duplicat)o(e\()o(\))17 b Fr(befor)n(e)22 b(r)n(eturning)g
(the)f(object)i(r)n(efer)n(ence.)171 2189 y Fe(newProxyObject)34
b Fr(may)40 b(be)g(called)h(concurr)n(ently)e(by)h(dif)n(fer)n(ent)g
(thr)n(eads)f(within)h(the)30 2302 y(ORB.)22 b(Needless)e(to)i(say)-10
b(,)22 b(the)g(function)h(must)f(be)g(thr)n(ead-safe.)p
eop
%%Page: 69 75
69 74 bop 150 980 a Fl(Chapter)44 b(9)150 1397 y Fn(T)-19
b(ype)52 b(Any)g(and)g(T)-19 b(ypeCode)150 1860 y Fr(The)32
b(CORBA)h(speci\002cation)h(pr)n(ovides)e(for)h(a)g(type)f(that)g(can)i
(hold)f(the)f(value)i(of)f(any)g(OMG)150 1973 y(IDL)26
b(type.)39 b(This)27 b(type)e(is)i(known)f(as)h(type)e(Any)-10
b(.)40 b(The)26 b(OMG)i(also)f(speci\002es)e(a)j(pseudo-object,)150
2086 y(T)-8 b(ypeCode,)20 b(that)i(can)i(encode)d(a)i(description)f(of)
g(any)h(type)e(speci\002able)i(in)g(OMG)h(IDL.)291 2200
y(In)h(this)h(chapter)-7 b(,)26 b(an)g(example)f(demonstrating)f(the)h
(use)f(of)i(type)e(Any)h(is)g(pr)n(esented.)34 b(This)150
2313 y(is)c(followed)f(by)g(sections)f(describing)h(the)g(behaviour)h
(of)g(type)d(Any)i(and)h(T)-8 b(ypeCode)27 b(in)j(om-)150
2426 y(niORB2.)e(For)19 b(further)h(information)h(on)e(type)g(Any)-10
b(,)20 b(r)n(efer)g(to)g(the)f(C++)i(Mapping)f(section)g(of)g(the)150
2539 y(CORBA)e(2)g(speci\002cation)g([OMG96a)s(],)h(and)f(for)f(mor)n
(e)h(information)h(on)e(T)-8 b(ypeCode,)16 b(r)n(efer)i(to)f(the)150
2652 y(Interface)j(Repository)e(chapter)i(in)h(the)f(CORBA)h(cor)n(e)f
(section)g(of)h(the)e(CORBA)i(2)g(speci\002cation.)150
2960 y Fj(9.1)119 b(Example)29 b(using)i(type)f(Any)150
3174 y Fr(Befor)n(e)i(going)g(thr)n(ough)g(this)h(example,)j(you)c
(should)g(make)h(sur)n(e)f(that)h(you)g(have)g(r)n(ead)g(and)150
3287 y(understood)24 b(the)j(examples)f(in)i(chapter)f(2.)43
b(The)26 b(sour)n(ce)h(code)f(for)i(this)f(example)g(is)g(included)150
3400 y(in)g(the)f(omniORB2)h(distribution,)f(in)h(the)f(dir)n(ectory)f
(sr)n(c/examples/anyExample.)39 b(A)26 b(listing)150
3513 y(of)d(the)e(sour)n(ce)h(code)g(is)h(pr)n(ovided)f(at)g(the)g(end)
g(of)h(this)f(chapter)-7 b(.)150 3777 y Fi(9.1.1)99 b(T)-9
b(ype)25 b(Any)g(in)g(IDL)150 3944 y Fr(T)-8 b(ype)33
b(Any)i(allows)g(one)f(to)g(delay)h(the)f(decision)h(on)f(the)g(type)g
(used)f(in)i(an)h(operation)e(until)150 4043 y(r)o(un-time.)28
b(T)-8 b(o)22 b(use)f(type)g(any)i(in)g(IDL,)f(use)g(the)g(keywor)n(d)e
Fe(any)p Fr(,)h(as)i(in)g(the)f(following)h(example:)150
4325 y Fd(//)49 b(IDL)150 4524 y(interface)f(anyExample)g({)250
4624 y(any)h(testOp\(in)f(any)h(mesg\);)150 4724 y(};)291
5017 y Fr(The)29 b(operation)f Fe(testOp\(\))d Fr(in)30
b(this)f(example)g(can)h(now)f(take)f(any)i(value)g(expr)n(essible)e
(in)150 5130 y(OMG)c(IDL)e(as)h(an)g(ar)n(gument,)f(and)g(can)i(also)e
(r)n(eturn)g(any)h(type)e(expr)n(essible)g(in)j(OMG)f(IDL.)291
5244 y(T)-8 b(ype)20 b(Any)g(is)i(mapped)e(into)h(C++)h(as)f(the)g
(type)e Fe(CORBA::Any)p Fr(.)k(When)e(passed)f(as)h(an)h(ar)n(gu-)150
5357 y(ment)g(or)g(as)h(a)g(r)n(esult)f(of)h(an)g(operation,)e(the)h
(following)h(r)o(ules)f(apply:)341 5463 y Fa(In)863 b(InOut)417
b(Out)599 b(Return)p 291 5496 3039 4 v 341 5566 a Fd(const)49
b(CORBA::Any&)97 b(CORBA::Any&)h(CORBA::Any*&)147 b(CORBA::Any*)1815
5778 y Fr(69)p eop
%%Page: 70 76
70 75 bop 30 100 a Fr(70)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)171 356 y Fr(So,)g(the)g(above)h(IDL)f
(would)g(map)h(to)f(the)g(following)h(C++)30 756 y Fd(//)49
b(C++)30 955 y(class)g(anyExample_i)e(:)j(public)f(virtual)f
(_sk_anyExample)f({)30 1055 y(public:)130 1155 y(anyExample_i\(\))g({)i
(})130 1254 y(virtual)f(\230anyExample_i\(\))f({)j(})130
1354 y(virtual)e(CORBA::Any*)g(testOp\(const)f(CORBA::Any&)h(a\);)30
1454 y(};)30 1912 y Fi(9.1.2)99 b(Inserting)25 b(and)f(Extracting)h
(Basic)h(T)-9 b(ypes)26 b(from)e(an)h(Any)30 2123 y Fr(The)20
b(question)f(now)i(arises)f(as)h(to)f(how)g(values)h(ar)n(e)g(inserted)
e(into)i(and)g(r)n(emoved)f(fr)n(om)h(an)g(Any)-10 b(.)30
2236 y(This)22 b(is)h(achieved)g(using)f(two)g(overloaded)f(operators:)
26 b Fe(<<=)53 b(and)g(>>=)h Fr(.)171 2365 y(T)-8 b(wo)22
b(insert)g(a)h(value)g(into)f(an)i(Any)-10 b(,)21 b(the)h
Fe(<<=)53 b Fr(operator)21 b(is)i(used,)e(as)i(in)g(this)f(example:)30
2765 y Fd(//)49 b(C++)30 2965 y(CORBA::Any)f(an_any;)30
3064 y(CORBA::Long)g(l)h(=)h(100;)30 3164 y(an_any)f(<<=)g(l;)171
3561 y Fr(Note)21 b(that)i(the)e(overloaded)h Fe(<<=)53
b Fr(operator)21 b(has)i(a)g(r)n(eturn)f(type)f(of)h
Fe(void)p Fr(.)171 3690 y(T)-8 b(o)29 b(extract)g(a)h(value,)i(the)d
Fe(>>=)53 b Fr(operator)28 b(is)i(used,)f(as)h(in)g(this)f(example)h
(\(wher)n(e)f(the)g(Any)30 3803 y(contains)23 b(a)g(long\):)30
4203 y Fd(//)49 b(C++)30 4403 y(CORBA::Long)f(l;)30 4502
y(an_any)h(>>=)g(l;)30 4702 y(cout)g(<<)g("This)g(is)h(a)f(long:)g(")h
(<<)f(l)h(<<)f(endl;)171 5098 y Fr(The)27 b(overloaded)g
Fe(>>=)53 b Fr(operator)27 b(r)n(eturns)f(a)j(CORBA::Boolean.)42
b(If)28 b(an)g(attempt)f(is)h(made)30 5211 y(to)e(extract)h(a)g(value)h
(fr)n(om)f(an)h(Any)e(when)g(it)h(contains)g(a)g(dif)n(fer)n(ent)g
(value)h(\(e.g.)40 b(an)27 b(attempt)f(to)30 5324 y(extract)i(a)i(long)
f(fr)n(om)g(an)g(Any)g(containing)g(a)h(double\),)f(the)g(overloaded)e
Fe(>>=)53 b Fr(operator)28 b(will)30 5437 y(r)n(eturn)i(False;)35
b(otherwise)29 b(it)i(will)i(r)n(eturn)d(T)-8 b(r)o(ue.)52
b(Thus,)32 b(a)g(common)f(tactic)h(to)e(extract)h(values)30
5550 y(fr)n(om)23 b(an)g(Any)f(is)h(as)g(follows:)p eop
%%Page: 71 77
71 76 bop 150 100 a Ff(9.1.)51 b(EXAMPLE)21 b(USING)h(TYPE)f(ANY)1906
b Fr(71)150 456 y Fd(//)49 b(C++)150 754 y(CORBA::Long)f(l;)150
854 y(CORBA::Double)f(d;)150 954 y(char*)i(str;)150 1153
y(if)g(\(an_any)g(>>=)g(l\))h({)349 1253 y(cout)f(<<)h("Long:)e(")i(<<)
g(l)f(<<)h(endl;)150 1352 y(})150 1452 y(else)f(if)h(\(an_any)e(>>=)h
(d\))h({)349 1551 y(cout)f(<<)h("Double:)e(")i(<<)f(d)h(<<)f(endl;)150
1651 y(})150 1751 y(else)g(if)h(\(an_any)e(>>=)h(str\))g({)349
1850 y(cout)g(<<)h("String:)e(")i(<<)f(str)g(<<)h(endl;)150
1950 y(})150 2050 y(else)f({)349 2149 y(cout)g(<<)h("Unknown)e(value.")
h(<<)g(endl;)150 2249 y(})150 2599 y Fi(9.1.3)99 b(Inserting)25
b(and)f(Extracting)h(Constructed)h(T)-9 b(ypes)25 b(from)g(an)f(Any)150
2776 y Fr(It)d(is)g(also)h(possible)f(to)f(insert)h(and)g(extract)g
(constr)o(ucted)f(types)g(and)h(object)g(r)n(efer)n(ences)g(fr)n(om)h
(an)150 2888 y(Any)-10 b(.)34 b Fe(omniidl2)51 b Fr(will)27
b(generate)c(insertion)h(and)h(extraction)g(operators)e(for)i(the)f
(constr)o(ucted)150 3001 y(type.)60 b(Note)32 b(that)h(it)h(is)g
(necessary)e(to)h(specify)g(the)g Fe(-a)g Fr(command-line)i(\003ag)f
(when)f(r)o(unning)150 3114 y(omniidl2)c(in)f(or)n(der)e(to)h(generate)
e(these)h(operators.)40 b(The)27 b(following)h(example)f(illustrates)g
(the)150 3227 y(use)22 b(of)g(constr)o(ucted)f(types)g(with)h(type)f
(Any:)150 3499 y Fd(//)49 b(IDL)150 3699 y(struct)g(testStruct)f({)250
3798 y(long)h(l;)250 3898 y(short)g(s;)150 3997 y(};)150
4296 y(interface)f(anyExample)g({)250 4396 y(any)h(testOp\(in)f(any)h
(mesg\);)150 4496 y(};)291 4781 y Fr(Upon)20 b(compiling)h(the)f(above)
h(IDL)f(with)h Fe(omniidl2)51 b(-a)p Fr(,)19 b(the)h(following)h
(overloaded)e(op-)150 4894 y(erators)i(ar)n(e)i(generated:)264
5080 y(1.)45 b Fe(void)53 b(operator<<=\(COR)o(BA)o(::)o(An)o(y&,)48
b(const)k(testStruct&)d(\))264 5258 y Fr(2.)c Fe(void)53
b(operator<<=\(COR)o(BA)o(::)o(An)o(y&,)48 b(testStruct*)h(\))264
5437 y Fr(3.)c Fe(CORBA::Boolean)j(operator>>=\(cons)o(t)g
(CORBA::Any&,)h(test-)377 5550 y(Struct*&\))p eop
%%Page: 72 78
72 77 bop 30 100 a Fr(72)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)171 356 y Fr(Operators)g(of)g(this)g
(form)h(ar)n(e)g(generated)e(for)h(all)i(constr)o(ucted)d(types,)g(and)
h(for)h(interfaces.)171 456 y(The)e(\002rst)f(operator)-7
b(,)20 b Fq(\(1\))j Fr(,)e(copies)g(the)f(constr)o(ucted)g(type,)g(and)
h(inserts)f(it)i(into)f(the)f(Any)-10 b(.)27 b(The)30
556 y(second)e(operator)-7 b(,)25 b Fq(\(2\))j Fr(,)e(inserts)f(the)h
(constr)o(ucted)e(type)h(into)g(the)h(Any)-10 b(,)26
b(and)g(then)f(manages)h(it.)30 656 y(Note)c(that)h(if)h(the)e(second)g
(operator)f(is)j(used,)d(the)h(Any)h(consumes)f(the)g(constr)o(ucted)g
(type,)f(and)30 755 y(the)h(caller)i(should)d(not)h(used)f(the)h
(pointer)f(to)h(access)g(the)g(data)h(after)f(insertion.)27
b(The)22 b(following)30 855 y(is)h(an)g(example)f(of)h(how)f(to)g
(insert)g(a)h(value)g(into)g(an)g(Any)f(using)g(operator)f
Fq(\(1\))j Fr(:)30 1133 y Fd(//)49 b(C++)30 1332 y(CORBA::Any)f
(an_any;)30 1531 y(testStruct)g(t;)30 1631 y(t.l)h(=)h(456;)30
1731 y(t.s)f(=)h(8;)30 1930 y(an_any)f(<<=)g(t;)171 2220
y Fr(The)25 b(thir)n(d)h(operator)-7 b(,)26 b Fq(\(3\))h
Fr(,)g(is)f(used)e(to)i(extract)f(the)h(constr)o(ucted)e(type)g(fr)n
(om)j(the)e(Any)-10 b(,)26 b(and)30 2333 y(can)d(be)g(used)e(as)i
(follows:)30 2637 y Fd(testStruct*)48 b(tp;)30 2836 y(if)h(\(an_any)g
(>>=)g(tp\))g({)229 2936 y(cout)g(<<)h("testStruct:)d(l:)j(")f(<<)h
(tp->l)f(<<)g(endl;)229 3035 y(cout)g(<<)h(")597 b(s:)50
b(")f(<<)h(tp->s)f(<<)g(endl;)30 3135 y(})30 3235 y(else)g({)229
3334 y(cout)g(<<)h("Unknown)e(value)h(contained)f(in)i(Any.")e(<<)i
(endl;)30 3434 y(})171 3750 y Fr(As)23 b(with)g(basic)i(types,)c(if)j
(an)g(attempt)f(is)g(made)g(to)g(extract)g(a)h(type)e(fr)n(om)i(an)g
(Any)f(that)g(does)30 3863 y(not)f(contain)h(a)h(value)f(of)g(that)f
(type,)f(the)h(extraction)g(operator)g(r)n(eturns)f(False.)28
b(If)23 b(the)f(Any)g(does)30 3976 y(contain)k(that)f(type,)f(the)h
(extraction)g(operator)f(r)n(eturns)g(T)-8 b(r)o(ue.)35
b(If)26 b(the)e(extraction)h(is)h(successful,)30 4089
y(the)j(caller)7 b('s)30 b(pointer)e(will)j(point)d(to)h(memory)g
(managed)g(by)g(the)g(Any)-10 b(.)47 b(The)28 b(caller)j(must)e(not)30
4202 y(delete)21 b(or)i(otherwise)e(change)h(this)h(storage,)e(and)i
(should)e(not)i(use)e(this)i(storage)e(after)i(the)f(con-)30
4315 y(tents)g(of)h(the)g(Any)g(ar)n(e)h(r)n(eplaced)f(\(either)g(by)h
(insertion)e(or)h(assignment\),)g(or)g(after)h(the)e(Any)h(has)30
4428 y(been)g(destr)n(oyed)669 4395 y Fk(1)706 4428 y
Fr(.)31 b(In)23 b(particular)-7 b(,)25 b(management)e(of)h(the)f
(pointer)f(should)h(not)g(be)g(assigned)g(to)30 4541
y(a)p 104 4541 28 4 v 56 w Fe(var)e Fr(type.)171 4654
y(If)i(the)f(extraction)g(fails,)h(the)f(caller)7 b('s)24
b(pointer)d(will)j(be)f(set)e(to)h(point)g(to)g(null.)171
4768 y(Note)c(that)g(ther)n(e)g(ar)n(e)h(special)h(r)o(ules)e(for)h
(inserting)f(and)h(extracting)g(arrays)f(\(using)p 3095
4768 V 52 w Fe(forany)30 4881 y Fr(types\),)25 b(and)g(for)h(inserting)
f(and)h(extracting)f(booleans,)h(octets,)e(chars,)j(and)f(bounded)e
(strings.)30 4994 y(Please)30 b(r)n(efer)h(to)f(section)g(16.14)j(of)e
(the)f(C++)h(Mapping)g(section)f(of)h(the)f(CORBA)h(2)g(speci\002ca-)30
5107 y(tion)22 b([OMG96a)s(])h(for)f(further)g(information.)p
30 5188 1368 4 v 135 5244 a Fh(1)164 5276 y Fg(It)g(is)e(unclear)h(in)g
(the)g(CORBA)g(speci\002cation)g(whether)g(or)g(not)g(object)h(r)o
(efer)o(ences)c(should)j(be)f(managed)h(by)g(an)30 5367
y(Any)-8 b(.)35 b(The)23 b(omniORB2)f(implementation)h(leaves)g
(management)h(of)e(an)i(extracted)e(object)h(r)o(efer)o(ence)e(to)i
(the)h(caller)-6 b(.)30 5458 y(Ther)o(efor)o(e,)27 b(the)i(pr)o
(ogrammer)c(should)i(r)o(elease)f(object)j(r)o(efer)o(ences)c(and)k(T)
-7 b(ypeCodes)25 b(that)30 b(have)e(been)g(extracted)30
5550 y(fr)o(om)17 b(an)j(Any)-8 b(.)p eop
%%Page: 73 79
73 78 bop 150 100 a Ff(9.2.)51 b(TYPE)22 b(ANY)f(IN)h(OMNIORB2)2037
b Fr(73)150 356 y Fj(9.2)119 b(T)-11 b(ype)30 b(Any)h(in)e(omniORB2)150
567 y Fr(This)21 b(section)f(contains)h(some)f(notes)g(on)g(the)h(use)f
(and)h(behaviour)g(of)g(type)f(Any)g(in)i(omniORB2.)150
818 y Fm(Generating)d(Insertion)g(and)e(Extraction)j(Operators.)91
b Fr(T)-8 b(o)18 b(generate)e(type)h(Any)g(insertion)g(and)150
931 y(extraction)27 b(operators)e(for)j(constr)o(ucted)d(types)g(and)j
(interfaces,)g(the)e Fe(-a)54 b Fr(command)28 b(line)g(\003ag)150
1044 y(should)22 b(be)g(speci\002ed)g(when)f(r)o(unning)i
Fe(omniidl2)p Fr(.)150 1295 y Fm(T)-8 b(ypeCode)22 b(comparison)j(when)
e(extracting)j(from)f(an)f(Any)-8 b(.)89 b Fr(When)24
b(an)g(attempt)f(is)i(made)f(to)150 1408 y(extract)f(a)h(type)e(fr)n
(om)i(an)g(Any)-10 b(,)23 b(the)g(T)-8 b(ypeCode)21 b(of)j(the)e(type)g
(is)i(checked)e(for)i(equality)f(with)h(the)150 1520
y(T)-8 b(ypeCode)22 b(of)i(the)g(type)f(stor)n(ed)f(by)j(the)e(Any)-10
b(.)32 b(omniORB2)25 b(will)h(ignor)n(e)e(any)g(alias)i(T)-8
b(ypeCodes)150 1633 y(\()p Fe(tk)p 295 1633 28 4 v 32
w(alias)p Fr(\))21 b(when)h(making)h(this)f(comparison.)28
b(Examples:)150 1929 y Fd(//)49 b(IDL)h(1)150 2129 y(typedef)f(double)f
(Double1;)150 2328 y(struct)h(Test1)g({)150 2427 y(Double1)g(a;)150
2527 y(};)150 2826 y(------)150 3125 y(//)g(IDL)h(2)150
3324 y(typedef)f(double)f(Double2;)150 3523 y(struct)h(Test1)g({)250
3623 y(Double2)f(a;)150 3723 y(};)291 4032 y Fr(If)32
b(an)g(attempt)f(is)h(made)g(to)f(extract)h(the)f(type)f
Fe(Test1)53 b Fr(de\002ned)30 b(in)i(IDL)g(1)g(fr)n(om)g(an)h(Any)150
4145 y(containing)23 b(the)g Fe(Test1)52 b Fr(de\002ned)21
b(in)j(IDL)e(2,)i(this)e(will)i(succeed)e(\(and)i(vice-versa\),)g(as)f
(the)f(two)150 4258 y(types)f(dif)n(fer)i(only)f(by)h(an)g(alias.)150
4508 y Fm(Object)30 b(references.)94 b Fr(Note)28 b(that)h(type)f(Any)h
(does)e(not)i(manage)h(object)f(r)n(efer)n(ence)g(types)e(-)j(it)150
4621 y(is)c(unclear)h(in)g(the)f(CORBA)g(speci\002cation)g(whether)f
(this)h(is)g(r)n(equir)n(ed)g(or)g(not.)38 b(Ther)n(efor)n(e,)26
b(the)150 4734 y(pr)n(ogrammer)e(should)g(r)n(elease)g(object)g(r)n
(efer)n(ences)g(and)g(pseudo-objects)e(\(such)j(as)f(T)-8
b(ypeCode\))150 4847 y(that)25 b(have)i(been)e(extracted)f(fr)n(om)i
(an)h(Any)-10 b(.)36 b(T)-8 b(ype)24 b(Any)h(will,)i(however)-7
b(,)26 b(manage)g(constr)o(ucted)150 4960 y(types)h(\(as)h(per)g(the)g
(CORBA)g(2)h(speci\002cation\))g(-)g(constr)o(ucted)e(types)g
(extracted)g(fr)n(om)i(an)g(Any)150 5073 y(should)22
b(not)g(be)g(deleted,)e(as)j(they)e(will)j(be)f(deleted)d(by)j(the)f
(Any)g(when)g(it)g(is)h(destr)n(oyed.)150 5324 y Fm(T)-10
b(op-level)20 b(aliases.)93 b Fr(When)19 b(a)h(type)e(is)i(inserted)d
(into)j(an)g(Any)-10 b(,)19 b(the)g(Any)g(stor)n(es)e(both)j(the)e
(value)150 5437 y(of)k(the)f(type)g(and)h(the)f(T)-8
b(ypeCode)20 b(for)i(that)f(type.)26 b(If)d(ther)n(e)e(ar)n(e)h(any)g
(top-level)g Fe(tk)p 3022 5437 V 32 w(alias)d Fr(T)-8
b(ype-)150 5550 y(Codes)25 b(in)i(the)f(T)-8 b(ypeCode,)25
b(they)g(will)j(be)e(r)n(emoved)g(fr)n(om)h(the)f(T)-8
b(ypeCode)24 b(stor)n(ed)h(in)h(the)g(Any)-10 b(.)p eop
%%Page: 74 80
74 79 bop 30 100 a Fr(74)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 356 y Fr(Note)f(that)i(this)g(does)
e(not)h(af)n(fect)i(the)p 1364 356 28 4 v 55 w Fe(tc)p
1506 356 V 86 w Fr(T)-8 b(ypeCode)21 b(generated)f(to)j(r)n(epr)n
(esent)e(the)h(type)f(\(see)30 469 y(section)32 b(on)g(T)-8
b(ypeCode,)32 b(below\).)57 b(This)32 b(behaviour)h(is)g(necessary)-10
b(,)33 b(as)f(two)g(types)e(that)j(dif)n(fer)30 582 y(only)d(by)g(a)h
(top-level)e(alias)j(can)f(use)e(the)g(same)h(insertion)g(and)g
(extraction)f(operators.)49 b(If)30 b(the)30 695 y Fe(tk)p
145 695 V 32 w(alias)h Fr(is)i(not)f(r)n(emoved,)j(one)d(of)h(the)g
(types)e(could)i(be)g(transmitted)e(with)i(an)h(incorr)n(ect)30
808 y Fe(tk)p 145 808 V 32 w(alias)20 b Fr(T)-8 b(ypeCode.)26
b(Example:)30 1150 y Fd(//)49 b(IDL)h(3)30 1350 y(typedef)e
(sequence<double>)f(seqDouble1;)30 1449 y(typedef)h(sequence<double>)f
(seqDouble2;)171 1798 y Fr(If)52 b(either)e(seqDouble1)h(or)g
(seqDouble2)g(is)g(inserted)f(into)h(a)h(T)-8 b(ypeCode,)56
b(the)50 b(T)-8 b(ype-)30 1911 y(Code)47 b(stor)n(ed)f(will)k(be)e(for)
f(a)i Fe(sequence<double)o(>)p Fr(,)f(and)g(not)f(for)h(an)g(alias)i
(to)d(a)h Fe(se-)30 2024 y(quence<double>)p Fr(.)30 2320
y Fm(Removing)26 b(aliases)k(from)d(T)-8 b(ypeCodes.)90
b Fr(Some)26 b(ORBs)h(\(e.g.)41 b(Orbix\))29 b(will)f(not)f(accept)g(T)
-8 b(ype-)30 2433 y(Codes)24 b(containing)i Fe(tk)p 875
2433 V 32 w(alias)d Fr(T)-8 b(ypeCodes.)32 b(When)25
b(using)g(type)e(Any)i(while)g(inter)n(operating)30 2546
y(with)20 b(these)f(ORBs,)g(it)i(is)f(necessary)f(to)g(r)n(emove)h
Fe(tk)p 1842 2546 V 32 w(alias)e Fr(T)-8 b(ypeCodes)17
b(fr)n(om)k(thr)n(oughout)d(the)30 2659 y(T)-8 b(ypeCode)20
b(r)n(epr)n(esenting)h(a)i(constr)o(ucted)e(type.)171
2779 y(While)30 b(omniORB2)g(will)g(always)g(r)n(emove)f(top-level)g
(aliases,)i(it)e(doesn't)f(r)n(emove)h(aliases)30 2892
y(contained)17 b(in)h(a)h(constr)o(ucted)d(type)g(\(for)i(example,)g
Fe(Double1)d Fr(in)j(the)f(str)o(uct)g Fe(Test1)e Fr(in)j(example)30
3005 y(1,)26 b(above\).)35 b(T)-8 b(o)24 b(r)n(emove)h(all)h
Fe(tk)p 1140 3005 V 32 w(alias)d Fr(T)-8 b(ypeCodes)22
b(fr)n(om)j(T)-8 b(ypeCodes)22 b(stor)n(ed)h(in)j(Anys,)e(sup-)30
3118 y(ply)30 b(the)g Fe(-ORBtcAliasExp)o(and)48 b(1)84
b Fr(command-line)32 b(\003ag)f(when)e(r)o(unning)i(an)g(omniORB2)30
3231 y(executable.)56 b(Ther)n(e)31 b(will)i(be)f(some)f(\(small\))j
(performance)e(penalty)f(when)h(inserting)f(values)30
3344 y(into)22 b(an)h(Any)-10 b(.)171 3464 y(Note)20
b(that)i(the)p 724 3464 V 53 w Fe(tc)p 866 3464 V 87
w Fr(T)-8 b(ypeCodes)18 b(generated)i(for)h(all)i(constr)o(ucted)d
(types)g(will)j(contain)f(the)30 3577 y(complete)i(T)-8
b(ypeCode)22 b(for)j(the)f(type)g(\(including)h(any)g
Fe(tk)p 2083 3577 V 32 w(alias)e Fr(T)-8 b(ypeCodes\),)22
b(r)n(egar)n(dless)i(of)30 3690 y(whether)d(the)h Fe(-ORBtcAliasExp)o
(and)16 b Fr(\003ag)23 b(is)g(set)e(to)h(1)h(or)f(not.)30
3973 y Fm(Recursive)27 b(T)-8 b(ypeCodes.)89 b Fr(omniORB2)26
b(does)f(not)g(yet)f(support)g(r)n(ecursive)i(T)-8 b(ypeCodes.)34
b(This)30 4073 y(means)22 b(that)h(types)d(such)j(as)g(the)e(following)
i(can)h(not)e(be)g(inserted)f(or)h(extracted)g(fr)n(om)h(an)g(Any:)30
4383 y Fd(//)49 b(IDL)h(4)30 4582 y(struct)f(Test4)g({)130
4682 y(sequence<Test4>)e(a;)30 4782 y(};)171 5098 y Fr(If)27
b(these)e(types)g(ar)n(e)j(speci\002ed)d(in)j(IDL,)e(omniidl2)i(will)h
(not)d(generate)f(Any)h(insertion/)g(ex-)30 5211 y(traction)34
b(operators,)g(so)e(an)i(attempt)f(to)g(insert/extract)f(them)h(will)i
(r)n(esult)d(in)i(compile-time)30 5324 y(err)n(ors.)c(Similarly)-10
b(,)26 b(it)e(won't)f(generate)f(a)p 1506 5324 V 58 w
Fe(tc)p 1649 5324 V 55 w Fr(T)-8 b(ypeCode)22 b(for)i(the)f(type.)30
b(If)24 b(another)e(type)h(con-)30 5437 y(tains)h(a)g(type)e(which)i
(is)g(r)n(ecursive,)g(operators)e(won't)h(be)g(generated)f(for)h(that)h
(type)e(either)-7 b(,)23 b(and)30 5550 y(so)f(on.)27
b(Recursive)22 b(T)-8 b(ypeCodes)20 b(will)k(be)f(supported)c(in)k(a)g
(futur)n(e)g(r)n(elease)f(of)g(omniORB2.)p eop
%%Page: 75 81
75 80 bop 150 100 a Ff(9.3.)51 b(TYPECODE)23 b(IN)f(OMNIORB2)2004
b Fr(75)150 356 y Fm(T)-8 b(ype-unsafe)27 b(construction)g(and)g
(insertion.)92 b Fr(If)27 b(using)f(the)h(type-unsafe)e(Any)h(constr)o
(uctor)-7 b(,)150 469 y(or)27 b(the)f Fe(CORBA::Any::rep)o(la)o(ce)o
(\(\))21 b Fr(member)27 b(function,)h(ensur)n(e)e(that)h(the)f(value)i
(r)n(eturned)150 582 y(by)22 b(the)f Fe(CORBA::Any::va)o(lue)o(\(\))15
b Fr(member)22 b(function)g(and)g(the)f(T)-8 b(ypeCode)19
b(r)n(eturned)h(by)i(the)150 695 y Fe(CORBA::Any::typ)o(e\()o(\))13
b Fr(member)19 b(function)g(ar)n(e)g(used)e(as)i(ar)n(guments)f(to)h
(the)f(constr)o(uctor)f(or)150 808 y(function.)26 b(Using)17
b(other)f(values)i(or)f(T)-8 b(ypeCodes)14 b(may)k(r)n(esult)f(in)h(a)g
(mismatch,)h(and)f(is)f(unde\002ned)150 920 y(behaviour)-7
b(.)291 1020 y(Note)21 b(that)i(a)g(non-CORBA)f(2)h(function,)299
1186 y Fd(CORBA::ULong)48 b(CORBA::Any::NP_length\(\))e(const)291
1364 y Fr(is)24 b(supplied.)29 b(This)24 b(member)f(function)h(r)n
(eturns)e(the)h(length)g(of)g(the)g(value)h(r)n(eturned)e(by)i(the)150
1477 y Fe(CORBA::Any::val)o(ue)o(\(\))48 b Fr(member)23
b(function.)29 b(It)23 b(may)g(be)g(necessary)f(to)g(use)g(this)h
(function)150 1590 y(if)g(the)f(Any's)g(value)h(is)g(to)f(be)h(stor)n
(ed)e(in)i(a)g(\002le.)150 1840 y Fm(Threads)g(and)f(type)g(Any)-8
b(.)89 b Fr(Inserting)21 b(and)h(extracting)g(simultaneously)f(fr)n(om)
i(the)f(same)g(Any)150 1953 y(\(in)h(2)h(dif)n(fer)n(ent)e(thr)n
(eads\))g(is)h(unde\002ned)d(behaviour)-7 b(.)291 2066
y(Extracting)20 b(simultaneously)f(fr)n(om)i(the)f(same)g(Any)g(\(in)h
(2)g(or)f(mor)n(e)g(dif)n(fer)n(ent)g(thr)n(eads\))g(may)150
2179 y(r)n(esult)28 b(in)h(a)g(memory)f(leak)g(if)i(the)d(type)g(being)
i(extracted)e(is)i(a)g(constr)o(ucted)d(type.)44 b(It)28
b(was)h(de-)150 2292 y(cided)22 b(not)f(to)h(mutex)g(the)f(Any)-10
b(,)21 b(as)i(this)f(condition)g(should)f(rar)n(ely)i(arise,)f(and)g
(adding)g(a)h(mutex)150 2405 y(would)f(lead)h(to)f(performance)g
(penalties.)150 2701 y Fj(9.3)119 b(T)-11 b(ypeCode)31
b(in)f(omniORB2)150 2912 y Fr(This)20 b(section)f(contains)h(some)f
(notes)g(on)g(the)h(use)f(and)h(behaviour)g(of)g(T)-8
b(ypeCode)18 b(in)j(omniORB2)150 3149 y Fm(T)-8 b(ypeCodes)20
b(in)h(IDL.)90 b Fr(When)21 b(using)g(T)-8 b(ypeCodes)18
b(in)k(IDL,)e(note)g(that)h(they)f(ar)n(e)i(de\002ned)d(in)j(the)150
3248 y(CORBA)h(scope.)j(Ther)n(efor)n(e,)21 b(CORBA::T)-8
b(ypeCode)20 b(should)i(be)g(used.)27 b(Example:)150
3414 y Fd(//)49 b(IDL)h(5)150 3613 y(struct)f(Test5)g({)250
3713 y(long)g(length;)250 3812 y(CORBA::TypeCode)e(desc;)150
3912 y(};)150 4162 y Fm(orb.idl)90 b Fr(Inclusion)28
b(of)f(the)g(\002le)h Fe(orb.idl)51 b Fr(in)28 b(IDL)f(using)g
(CORBA::T)-8 b(ypeCode)25 b(is)i(optional.)150 4275 y(An)22
b(empty)g(orb.idl)g(\002le)h(is)g(pr)n(ovided)f(for)g(compatibility)i
(purposes.)150 4524 y Fm(Generating)41 b(T)-8 b(ypeCodes)40
b(for)g(constructed)i(types.)91 b Fr(T)-8 b(o)39 b(generate)g(a)i(T)-8
b(ypeCode)38 b(for)j(con-)150 4637 y(str)o(ucted)27 b(types,)g(specify)
h(the)g Fe(-a)g Fr(command-line)h(\003ag)g(when)f(r)o(unning)g
(omniidl2.)47 b(This)28 b(will)150 4750 y(generate)e(a)p
603 4750 28 4 v 62 w Fe(tc)p 745 4750 V 60 w Fr(T)-8
b(ypeCode)26 b(describing)h(the)h(type,)f(at)i(the)e(same)h(scope)f(as)
h(the)g(type)e(\(as)j(per)150 4863 y(the)22 b(CORBA)g(2)i
(speci\002cation\).)k(Example:)150 5052 y Fd(//)49 b(IDL)h(6)150
5251 y(struct)f(Test6)g({)200 5351 y(double)g(a;)200
5450 y(sequence<long>)e(b;)150 5550 y(};)p eop
%%Page: 76 82
76 81 bop 30 100 a Fr(76)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)171 356 y Fr(A)j(T)-8
b(ypeCode,)p 729 356 28 4 v 55 w Fe(tc)p 872 356 V 31
w(Test6)p Fr(,)23 b(will)j(be)e(generated)f(to)h(describe)f(the)h(str)o
(uct)g Fe(Test6)p Fr(.)32 b(The)23 b(op-)30 469 y(erations)j(de\002ned)
f(in)i(the)e(T)-8 b(ypeCode)24 b(interface)j(\(see)f(section)g(6.7.1)h
(of)g(the)e(CORBA)i(2)g(speci\002-)30 582 y(cation)c([OMG96a)s(])g(\))g
(can)g(be)g(used)e(to)h(query)f(the)h(T)-8 b(ypeCode)20
b(about)j(the)f(type)f(it)i(r)n(epr)n(esents.)30 833
y Fm(T)-8 b(ypeCode)24 b(equality)-8 b(.)91 b Fr(The)25
b Fe(CORBA::TypeCod)o(e:)o(:e)o(qua)o(l\()o(\))19 b Fr(member)26
b(function)g(will)h(r)n(e-)30 946 y(turn)g(tr)o(ue)f(only)h(if)h(the)e
(two)h(T)-8 b(ypeCodes)24 b(ar)n(e)k(exactly)f(the)f(same.)42
b Fe(tk)p 2525 946 V 31 w(alias)25 b Fr(T)-8 b(ypeCodes)25
b(ar)n(e)30 1059 y(included)g(in)h(this)f(comparison,)h(unlike)g(the)e
(comparison)i(made)f(when)g(values)h(ar)n(e)f(extracted)30
1172 y(fr)n(om)e(an)g(Any)f(\(see)g(section)g(on)g(Any)-10
b(,)21 b(above\).)171 1285 y(If)30 b(one)e(of)i(the)e(T)-8
b(ypeCodes)27 b(being)i(checked)f(is)i(a)g Fe(tk)p 2074
1285 V 32 w(struct)p Fr(,)e Fe(tk)p 2597 1285 V 32 w(union)p
Fr(,)g Fe(tk)p 3065 1285 V 32 w(enum)p Fr(,)h(or)30 1398
y Fe(tk)p 145 1398 V 32 w(alias)p Fr(,)37 b(and)f(has)g(an)h(empty)e(r)
n(epository)f(ID)i(parameter)-7 b(,)39 b(then)c(the)g(r)n(epository)f
(ID)j(pa-)30 1511 y(rameter)28 b(will)i(be)f(ignor)n(ed)f(when)g
(checking)h(for)g(equality)-10 b(.)46 b(Similarly)-10
b(,)32 b(if)e(the)e Fe(name)52 b Fr(or)29 b Fe(mem-)30
1624 y(ber)p 200 1624 V 31 w(name)53 b Fr(parameters)38
b(of)h(a)g(T)-8 b(ypeCode)36 b(ar)n(e)j(empty)f(strings,)j(they)d(will)
i(be)e(ignor)n(ed)g(for)30 1737 y(equality)33 b(checking)f(purposes.)55
b(This)32 b(is)h(because)f(a)h(CORBA)g(2)g(ORB)g(does)e(not)g(have)i
(to)f(in-)30 1849 y(clude)d(these)e(parameters)i(in)g(a)h(T)-8
b(ypeCode)27 b(\(see)h(section)g(12.3.4)j(of)e(the)f(Inter)n
(operability)g(sec-)30 1962 y(tion)d(of)h(the)f(CORBA)h(2)g
(speci\002cation)g([OMG96a)r(]\).)38 b(Note)24 b(that)h(these)f
(\(optional\))i(parameters)30 2075 y(ar)n(e)d(included)f(in)h(T)-8
b(ypeCodes)20 b(generated)h(by)h(omniORB2.)p eop
%%Page: 77 83
77 82 bop 150 100 a Ff(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(77)150 356 y Fj(9.4)119 b(Source)30 b(Listing)150
590 y Fi(9.4.1)99 b(anyExample)p 1015 590 30 4 v 35 w(impl.cc)150
768 y Fd(//)49 b(anyExample_impl.cc)e(-)j(This)f(is)g(the)g(source)g
(code)g(of)g(the)h(exam-)150 867 y(ple)f(used)g(in)150
967 y(//)1096 b(Chapter)48 b(9)i("Type)f(Any)g(and)g(Type-)150
1067 y(Code")g(of)g(the)h(omniORB2)150 1166 y(//)1096
b(users)48 b(guide.)150 1266 y(//)150 1365 y(//)747 b(This)49
b(is)g(the)h(object)e(implementation.)150 1465 y(//)150
1565 y(//)h(Usage:)g(anyExample_impl)150 1664 y(//)150
1764 y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(registered)f(with)h(the)150 1864 y(//)398 b(COS)49 b(naming)g
(service.)f(The)i(client)e(uses)h(the)h(naming)e(service)h(to)150
1963 y(//)398 b(locate)49 b(this)g(object.)150 2063 y(//)150
2163 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i(bound)f(to)
g(is)g(as)h(follows:)150 2262 y(//)697 b(root)99 b([context])150
2362 y(//)747 b(|)150 2461 y(//)697 b(text)99 b([context])48
b(kind)h([my_context])150 2561 y(//)747 b(|)150 2661
y(//)697 b(anyExample)98 b([object])g(kind)49 b([Object])150
2760 y(//)150 2960 y(#include)f(<iostream.h>)150 3159
y(#include)g("anyExample.hh")150 3458 y(static)h(CORBA::Boolean)e
(bindObjectToName\(CORBA::ORB_ptr,COR)o(BA::O)o(bject)o(_ptr\);)150
3757 y(class)i(anyExample_i)e(:)j(public)f(virtual)f(_sk_anyExample)f
({)150 3856 y(public:)250 3956 y(anyExample_i\(\))g({)i(})250
4055 y(virtual)f(\230anyExample_i\(\))f({)j(})250 4155
y(virtual)e(CORBA::Any*)g(testOp\(const)f(CORBA::Any&)h(a\);)150
4255 y(};)150 4554 y(CORBA::Any*)150 4653 y
(anyExample_i::testOp\(const)d(CORBA::Any&)j(a\))h({)250
4852 y(cout)g(<<)g("Any)g(received,)f(containing:)g(")i(<<)f(endl;)150
5052 y(#ifndef)g(NO_FLOAT)250 5151 y(CORBA::Double)e(d;)150
5251 y(#endif)250 5450 y(CORBA::Long)g(l;)250 5550 y(char*)i(str;)p
eop
%%Page: 78 84
78 83 bop 30 100 a Fr(78)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)130 456 y Fd(testStruct*)47
b(tp;)130 754 y(if)i(\(a)g(>>=)h(l\))f({)229 854 y(cout)g(<<)h("Long:)e
(")i(<<)g(l)f(<<)h(endl;)130 954 y(})30 1053 y(#ifndef)e(NO_FLOAT)130
1153 y(else)h(if)g(\(a)h(>>=)f(d\))g({)229 1253 y(cout)g(<<)h("Double:)
e(")i(<<)f(d)h(<<)f(endl;)130 1352 y(})30 1452 y(#endif)130
1551 y(else)g(if)g(\(a)h(>>=)f(str\))g({)229 1651 y(cout)g(<<)h
("String:)e(")i(<<)f(str)g(<<)h(endl;)130 1751 y(})130
1850 y(else)f(if)g(\(a)h(>>=)f(tp\))g({)229 1950 y(cout)g(<<)h
("testStruct:)d(l:)j(")f(<<)h(tp->l)f(<<)g(endl;)229
2050 y(cout)g(<<)h(")597 b(s:)50 b(")f(<<)h(tp->s)f(<<)g(endl;)130
2149 y(})130 2249 y(else)g({)229 2348 y(cout)g(<<)h("Unknown)e(value.")
h(<<)g(endl;)130 2448 y(})130 2647 y(CORBA::Any*)e(ap)j(=)f(new)h
(CORBA::Any;)130 2847 y(*ap)f(<<=)g(\(CORBA::ULong\))e(314;)130
3046 y(cout)i(<<)g("Returning)f(Any)h(containing:)f(ULong:)h(314\\n")f
(<<)i(endl;)130 3145 y(return)e(ap;)30 3245 y(})30 3544
y(int)30 3644 y(main\(int)g(argc,)h(char)g(**argv\))30
3743 y({)130 3843 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 3942
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 4142 y(anyExample_i)d(*myobj)i(=)h(new)f
(anyExample_i\(\);)130 4241 y(myobj->_obj_is_ready\(boa\);)130
4441 y({)229 4540 y(anyExample_var)e(myobjRef)i(=)g(myobj->_this\(\);)
229 4640 y(if)h(\(!bindObjectToName\(orb,myobjRef\)\))43
b({)329 4740 y(return)49 b(1;)229 4839 y(})130 4939 y(})130
5138 y(boa->impl_is_ready\(\);)130 5238 y(//)g(Tell)g(the)g(BOA)h(we)f
(are)g(ready.)g(The)g(BOA's)g(default)g(be-)30 5337 y(haviour)f(is)i
(to)f(block)130 5437 y(//)g(on)g(this)h(call)f(indefinitely.)p
eop
%%Page: 79 85
79 84 bop 150 100 a Ff(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(79)250 356 y Fd(return)48 b(0;)150 456 y(})150 754
y(static)150 854 y(CORBA::Boolean)150 954 y
(bindObjectToName\(CORBA::ORB_ptr)c(orb,CORBA::Object_ptr)i(obj\))150
1053 y({)250 1153 y(CosNaming::NamingContext_var)e(rootContext;)250
1352 y(try)49 b({)349 1452 y(//)h(Obtain)e(a)i(reference)e(to)i(the)f
(root)g(context)f(of)i(the)f(Name)g(service:)349 1551
y(CORBA::Object_var)e(initServ;)349 1651 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)349
1850 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))349 1950 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)349 2050 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)349
2149 y(if)g(\(CORBA::is_nil\(rootContext\)\))449 2249
y({)549 2348 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)549 2448 y(return)e(0;)449 2548 y(})250 2647
y(})250 2747 y(catch\(CORBA::ORB::InvalidName&)c(ex\))49
b({)349 2847 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)e([does)h
(not)g(exist].")g(<<)g(endl;)349 2946 y(return)g(0;)250
3046 y(})250 3345 y(try)g({)349 3444 y(//)h(Bind)f(a)g(context)g
(called)g("test")f(to)i(the)f(root)g(context:)349 3644
y(CosNaming::Name)e(contextName;)349 3743 y(contextName.length\(1\);)
349 3843 y(contextName[0].id)147 b(=)49 b(\(const)g(char*\))g("test";)
197 b(//)50 b(string)f(copied)349 3942 y(contextName[0].kind)e(=)i
(\(const)g(char*\))g("my_context";)e(//)i(string)g(copied)349
4042 y(//)h(Note)f(on)g(kind:)g(The)g(kind)g(field)g(is)h(used)f(to)g
(indicate)g(the)g(type)349 4142 y(//)h(of)f(the)g(object.)g(This)g(is)g
(to)h(avoid)f(conventions)e(such)j(as)f(that)g(used)349
4241 y(//)h(by)f(files)g(\(name.type)f(--)h(e.g.)g(test.ps)g(=)h
(postscript)e(etc.\))349 4441 y(CosNaming::NamingContext_var)d
(testContext;)349 4540 y(try)50 b({)449 4640 y(//)f(Bind)g(the)h
(context)e(to)i(root,)e(and)i(assign)e(testContext)g(to)i(it:)449
4740 y(testContext)e(=)h(rootContext->bind_new_context\(context)o
(Name\))o(;)349 4839 y(})349 4939 y
(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)449 5038 y(//)g(If)h(the)f(context)g(already)f(exists,)h
(this)g(excep-)150 5138 y(tion)g(will)g(be)h(raised.)449
5238 y(//)f(In)h(this)f(case,)g(just)g(resolve)f(the)i(name)f(and)g
(assign)g(testContext)449 5337 y(//)g(to)h(the)f(object)g(returned:)449
5437 y(CORBA::Object_var)e(tmpobj;)449 5537 y(tmpobj)i(=)g
(rootContext->resolve\(contextName\);)p eop
%%Page: 80 86
80 85 bop 30 100 a Fr(80)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)329 356 y Fd(testContext)48
b(=)h(CosNaming::NamingContext::_narrow\(tmp)o(obj\);)329
456 y(if)g(\(CORBA::is_nil\(testContext\)\))c({)428 555
y(cerr)50 b(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g(<<)i
(endl;)428 655 y(return)f(0;)329 754 y(})229 854 y(})229
1053 y(//)h(Bind)f(the)g(object)g(\(obj\))g(to)g(testContext,)f(naming)
g(it)i(anyExample:)229 1153 y(CosNaming::Name)d(objectName;)229
1253 y(objectName.length\(1\);)229 1352 y(objectName[0].id)147
b(=)49 b(\(const)g(char*\))g("anyExam-)30 1452 y(ple";)148
b(//)50 b(string)f(copied)229 1551 y(objectName[0].kind)e(=)i(\(const)g
(char*\))g("Object";)f(//)h(string)g(copied)229 1850
y(//)h(Bind)f(obj)g(with)g(name)g(anyExample)f(to)i(the)f(testContext:)
229 1950 y(try)g({)329 2050 y(testContext->bind\(objectName,obj\);)229
2149 y(})229 2249 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o
(nd&)44 b(ex\))49 b({)329 2348 y(testContext->rebind\(objectName,obj\))
o(;)229 2448 y(})229 2548 y(//)h(Note:)f(Using)f(rebind\(\))h(will)g
(overwrite)f(any)h(Object)g(previ-)30 2647 y(ously)g(bound)229
2747 y(//)349 b(to)49 b(/test/anyExample)e(with)i(obj.)229
2847 y(//)349 b(Alternatively,)47 b(bind\(\))h(can)i(be)f(used,)g
(which)g(will)g(raise)g(a)229 2946 y(//)349 b
(CosNaming::NamingContext::Already)o(Bound)43 b(excep-)30
3046 y(tion)49 b(if)g(the)h(name)229 3145 y(//)349 b(supplied)48
b(is)h(already)g(bound)g(to)g(an)h(object.)130 3245 y(})130
3345 y(catch)e(\(CORBA::COMM_FAILURE&)e(ex\))k({)229
3444 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)30 3544 y(tact)f(the)g(")478 3644
y(<<)h("naming)e(service.")g(<<)i(endl;)229 3743 y(return)f(0;)130
3843 y(})130 3942 y(catch)f(\(omniORB::fatalException&)e(ex\))j({)229
4042 y(throw;)130 4142 y(})130 4241 y(catch)f(\(...\))h({)229
4341 y(cerr)g(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)30 4441 y(vice."<<)g(endl;)229 4540
y(return)h(0;)130 4640 y(})130 4740 y(return)f(1;)30
4839 y(})p eop
%%Page: 81 87
81 86 bop 150 100 a Ff(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(81)150 356 y Fi(9.4.2)99 b(anyExample)p 1015 356
30 4 v 35 w(clt.cc)150 568 y Fd(//)49 b(anyExample_clt.cc)e(-)100
b(This)49 b(is)g(the)g(source)g(code)g(of)g(the)h(exam-)150
668 y(ple)f(used)g(in)150 768 y(//)1096 b(Chapter)48
b(9)i("Type)f(Any)g(and)g(Type-)150 867 y(Code")g(of)g(the)h(omniORB2)
150 967 y(//)1096 b(users)48 b(guide.)150 1067 y(//)150
1166 y(//)697 b(This)49 b(is)h(the)f(client.)f(It)i(uses)f(the)g(COSS)g
(naming)g(service)150 1266 y(//)697 b(to)49 b(obtain)g(the)g(object)g
(reference.)150 1365 y(//)150 1465 y(//)g(Usage:)g(anyExample_clt)150
1565 y(//)150 1664 y(//)150 1764 y(//)398 b(On)50 b(startup,)e(the)h
(client)g(lookup)g(the)g(object)f(refer-)150 1864 y(ence)h(from)g(the)
150 1963 y(//)398 b(COS)49 b(naming)g(service.)150 2063
y(//)150 2163 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i
(bound)f(to)g(is)g(as)h(follows:)150 2262 y(//)697 b(root)99
b([context])150 2362 y(//)747 b(|)150 2461 y(//)697 b(text)99
b([context])48 b(kind)h([my_context])150 2561 y(//)747
b(|)150 2661 y(//)697 b(anyExample)98 b([object])g(kind)49
b([Object])150 2760 y(//)150 2960 y(#include)f(<iostream.h>)150
3059 y(#include)g("anyExample.hh")150 3258 y(static)h
(CORBA::Object_ptr)d(getObjectReference\(CORBA::ORB_ptr)e(orb\);)150
3358 y(static)49 b(void)g(invokeOp\(anyExample_ptr&)c(tobj,)k(const)g
(CORBA::Any&)f(a\);)150 3557 y(int)150 3657 y(main)h(\(int)g(argc,)g
(char)g(**argv\))150 3757 y({)250 3856 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 3956
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 4055 y(CORBA::Object_var)c(obj;)250 4255
y(try)j({)349 4354 y(obj)h(=)f(getObjectReference\(orb\);)250
4454 y(})250 4554 y(catch\(CORBA::COMM_FAILURE&)c(ex\))k({)349
4653 y(cerr)g(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 4753 y(tact)f(the)g(")598 4852
y(<<)h("object.")e(<<)h(endl;)349 4952 y(return)g(-1;)250
5052 y(})250 5151 y(catch\(omniORB::fatalException&)44
b(ex\))49 b({)349 5251 y(cerr)g(<<)h("Caught)e(omniORB2)h
(fatalException.)e(This)i(indi-)150 5351 y(cates)g(a)h(bug)f(is)g
(caught)g(")598 5450 y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h
(bug)f(report.\\n")598 5550 y(<<)h("The)f(exception)f(was)h(thrown)g
(in)g(file:)g(")h(<<)f(ex.file\(\))f(<<)i("\\n")p eop
%%Page: 82 88
82 87 bop 30 100 a Fr(82)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)478 356 y Fd(<<)50 b(")1394
b(line:)49 b(")h(<<)f(ex.line\(\))f(<<)i("\\n")478 456
y(<<)g("The)f(error)g(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)j
(endl;)229 555 y(return)f(-1;)130 655 y(})130 754 y(catch\(...\))f({)
229 854 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception.")e(<<)j(endl;)
229 954 y(return)f(-1;)130 1053 y(})130 1352 y(anyExample_ptr)e(tobj)i
(=)h(anyExample::_narrow\(obj\);)130 1551 y(if)f
(\(CORBA::is_nil\(tobj\)\))d({)229 1651 y(cerr)j(<<)h("Can't)e(narrow)h
(object)g(reference)f(to)h(type)g(anyExam-)30 1751 y(ple.")g(<<)g
(endl;)229 1850 y(return)g(-1;)130 1950 y(})130 2249
y(CORBA::Any)f(a;)130 2448 y(try)h({)229 2548 y(//)h(Sending)e(Long)229
2647 y(CORBA::Long)g(l)i(=)f(100;)229 2747 y(a)h(<<=)f(l;)229
2847 y(cout)g(<<)h("Sending)e(Any)h(containing)f(Long:)h(")h(<<)f(l)h
(<<)f(endl;)229 2946 y(invokeOp\(tobj,a\);)229 3145 y(//)h(Sending)e
(Double)30 3245 y(#ifndef)g(NO_FLOAT)229 3345 y(CORBA::Double)g(d)h(=)h
(1.2345;)229 3444 y(a)g(<<=)f(d;)229 3544 y(cout)g(<<)h("Sending)e(Any)
h(containing)f(Double:)h(")g(<<)h(d)f(<<)h(endl;)229
3644 y(invokeOp\(tobj,a\);)30 3743 y(#endif)229 3942
y(//)g(Sending)e(String)229 4042 y(const)h(char*)g(str)g(=)h("Hello";)
229 4142 y(a)g(<<=)f(str;)229 4241 y(cout)g(<<)h("Sending)e(Any)h
(containing)f(String:)h(")g(<<)h(str)f(<<)h(endl;)229
4341 y(invokeOp\(tobj,a\);)229 4540 y(//)g(Sending)e(testStruct)98
b([Struct)48 b(defined)h(in)g(IDL])229 4640 y(testStruct)f(t;)229
4740 y(t.l)h(=)h(456;)229 4839 y(t.s)f(=)h(8;)229 4939
y(a)g(<<=)f(t;)229 5038 y(cout)g(<<)h("Sending)e(Any)h(containing)f
(testStruct:)g(l:)h(")h(<<)g(t.l)f(<<)g(endl;)229 5138
y(cout)g(<<)h(")1743 b(s:)49 b(")h(<<)g(t.s)f(<<)g(endl;)229
5238 y(invokeOp\(tobj,a\);)130 5337 y(})130 5437 y
(catch\(CORBA::COMM_FAILURE&)c(ex\))k({)229 5537 y(cerr)g(<<)h("Caught)
e(system)h(exception)f(COMM_FAILURE,)f(unable)i(to)h(con-)p
eop
%%Page: 83 89
83 88 bop 150 100 a Ff(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(83)150 356 y Fd(tact)49 b(the)g(")598 456 y(<<)h("object.")e(<<)h
(endl;)349 555 y(return)g(-1;)250 655 y(})250 754 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)349
854 y(cerr)g(<<)h("Caught)e(omniORB2)h(fatalException.)e(This)i(indi-)
150 954 y(cates)g(a)h(bug)f(is)g(caught)g(")598 1053
y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h(bug)f(report.\\n")598
1153 y(<<)h("The)f(exception)f(was)h(thrown)g(in)g(file:)g(")h(<<)f
(ex.file\(\))f(<<)i("\\n")598 1253 y(<<)g(")1394 b(line:)49
b(")h(<<)f(ex.line\(\))f(<<)i("\\n")598 1352 y(<<)g("The)f(error)g
(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)j(endl;)349
1452 y(return)f(-1;)250 1551 y(})250 1651 y(catch\(...\))f({)349
1751 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception.")e(<<)j(endl;)349
1850 y(return)f(-1;)250 1950 y(})250 2149 y(return)f(0;)150
2249 y(})150 2448 y(static)150 2548 y(CORBA::Object_ptr)150
2647 y(getObjectReference\(CORBA::ORB_ptr)c(orb\))150
2747 y({)250 2847 y(CosNaming::NamingContext_var)g(rootContext;)250
3046 y(try)49 b({)349 3145 y(//)h(Obtain)e(a)i(reference)e(to)i(the)f
(root)g(context)f(of)i(the)f(Name)g(service:)349 3245
y(CORBA::Object_var)e(initServ;)349 3345 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)349
3544 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))349 3644 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)349 3743 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)349
3843 y(if)g(\(CORBA::is_nil\(rootContext\)\))449 3942
y({)549 4042 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)549 4142 y(return)e(CORBA::Object::_nil\(\);)449
4241 y(})250 4341 y(})250 4441 y(catch\(CORBA::ORB::InvalidName&)c
(ex\))49 b({)349 4540 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)
e([does)h(not)g(exist].")g(<<)g(endl;)349 4640 y(return)g
(CORBA::Object::_nil\(\);)250 4740 y(})250 5038 y(//)g(Create)g(a)g
(name)g(object,)g(containing)f(the)h(name)g(test/context:)250
5138 y(CosNaming::Name)e(name;)250 5238 y(name.length\(2\);)250
5437 y(name[0].id)147 b(=)50 b(\(const)f(char*\))f("test";)348
b(//)49 b(string)g(copied)250 5537 y(name[0].kind)e(=)j(\(const)f
(char*\))f("my_context";)g(//)h(string)g(copied)p eop
%%Page: 84 90
84 89 bop 30 100 a Fr(84)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)130 356 y Fd(name[1].id)147
b(=)50 b(\(const)f(char*\))f("anyExample";)130 456 y(name[1].kind)f(=)j
(\(const)f(char*\))f("Object";)130 555 y(//)h(Note)g(on)h(kind:)e(The)i
(kind)f(field)g(is)g(used)g(to)h(indicate)e(the)h(type)130
655 y(//)g(of)g(the)h(object.)e(This)h(is)h(to)f(avoid)g(conventions)f
(such)h(as)g(that)g(used)130 754 y(//)g(by)g(files)g(\(name.type)f(--)i
(e.g.)f(test.ps)f(=)i(postscript)e(etc.\))130 1053 y(CORBA::Object_ptr)
e(obj;)130 1153 y(try)j({)229 1253 y(//)h(Resolve)e(the)h(name)h(to)f
(an)g(object)g(reference,)f(and)h(as-)30 1352 y(sign)g(the)g(reference)
229 1452 y(//)h(returned)e(to)h(a)h(CORBA::Object:)229
1551 y(obj)f(=)h(rootContext->resolve\(name\);)130 1651
y(})130 1751 y(catch\(CosNaming::NamingContext::N)o(otFoun)o(d&)44
b(ex\))229 1850 y({)329 1950 y(//)49 b(This)g(exception)g(is)g(thrown)g
(if)g(any)g(of)h(the)f(components)f(of)h(the)329 2050
y(//)g(path)g([contexts)g(or)g(the)g(object])g(aren't)f(found:)329
2149 y(cerr)h(<<)g("Context)g(not)g(found.")f(<<)i(endl;)329
2249 y(return)f(CORBA::Object::_nil\(\);)229 2348 y(})130
2448 y(catch)f(\(CORBA::COMM_FAILURE&)e(ex\))k({)229
2548 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)30 2647 y(tact)f(the)g(")478 2747
y(<<)h("naming)e(service.")g(<<)i(endl;)229 2847 y(return)f
(CORBA::Object::_nil\(\);)130 2946 y(})130 3046 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)229
3145 y(throw;)130 3245 y(})130 3345 y(catch)f(\(...\))h({)229
3444 y(cerr)g(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)30 3544 y(vice."<<)g(endl;)229 3644
y(return)h(CORBA::Object::_nil\(\);)130 3743 y(})130
3843 y(return)f(obj;)30 3942 y(})30 4241 y(static)h(void)30
4341 y(invokeOp\(anyExample_ptr&)c(tobj,)k(const)g(CORBA::Any&)f(a\))30
4441 y({)130 4540 y(CORBA::Any_var)f(bp;)130 4740 y(cout)i(<<)g
("Invoking)f(operation.")g(<<)h(endl;)130 4839 y(bp)g(=)h
(tobj->testOp\(a\);)130 5038 y(cout)f(<<)g("Operation)f(completed.)g
(Returned)g(Any:)h(";)130 5138 y(CORBA::ULong)e(ul;)130
5337 y(if)i(\(bp)g(>>=)h(ul\))f({)229 5437 y(cout)g(<<)h("ULong:)e(")i
(<<)f(ul)h(<<)f("\\n")g(<<)h(endl;)130 5537 y(})p eop
%%Page: 85 91
85 90 bop 150 100 a Ff(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(85)250 356 y Fd(else)49 b({)349 456 y(cout)g(<<)h("Unknown)e
(value.")h(<<)g("\\n")g(<<)h(endl;)250 555 y(})150 655
y(})p eop
%%Page: 86 92
86 91 bop 30 100 a Fr(86)1543 b Ff(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)p eop
%%Page: 87 93
87 92 bop 150 981 a Fl(Chapter)44 b(10)150 1399 y Fn(Dynamic)51
b(Management)h(of)g(Any)150 1648 y(V)-23 b(alues)150
2096 y Fr(In)30 b(CORBA)h(speci\002cation)g(2.2,)j(a)d(new)f(facility-)
j Fm(DynAny)c Fr(is)i(intr)n(oduced.)51 b(Pr)n(eviously)-10
b(,)32 b(it)f(is)150 2209 y(not)j(possible)h(to)f(insert)g(or)h
(extract)g(constr)o(ucted)e(and)i(other)f(complex)h(types)e(fr)n(om)j
(an)f Fm(any)150 2322 y Fr(without)22 b(using)g(the)g(stub)h(code)f
(generated)e(by)j(an)h(idl)f(compiler)g(for)g(these)e(types.)27
b(This)c(makes)150 2435 y(it)d(impossible)f(to)g(write)h(generic)f
(servers)f(\(bridges,)h(event)g(channels)g(supporting)f(\002ltering)h
(etc\))150 2548 y(because)i(these)f(servers)g(can)i(not)f(have)h
(static)f(knowledge)e(of)j(all)h(the)e(possible)f(data)i(types)d(that)
150 2661 y(they)i(have)i(to)f(handle.)291 2776 y(T)-8
b(o)21 b(\002ll)h(this)f(gap,)h(the)e Fm(DynAny)f Fr(facility)24
b(is)d(de\002ned)f(to)h(enable)h(traversal)f(of)h(the)f(data)g(value)
150 2889 y(associated)j(with)g(an)h Fm(any)f Fr(at)g(r)o(untime)g(and)h
(extraction)f(of)g(its)g(constituents.)31 b(This)24 b(facility)i(also)
150 3002 y(enables)e(the)f(constr)o(uction)g(of)g(an)i
Fm(any)e Fr(at)h(r)o(untime,)g(without)f(having)h(static)g(knowledge)e
(of)h(its)150 3115 y(types.)291 3231 y(This)k(chapter)f(explains)h(how)
g Fm(DynAny)d Fr(may)j(be)g(used.)40 b(For)26 b(completeness,)f(you)h
(should)150 3344 y(also)g(r)n(ead)g(the)g(DynAny)f(speci\002cation)h
(de\002ned)e(in)j(Chapter)f(7)g(of)h(the)e(CORBA)h(speci\002cation)150
3457 y(2.2.)50 b(Wher)n(e)29 b(possible,)h(the)f(implementation)h(in)g
(omniORB2)g(adher)n(es)f(closely)g(to)g(the)g(speci-)150
3570 y(\002cation.)44 b(However)-7 b(,)28 b(ther)n(e)f(ar)n(e)h(ar)n
(eas)g(in)h(the)e(speci\002cation)h(that)g(ar)n(e)g(ambiguous)g(or)f
(lacking)150 3682 y(in)e(details.)34 b(A)25 b(number)f(of)h(these)e
(issues)g(ar)n(e)j(curr)n(ently)e(opened)f(with)h(the)g(ORB)h(r)n
(evision)g(task)150 3795 y(for)n(ce.)32 b(Until)25 b(the)e(issues)f(ar)
n(e)j(r)n(esolved,)e(it)h(is)g(possible)f(that)h(a)h(dif)n(fer)n(ent)f
(implementation)g(may)150 3908 y(choose)g(to)h(intepr)n(et)f(the)h
(speci\002cation)g(dif)n(fer)n(ently)-10 b(.)36 b(This)25
b(chapter)g(pr)n(ovides)g(clari\002cations)i(to)150 4021
y(the)g(speci\002cation,)i(explains)f(the)g(interpr)n(etation)e(used)h
(and)h(of)n(fers)g(some)f(advice)i(and)f(warn-)150 4134
y(ings)22 b(on)g(potential)h(portability)f(pr)n(oblems.)150
4450 y Fj(10.1)119 b(C++)31 b(mapping)250 4753 y Fd(//)49
b(namespace)f(CORBA)250 4952 y(class)h(ORB)g({)250 5052
y(public:)349 5151 y(...)349 5351 y(class)g(InconsistentTypeCode)d(:)k
(public)f(UserException)e({)j(...)f(};)349 5550 y(DynAny_ptr)f
(create_dyn_any\(const)e(Any&)j(value\);)1815 5778 y
Fr(87)p eop
%%Page: 88 94
88 93 bop 30 100 a Fr(88)770 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)229
456 y Fd(DynAny_ptr)48 b(create_basic_dyn_any\(TypeCode_ptr)c(tc\);)229
655 y(DynStruct_ptr)k(create_dyn_struct\(TypeCode_ptr)c(tc\);)229
854 y(DynSequence_ptr)j(create_dyn_sequence\(TypeCode_ptr)d(tc\);)229
1053 y(DynArray_ptr)k(create_dyn_array\(TypeCode_ptr)c(tc\);)229
1253 y(DynUnion_ptr)k(create_dyn_union\(TypeCode_ptr)c(tc\);)229
1452 y(DynEnum_ptr)k(create_dyn_enum\(TypeCode_ptr)d(tc\);)130
1651 y(};)130 1850 y(typedef)j(DynAny*)h(DynAny_ptr;)130
1950 y(class)f(DynAny_var)g({)i(...)f(};)130 2149 y(class)f(DynAny)h({)
130 2249 y(public:)229 2448 y(class)g(Invalid)g(:)g(public)g
(UserException)e({)j(...)f(};)229 2548 y(class)g(InvalidValue)f(:)h
(public)g(UserException)e({)j(...)f(};)229 2647 y(class)g(TypeMismatch)
f(:)h(public)g(UserException)e({)j(...)f(};)229 2747
y(class)g(InvalidSeq)f(:)i(public)e(UserException)g({)h(...)h(};)229
2946 y(typedef)f(_CORBA_Unbounded_Sequence__Octet)44
b(OctetSeq;)229 3145 y(TypeCode_ptr)k(type\(\))h(const;)229
3345 y(void)g(assign\(DynAny_ptr)e(dyn_any\))h
(throw\(Invalid,SystemException\);)229 3444 y(void)h(from_any\(const)f
(Any&)h(value\))f(throw\(Invalid,SystemException\);)229
3544 y(Any*)h(to_any\(\))g(throw\(Invalid,SystemException\);)229
3644 y(void)g(destroy\(\);)229 3743 y(DynAny_ptr)f(copy\(\);)229
3942 y(DynAny_ptr)g(current_component\(\);)229 4042 y(Boolean)h
(next\(\);)229 4142 y(Boolean)g(seek\(Long)f(index\);)229
4241 y(void)h(rewind\(\);)229 4441 y(void)g(insert_boolean\(Boolean)d
(value\))j(throw\(InvalidValue,SystemException)o(\);)229
4540 y(void)g(insert_octet\(Octet)e(value\))h
(throw\(InvalidValue,SystemException\);)229 4640 y(void)h
(insert_char\(Char)e(value\))i(throw\(InvalidValue,SystemException)o
(\);)229 4740 y(void)g(insert_short\(Short)e(value\))h
(throw\(InvalidValue,SystemException\);)229 4839 y(void)h
(insert_ushort\(UShort)d(value\))j
(throw\(InvalidValue,SystemException\);)229 4939 y(void)g
(insert_long\(Long)e(value\))i(throw\(InvalidValue,SystemException)o
(\);)229 5038 y(void)g(insert_ulong\(ULong)e(value\))h
(throw\(InvalidValue,SystemException\);)229 5138 y(void)h
(insert_float\(Float)e(value\))h
(throw\(InvalidValue,SystemException\);)229 5238 y(void)h
(insert_double\(Double)d(value\))j
(throw\(InvalidValue,SystemException\);)229 5337 y(void)g
(insert_string\(const)e(char*)h(value\))h
(throw\(InvalidValue,SystemException\);)229 5437 y(void)g
(insert_reference\(Object_ptr)c(v\))50 b
(throw\(InvalidValue,SystemExceptio)o(n\);)229 5537 y(void)f
(insert_typecode\(TypeCode_ptr)c(v\))k
(throw\(InvalidValue,SystemException\);)p eop
%%Page: 89 95
89 94 bop 150 100 a Ff(10.1.)52 b(C++)23 b(MAPPING)2456
b Fr(89)349 356 y Fd(void)49 b(insert_any\(const)e(Any&)i(value\))g
(throw\(InvalidValue,SystemException\))o(;)349 555 y(Boolean)g
(get_boolean\(\))e(throw\(TypeMismatch,SystemException\);)349
655 y(Octet)i(get_octet\(\))f(throw\(TypeMismatch,SystemException\))o
(;)349 754 y(Char)h(get_char\(\))f
(throw\(TypeMismatch,SystemException\);)349 854 y(Short)h
(get_short\(\))f(throw\(TypeMismatch,SystemException\))o(;)349
954 y(UShort)h(get_ushort\(\))f(throw\(TypeMismatch,SystemExceptio)o
(n\);)349 1053 y(Long)h(get_long\(\))f
(throw\(TypeMismatch,SystemException\);)349 1153 y(ULong)h
(get_ulong\(\))f(throw\(TypeMismatch,SystemException\))o(;)349
1253 y(Float)h(get_float\(\))f(throw\(TypeMismatch,SystemException\))o
(;)349 1352 y(Double)h(get_double\(\))f
(throw\(TypeMismatch,SystemExceptio)o(n\);)349 1452 y(char*)h
(get_string\(\))f(throw\(TypeMismatch,SystemException)o(\);)349
1551 y(Object_ptr)g(get_reference\(\))f
(throw\(TypeMismatch,SystemException\);)349 1651 y(TypeCode_ptr)h
(get_typecode\(\))f(throw\(TypeMismatch,SystemException\))o(;)349
1751 y(Any*)i(get_any\(\))f(throw\(TypeMismatch,SystemException\);)349
1950 y(static)h(DynAny_ptr)f(_duplicate\(DynAny_ptr\);)349
2050 y(static)h(DynAny_ptr)f(_narrow\(DynAny_ptr\);)349
2149 y(static)h(DynAny_ptr)f(_nil\(\);)250 2249 y(};)250
2448 y(//)h(DynFixed)f(is)i(not)f(supported.)250 2647
y(typedef)f(DynEnum*)g(DynEnum_ptr;)250 2747 y(class)h(DynEnum_var)e({)
j(...)f(};)250 2946 y(class)g(DynEnum)f(:)99 b(public)49
b(DynAny)g({)250 3046 y(public:)349 3245 y(char*)g
(value_as_string\(\);)349 3345 y(void)g(value_as_string\(const)d(char*)
j(value\);)349 3444 y(ULong)g(value_as_ulong\(\);)349
3544 y(void)g(value_as_ulong\(ULong)d(value\);)349 3743
y(static)j(DynEnum_ptr)f(_duplicate\(DynEnum_ptr\);)349
3843 y(static)h(DynEnum_ptr)f(_narrow\(DynAny_ptr\);)349
3942 y(static)h(DynEnum_ptr)f(_nil\(\);)250 4042 y(};)250
4241 y(typedef)g(char*)h(FieldName;)250 4341 y(typedef)f(String_var)g
(FieldName_var;)250 4540 y(struct)g(NameValuePair)g({)349
4640 y(String_member)g(id;)349 4740 y(Any)i(value;)250
4839 y(};)250 5038 y(typedef)e(_CORBA_ConstrType_Variable_Var<NameV)o
(alueP)o(air>)c(NameValuePair_var;)250 5138 y(typedef)k
(_CORBA_Unbounded_Sequence<NameValueP)o(air)c(>)49 b(NameValuePairSeq;)
250 5337 y(typedef)f(DynStruct*)g(DynStruct_ptr;)250
5437 y(class)h(DynStruct_var)e({)j(...)f(};)p eop
%%Page: 90 96
90 95 bop 30 100 a Fr(90)770 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)130
356 y Fd(class)48 b(DynStruct)h(:)99 b(public)49 b(DynAny)f({)130
456 y(public:)229 655 y(char*)99 b(current_member_name\(\);)229
754 y(TCKind)49 b(current_member_kind\(\);)229 854 y(NameValuePairSeq*)
e(get_members\(\);)229 954 y(void)i(set_members\(const)e
(NameValuePairSeq&)g(NVSeqVal\))1076 1053 y
(throw\(InvalidSeq,SystemException\);)229 1253 y(static)i
(DynStruct_ptr)e(_duplicate\(DynStruct_ptr\);)229 1352
y(static)i(DynStruct_ptr)e(_narrow\(DynAny_ptr\);)229
1452 y(static)i(DynStruct_ptr)e(_nil\(\);)130 1551 y(};)130
1751 y(typedef)h(DynUnion*)g(DynUnion_ptr;)130 1850 y(class)g
(DynUnion_var)g({)i(...)f(};)130 2050 y(class)f(DynUnion)h(:)99
b(public)49 b(DynAny)g({)130 2149 y(public:)229 2348
y(Boolean)g(set_as_default\(\);)229 2448 y(void)g
(set_as_default\(Boolean)d(value\);)229 2548 y(DynAny_ptr)i
(discriminator\(\);)229 2647 y(TCKind)h(discriminator_kind\(\);)229
2747 y(DynAny_ptr)f(member\(\);)229 2847 y(char*)99 b(member_name\(\);)
229 2946 y(void)49 b(member_name\(const)e(char*)i(value\);)229
3046 y(TCKind)g(member_kind\(\);)229 3245 y(static)g(DynUnion_ptr)f
(_duplicate\(DynUnion_ptr\);)229 3345 y(static)h(DynUnion_ptr)f
(_narrow\(DynAny_ptr\);)229 3444 y(static)h(DynUnion_ptr)f(_nil\(\);)
130 3544 y(};)130 3743 y(typedef)g(_CORBA_Unbounded_Sequence<Any)d(>)k
(AnySeq;)130 3942 y(typedef)f(DynSequence*)g(DynSequence_ptr;)130
4042 y(class)g(DynSequence_var)g({)h(...)g(};)130 4241
y(class)f(DynSequence)g(:)100 b(public)48 b(DynAny)h({)130
4341 y(public:)229 4540 y(ULong)g(length\(\);)229 4640
y(void)g(length)g(\(ULong)g(value\);)229 4740 y(AnySeq*)g
(get_elements\(\);)229 4839 y(void)g(set_elements\(const)e(AnySeq&)h
(value\))h(throw\(InvalidValue,SystemException\))o(;)229
5038 y(static)g(DynSequence_ptr)e(_duplicate\(DynSequence_ptr\);)229
5138 y(static)i(DynSequence_ptr)e(_narrow\(DynAny_ptr\);)229
5238 y(static)i(DynSequence_ptr)e(_nil\(\);)130 5337
y(};)130 5537 y(typedef)h(DynArray*)g(DynArray_ptr;)p
eop
%%Page: 91 97
91 96 bop 150 100 a Ff(10.2.)52 b(THE)21 b(DYNANY)h(INTERF)-7
b(ACE)1935 b Fr(91)250 356 y Fd(class)49 b(DynArray_var)e({)j(...)f(};)
250 555 y(class)g(DynArray)f(:)h(public)g(DynAny)g({)250
655 y(public:)349 854 y(AnySeq*)g(get_elements\(\);)349
954 y(void)g(set_elements\(const)e(AnySeq&)h(value\))h
(throw\(InvalidValue,SystemException\))o(;)349 1153 y(static)g
(DynArray_ptr)f(_duplicate\(DynArray_ptr\);)349 1253
y(static)h(DynArray_ptr)f(_narrow\(DynAny_ptr\);)349
1352 y(static)h(DynArray_ptr)f(_nil\(\);)250 1452 y(};)150
1886 y Fj(10.2)119 b(The)29 b(DynAny)i(Interface)150
2112 y Fi(10.2.1)99 b(Example:)29 b(extract)c(data)g(values)g(from)f
(an)h(Any)150 2301 y Fr(If)17 b(an)h Fm(any)f Fr(contains)g(a)h(value)g
(of)g(one)e(of)i(the)e(basic)j(data)e(types,)f(its)h(value)h(can)h(be)e
(extracted)f(using)150 2414 y(the)31 b(pr)n(e-de\002ned)e(operators)h
(in)i(the)f(Any)g(interface.)55 b(When)31 b(the)g(value)h(is)g(a)g(str)
o(uct)f(or)g(other)150 2527 y(non-basic)24 b(types,)c(one)i(can)h(use)f
(the)g(DynAny)f(interface)i(to)f(extract)g(its)h(constituent)e(values.)
291 2646 y(In)k(this)g(section,)h(we)f(use)f(a)i(str)o(uct)f(as)h(an)g
(example)f(to)g(illustrate)h(how)f(the)f(DynAny)h(inter)n(-)150
2758 y(face)e(can)h(be)e(used.)291 2877 y(The)g(example)h(str)o(uct)e
(is)i(as)g(follows:)349 3112 y Fd(//)50 b(IDL)349 3311
y(struct)f(exampleStruct1)e({)449 3410 y(string)i(s;)449
3510 y(double)g(d;)449 3610 y(long)149 b(l;)349 3709
y(};)291 4051 y Fr(T)-8 b(o)22 b Fm(create)j Fr(a)e(DynAny)f(fr)n(om)h
(an)g(Any)f(value,)h(one)f(uses)f(the)h Fe(create)p 2768
4051 28 4 v 30 w(dyn)p 2963 4051 V 31 w(any)g Fr(method:)349
4285 y Fd(//)50 b(C++)349 4484 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
4684 y(Any)h(v;)349 4783 y(...)348 b(//)50 b(Initialise)e(v)h(to)h
(contain)e(a)i(value)f(of)g(type)g(exampleStruct1.)349
4983 y(CORBA::DynAny_var)e(dv)i(=)h(orb->create_dyn_any\(v\);)291
5324 y Fr(Like)23 b(CORBA)g(object)g(and)g(pseudo)e(object)i(r)n(efer)n
(ences,)f(a)i Fe(DynAny)p 2705 5324 V 30 w(ptr)e Fr(can)i(be)f(managed)
150 5437 y(by)f(a)p 346 5437 V 55 w(var)h(type)d(\()p
Fe(DynAny)p 1093 5437 V 30 w(var)p Fr(\))h(which)h(will)h(r)n(elease)f
(the)f Fe(DynAny)p 2562 5437 V 30 w(ptr)f Fr(automatically)k(when)150
5550 y(the)e(variable)i(goes)d(out)h(of)h(scope.)p eop
%%Page: 92 98
92 97 bop 30 100 a Fr(92)770 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)30
356 y Fm(10.2.1.1)92 b(Iterate)26 b(through)21 b(the)i(components)30
533 y Fr(Once)f(the)e(DynAny)g(object)h(is)g(cr)n(eated,)g(we)g(can)h
(use)e(the)g(DynAny)g(interface)i(to)e(extract)h(the)f(in-)30
646 y(dividual)28 b(components)d(in)i Fe(exampleStruct1)o
Fr(.)34 b(The)26 b(DynAny)g(interface)h(pr)n(ovides)f(a)h(num-)30
759 y(ber)f(of)g(functions)g(to)f(extract)h(and)g(insert)g(component)e
(values.)39 b(These)25 b(functions)g(ar)n(e)i(de\002ned)30
872 y(to)22 b(operate)f(on)h(the)g(component)f(identi\002ed)h(by)g(the)
g Fm(current)i(component)d Fr(pointer)-7 b(.)171 985
y(A)34 b Fm(current)h(component)e Fr(pointer)g(is)h(an)h(internal)f
(state)f(of)h(a)h(DynAny)e(object.)62 b(When)34 b(a)30
1098 y(DynAny)26 b(object)i(is)f(cr)n(eated,)h(the)e(pointer)g(is)i
(initialised)g(to)f(point)f(to)h(the)g(\002rst)f(component)g(of)30
1210 y(the)c(any)g(value.)171 1323 y(The)27 b(pointer)f(can)i(be)g
(advanced)g(to)e(the)h(next)g(component)f(with)h(the)g
Fe(next\(\))d Fr(operation.)30 1436 y(The)d(function)h(r)n(eturns)e(F)
-7 b(ALSE)20 b(\(0\))j(if)g(ther)n(e)d(ar)n(e)i(no)g(mor)n(e)f
(components.)26 b(Otherwise)20 b(it)i(r)n(eturns)30 1549
y(TRUE)27 b(\(1\).)46 b(When)28 b(the)f(any)h(value)h(in)g(the)f
(DynAny)f(object)h(contains)g(only)g(one)g(component,)30
1662 y(the)22 b Fe(next\(\))e Fr(operation)h(always)i(r)n(eturns)f(F)-7
b(ALSE\(0\).)171 1775 y(Another)28 b(way)h(of)g(adjusting)g(the)f
(pointer)h(is)g(the)f Fe(seek\(\))f Fr(operation.)47
b(The)28 b(function)i(r)n(e-)30 1888 y(turns)25 b(F)-7
b(ALSE)24 b(\(0\))j(if)g(ther)n(e)e(is)h(no)g(component)e(at)i(the)f
(speci\002ed)g(index.)37 b(Otherwise)25 b(it)h(r)n(eturns)30
2001 y(TRUE)35 b(\(1\).)68 b(The)35 b(index)g(value)h(of)g(the)f
(\002rst)g(component)f(is)i(zer)n(o.)67 b(Ther)n(efor)n(e,)38
b(a)e Fe(seek\(0\))30 2114 y Fr(call)28 b(r)n(ewinds)e(the)g(pointer)f
(to)h(the)g(\002rst)g(component,)g(this)g(is)h(also)g(equivalent)f(to)g
(a)i(call)g(to)e(the)30 2227 y Fe(rewind\(\))19 b Fr(operation.)171
2340 y(For)25 b(completeness,)g(we)g(should)g(also)i(mention)e(her)n(e)
h(the)f Fe(current)p 2665 2340 28 4 v 29 w(component\(\))c
Fr(op-)30 2453 y(eration.)64 b(This)35 b(operation)f(causes)g(the)g
(DynAny)h(object)f(to)h(r)n(eturn)f(a)h(r)n(efer)n(ence)g(to)f(another)
30 2566 y(DynAny)40 b(object)i(that)f(can)h(be)f(used)f(to)h(access)g
(the)f(curr)n(ent)h(component.)83 b(It)40 b(is)i(possible)30
2679 y(that)e(the)f(curr)n(ent)h(component)e(pointer)h(is)h(not)g
(pointing)f(to)h(a)g(valid)i(component,)g(for)e(in-)30
2791 y(stance,)f(the)c Fe(next\(\))f Fr(operation)h(has)h(been)g
(invoked)f(and)h(ther)n(e)g(is)g(no)g(mor)n(e)g(component.)30
2904 y(Under)g(this)i(cir)n(cumstance,)k(the)37 b Fe(current)p
1657 2904 V 29 w(component\(\))c Fr(operation)k(r)n(eturns)f(a)i(nil)h
(Dy-)30 3017 y(nAny)22 b(object)h(r)n(efer)n(ence)905
2984 y Fk(1)942 3017 y Fr(.)29 b(For)22 b(components)f(which)j(ar)n(e)f
(just)g(basic)h(data)f(types,)e(calling)k Fe(cur-)30
3130 y(rent)p 255 3130 V 31 w(component\(\))e Fr(is)k(an)i(overkill)f
(because)f(we)g(can)i(just)e(use)g(the)f(basic)j(type)e(extraction)30
3243 y(and)c(insertion)e(functions)i(dir)n(ectly)-10
b(.)30 3495 y Fm(10.2.1.2)92 b(Extract)25 b(basic)f(type)e(components)
30 3672 y Fr(In)g(our)g(example,)h(the)e(component)h(values)h(can)g(be)
g(extracted)e(as)i(follows:)229 3872 y Fd(CORBA::String_var)47
b(s)j(=)f(dv->get_string\(\);)229 3971 y(CORBA::Double)247
b(d)50 b(=)f(dv->get_double\(\);)229 4071 y(CORBA::Long)347
b(l)50 b(=)f(dv->get_long\(\);)171 4284 y Fr(Each)25
b(get)f(basic)h(type)f(operation)f(has)i(the)f(side-ef)n(fect)g(of)g
(advancing)i(the)e(curr)n(ent)g(compo-)30 4397 y(nent)e(pointer)-7
b(.)27 b(For)21 b(instance:)229 4596 y Fd(CORBA::String_var)47
b(s)j(=)f(dv->get_string\(\);)171 4809 y Fr(is)23 b(equivalent)g(to:)
229 5009 y Fd(CORBA::DynAny_var)47 b(temp)i(=)h
(dv->current_component\(\);)229 5109 y(CORBA::String_var)d(s)j(=)f
(temp->get_string\(\);)229 5208 y(dv->next\(\);)p 30
5279 1368 4 v 135 5335 a Fh(1)164 5367 y Fg(T)-7 b(esting)26
b(a)h(nil)f(DynAny)g(object)h(with)g(CORBA::is)p 1676
5367 23 4 v 25 w(nil\(\))f(r)o(eturns)f(TRUE\(1\).)44
b(The)27 b(CORBA)e(2.2)i(speci\002cation)30 5458 y(does)17
b(not)h(specify)e(what)j(is)e(the)h(r)o(eturn)f(value)h(of)f(this)h
(function)h(when)f(the)h(curr)o(ent)e(component)h(pointer)f(is)g
(invalid.)30 5550 y(T)-7 b(o)18 b(ensur)o(e)g(portability)-8
b(,)17 b(it)i(is)f(best)h(to)g(avoid)f(calling)h Fc(current)p
1883 5550 V 26 w(component\(\))e Fg(under)h(this)h(condition.)p
eop
%%Page: 93 99
93 98 bop 150 100 a Ff(10.2.)52 b(THE)21 b(DYNANY)h(INTERF)-7
b(ACE)1935 b Fr(93)291 356 y(The)30 b(get)g(operations)f(ensur)n(e)g
(that)i(the)e(curr)n(ent)i(component)e(is)i(of)g(the)e(same)i(type)e
(as)i(r)n(e-)150 469 y(quested.)74 b(Otherwise,)41 b(the)d(object)h
(thr)n(ows)f(a)h(T)-8 b(ypeMismatch)38 b(exception.)75
b(If)39 b(the)f(curr)n(ent)150 582 y(component)30 b(pointer)h(is)g
(invalid)j(when)d(a)h(get)e(operation)h(is)h(called,)i(the)d(object)g
(also)h(thr)n(ows)150 695 y(a)23 b(T)-8 b(ypeMismatch)22
b(exception)1226 662 y Fk(2)1262 695 y Fr(.)291 808 y(T)-8
b(o)27 b(r)n(epeatedly)f(access)i(the)f(components,)g(one)f(can)j(use)e
(the)g Fe(rewind\(\))d Fr(or)j Fe(seek\(\))e Fr(op-)150
921 y(eration)32 b(to)h(manipulate)g(the)f(curr)n(ent)g(component)g
(pointer)-7 b(.)57 b(For)32 b(instance,)j(to)d(access)h(the)e
Fe(d)150 1034 y Fr(member)23 b(in)g Fe(exampleStruct1)16
b Fr(dir)n(ectly:)349 1238 y Fd(dv->seek\(1\);)496 b(//)50
b(position)e(current)g(component)h(to)g(member)g(d.)349
1338 y(CORBA::Double)247 b(d)50 b(=)f(dv->get_double\(\);)150
1594 y Fm(10.2.1.3)92 b(Extract)25 b(complex)e(components)150
1772 y Fr(When)28 b(a)h(component)e(is)i(not)f(one)f(of)i(the)e(basic)j
(data)f(types,)f(it)g(is)h(not)f(possible)f(to)h(extract)g(its)150
1885 y(value)20 b(using)f(the)g(get)f(operations.)26
b(Instead,)18 b(a)i(DynAny)f(object)g(has)h(to)f(be)g(cr)n(eated)g(fr)n
(om)i(which)150 1998 y(the)h(component)f(is)i(accessed.)291
2112 y(Consider)f(this)g(example:)349 2316 y Fd(//)50
b(IDL)349 2515 y(struct)f(exampleStruct2)e({)449 2615
y(string)i(m1;)449 2714 y(exampleStruct1)e(m2;)349 2814
y(};)291 3030 y Fr(In)29 b(or)n(der)f(to)h(extract)g(the)f(data)h
(members)g(within)g Fe(m2)g Fr(\(of)g(type)f Fe(exampleStruct1)p
Fr(\),)d(we)150 3143 y(use)d Fe(current)p 700 3143 28
4 v 29 w(component\(\))c Fr(as)23 b(follows:)349 3347
y Fd(//)50 b(C++)349 3546 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
3646 y(Any)h(v;)349 3745 y(...)348 b(//)50 b(Initialise)e(v)h(to)h
(contain)e(a)i(value)f(of)g(type)g(exampleStruct2.)349
3945 y(CORBA::DynAny_var)e(dv)i(=)h(orb->create_dyn_any\(v\);)349
4144 y(CORBA::String_var)d(m1)i(=)h(dv->get_string\(\);)96
b(//)50 b(extract)e(member)h(m1)349 4244 y(CORBA::DynAny_var)e(dm)i(=)h
(dv->current_component\(\);)45 b(//)50 b(DynAny)e(refer-)150
4343 y(ence)h(to)h(m2)349 4443 y(CORBA::String_var)d(s)j(=)f
(dm->get_string\(\);)146 b(//)50 b(m2.s)349 4542 y(CORBA::Double)247
b(d)50 b(=)f(dm->get_double\(\);)146 b(//)50 b(m2.d)349
4642 y(CORBA::Long)347 b(l)50 b(=)f(dm->get_long\(\);)246
b(//)50 b(m2.l)150 4898 y Fm(10.2.1.4)92 b(Clean-up)150
5077 y Fr(Now)34 b(we)g(\002nish)g(of)n(f)h(this)f(example)h(with)f(a)h
(description)e(on)h(destr)n(oying)e(DynAny)i(objects.)150
5190 y(Ther)n(e)22 b(ar)n(e)h(two)f(points)f(to)h(r)n(emember:)p
150 5280 1368 4 v 255 5335 a Fh(2)284 5367 y Fg(The)g(CORBA)g(2.2)g
(speci\002cation)g(does)f(not)h(de\002ne)g(the)g(behavior)g(of)g(this)g
(err)o(or)d(condition.)33 b(T)-7 b(o)21 b(ensur)o(e)g(porta-)150
5458 y(bility)-8 b(,)22 b(it)h(is)f(best)g(to)h(avoid)f(calling)h(the)g
(get)f(operations)g(when)i(the)f(curr)o(ent)f(component)h(pointer)f(is)
g(known)h(to)g(be)150 5550 y(invalid.)p eop
%%Page: 94 100
94 99 bop 30 100 a Fr(94)770 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)144
356 y Fr(1.)45 b(A)26 b(DynAny)f(r)n(efer)n(ence)h(\()p
Fe(DynAny)p 1486 356 28 4 v 30 w(ptr)p Fr(\))f(is)h(like)h(any)f(CORBA)
g(object)g(or)f(psuedo)f(object)257 469 y(r)n(efer)n(ence)h(and)h
(should)f(be)h(handled)f(in)h(the)f(same)h(way)-10 b(.)37
b(In)26 b(particular)-7 b(,)27 b(one)e(has)h(to)f(call)257
582 y(the)33 b Fe(CORBA::release)28 b Fr(operation)33
b(to)g(indicate)i(that)e(a)i(DynAny)e(r)n(efer)n(ence)g(will)i(no)257
695 y(longer)22 b(be)h(accessed.)j(In)d(the)e(example,)i(this)f(is)h
(done)e(automatically)j(by)f Fe(DynAny)p 3208 695 V 30
w(var)p Fr(.)144 885 y(2.)45 b(A)e(DynAny)e(object)h(and)h(its)f(r)n
(efer)n(ences)g(ar)n(e)g(separate)g(entities,)k(just)41
b(as)i(a)g(CORBA)257 998 y(object)e(implementation)f(and)g(its)h
(object)f(r)n(efer)n(ences)f(ar)n(e)i(dif)n(fer)n(ent)g(entities.)80
b(While)257 1111 y Fe(CORBA::release)13 b Fr(will)21
b(r)n(elease)d(any)i(r)n(esour)n(ce)e(associated)h(with)g(a)h
Fe(DynAny)p 3073 1111 V 30 w(ptr)p Fr(,)e(one)257 1223
y(has)25 b(to)f(separately)f(destr)n(oy)f(the)i(DynAny)f(object)h(to)g
(avoid)h(any)g(memory)e(leak.)34 b(This)24 b(is)257 1336
y(done)e(by)g(calling)j(the)c Fe(destroy\(\))e Fr(operation.)171
1552 y(In)j(the)g(example,)g(the)g(DynAny)g(object)g(can)i(be)e(destr)n
(oyed)e(as)j(follows:)229 1755 y Fd(//)50 b(C++)229 1854
y(...)229 1954 y(CORBA::DynAny_var)d(dv)i(=)h
(orb->create_dyn_any\(v\);)229 2054 y(...)229 2153 y(dv->destroy\(\);)
229 2353 y(//)g(From)f(now)g(on,)g(one)h(should)e(not)h(invoke)g(any)g
(operation)g(in)g(dv.)g(Oth-)30 2452 y(erwise)g(the)229
2552 y(//)h(behavior)e(is)h(undefined.)30 2910 y Fi(10.2.2)99
b(Example:)29 b(insert)c(data)g(values)g(into)h(an)e(Any)30
3088 y Fr(Using)31 b(the)f(DynAny)h(interface,)j(one)c(can)j(cr)n(eate)
e(an)h(Any)f(value)h(fr)n(om)g(scratch.)55 b(In)31 b(this)g(ex-)30
3201 y(ample,)c(we)f(ar)n(e)g(going)f(to)h(cr)n(eate)g(an)g(Any)g
(containing)g(the)f(value)i(of)f(the)f Fe(exampleStruct1)30
3314 y Fr(type.)171 3427 y(Firstly)-10 b(,)40 b(we)d(have)h(to)f(cr)n
(eate)h(a)g(DynAny)f(to)g(stor)n(e)f(the)h(value)i(using)e(one)f(of)i
(the)f Fe(cre-)30 3540 y(ate)p 200 3540 V 31 w(dyn)e
Fr(functions.)69 b(Because)35 b Fe(exampleStruct1)30
b Fr(is)36 b(a)h(str)o(uct)f(type,)h(we)f(use)f(the)h
Fe(cre-)30 3653 y(ate)p 200 3653 V 31 w(dyn)p 396 3653
V 32 w(struct\(\))19 b Fr(operation.)229 3856 y Fd(//)50
b(C++)229 4055 y(CORBA::ORB_ptr)d(orb;)99 b(//)50 b(orb)f(initialised)f
(by)h(CORBA::ORB_init.)229 4255 y(//)h(create)e(the)i(TypeCode)e(for)h
(exampleStruct.)229 4354 y(StructMemberSeq)e(tc_members;)229
4454 y(tc_members.length\(3\);)229 4554 y(tc_members[0].name)g(=)i
(\(const)g(char*\)"s";)229 4653 y(tc_members[0].type)e(=)i
(CORBA::TypeCode::_duplicate\(CORBA::_t)o(c_str)o(ing\);)229
4753 y(tc_members[0].type_def)d(=)k(CORBA::IDLType::_nil\(\);)229
4852 y(tc_members[1].name)d(=)i(\(const)g(char*\)"d";)229
4952 y(tc_members[1].type)e(=)i(CORBA::TypeCode::_duplicate\(CORBA::_t)
o(c_dou)o(ble\);)229 5052 y(tc_members[1].type_def)d(=)k
(CORBA::IDLType::_nil\(\);)229 5151 y(tc_members[2].name)d(=)i(\(const)
g(char*\)"l";)229 5251 y(tc_members[2].type)e(=)i
(CORBA::TypeCode::_duplicate\(CORBA::_t)o(c_lon)o(g\);)229
5351 y(tc_members[2].type_def)d(=)k(CORBA::IDLType::_nil\(\);)229
5450 y(CORBA::TypeCode_var)d(tc)i(=)h
(orb->create_struct_tc\("IDL:exampl)o(eStru)o(ct1:1.)o(0",)2570
5550 y("exampleStruct1",)p eop
%%Page: 95 101
95 100 bop 150 100 a Ff(10.2.)52 b(THE)21 b(DYNANY)h(INTERF)-7
b(ACE)1935 b Fr(95)2690 356 y Fd(tc_members\);)349 555
y(//)50 b(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g(any)g
(value)349 655 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_struct\(tc\);)150 906 y Fm(10.2.2.1)92
b(Insert)24 b(basic)g(type)f(components)150 1083 y Fr(Once)34
b(the)f(DynAny)f(object)i(is)f(cr)n(eated,)j(we)d(can)h(use)e(the)h
(DynAny)g(interface)g(to)g(insert)g(the)150 1196 y(components.)j(The)26
b(DynAny)f(interface)h(pr)n(ovides)f(a)i(number)f(of)g(insert)f
(operations)g(to)g(insert)150 1308 y(basic)g(types)c(into)i(the)g(any)h
(value.)31 b(In)23 b(our)g(example,)g(the)g(component)f(values)i(can)g
(be)g(inserted)150 1421 y(as)f(follows:)349 1618 y Fd
(CORBA::String_var)47 b(s)j(=)f(\(const)g(char*\)"Hello";)349
1717 y(CORBA::Double)247 b(d)50 b(=)f(3.1416;)349 1817
y(CORBA::Long)347 b(l)50 b(=)f(1;)349 2016 y(dv->insert_string\(s\);)
349 2116 y(dv->insert_double\(d\);)349 2215 y(dv->insert_long\(l\);)291
2425 y Fr(Each)25 b(insert)f(basic)i(type)d(operation)h(has)h(the)e
(side-ef)n(fect)i(of)f(advancing)i(the)e(curr)n(ent)g(com-)150
2538 y(ponent)d(pointer)-7 b(.)27 b(For)22 b(instance:)349
2734 y Fd(dv->insert_string\(s\);)291 2944 y Fr(is)h(equivalent)g(to:)
349 3140 y Fd(CORBA::DynAny_var)47 b(temp)i(=)h
(dv->current_component\(\);)349 3239 y(temp->insert_string\(s\);)349
3339 y(dv->next\(\);)291 3549 y Fr(The)21 b(insert)h(operations)e
(ensur)n(e)h(that)h(the)f(curr)n(ent)g(component)g(is)h(of)g(the)f
(same)h(type)f(as)h(the)150 3662 y(inserted)i(value.)40
b(Otherwise,)26 b(the)f(object)h(thr)n(ows)g(a)g(InvalidV)-8
b(alue)27 b(exception.)38 b(If)26 b(the)g(curr)n(ent)150
3774 y(component)18 b(pointer)h(is)h(invalid)h(when)e(an)h(insert)f
(operation)g(is)h(called,)h(the)e(object)g(also)h(thr)n(ows)150
3887 y(a)j(InvalidV)-8 b(alue)23 b(exception)1146 3854
y Fk(3)1182 3887 y Fr(.)291 4000 y(Sometimes,)33 b(one)e(may)h(just)f
(want)h(to)f(modify)h(one)f(component)g(in)h(an)g(Any)g(value.)56
b(For)150 4113 y(instance,)39 b(one)d(may)g(just)g(want)g(to)g(change)g
(the)f(value)i(of)f(the)g(double)f(member)i(in)f Fe(exam-)150
4226 y(pleStruct1)p Fr(.)23 b(This)g(can)g(be)g(done)e(as)i(follows:)
349 4422 y Fd(//)50 b(C++)349 4622 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
4821 y(Any)h(v;)349 4920 y(...)348 b(//)50 b(Initialise)e(v)h(to)h
(contain)e(a)i(value)f(of)g(type)g(exampleStruct1.)349
5120 y(CORBA::Double)f(d)h(=)h(6.28;)p 150 5280 1368
4 v 255 5335 a Fh(3)284 5367 y Fg(The)22 b(CORBA)g(2.2)g
(speci\002cation)g(does)f(not)h(de\002ne)g(the)g(behavior)g(of)g(this)g
(err)o(or)d(condition.)33 b(T)-7 b(o)21 b(ensur)o(e)g(porta-)150
5458 y(bility)-8 b(,)17 b(it)h(is)f(best)h(to)g(avoid)g(calling)f(the)i
(insert)e(operations)g(when)i(the)g(curr)o(ent)e(component)i(pointer)e
(is)g(known)i(to)f(be)150 5550 y(invalid.)p eop
%%Page: 96 102
96 101 bop 30 100 a Fr(96)770 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)229
356 y Fd(CORBA::DynAny_var)47 b(dv)i(=)h(orb->create_dyn_any\(v\);)229
555 y(dv->seek\(1\);)229 655 y(dv->insert_double\(d\);)196
b(//)49 b(Change)g(the)g(value)g(of)g(the)h(member)e(d.)171
819 y Fr(Finally)-10 b(,)20 b(the)d(any)h(value)h(can)g(be)f(obtained)g
(fr)n(om)g(the)g(DynAny)f(object)h(using)f(the)g Fe(to)p
3150 819 28 4 v 32 w(any\(\))30 932 y Fr(operation:)229
1083 y Fd(CORBA::Any_var)47 b(v)j(=)g(dv->to_any\(\);)197
b(//)49 b(Obtain)g(the)g(any)g(value.)30 1327 y Fm(10.2.2.2)92
b(Insert)24 b(complex)g(components)30 1503 y Fr(When)30
b(a)i(component)e(is)h(not)f(one)h(of)g(the)f(basic)i(data)g(types,)f
(it)g(is)g(not)f(possible)h(to)f(insert)g(its)30 1616
y(value)23 b(using)f(the)g(insert)f(operations.)26 b(Instead,)21
b(a)i(DynAny)e(object)i(has)f(to)g(be)g(cr)n(eated)g(thr)n(ough)30
1729 y(which)h(the)f(component)f(can)j(be)e(inserted.)171
1842 y(In)29 b(our)f(example,)j(one)d(can)i(insert)e(component)g
(values)h(into)g Fe(exampleStruct2)23 b Fr(as)29 b(fol-)30
1955 y(lows:)229 2106 y Fd(//)50 b(C++)229 2306 y(CORBA::ORB_ptr)d
(orb;)99 b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)229
2505 y(CORBA::TypeCode_var)e(tc;)229 2604 y(//)j(create)e(the)i
(TypeCode)e(for)h(exampleStruct2.)229 2704 y(...)229
2804 y(//)h(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g
(any)g(value)229 2903 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_struct\(tc\);)229 3103 y(CORBA::String_var)d(m1)99
b(=)50 b(\(const)e(char*\)"Greetings";)229 3202 y(CORBA::String_var)f
(m2s)i(=)h(\(const)e(char*\)"Hello";)229 3302 y(CORBA::Double)247
b(m2d)49 b(=)h(3.1416;)229 3401 y(CORBA::Long)347 b(m2l)49
b(=)h(1;)229 3601 y(dv->insert_string\(m1\);)146 b(//)49
b(insert)g(member)f(m1)229 3700 y(CORBA::DynAny_var)f(dm)i(=)h
(dv->current_component\(\);)45 b(//)50 b(DynAny)e(refer-)30
3800 y(ence)h(to)g(m2)229 3900 y(dm->insert_string\(m2s\);)96
b(//)49 b(insert)g(member)f(m2.s)229 3999 y(dm->insert_double\(m2d\);)
96 b(//)49 b(insert)g(member)f(m2.d)229 4099 y(dm->insert_long\(m2l\);)
196 b(//)49 b(insert)g(member)f(m2.l)229 4298 y(CORBA::Any_var)f(v)j(=)
g(dv->to_any\(\);)97 b(//)49 b(obtain)g(the)g(any)h(value)229
4497 y(dv->destroy\(\);)496 b(//)49 b(destroy)g(the)g(DynAny)g(object.)
1425 4597 y(//)g(No)h(operation)e(should)g(be)i(invoked)e(on)i(dv)1425
4697 y(//)f(from)g(this)g(point)g(on)h(ex-)30 4796 y(cept)f
(CORBA::release.)171 4961 y Fr(In)28 b(addition)f(to)g(the)g(DynAny)g
(interface,)i(a)f(number)g(of)g(derived)f(interfaces)g(ar)n(e)h
(de\002ned.)30 5074 y(These)f(interfaces)i(ar)n(e)g(specialisation)g
(of)g(the)f(DynAny)f(interface)i(to)f(facilitate)j(the)d(handling)30
5186 y(of)g(any)h(values)f(containing)h(non-basic)g(types:)37
b(str)o(uct,)29 b(sequence,)e(array)-10 b(,)30 b(enum)e(and)g(union)
3390 5153 y Fk(4)3427 5186 y Fr(.)30 5299 y(The)22 b(next)g(few)g
(sections)f(will)j(pr)n(ovide)e(mor)n(e)h(details)f(on)h(these)d
(interfaces.)p 30 5370 1368 4 v 135 5427 a Fh(4)164 5458
y Fg(In)f(the)f(CORBA)f(2.2)h(speci\002cation,)g(the)g(DynFixed)e
(interface)i(is)f(de\002ned)g(to)h(handle)g(the)g(\002xed)f(data)h
(type.)k(This)30 5550 y(is)c(not)h(supported)f(in)h(this)g
(implementation.)p eop
%%Page: 97 103
97 102 bop 150 100 a Ff(10.3.)52 b(THE)21 b(DYNSTRUCT)h(INTERF)-7
b(ACE)1787 b Fr(97)150 356 y Fj(10.3)119 b(The)29 b(DynStruct)h
(Interface)150 570 y Fr(When)37 b(a)g(DynAny)f(object)h(is)h(cr)n
(eated)e(thr)n(ough)g(the)h Fe(create)p 2460 570 28 4
v 30 w(dyn)p 2655 570 V 31 w(any\(\))e Fr(operation)h(and)150
683 y(the)50 b(any)i(value)g(contains)f(a)h(str)o(uct)e(type,)57
b(a)52 b(DynStr)o(uct)f(object)g(is)g(cr)n(eated.)113
b(The)51 b(Dy-)150 796 y(nAny)j(r)n(efer)n(ence)f(r)n(eturned)g(can)i
(be)f(narr)n(owed)g(to)g(a)h(DynStr)o(uct)e(r)n(efer)n(ence)h(using)g
(the)150 908 y Fe(CORBA::DynStruc)o(t:)o(:)p 1143 908
V 27 w(narrow\(\))19 b Fr(operation.)291 1023 y(In)56
b(the)g(pr)n(evious)g(example,)65 b(the)56 b(components)f(ar)n(e)i
(extracted)e(using)h(the)g(get)f(op-)150 1136 y(erations.)108
b(Alternatively)-10 b(,)55 b(the)49 b(DynStr)o(uct)g(interface)g(pr)n
(ovides)g(an)h(addition)f(operation)150 1249 y(\()p Fe(get)p
350 1249 V 32 w(members\(\))p Fr(\))26 b(to)j(r)n(eturn)f(all)k(the)c
(components)g(in)i(a)h(single)e(call.)50 b(The)29 b(r)n(eturned)f
(value)150 1362 y(is)h(a)g(sequence)e(of)i(name)g(value)g(pair)-7
b(.)47 b(The)28 b(member)h(name)g(is)g(given)g(in)g(the)f(name)h
(\002eld)f(and)150 1474 y(its)e(value)h(is)g(r)n(eturned)d(as)j(an)g
(Any)e(value.)40 b(For)25 b(example,)i(an)g(alternative)g(way)f(to)g
(extract)g(the)150 1587 y(components)21 b(in)i(the)f(pr)n(evious)g
(example)g(is)h(as)g(follows:)349 1795 y Fd(//)50 b(C++)349
1994 y(CORBA::ORB_ptr)d(orb;)99 b(//)50 b(orb)f(initialised)f(by)h
(CORBA::ORB_init.)349 2094 y(Any)h(v;)349 2194 y(...)348
b(//)50 b(Initialise)e(v)h(to)h(contain)e(a)i(value)f(of)g(type)g
(exampleStruct1.)349 2293 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_any\(v\);)349 2492 y(CORBA::DynStruct_var)c(ds)k(=)f
(CORBA::DynStruct::_narrow\(dv\);)349 2692 y(CORBA::NameValuePairSeq*)d
(sq)j(=)h(ds->get_members\(\);)349 2891 y(char*)448 b(s;)349
2991 y(CORBA::Double)48 b(d;)349 3090 y(CORBA::Long)148
b(l;)349 3289 y(\(*sq\)[0].value)47 b(>>=)j(s;)398 b(//)49
b(1st)h(element)e(contains)g(member)h(s)349 3389 y(\(*sq\)[1].value)e
(>>=)j(d;)398 b(//)49 b(2nd)h(element)e(contains)g(member)h(d)349
3489 y(\(*sq\)[2].value)e(>>=)j(l;)398 b(//)49 b(3rd)h(element)e
(contains)g(member)h(l)291 3708 y Fr(Similarly)-10 b(,)140
b(the)115 b(DynStr)o(uct)g(interface)h(pr)n(ovides)f(an)h(addition)f
(operation)150 3821 y(\()p Fe(set)p 350 3821 V 32 w(members\(\))p
Fr(\))36 b(to)j(insert)g(all)i(the)e(components)f(in)j(a)f(single)f
(call.)82 b(The)39 b(following)h(is)150 3934 y(an)33
b(alternative)g(way)f(to)g(insert)f(the)h(components)e(of)j(the)e(type)
g Fe(exampleStruct1)26 b Fr(into)33 b(an)150 4047 y(Any)22
b(value:)349 4255 y Fd(//)50 b(C++)349 4454 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
4653 y(CORBA::TypeCode_var)e(tc;)349 4753 y(//)j(create)e(the)i
(TypeCode)e(for)h(exampleStruct1.)349 4852 y(...)349
4952 y(//)h(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g
(any)g(value)349 5052 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_struct\(tc\);)349 5251 y(CORBA::String_var)d(s)j(=)f
(\(const)g(char*\)"Hello";)349 5351 y(CORBA::Double)247
b(d)50 b(=)f(3.1416;)349 5450 y(CORBA::Long)347 b(l)50
b(=)f(1;)p eop
%%Page: 98 104
98 103 bop 30 100 a Fr(98)770 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)229
356 y Fd(CORBA::NameValuePairSeq)46 b(sq;)229 456 y(sq.length\(3\);)229
555 y(sq[0].id)j(=)g(\(const)g(char*\)"s";)229 655 y(sq[0].value)f(<<=)
h(CORBA::Any::from_string\(s,0\);)1823 754 y(//)h(1st)f(element)f
(contains)h(member)f(s)229 854 y(sq[1].id)h(=)g(\(const)g(char*\)"d";)
229 954 y(sq[1].value)f(<<=)h(d;)647 b(//)50 b(2nd)f(element)g
(contains)f(member)h(d)229 1053 y(sq[2].id)g(=)g(\(const)g(char*\)"l";)
229 1153 y(sq[2].value)f(<<=)h(l;)647 b(//)50 b(3rd)f(element)g
(contains)f(member)h(l)229 1352 y(dv->set_members\(sq\);)171
1571 y Fr(Notice)21 b(that)g(the)g(name-value)i(pairs)f(in)g(the)f(ar)n
(gument)g(to)g Fe(set)p 2437 1571 28 4 v 32 w(members\(\))c
Fr(must)k(match)30 1684 y(the)g(members)g(of)h(the)f(str)o(uct)h
(exactly)g(or)f(the)g(object)h(would)f(thr)n(ow)h(the)f(InvalidSeq)h
(exception.)171 1798 y(In)c(addition)h(to)f(the)f Fe(current)p
1266 1798 V 30 w(component\(\))d Fr(operation,)k(the)g(DynStr)o(uct)f
(interface)i(pr)n(o-)30 1911 y(vides)j(two)g(operations:)k
Fe(current)p 1313 1911 V 29 w(member)p 1672 1911 V 30
w(name\(\))20 b Fr(and)j Fe(current)p 2614 1911 V 29
w(member)p 2973 1911 V 30 w(kind\(\))p Fr(,)d(to)30 2024
y(r)n(eturn)i(information)h(about)g(the)e(curr)n(ent)i(component.)30
2331 y Fj(10.4)119 b(The)29 b(DynSequence)h(Interface)30
2544 y Fr(Like)24 b(str)o(uct)g(values,)h(sequence)e(values)i(can)h(be)
f(traversed)e(using)h(the)g(operations)f(intr)n(oduced)30
2657 y(in)k(section)e(10.2.)40 b(The)26 b(\002rst)f(sequence)g(element)
g(can)i(be)f(accessed)g(as)g(the)g(\002rst)f(DynAny)g(com-)30
2770 y(ponent,)c(the)h(second)f(sequence)g(element)g(as)i(the)f(second)
f(DynAny)h(component)f(and)i(so)f(on.)171 2884 y(T)-8
b(o)20 b(extract)h(component)f(values)i(fr)n(om)g(an)f(Any)g
(containing)g(a)h(sequence,)e(the)g(length)h(of)g(the)30
2997 y(sequence)c(can)i(be)f(obtained)g(using)g(the)f(get)g(length)h
(operation)f(in)i(the)f(DynSequence)e(interface.)30 3110
y(Her)n(e)22 b(is)g(an)i(example)e(to)g(extract)g(the)g(components)f
(of)i(a)g(sequence)e(of)h(long:)229 3317 y Fd(//)50 b(C++)229
3516 y(CORBA::ORB_ptr)d(orb;)99 b(//)50 b(orb)f(initialised)f(by)h
(CORBA::ORB_init.)229 3616 y(Any)g(v;)229 3716 y(...)348
b(//)50 b(Initialise)e(v)h(to)h(contain)e(a)i(value)f(of)g(a)h(se-)30
3815 y(quence)f(of)g(long)229 3915 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_any\(v\);)229 4114 y(CORBA::DynSequence_var)c(ds)j(=)h
(CORBA::DynSequence::_narrow\(dv\);)229 4214 y(CORBA::ULong)e(len)h(=)h
(ds->length\(\);)246 b(//)50 b(ex-)30 4313 y(tract)f(the)g(length)g(of)
g(the)h(sequence)229 4413 y(CORBA::ULong)e(index;)229
4513 y(for)h(\(index)g(=)h(0;)f(index)g(<)h(len;)f(index++\))f({)329
4612 y(CORBA::Long)g(v)h(=)h(ds->get_long\(\);)329 4712
y(cerr)f(<<)g("[")h(<<)f(index)g(<<)g("])h(=)f(")h(<<)g(v)f(<<)h(endl;)
229 4812 y(})171 5031 y Fr(Conversely)-10 b(,)24 b(the)g(set)f(length)h
(operation)f(is)i(pr)n(ovided)f(to)g(set)f(the)h(length)g(of)g(the)g
(sequence.)30 5144 y(Her)n(e)e(is)g(an)i(example)e(to)g(insert)g(the)g
(components)e(of)j(a)g(sequence)e(of)i(long:)229 5351
y Fd(//)50 b(C++)229 5550 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)p
eop
%%Page: 99 105
99 104 bop 150 100 a Ff(10.5.)52 b(THE)21 b(DYNARRA)-10
b(Y)21 b(INTERF)-7 b(ACE)1829 b Fr(99)349 456 y Fd(CORBA::TypeCode_var)
47 b(tc;)349 555 y(//)j(create)e(the)i(TypeCode)e(for)h(a)h(sequence)e
(of)i(long.)349 655 y(...)349 754 y(//)g(create)e(the)i(DynAny)e
(object)h(to)g(represent)g(the)g(any)g(value)349 854
y(CORBA::DynSequence_var)d(ds)j(=)h(orb->create_dyn_sequence\(tc\);)349
1053 y(CORBA::ULong)e(len)h(=)h(3;)349 1253 y(ds->length\(len\);)645
b(//)49 b(set)h(the)f(length)f(of)i(the)f(sequence)349
1452 y(CORBA::ULong)f(index;)349 1551 y(for)i(\(index)e(=)i(0;)f(index)
g(<)h(len;)f(index++\))f({)449 1651 y(ds->insert_long\(index\);)195
b(//)49 b(insert)g(a)h(sequence)e(element)349 1751 y(})291
1974 y Fr(Similar)25 b(to)d(the)h(DynStr)o(uct)f(interface,)h(the)f
Fe(get)p 2002 1974 28 4 v 32 w(elements\(\))c Fr(operation)k(is)i(pr)n
(ovided)e(to)150 2087 y(r)n(eturn)k(all)i(the)d(sequence)g(elements)g
(and)i(the)f Fe(set)p 1989 2087 V 31 w(elements\(\))c
Fr(operation)j(is)i(pr)n(ovided)f(to)150 2200 y(insert)c(all)i(the)e
(sequence)f(elements.)150 2512 y Fj(10.5)119 b(The)29
b(DynArray)g(Interface)150 2728 y Fr(Array)f(values)g(ar)n(e)g(handled)
f(by)h(the)f(DynArray)h(interface.)43 b(The)27 b(DynArray)h(interface)g
(is)g(the)150 2841 y(same)k(as)f(the)g(DynSequence)f(interface)i
(except)e(that)h(the)g(former)g(does)f(not)h(pr)n(ovide)g(the)g(set)150
2954 y(length)22 b(and)g(get)g(length)g(operations.)150
3266 y Fj(10.6)119 b(The)29 b(DynEnum)i(Interface)150
3482 y Fr(Enum)c(values)g(ar)n(e)h(handled)e(by)h(the)g(DynEnum)f
(interface.)42 b(A)27 b(DynEnum)f(object)h(contains)h(a)150
3594 y(single)20 b(component)e(which)j(is)f(the)g(enum)g(value.)27
b(This)20 b(value)h(cannot)f(be)g(extracted)f(or)h(inserted)150
3707 y(using)32 b(the)h(get)f(and)h(insert)f(operations)f(of)i(the)g
(DynAny)f(interface.)59 b(Instead,)34 b(two)e(pairs)h(of)150
3820 y(operations)21 b(ar)n(e)i(pr)n(ovided)f(to)g(handle)g(this)h
(value.)291 3935 y(The)34 b Fe(value)p 758 3935 V 31
w(as)p 899 3935 V 31 w(string)f Fr(operations)g(allow)j(the)e(enum)g
(value)i(to)e(be)g(extracted)g(or)g(in-)150 4048 y(serted)27
b(as)h(a)i(string.)45 b(The)28 b Fe(value)p 1377 4048
V 30 w(as)p 1517 4048 V 32 w(ulong)e Fr(operations)h(allow)j(the)e
(enum)g(value)i(to)e(be)g(ex-)150 4161 y(tracted)22 b(or)g(inserted)f
(as)i(an)g(unsigned)e(long.)150 4474 y Fj(10.7)119 b(The)29
b(DynUnion)i(Interface)150 4689 y Fr(Union)24 b(values)h(ar)n(e)g
(handled)f(by)g(the)g(DynUnion)g(interface.)33 b(Unfortunately)-10
b(,)23 b(the)h(CORBA)g(2.2)150 4802 y(speci\002cation)g(does)f(not)h
(de\002ne)f(the)g(DynUnion)h(interface)h(in)g(suf)n(\002cent)f(details)
g(to)f(nail)j(down)150 4915 y(its)i(intended)e(usage)895
4882 y Fk(5)931 4915 y Fr(.)44 b(In)28 b(this)f(section,)h(we)g(try)f
(to)g(\002ll)i(in)g(the)e(gaps)g(and)h(describe)f(a)i(sensible)150
5028 y(way)23 b(to)g(use)f(the)h(DynUnion)f(interface.)30
b(Wher)n(e)23 b(necessary)-10 b(,)21 b(the)i(semantics)g(of)g(the)g
(operations)150 5141 y(is)g(clari\002ed.)29 b(It)22 b(is)h(possible)f
(that)g(the)g(behavior)i(of)e(this)h(interface)g(in)g(another)f(ORB)g
(is)h(dif)n(fer)n(ent)150 5254 y(fr)n(om)j(this)f(implmentation.)36
b(Wher)n(e)25 b(appr)n(opriate,)g(we)g(give)h(warnings)f(on)g(usage)f
(that)h(might)150 5366 y(cause)d(pr)n(oblems)h(with)f(portability)-10
b(.)p 150 5462 1368 4 v 255 5518 a Fh(5)284 5550 y Fg(This)19
b(interface)g(is)f(curr)o(ently)f(an)j(open)e(issue)g(with)i(the)f(ORB)
f(r)o(evision)f(task)i(for)o(ce.)p eop
%%Page: 100 106
100 105 bop 30 100 a Fr(100)725 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)171
356 y Fr(In)20 b(r)n(elation)g(to)g(the)f(curr)n(ent)h(component)f
(pointer)f(\(10.2.1.1\),)23 b(a)e(DynUnion)e(object)h(contains)30
469 y(two)i(components.)28 b(The)23 b(\002rst)f(component)g(\(with)i
(the)e(index)h(value)h(equals)f(0\))h(is)f(the)g(discrimi-)30
582 y(nator)h(value,)i(the)d(second)g(one)h(is)h(the)e(member)i(value.)
34 b(Ther)n(efor)n(e,)23 b(one)h(can)i(use)d(the)h Fe(seek\(\))30
695 y Fr(and)h Fe(current)p 599 695 28 4 v 30 w(component\(\))20
b Fr(operations)k(to)g(obtain)i(a)g(r)n(efer)n(ence)e(to)h(the)f
(DynAny)h(objects)30 808 y(that)i(handle)g(the)f(two)h(components.)39
b(However)-7 b(,)27 b(it)g(is)h(better)d(to)i(use)f(the)g(operations)g
(de\002ned)30 920 y(in)33 b(the)e(DynUnion)h(interface)h(to)e
(manipulate)i(these)e(components)g(as)h(the)f(semantics)i(of)f(the)30
1033 y(operations)21 b(is)i(easier)f(to)g(understand.)30
1288 y Fi(10.7.1)99 b(Three)24 b(Categories)i(of)f(Union)30
1464 y Fr(Befor)n(e)19 b(we)g(continue,)h(it)g(is)g(important)g(to)f
(understand)f(that)h(unions)h(can)g(be)g(classi\002ed)g(into)g(the)30
1577 y(following)j(categories:)144 1786 y(1.)45 b(One)33
b(that)g(has)g(a)g(default)g(branch)h(de\002ned)d(in)i(the)f(IDL.)h
(This)f(will)i(be)f(called)h Fm(explicit)257 1899 y(default)24
b(union)d Fr(in)i(the)f(r)n(est)g(of)g(this)h(section.)144
2086 y(2.)45 b(One)22 b(that)f(has)g(no)g(default)g(branch)i(and)e(not)
g(all)i(the)d(possible)h(values)g(of)h(the)e(discrimina-)257
2199 y(tor)j(type)e(ar)n(e)j(cover)n(ed)e(by)h(the)g(branch)h(labels)g
(in)g(the)e(IDL.)g(This)h(will)i(be)e(called)h Fm(implicit)257
2312 y(default)g(union)p Fr(.)144 2498 y(3.)45 b(One)28
b(that)g(has)g(no)g(default)g(branch)h(but)f(all)i(the)d(possible)h
(values)g(of)g(the)f(discriminator)257 2611 y(type)21
b(ar)n(e)i(cover)n(ed.)28 b(This)22 b(will)i(be)e(called)i
Fm(no)e(default)h(union)p Fr(.)171 2820 y(Of)i(the)e(thr)n(ee)g
(categories,)f(the)h(implicit)j(default)d(union)h(is)g(inter)n(esting)e
(because)i(by)f(de\002ni-)30 2933 y(tion)j(if)i(the)e(discriminator)h
(value)h(is)e(not)g(equal)h(to)f(any)h(of)g(the)f(branch)h(labels,)i
(the)d(union)g(has)30 3046 y Fm(no)c Fr(member)-7 b(.)28
b(That)22 b(is,)h(the)f(union)g(value)h(consists)f(solely)g(of)g(the)g
(discriminator)h(value.)30 3300 y Fi(10.7.2)99 b(Example:)29
b(extract)c(data)g(values)g(from)f(a)h(union)30 3477
y Fm(10.7.2.1)92 b(Explicit)24 b(default)g(union)30 3654
y Fr(Consider)e(a)h(union)f(of)h(the)f(following)h(type:)229
3850 y Fd(//)50 b(IDL)229 4049 y(union)f(exampleUnion1)f
(switch\(boolean\))f({)229 4149 y(case)i(TRUE:)g(long)g(l;)229
4248 y(default:)148 b(double)49 b(d;)229 4348 y(};)171
4557 y Fr(The)22 b(most)g(straightforwar)n(d)g(way)g(to)g(extract)g
(the)g(member)h(value)g(is)g(as)f(follows:)229 4753 y
Fd(//)50 b(C++)229 4952 y(CORBA::ORB_ptr)d(orb;)99 b(//)50
b(orb)f(initialised)f(by)h(CORBA::ORB_init.)229 5151
y(Any)g(v;)229 5251 y(...)348 b(//)50 b(Initialise)e(v)h(to)h(contain)e
(a)i(value)f(of)g(type)g(exampleUnion1.)229 5450 y(CORBA::DynAny_var)e
(dv)i(=)h(orb->create_dyn_any\(v\);)229 5550 y(CORBA::DynUnion_var)d
(du)i(=)h(CORBA::DynUnion::_narrow\(dv\);)p eop
%%Page: 101 107
101 106 bop 150 100 a Ff(10.7.)52 b(THE)21 b(DYNUNION)h(INTERF)-7
b(ACE)1773 b Fr(101)349 456 y Fd(CORBA::String_var)47
b(di)i(=)h(du->member_name\(\);)349 555 y(CORBA::DynAny_var)d(dm)i(=)h
(du->member\(\);)349 754 y(if)g(\(strcmp\(\(const)d(char*\)di,"l"\))g
(==)j(0\))f({)449 854 y(//)g(branch)g(label)g(is)g(TRUE)449
954 y(CORBA::Long)f(v)h(=)h(dm->get_long\(\);)449 1053
y(cerr)f(<<)g("l)h(=)f(")h(<<)g(v)f(<<)h(endl;)349 1153
y(})349 1352 y(if)g(\(strcmp\(\(const)d(char*\)di,"d"\))g(==)j(0\))f({)
449 1452 y(//)g(Is)h(default)e(branch)449 1551 y(CORBA::Double)f(v)j(=)
g(dm->get_double\(\);)449 1651 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h
(endl;)349 1751 y(})291 1947 y Fr(In)21 b(the)f(example,)g(the)g
(operation)g Fe(member)p 1818 1947 28 4 v 30 w(name\(\))e
Fr(is)j(used)e(to)i(determine)e(which)i(branch)150 2060
y(the)d(union)g(has)h(been)f(instantiated.)26 b(The)18
b(operation)f Fe(member\(\))e Fr(is)k(used)e(to)h(obtain)i(a)f(r)n
(efer)n(ence)150 2172 y(to)j(the)g(DynAny)g(object)g(that)g(handles)g
(the)g(member)-7 b(.)291 2285 y(Alternatively)d(,)22
b(the)g(branch)h(can)h(be)e(determined)f(by)i(r)n(eading)f(the)g
(discriminator)h(value:)349 2468 y Fd(//)50 b(C++)349
2667 y(CORBA::DynAny_var)d(di)i(=)h(du->discriminator\(\);)349
2767 y(CORBA::DynAny_var)d(dm)i(=)h(du->member\(\);)349
2966 y(CORBA::Boolean)d(di_v)j(=)f(di->get_boolean\(\);)349
3165 y(switch)g(\(di_v\))g({)349 3265 y(case)g(1:)449
3365 y(CORBA::Long)f(v)h(=)h(dm->get_long\(\);)449 3464
y(cerr)f(<<)g("l)h(=)f(")h(<<)g(v)f(<<)h(endl;)449 3564
y(break;)349 3664 y(default:)449 3763 y(CORBA::Double)d(v)j(=)g
(dm->get_double\(\);)449 3863 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h
(endl;)349 3962 y(})291 4158 y Fr(The)19 b(operation)f
Fe(discriminator\(\))13 b Fr(is)20 b(used)e(to)h(obtain)h(the)f(value)h
(of)g(the)e(discriminator)-7 b(.)291 4271 y(Finally)d(,)23
b(the)f(thir)n(d)h(way)f(to)g(determine)f(the)h(branch)i(is)e(to)g
(test)f(if)j(the)e(default)g(is)h(selected:)349 4454
y Fd(//)50 b(C++)349 4653 y(switch)f(\(dv->set_as_default\(\)\))d({)349
4753 y(case)j(1:)449 4852 y(CORBA::Double)e(v)j(=)g
(dm->get_double\(\);)449 4952 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h
(endl;)449 5052 y(break;)349 5151 y(default:)449 5251
y(CORBA::Long)e(v)h(=)h(dm->get_long\(\);)449 5351 y(cerr)f(<<)g("l)h
(=)f(")h(<<)g(v)f(<<)h(endl;)349 5450 y(})p eop
%%Page: 102 108
102 107 bop 30 100 a Fr(102)725 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)171
356 y Fr(The)21 b(operation)g Fe(set)p 925 356 28 4 v
31 w(as)p 1066 356 V 32 w(default\(\))d Fr(r)n(eturns)i(TRUE)h(\(1\))h
(if)h(the)e(discriminator)h(has)g(been)30 469 y(assigned)f(a)i(valid)h
(default)f(value.)30 719 y Fm(10.7.2.2)92 b(Implicit)24
b(default)g(union)30 896 y Fr(Consider)e(a)h(union)f(of)h(the)f
(following)h(type:)229 1087 y Fd(//)50 b(IDL)229 1286
y(union)f(exampleUnion2)f(switch\(long\))f({)229 1385
y(case)i(1:)h(long)f(l;)229 1485 y(case)g(2:)h(double)e(d;)229
1585 y(};)171 1789 y Fr(This)32 b(example)f(is)h(similar)i(to)d(the)g
(pr)n(evious)g(one)g(but)h(ther)n(e)f(is)g(no)h(default)g(branch.)56
b(The)30 1902 y(description)29 b(above)h(also)h(applies)f(to)f(this)h
(example.)50 b(However)-7 b(,)31 b(the)e(discriminator)i(may)f(be)30
2015 y(set)g(to)g(neither)g(1)i(nor)e(2.)54 b(Under)30
b(this)g(condition,)j(the)d(implicit)j(default)e(is)g(selected)e(and)i
(the)30 2128 y(union)22 b(value)i(contains)e(the)g(discriminator)i
(only!)171 2241 y(When)33 b(the)f(discriminator)i(contains)f(an)h
(implicit)h(default)e(value,)k(one)32 b(might)h(ask)g(what)30
2353 y(is)28 b(the)g(value)g(r)n(eturned)f(by)h(the)f
Fe(member)p 1524 2353 V 30 w(name\(\))f Fr(and)i Fe(member\(\))d
Fr(operation.)43 b(Since)28 b(ther)n(e)30 2466 y(is)f(no)g(member)f(in)
i(the)e(union)h(value,)h(omniORB2)g(r)n(eturns)d(a)j(null)g(string)e
(and)h(a)g(nil)h(DynAny)30 2579 y(r)n(efer)n(ence)e(r)n(espectively)-10
b(.)38 b(This)27 b(behavior)g(is)g(not)e(speci\002ed)h(in)h(the)e
(CORBA)i(2.2)g(speci\002cation.)30 2692 y(T)-8 b(o)23
b(ensur)n(e)g(that)h(your)e(application)k(is)e(portable,)f(it)i(is)f
(best)f(to)g(avoid)i(calling)g(these)e(operations)30
2805 y(when)f(the)g(DynUnion)g(object)g(might)h(contain)g(an)g
(implicit)i(default)d(value.)30 3055 y Fm(10.7.2.3)92
b(No)22 b(default)i(union)30 3232 y Fr(This)e(is)h(the)f(last)h(union)f
(category)-10 b(.)27 b(For)21 b(instance:)229 3423 y
Fd(//)50 b(IDL)229 3622 y(union)f(exampleUnion3)f(switch\(boolean\))f
({)229 3722 y(case)i(TRUE:)g(long)g(l;)229 3821 y(case)g(FALSE:)g
(double)g(d;)229 3921 y(};)171 4125 y Fr(In)27 b(this)g(example,)h(all)
g(the)f(possible)f(values)i(of)f(the)f(discriminator)i(ar)n(e)g(used)d
(as)j(union)f(la-)30 4238 y(bels.)46 b(Ther)n(e)28 b(is)h(no)g(default)
f(branch.)47 b(The)28 b(only)h(dif)n(fer)n(ence)g(between)e(this)i
(category)e(and)i(the)30 4351 y(explicit)20 b(default)f(union)g(is)g
(that)g(the)f Fe(set)p 1481 4351 V 31 w(as)p 1622 4351
V 32 w(default\(\))d Fr(operation)j(always)i(r)n(eturns)e(F)-7
b(ALSE)30 4464 y(\(0\).)30 4717 y Fi(10.7.3)99 b(Example:)29
b(insert)c(data)g(values)g(into)h(a)e(union)30 4894 y
Fr(W)-7 b(riting)34 b(into)f(a)h(union)g(involves)g(selecting)e(the)h
(union)g(branch)i(with)e(the)g(appr)n(opriate)g(dis-)30
5007 y(criminator)26 b(value)f(and)g(then)e(writing)i(the)f(member)g
(value.)35 b(Ther)n(e)24 b(ar)n(e)h(thr)n(ee)e(ways)h(to)g(set)g(the)30
5120 y(discriminator)f(value:)144 5324 y(1.)45 b(Use)25
b(the)h Fe(member)p 924 5324 V 30 w(name\(\))d Fr(write)j(operation)f
(to)g(specify)h(the)f(union)h(branch)h(by)f(speci-)257
5437 y(fying)21 b(the)g(union)g(member)g(dir)n(ectly)-10
b(.)27 b(This)21 b(operation)f(has)i(the)e(side)h(ef)n(fect)g(of)g
(setting)f(the)257 5550 y(discriminator)k(to)e(the)f(label)j(value)g
(of)e(the)g(branch.)p eop
%%Page: 103 109
103 108 bop 150 100 a Ff(10.7.)52 b(THE)21 b(DYNUNION)h(INTERF)-7
b(ACE)1773 b Fr(103)264 356 y(2.)45 b(W)-7 b(rite)23
b(the)g(label)h(value)g(of)f(a)h(union)f(branch)h(into)f(the)g(DynAny)f
(object)h(that)g(handles)g(the)377 469 y(discriminator)-7
b(.)264 659 y(3.)45 b(If)53 b(the)f(union)g(has)h(a)g(default)g
(branch,)60 b(either)52 b(explicitly)h(or)g(implicitly)-10
b(,)61 b(use)52 b(the)377 772 y Fe(set)p 547 772 28 4
v 32 w(as)p 689 772 V 31 w(default\(\))25 b Fr(write)j(operation)g(to)g
(set)g(the)f(discriminator)j(to)e(a)h(valid)h(default)377
885 y(value.)291 1101 y(The)22 b(following)h(example)f(shows)g(the)f
(thr)n(ee)h(ways)g(of)h(writing)f(into)h(a)g(union:)349
1304 y Fd(//)50 b(C++)349 1503 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
1702 y(CORBA::TypeCode_var)e(tc;)349 1802 y(//)j(create)e(the)i
(TypeCode)e(for)h(exampleUnion1.)349 1902 y(...)349 2001
y(//)h(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g(any)g
(value)349 2101 y(CORBA::DynUnion_var)e(dv)i(=)h
(orb->create_dyn_union\(tc\);)349 2300 y(CORBA::Any_var)d(v;)349
2400 y(DynAny_ptr)h(dm;)349 2599 y(//)i(Use)f(member_name)f(to)h
(select)g(the)g(union)g(branch)349 2699 y(dv->member_name\("l"\);)349
2798 y(dm)h(=)f(dv->member\(\);)349 2898 y(dm->insert_long\(10\);)349
2997 y(v)h(=)g(dv->to_any\(\);)495 b(//)50 b(transfer)e(to)h(an)h(Any)
349 3097 y(CORBA::release\(dm\);)349 3296 y(//)g(Setting)e(the)h
(discriminator)f(value)h(to)g(select)g(the)g(union)g(branch)349
3396 y(CORBA::DynAny_var)e(di)i(=)h(dv->discriminator\(\);)349
3496 y(di->insert_boolean\(1\);)245 b(//)50 b(set)f(discriminator)e(to)
j(label)f(TRUE)349 3595 y(dm)h(=)f(dv->member\(\);)349
3695 y(dm->insert_long\(20\);)349 3794 y(v)h(=)g(dv->to_any\(\);)495
b(//)50 b(transfer)e(to)h(an)h(Any)349 3894 y(CORBA::release\(dm\);)349
4093 y(//)g(Use)f(set_as_default)e(to)j(select)e(the)i(default)e(union)
h(branch)349 4193 y(dv->set_as_default\(1\);)349 4293
y(dm)h(=)f(dv->member\(\);)349 4392 y(dm->insert_double\(3.14\);)349
4492 y(v)h(=)g(dv->to_any\(\);)495 b(//)50 b(transfer)e(to)h(an)h(Any)
349 4591 y(CORBA::release\(dm\);)349 4791 y(dv->destroy\(\);)150
5146 y Fm(10.7.3.1)92 b(Ambiguous)21 b(usage)264 5324
y Fr(1.)45 b(When)25 b(the)f(discriminator)h(is)g(set)f(to)g(a)h(dif)n
(fer)n(ent)g(value,)h(a)g(dif)n(fer)n(ent)e(member)h(branch)h(is)377
5437 y(selected.)36 b(Suppose)24 b(the)h(application)i(has)f(pr)n
(eviously)g(obtained)f(a)i(DynAny)e(r)n(efer)n(ence)377
5550 y(to)h(a)i(union)e(member)h(when)f(it)h(changes)f(the)g
(discriminator)i(value.)41 b(As)26 b(a)h(r)n(esult)f(of)h(the)p
eop
%%Page: 104 110
104 109 bop 30 100 a Fr(104)725 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)257
356 y Fr(value)27 b(change,)g(the)e(union)h(is)g(now)f(instantiated)h
(to)f(another)g(union)h(branch,)i(i.e.)38 b(a)26 b(call)257
469 y(to)j(the)f Fe(member\(\))d Fr(operation)j(will)j(now)d(r)n(eturn)
g(a)i(r)n(efer)n(ence)e(to)h(a)g(dif)n(fer)n(ent)g(DynAny)257
582 y(object.)f(If)22 b(the)g(application)h(continues)f(to)f(access)i
(the)e(DynAny)h(object)g(of)h(the)e(old)h(union)257 695
y(member)-7 b(,)39 b(the)34 b(behavior)i(of)f(the)g(ORB)g(under)f(this)
h(condition)g(is)h(not)e(de\002ned)g(by)h(the)257 808
y(CORBA)25 b(2.2)h(speci\002cation.)35 b(W)-5 b(ith)25
b(omniORB2,)h(the)e(DynAny)g(object)h(of)g(the)g(old)f(union)257
920 y(member)18 b(is)g(detached)f(fr)n(om)h(the)g(union)f(when)h(a)g
(new)f(union)h(branch)h(is)f(selected.)25 b(Ther)n(e-)257
1033 y(for)n(e)d(r)n(eading)f(or)g(writing)h(this)f(object)h(will)h
(not)e(have)h(any)f(r)n(elation)h(to)f(the)g(curr)n(ent)g(value)257
1146 y(of)31 b(the)f(union.)53 b(T)-8 b(o)30 b(avoid)h(this)g
(ambiguity)-10 b(,)33 b(the)d(r)n(efer)n(ence)g(to)h(the)f(old)g(union)
h(member)257 1259 y(should)22 b(be)g(r)n(eleased)g(befor)n(e)g(a)i(dif)
n(fer)n(ent)e(union)h(branch)g(is)g(selected.)144 1464
y(2.)45 b(The)32 b(write)f(operation)g Fe(set)p 1275
1464 28 4 v 31 w(as)p 1416 1464 V 32 w(default\(\))d
Fr(takes)j(a)i(boolean)f(ar)n(gument.)55 b(It)32 b(is)g(am-)257
1576 y(biguous)k(to)h(call)h(this)f(function)g(with)g(the)f(ar)n
(gument)g(set)g(to)g(F)-7 b(ALSE)35 b(\(0\).)72 b(W)-5
b(ith)37 b(om-)257 1689 y(niORB2,)23 b(such)g(a)g(call)h(will)g(be)f
(silently)f(ignor)n(ed.)144 1894 y(3.)45 b(It)25 b(is)h(also)g
(ambiguous)f(to)g(pass)g(the)g(value)i(TRUE)d(\(1\))j(to)e(the)g
Fe(set)p 2631 1894 V 31 w(as)p 2772 1894 V 32 w(default\(\))c
Fr(op-)257 2007 y(eration)28 b(when)f(the)g(union)h(is)g(a)h(no)f
(default)f(union)h(\(10.7.1\).)46 b(W)-5 b(ith)28 b(omniORB2,)i(such)e
(a)257 2119 y(call)d(will)f(be)e(silently)g(ignor)n(ed.)144
2324 y(4.)45 b(When)24 b(the)f(discriminator)h(value)h(is)f(not)g(set,)
f(calling)i(the)e Fe(member\(\))e Fr(operation)i(is)h(am-)257
2437 y(biguous.)37 b(W)-5 b(ith)25 b(omniORB2,)i(such)f(a)g(call)i
(will)f(r)n(eturn)e(a)h(nil)h(DynAny)e(r)n(efer)n(ence.)36
b(Sim-)257 2550 y(ilarly)-10 b(,)32 b(a)e(call)h(to)e(the)f
Fe(member)p 1354 2550 V 30 w(kind\(\))f Fr(operation)h(under)g(this)h
(condition)f(will)j(r)n(eturn)257 2662 y Fe(tk)p 372
2662 V 32 w(null)p Fr(.)171 2896 y(T)-8 b(o)27 b(ensur)n(e)g
(portability)-10 b(,)30 b(it)e(is)g(best)f(to)h(avoid)g(using)g(the)f
(DynUnion)h(interface)g(and)g(not)g(to)30 3009 y(r)n(ely)23
b(on)f(the)g(ORB)g(to)g(behave)h(as)g(omniORB2)g(does)e(under)g(these)g
(ambiguous)i(conditions.)30 3333 y Fj(10.8)119 b(Duplicate)28
b(DynAny)j(References)30 3552 y Fr(Like)22 b(any)g(CORBA)g(object)g
(and)h(psuedo)d(object)i(r)n(efer)n(ences,)f(a)i(DynAny)e(r)n(efer)n
(ence)h(can)h(be)f(du-)30 3665 y(plicated)d(using)e(the)p
763 3665 V 51 w Fe(duplicate\(\))c Fr(operations.)25
b(When)18 b(an)h(application)h(has)e(obtained)g(mul-)30
3778 y(tiple)23 b(DynAny)e(r)n(efer)n(ences)h(to)g(the)g(same)h(DynAny)
f(object,)g(it)h(should)f(be)g(noted)f(that)i(a)g(change)30
3891 y(made)e(to)f(the)g(object)g(by)h(invoking)f(on)h(one)e(r)n(efer)n
(ence)h(is)h(also)g(visible)h(thr)n(ough)e(the)f(other)h(r)n(efer)n(-)
30 4004 y(ences.)30 b(In)24 b(particular)-7 b(,)25 b(if)g(a)f(call)i
(thr)n(ough)d(one)g(r)n(efer)n(ence)g(has)h(caused)f(the)g(curr)n(ent)g
(component)30 4117 y(pointer)j(to)g(be)i(changed,)f(subsequent)e(calls)
j(thr)n(ough)e(other)g(r)n(efer)n(ences)g(will)j(operate)c(on)i(the)30
4230 y(new)22 b(curr)n(ent)g(component)f(pointer)-7 b(.)30
4554 y Fj(10.9)119 b(Other)28 b(Operations)30 4773 y
Fr(The)k(following)i(is)f(a)g(short)f(summary)h(of)g(the)g(other)e
(operations)h(in)h(the)g(DynAny)f(interface)30 4886 y(which)23
b(have)g(not)f(been)g(cover)n(ed)g(in)h(pr)n(evious)f(sections:)30
5120 y Fe(assign\(\))42 b Fr(initialises)25 b(a)f(DynAny)f(object)h
(with)g(another)f(DynAny)g(object.)31 b(The)24 b(two)f(objects)257
5233 y(must)f(have)h(the)f(same)h(typecode.)30 5437 y
Fe(from)p 255 5437 V 31 w(any\(\))43 b Fr(initialises)30
b(a)f(DynAny)e(object)i(fr)n(om)g(the)f(value)h(in)g(an)g(any)-10
b(.)46 b(The)28 b(typecode)e(in)257 5550 y(the)c(two)g(objects)g(must)g
(be)g(the)g(same.)p eop
%%Page: 105 111
105 110 bop 150 100 a Ff(10.9.)52 b(OTHER)22 b(OPERA)-7
b(TIONS)2120 b Fr(105)150 356 y Fe(copy\(\))43 b Fr(cr)n(eates)25
b(a)h(new)f(DynAny)f(object)i(whose)e(value)i(is)g(a)g(deep)e(copy)g
(of)i(the)f(curr)n(ent)g(ob-)377 469 y(ject.)150 656
y Fe(type\(\))43 b Fr(r)n(eturns)21 b(the)h(typecode)e(associated)i
(with)h(the)e(DynAny)h(object.)p eop
%%Page: 106 112
106 111 bop 30 100 a Fr(106)725 b Ff(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)p
eop
%%Page: 107 113
107 112 bop 150 982 a Fl(Chapter)44 b(1)-6 b(1)150 1401
y Fn(The)52 b(Dynamic)f(Invocation)h(Interface)150 1866
y Fr(The)30 b(Dynamic)i(Invocation)f(Interface)g(\(or)f(DII\))h(allows)
g(applications)h(to)e(invoke)h(operations)150 1979 y(on)g(CORBA)h
(objects)f(about)h(which)g(they)f(have)h(no)f(static)h(information.)56
b(That)32 b(is)f(to)h(say)f(the)150 2092 y(application)26
b(has)e(not)g(been)f(linked)h(with)h(stub)e(code)h(which)h(performs)e
(the)h(r)n(emote)f(operation)150 2205 y(invocation.)53
b(Thus)30 b(using)g(the)f(DII)i(applications)g(may)g(invoke)g
(operations)e(on)h Fq(any)h Fr(CORBA)150 2318 y(object,)e(possibly)e
(determining)g(the)g(object's)g(interface)i(dynamically)g(by)f(using)f
(an)i(Interface)150 2431 y(Repository)-10 b(.)291 2547
y(This)44 b(chapter)g(pr)n(esents)e(an)i(overview)g(of)g(the)g(Dynamic)
h(Invocation)g(Interface.)91 b(An)150 2660 y(toy)47 b(example)g(use)g
(of)h(the)f(DII)g(can)i(be)e(found)g(in)h(the)f(omniORB2)i
(distribution)e(in)h(the)150 2773 y Fe(<top>/src/examp)o(le)o(s/)o(di)o
(i)34 b Fr(dir)n(ectory)-10 b(.)79 b(The)39 b(DII)h(makes)g(extensive)e
(use)h(of)h(the)g(type)150 2886 y(Any)-10 b(,)43 b(so)d(ensur)n(e)e
(that)i(you)f(have)h(r)n(ead)g(chapter)g(9.)80 b(For)39
b(mor)n(e)h(information)h(r)n(efer)f(to)f(the)150 2999
y(Dynamic)e(Invocation)e(Interface)g(and)g(C++)i(Mapping)e(sections)f
(of)h(the)g(CORBA)g(2)h(speci\002-)150 3112 y(cation)23
b([OMG96a)s(].)150 3433 y Fj(1)l(1.1)118 b(Overview)150
3652 y Fr(T)-8 b(o)26 b(invoke)g(an)i(operation)d(on)i(a)g(CORBA)g
(object)g(an)g(application)h(needs)d(an)i(object)g(r)n(efer)n(ence,)150
3765 y(the)16 b(name)i(of)f(the)g(operation)f(and)h(a)h(list)f(of)h
(the)e(parameters.)25 b(In)17 b(addition)g(the)f(application)j(must)150
3877 y(know)25 b(whether)g(the)g(operation)g(is)i(one-way)-10
b(,)26 b(what)g(user)n(-de\002ned)e(exceptions)g(it)j(may)f(thr)n(ow)-8
b(,)150 3990 y(any)22 b(user)n(-context)d(strings)h(which)j(must)e(be)g
(supplied,)f(a)i('context')f(to)g(take)g(these)f(values)i(fr)n(om)150
4103 y(and)33 b(the)f(type)f(of)i(the)f(r)n(eturned)f(value.)59
b(This)33 b(information)g(is)g(given)g(by)f(the)g(IDL)h(interface)150
4216 y(declaration,)22 b(and)g(so)e(is)i(normally)g(made)g(available)j
(to)c(the)f(application)j(via)g(the)e(stub)g(code.)26
b(In)150 4329 y(the)c(DII)g(this)g(information)i(is)e(encapsulated)g
(in)h(the)f Fe(CORBA::Request)16 b Fr(pseudo-object.)291
4446 y(T)-8 b(o)28 b(perform)h(an)h(operation)e(invocation)i(the)e
(application)i(must)f(obtain)h(an)f(instance)g(of)h(a)150
4559 y Fe(Request)24 b Fr(object,)29 b(supply)d(the)h(information)h
(listed)f(above)h(and)f(call)j(one)d(of)g(the)g(methods)f(to)150
4671 y(actually)e(make)e(the)g(invocation.)29 b(If)23
b(the)f(invocation)h(causes)f(an)h(exception)f(to)g(be)g(thr)n(own)g
(then)150 4784 y(this)g(may)h(be)g(r)n(etrieved)e(and)i(inspected,)e
(or)h(the)g(r)n(eturn)g(value)h(on)f(success.)150 5106
y Fj(1)l(1.2)118 b(Pseudo)31 b(Objects)150 5324 y Fr(The)d(DII)h
(de\002nes)e(a)i(number)g(of)g(psuedo-object)e(types,)h(all)i
(de\002ned)e(in)h(the)f(CORBA)h(names-)150 5437 y(pace.)41
b(These)25 b(objects)i(behave)g(in)g(many)g(ways)g(like)g(CORBA)g
(objects.)40 b(They)26 b(should)g(only)g(be)150 5550
y(accessed)18 b(by)g(r)n(efer)n(ence)h(\(thr)n(ough)e
Fe(foo)p 1563 5550 28 4 v 32 w(ptr)g Fr(or)i Fe(foo)p
2047 5550 V 31 w(var)p Fr(\),)f(may)h(not)f(be)h(instantiated)f(dir)n
(ectly)1792 5778 y(107)p eop
%%Page: 108 114
108 113 bop 30 100 a Fr(108)834 b Ff(CHAPTER)21 b(1)-5
b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22 b(INTERF)-7
b(ACE)30 356 y Fr(and)23 b(should)f(be)h(r)n(eleased)f(by)h(calling)i
Fe(CORBA::release\()o(\))2274 323 y Fk(1)2305 356 y Fr(.)k(A)23
b(nil)h(r)n(efer)n(ence)e(should)g(only)30 469 y(be)h(r)n(epr)n
(esented)c(by)k Fe(foo::)p 1047 469 28 4 v 30 w(nil\(\))p
Fr(.)171 584 y(These)g(pseudo)g(objects,)h(although)h(de\002ned)e(in)i
(pseudo-IDL)d(in)k(the)e(speci\002cation)h(do)f(not)30
697 y(follow)30 b(the)g(normal)g(mapping)h(for)e(CORBA)i(objects.)49
b(In)30 b(particular)h(the)e(memory)h(manage-)30 810
y(ment)d(r)o(ules)g(ar)n(e)h(dif)n(fer)n(ent)f(-)h(see)e(the)h(CORBA)g
(2)h(speci\002cation)g([OMG96a)r(])g(for)f(mor)n(e)h(details.)30
923 y(New)19 b(instances)g(of)h(these)e(objects)h(may)h(only)f(be)h(cr)
n(eated)f(by)h(the)f(ORB.)g(A)h(number)f(of)h(methods)30
1036 y(ar)n(e)j(de\002ned)e(in)i Fe(CORBA::ORB)18 b Fr(to)k(do)g(this.)
30 1305 y Fi(1)l(1.2.1)99 b(Request)30 1487 y Fr(A)26
b Fe(Request)e Fr(encapsulates)i(a)h(single)f(operation)f(invocation.)
41 b(It)26 b(may)h Fq(not)g Fr(be)f(r)n(e-used)g(-)h(even)30
1599 y(for)c(another)e(call)k(with)d(the)g(same)h(ar)n(guments.)30
1813 y Fd(class)49 b(Request)f({)30 1912 y(public:)130
2012 y(virtual)g(Object_ptr)397 b(target\(\))48 b(const;)130
2112 y(virtual)g(const)h(char*)348 b(operation\(\))48
b(const;)130 2211 y(virtual)g(NVList_ptr)397 b(arguments\(\);)130
2311 y(virtual)48 b(NamedValue_ptr)197 b(result\(\);)130
2411 y(virtual)48 b(Environment_ptr)147 b(env\(\);)130
2510 y(virtual)48 b(ExceptionList_ptr)f(exceptions\(\);)130
2610 y(virtual)h(ContextList_ptr)147 b(contexts\(\);)130
2709 y(virtual)48 b(Context_ptr)347 b(ctxt\(\))48 b(const;)130
2809 y(virtual)g(void)697 b(ctx\(Context_ptr\);)130 3008
y(virtual)48 b(Any&)h(add_in_arg\(\);)130 3108 y(virtual)f(Any&)h
(add_in_arg\(const)e(char*)i(name\);)130 3208 y(virtual)f(Any&)h
(add_inout_arg\(\);)130 3307 y(virtual)f(Any&)h(add_inout_arg\(const)d
(char*)j(name\);)130 3407 y(virtual)f(Any&)h(add_out_arg\(\);)130
3506 y(virtual)f(Any&)h(add_out_arg\(const)e(char*)i(name\);)130
3706 y(virtual)f(void)h(set_return_type\(TypeCode_ptr)c(tc\);)130
3805 y(virtual)j(Any&)h(return_value\(\);)130 4005 y(virtual)f(Status)
99 b(invoke\(\);)130 4104 y(virtual)48 b(Status)99 b(send_oneway\(\);)
130 4204 y(virtual)48 b(Status)99 b(send_deferred\(\);)130
4303 y(virtual)48 b(Status)99 b(get_response\(\);)130
4403 y(virtual)48 b(Boolean)h(poll_response\(\);)130
4602 y(static)f(Request_ptr)g(_duplicate\(Request_ptr\);)130
4702 y(static)g(Request_ptr)g(_nil\(\);)30 4802 y(};)30
5071 y Fi(1)l(1.2.2)99 b(NamedV)-11 b(alue)30 5252 y
Fr(A)28 b(pair)h(consisting)f(of)g(a)h(string)e(and)i(a)g(value)g(-)f
(encapsulated)g(in)h(an)f(Any)-10 b(.)45 b(The)27 b(name)i(is)f(op-)30
5365 y(tional.)g(This)23 b(type)e(is)i(used)e(to)h(encapsulate)g
(parameters)g(and)g(r)n(eturned)f(values.)p 30 5462 1368
4 v 135 5518 a Fh(1)164 5550 y Fg(if)e(not)g(managed)g(by)g(a)p
845 5550 23 4 v 45 w Fc(var)g Fg(type.)p eop
%%Page: 109 115
109 114 bop 150 100 a Ff(1)-5 b(1.2.)52 b(PSEUDO)22 b(OBJECTS)2282
b Fr(109)150 356 y Fd(class)49 b(NamedValue)f({)150 456
y(public:)250 555 y(virtual)g(const)h(char*)g(name\(\))g(const;)250
655 y(//)g(Retains)g(ownership)f(of)h(return)g(value.)250
854 y(virtual)f(Any*)h(value\(\))g(const;)250 954 y(//)g(Retains)g
(ownership)f(of)h(return)g(value.)250 1153 y(virtual)f(Flags)h
(flags\(\))g(const;)250 1352 y(static)f(NamedValue_ptr)g
(_duplicate\(NamedValue_ptr\);)250 1452 y(static)g(NamedValue_ptr)g
(_nil\(\);)150 1551 y(};)150 1811 y Fi(1)l(1.2.3)99 b(NVList)150
1989 y Fr(A)22 b(list)h(of)g Fe(NamedValue)18 b Fr(objects.)150
2192 y Fd(class)49 b(NVList)g({)150 2292 y(public:)250
2392 y(virtual)f(ULong)h(count\(\))g(const;)250 2491
y(virtual)f(NamedValue_ptr)f(add\(Flags\);)250 2591 y(virtual)h
(NamedValue_ptr)f(add_item\(const)h(char*,)g(Flags\);)250
2691 y(virtual)g(NamedValue_ptr)f(add_value\(const)g(char*,)i(const)g
(Any&,)g(Flags\);)250 2790 y(virtual)f(NamedValue_ptr)f
(add_item_consume\(char*,Flags\);)250 2890 y(virtual)h(NamedValue_ptr)f
(add_value_consume\(char*,)f(Any*,)j(Flags\);)250 2989
y(virtual)f(NamedValue_ptr)f(item\(ULong)h(index\);)250
3089 y(virtual)g(Status)h(remove)g(\(ULong\);)250 3288
y(static)f(NVList_ptr)g(_duplicate\(NVList_ptr\);)250
3388 y(static)g(NVList_ptr)g(_nil\(\);)150 3488 y(};)150
3747 y Fi(1)l(1.2.4)99 b(Context)150 3925 y Fr(Repr)n(esents)24
b(a)k(set)f(of)g(context)f(strings.)41 b(User)26 b(contexts)g(ar)n(e)i
(not)e(supported)f(by)i(the)g(omniidl2)150 4038 y(IDL)k(compiler)h(-)g
(and)f(so)g(cannot)h(be)f(used)f(with)h(statically)i(de\002ned)d
(operations.)53 b(However)150 4151 y(they)21 b(ar)n(e)i(supported)d(in)
j(the)f(DII.)150 4354 y Fd(class)49 b(Context)f({)150
4454 y(public:)250 4554 y(virtual)g(const)h(char*)g(context_name\(\))e
(const;)250 4653 y(virtual)h(CORBA::Context_ptr)f(parent\(\))h(const;)
250 4753 y(virtual)g(CORBA::Status)g(create_child\(const)e(char*,)j
(Context_out\);)250 4852 y(virtual)f(CORBA::Status)g
(set_one_value\(const)e(char*,)i(const)h(CORBA::Any&\);)250
4952 y(virtual)f(CORBA::Status)g(set_values\(CORBA::NVList_ptr\);)250
5052 y(virtual)g(CORBA::Status)g(delete_values\(const)e(char*\);)250
5151 y(virtual)i(CORBA::Status)g(get_values\(const)e(char*)j
(start_scope,)1893 5251 y(CORBA::Flags)f(op_flags,)1893
5351 y(const)h(char*)g(pattern,)1893 5450 y(CORBA::NVList_out)e
(values\);)250 5550 y(//)i(Throws)g(BAD_CONTEXT)f(if)h(<start_scope>)e
(is)j(not)f(found.)p eop
%%Page: 110 116
110 115 bop 30 100 a Fr(1)-5 b(10)839 b Ff(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)130 356 y Fd(//)49 b(Returns)g(a)g(nil)g(NVList)g(in)
h(<values>)e(if)h(no)h(matches)e(are)i(found.)130 555
y(static)e(Context_ptr)g(_duplicate\(Context_ptr\);)130
655 y(static)g(Context_ptr)g(_nil\(\);)30 754 y(};)30
1007 y Fi(1)l(1.2.5)99 b(ContextList)30 1184 y Fr(A)35
b Fe(ContextList)29 b Fr(is)35 b(a)h(list)f(of)f(strings,)j(and)d(is)h
(used)e(to)i(specify)f(which)h(strings)f(fr)n(om)h(the)30
1297 y('context')22 b(should)g(be)g(sent)f(with)i(an)g(operation.)30
1486 y Fd(class)49 b(ContextList)f({)30 1586 y(public:)130
1685 y(virtual)g(ULong)h(count\(\))g(const;)130 1785
y(virtual)f(void)h(add\(const)f(char*)h(ctxt\);)130 1884
y(virtual)f(void)h(add_consume\(char*)e(ctxt\);)130 1984
y(//)i(consumes)f(ctxt)130 2183 y(virtual)g(const)h(char*)g
(item\(ULong)f(index\);)130 2283 y(//)h(retains)g(ownership)f(of)h
(return)g(value)130 2482 y(virtual)f(Status)h(remove\(ULong)e(index\);)
130 2681 y(static)h(ContextList_ptr)f(_duplicate\(ContextList_ptr\);)
130 2781 y(static)h(ContextList_ptr)f(_nil\(\);)30 2881
y(};)30 3134 y Fi(1)l(1.2.6)99 b(ExceptionList)30 3311
y Fe(ExceptionList)p Fr(s)22 b(contain)28 b(a)h(list)f(of)h(T)-8
b(ypeCodes)25 b(-)j(and)h(ar)n(e)f(used)f(to)g(specify)h(which)h(user)n
(-)30 3424 y(de\002ned)21 b(exceptions)g(an)i(operation)e(may)i(thr)n
(ow)-8 b(.)30 3612 y Fd(class)49 b(ExceptionList)e({)30
3712 y(public:)130 3812 y(virtual)h(ULong)h(count\(\))g(const;)130
3911 y(virtual)f(void)h(add\(TypeCode_ptr)e(tc\);)130
4011 y(virtual)h(void)h(add_consume\(TypeCode_ptr)d(tc\);)130
4110 y(//)j(Consumes)f(<tc>.)130 4310 y(virtual)g(TypeCode_ptr)g
(item\(ULong)g(index\);)130 4409 y(//)h(Retains)g(ownership)f(of)h
(return)g(value.)130 4609 y(virtual)f(Status)h(remove\(ULong)e
(index\);)130 4808 y(static)h(ExceptionList_ptr)f
(_duplicate\(ExceptionList_ptr\);)130 4907 y(static)h
(ExceptionList_ptr)f(_nil\(\);)30 5007 y(};)30 5260 y
Fi(1)l(1.2.7)99 b(UnknownUserException)30 5437 y Fr(When)31
b(a)h(user)n(-de\002ned)d(exception)h(is)h(thr)n(own)g(by)g(an)h
(operation)e(it)h(is)h(unmarshalled)f(into)h(a)30 5550
y(value)d(of)f(type)e(Any)-10 b(.)43 b(This)28 b(is)g(encapsulated)e
(in)j(an)f Fe(UnknownUserExce)o(pti)o(on)o Fr(.)38 b(This)28
b(type)p eop
%%Page: 111 117
111 116 bop 150 100 a Ff(1)-5 b(1.3.)52 b(CREA)-7 b(TING)21
b(REQUESTS)2101 b Fr(1)-5 b(1)g(1)150 356 y(follows)26
b(all)i(the)d(usual)h(r)o(ules)g(for)g(user)n(-de\002ned)d(exceptions)i
(-)h(it)h(is)f(not)f(a)i(pseudo)d(object,)i(and)150 469
y(its)c(r)n(esour)n(ces)g(may)h(be)f(r)n(eleased)g(by)g(using)g
Fe(delete)p Fr(.)150 673 y Fd(class)49 b(UnknownUserException)d(:)k
(public)e(UserException)g({)150 773 y(public:)250 872
y(UnknownUserException\(Any*)d(ex\);)250 972 y(//)k(Consumes)f(<ex>)h
(which)g(MUST)g(be)h(a)f(UserException.)250 1171 y(virtual)f
(\230UnknownUserException\(\);)250 1370 y(Any&)h(exception\(\);)250
1570 y(virtual)f(void)h(_raise\(\);)250 1669 y(static)f
(UnknownUserException*)e(_narrow\(Exception*\);)150 1769
y(};)150 2029 y Fi(1)l(1.2.8)99 b(Environment)150 2207
y Fr(An)43 b Fe(Environment)38 b Fr(is)43 b(used)f(to)h(hold)f(an)i
(instance)f(of)g(a)h(system)d(exception)h(or)h(an)g Fe(Un-)150
2320 y(knownUserExcept)o(io)o(n)p Fr(.)150 2525 y Fd(class)49
b(Environment)f({)250 2624 y(virtual)g(void)h(exception\(Exception*\);)
250 2724 y(virtual)f(Exception*)g(exception\(\))g(const;)250
2823 y(virtual)g(void)h(clear\(\);)250 3023 y(static)f(Environment_ptr)
f(_duplicate\(Environment_ptr\);)250 3122 y(static)h(Environment_ptr)f
(_nil\(\);)150 3222 y(};)150 3526 y Fj(1)l(1.3)118 b(Creating)30
b(Requests)150 3738 y Fe(CORBA::Object)18 b Fr(de\002nes)j(thr)n(ee)i
(methods)f(which)i(may)g(be)f(used)f(to)h(cr)n(eate)g(a)h
Fe(Request)d Fr(ob-)150 3851 y(ject)i(which)g(may)g(be)f(used)f(to)h
(perform)g(a)i(single)e(operation)f(invocation)j(on)e(that)g(object:)
150 4055 y Fd(class)49 b(Object)g({)250 4155 y(...)250
4255 y(Status)f(_create_request\(Context_ptr)d(ctx,)1395
4354 y(const)k(char*)g(operation,)1395 4454 y(NVList_ptr)f(arg_list,)
1395 4554 y(NamedValue_ptr)g(result,)1395 4653 y(Request_out)g
(request,)1395 4753 y(Flags)h(req_flags\);)250 4952 y(Status)f
(_create_request\(Context_ptr)d(ctx,)1395 5052 y(const)k(char*)g
(operation,)1395 5151 y(NVList_ptr)f(arg_list,)1395 5251
y(NamedValue_ptr)g(result,)1395 5351 y(ExceptionList_ptr)f(exceptions,)
1395 5450 y(ContextList_ptr)g(ctxlist,)1395 5550 y(Request_out)h
(request,)p eop
%%Page: 112 118
112 117 bop 30 100 a Fr(1)-5 b(12)839 b Ff(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)1275 356 y Fd(Flags)49 b(req_flags\);)130
555 y(Request_ptr)e(_request\(const)h(char*)g(operation\);)130
655 y(...)30 754 y(};)171 965 y Fe(operation)19 b Fr(is)k(the)f(name)h
(of)g(the)f(operation)g(-)h(which)g(is)g(the)f(same)h(as)g(the)f(name)h
(given)g(in)30 1078 y(IDL.)f(T)-8 b(o)22 b(access)g(attributes)g(the)g
(name)h(should)e(be)i(pr)n(e\002xed)e(by)p 2324 1078
28 4 v 55 w Fe(get)p 2521 1078 V 54 w Fr(or)p 2684 1078
V 55 w Fe(set)p 2881 1078 V 32 w Fr(.)171 1191 y(In)26
b(the)f(\002rst)g(two)g(cases)g(above)i(the)e(list)h(of)g(parameters)f
(may)h(be)g(supplied.)36 b(If)26 b(the)f(param-)30 1304
y(eters)h(ar)n(e)i(not)f(supplied)f(in)j(these)d(cases,)i(or)p
1663 1304 V 60 w Fe(request\(\))c Fr(is)j(used)g(then)f(the)h
(parameters)g(\(if)30 1417 y(any\))i(may)g(be)g(speci\002ed)e(using)h
(the)g Fe(add)p 1529 1417 V 32 w(*)p 1616 1417 V 32 w(arg\(\))f
Fr(methods)g(on)h(the)g Fe(Request)p Fr(.)43 b(Y)-8 b(ou)28
b(must)30 1529 y(use)f(one)h(method)f(or)h(the)g(other)f(-)i(not)f(a)h
(mixtur)n(e)f(of)h(the)f(two.)44 b(For)28 b Fq(in)p Fr(/)p
Fq(inout)g Fr(ar)n(guments)g(the)30 1642 y(value)22 b(must)e(be)h
(initialised,)h(for)f Fq(out)g Fr(ar)n(guments)f(only)g(the)g(type)g
(need)f(be)i(given.)27 b(Similarly)c(the)30 1755 y(type)f(of)h(the)f(r)
n(esult)g(may)i(be)f(speci\002ed)f(by)h(passing)f(a)i
Fe(NamedValue)18 b Fr(which)24 b(contains)f(an)h(Any)30
1868 y(which)g(has)f(been)f(initialised)i(to)f(contain)g(a)h(value)g
(of)f(that)g(type,)e(or)i(it)g(may)h(be)f(speci\002ed)f(using)30
1981 y(the)g Fe(set)p 349 1981 V 31 w(return)p 710 1981
V 30 w(type\(\))e Fr(method)h(of)i Fe(Request)p Fr(.)171
2094 y(When)31 b(using)p 702 2094 V 63 w Fe(create)p
1065 2094 V 30 w(request\(\))p Fr(,)e(the)h(management)h(of)g(any)g
(pseudo-object)e(r)n(efer)n(-)30 2207 y(ences)e(passed)g(in)i(r)n
(emains)g(the)e(r)n(esponsibility)h(of)g(the)g(application.)46
b(That)28 b(is,)i(the)d(values)i(ar)n(e)30 2320 y(not)22
b(consumed)g(-)h(and)g(must)f(be)h(r)n(eleased)f(using)g
Fe(CORBA::release\()o(\))p Fr(.)h(The)f(CORBA)h(spec-)30
2433 y(i\002cation)29 b(is)f(unclear)h(about)f(when)f(these)g(values)h
(may)h(be)f(r)n(eleased,)g(so)f(to)h(be)g(sur)n(e)f(of)h(porta-)30
2546 y(bility)f(do)e(not)g(r)n(elease)h(them)f(until)h(after)g(the)f(r)
n(equest)f(has)i(been)g(r)n(eleased.)36 b(V)-8 b(alues)25
b(which)i(ar)n(e)30 2659 y(not)22 b(needed)f(need)g(not)h(be)h
(supplied)f(-)h(so)f(if)i(no)e(parameters)g(ar)n(e)h(speci\002ed)f
(then)g(it)h(defaults)f(to)30 2771 y(an)h(empty)f(parameter)g(list.)29
b(If)23 b(no)g(r)n(esult)f(type)f(is)i(speci\002ed)f(then)g(it)h
(defaults)f(to)g(void.)29 b(A)23 b Fe(Con-)30 2884 y(text)f
Fr(need)h(only)g(be)h(given)g(if)g(a)h(non-empty)d Fe(ContextList)d
Fr(is)24 b(speci\002ed.)30 b(The)23 b Fe(req)p 3151 2884
V 31 w(flags)30 2997 y Fr(ar)n(gument)f(is)h(not)f(used)f(in)i(the)f
(C++)h(mapping.)30 3252 y Fi(1)l(1.3.1)99 b(Examples)30
3429 y Fr(An)22 b(operation)g(might)g(be)h(speci\002ed)e(in)i(IDL)g
(as:)30 3626 y Fd(short)49 b(anOpn\(in)f(string)h(a\);)30
3836 y Fr(An)22 b(operation)g(invocation)h(may)g(be)g(cr)n(eated)f(as)h
(follows:)30 4033 y Fd(CORBA::NVList_var)47 b(args;)30
4133 y(CORBA::ORB::create_list\(1,)e(args\);)30 4233
y(*\(args->add\(CORBA::ARG_IN\)->value\(\))o(\))f(<<=)49
b(\(const)g(char*\))g("Hello)f(World!";)30 4432 y
(CORBA::NamedValue_var)e(result;)30 4532 y
(CORBA::ORB::create_named_value\(resu)o(lt\);)30 4631
y(result->value\(\)->replace\(CORBA::_tc)o(_short)o(,)e(0\);)30
4830 y(CORBA::Request_var)i(req)k(=)f
(obj->_create_request\(CORBA::Context::)o(_nil\()o(\),)2023
4930 y("anOpn",)f(args,)h(result,)f(0\);)30 5141 y Fr(or)22
b(alternatively)h(and)g(much)g(mor)n(e)g(concisely:)30
5338 y Fd(CORBA::Request_var)46 b(req)k(=)f(obj->_request\("anOpn"\);)
30 5437 y(req->add_in_arg\(\))e(<<=)i(\(const)g(char*\))f("Hello)h
(World!";)30 5537 y(req->set_return_type\(CORBA::_tc_sho)o(rt\);)p
eop
%%Page: 113 119
113 118 bop 150 100 a Ff(1)-5 b(1.4.)52 b(INVOKING)21
b(OPERA)-7 b(TIONS)1965 b Fr(1)-5 b(13)150 356 y Fj(1)l(1.4)118
b(Invoking)31 b(Operations)150 567 y Fr(Once)18 b(the)e
Fe(Request)e Fr(object)j(has)h(been)e(pr)n(operly)g(constr)o(ucted)g
(the)g(operation)g(may)i(be)f(invoked)150 680 y(by)23
b(calling)h(one)e(of)g(the)g(following)h(methods)e(on)h(the)g(r)n
(equest)f(object:)150 914 y Fm(invoke\(\))90 b Fr(blocks)22
b(until)g(the)g(r)n(equest)e(has)i(completed.)k(The)21
b(application)i(should)e(then)g(test)g(to)150 1014 y(see)27
b(if)j(an)f(exception)e(was)i(raised.)45 b(Since)29 b(the)f(CORBA)g
(spec)g(is)h(not)f(clear)h(about)f(whether)f(or)150 1114
y(not)i(system)e(exceptions)h(should)g(be)i(thr)n(own)e(fr)n(om)i(this)
f(method,)h(a)f(r)o(untime)h(con\002guration)150 1213
y(variable)25 b(is)d(supplied)g(so)g(that)g(you)g(can)h(specify)f(the)g
(behavior:)150 1370 y Fd(namespace)48 b(omniORB)h({)250
1469 y(...)250 1569 y(CORBA::Boolean)e(diiThrowsSysExceptions;)250
1668 y(...)150 1768 y(};)291 1938 y Fr(By)33 b(default)h(this)f(is)h(F)
-7 b(ALSE,)32 b(and)h(the)g(application)i(should)e(call)i(the)e
Fe(env\(\))f Fr(method)g(of)150 2051 y(the)40 b(r)n(equest)g(to)g(r)n
(etrieve)g(an)i(exception)e(\(it)h(r)n(eturns)f(0)h(\(nil\))i(if)f(no)e
(exception)g(was)h(gener)n(-)150 2163 y(ated\).)47 b(If)29
b(it)h(is)f(TRUE)f(then)g(system)g(exceptions)f(will)k(be)e(thr)n(own)f
(out)g(of)i Fe(invoke\(\))p Fr(.)44 b(User)n(-)150 2276
y(de\002ned)34 b(exceptions)g(ar)n(e)i(always)g(passed)e(via)k
Fe(env\(\))p Fr(,)e(which)g(will)i(r)n(eturn)c(a)j(pointer)d(to)i(a)150
2389 y Fe(CORBA::UnknownU)o(se)o(rE)o(xc)o(ept)o(io)o(n)p
Fr(.)55 b(The)33 b(application)h(can)h(determine)d(which)i(type)e(of)
150 2502 y(exception)21 b(was)h(r)n(eturned)f(by)h Fe(env\(\))e
Fr(by)i(calling)i(the)p 2101 2502 28 4 v 54 w Fe(narrow\(\))19
b Fr(method)i(de\002ned)g(for)h(each)150 2615 y(exception)f(type.)291
2728 y(After)i(determining)f(that)h(no)f(exception)g(was)i(thr)n(own)e
(the)g(application)j(may)e(r)n(etrieve)g(any)150 2841
y(r)n(eturned)e(values)i(by)f(calling)j Fe(return)p 1556
2841 V 30 w(value\(\))19 b Fr(and)k Fe(arguments\(\))p
Fr(.)150 3089 y Fm(send)p 352 3089 V 33 w(oneway\(\))90
b Fr(has)30 b(the)f(same)g(semantics)g(as)h(a)g Fq(oneway)g
Fr(IDL)g(operation.)47 b(It)29 b(is)g(important)150 3202
y(to)21 b(note)g(that)h(oneway)f(operations)g(have)h(at-most-once)g
(semantics,)g(and)g(it)g(is)g(not)g(guaranteed)150 3315
y(that)h(they)f(will)i(not)f(block.)30 b(Any)22 b(operation)g(may)i(be)
f(invoked)f('oneway')h(using)g(the)f(DII,)h(even)150
3427 y(if)30 b(it)g(was)g(not)f(declar)n(ed)g(as)h('oneway')f(in)h
(IDL.)f(A)g(system)f(exception)g(may)i(be)g(generated,)f(in)150
3540 y(which)h(case)g(it)g(will)h(either)e(be)g(thr)n(own)g(or)h(may)g
(be)g(r)n(etrieved)e(using)h Fe(env\(\))f Fr(depending)f(on)150
3653 y Fe(diiThrowsSysExc)o(ep)o(ti)o(on)o(s)17 b Fr(as)22
b(above.)150 3901 y Fm(send)p 352 3901 V 33 w(deferred\(\))93
b Fr(initiates)33 b(the)f(invocation,)37 b(and)c(then)f(r)n(eturns)g
(without)g(waiting)i(for)f(the)150 4014 y(r)n(esult.)68
b(At)36 b(some)f(point)h(in)h(the)e(futur)n(e)h(the)g(application)h
(must)f(r)n(etrieve)f(the)h(r)n(esult)g(of)g(the)150
4127 y(operation)19 b(-)h(but)g(other)e(than)i(testing)e(for)i
(completion)f(of)h(the)f(operation)g(the)g(application)i(must)150
4240 y(not)h(call)i(any)f(of)g(the)e(r)n(equest's)g(methods)g(in)i(the)
f(meantime.)286 4409 y Fo(\017)46 b Fe(get)p 547 4409
V 32 w(response\(\))18 b Fr(blocks)k(until)h(the)f(r)n(eply)g(is)h(r)n
(eceived.)286 4590 y Fo(\017)46 b Fe(poll)p 602 4590
V 31 w(response\(\))23 b Fr(r)n(eturns)i(TRUE)h(if)i(the)e(r)n(eply)h
(has)g(been)f(r)n(eceived,)i(and)f(F)-7 b(ALSE)25 b(if)377
4703 y(not.)i(It)22 b(does)f(not)h(block.)150 4872 y(Once)30
b Fe(poll)p 613 4872 V 31 w(response\(\))c Fr(has)k(r)n(eturned)e
(TRUE,)g(or)i Fe(get)p 2343 4872 V 31 w(response\(\))c
Fr(has)k(been)f(called)150 4985 y(and)e(r)n(eturned,)f(the)f
(application)j(may)f(test)f(for)g(an)i(exception)d(and)i(r)n(etrieve)f
(r)n(eturned)f(values)150 5098 y(as)33 b(above.)61 b(If)33
b Fe(diiThrowsSysExc)o(ept)o(io)o(ns)27 b Fr(is)33 b(tr)o(ue,)i(then)e
(a)h(system)d(exception)h(may)i(be)150 5211 y(thr)n(own)g(fr)n(om)h
Fe(get)p 879 5211 V 31 w(response\(\))p Fr(.)60 b(It)34
b(is)g(guaranteed)g(that)g Fe(poll)p 2642 5211 V 31 w(response\(\))c
Fr(will)36 b(not)150 5324 y(raise)22 b(an)h(exception,)e(so)g(if)j
(polling,)e(the)f(application)j(must)d(also)i(call)h(another)d(method)g
(to)h(give)150 5437 y(the)k(r)n(equest)f(an)j(opportunity)c(to)i(raise)
h(the)f(exception.)40 b(This)26 b(can)i(be)f(one)f(of)h(the)f(methods)f
(to)150 5550 y(r)n(etrieve)d(values)h(fr)n(om)g(the)f(r)n(equest,)f(or)
h Fe(get)p 1749 5550 V 31 w(response\(\))p Fr(.)p eop
%%Page: 114 120
114 119 bop 30 100 a Fr(1)-5 b(14)839 b Ff(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)30 356 y Fj(1)l(1.5)118 b(Multiple)29
b(Requests)30 567 y Fr(The)j(following)i(methods)d(ar)n(e)i(pr)n
(ovided)f(by)h(the)f(ORB)h(to)f(enable)i(multiple)f(r)n(equests)e(to)h
(be)30 680 y(invoked)22 b(asynchr)n(onously)-10 b(.)30
879 y Fd(namespace)48 b(CORBA)h({)130 979 y(...)130 1078
y(class)f(ORB)i({)130 1178 y(public:)229 1278 y(...)229
1377 y(Status)f(send_multiple_requests_oneway\(const)43
b(RequestSeq&\);)229 1477 y(Status)49 b
(send_multiple_requests_deferred\(con)o(st)44 b(RequestSeq&\);)229
1576 y(Boolean)49 b(poll_next_response\(\);)229 1676
y(Status)g(get_next_response\(Request_out\);)229 1776
y(...)130 1875 y(};)130 1975 y(...)30 2075 y(};)30 2326
y Fm(send)p 232 2326 28 4 v 33 w(multiple)p 623 2326
V 33 w(requests)p 1003 2326 V 34 w(oneway\(\))91 b Fr(is)26
b(used)g(to)g(invoke)g(a)h(number)g(of)g(oneway)e(r)n(equests.)30
2439 y(An)17 b(attempt)f(will)j(be)e(made)h(to)e(invoke)h(each)h(of)g
(the)e(r)n(equests,)g(even)h(if)h(one)f(or)g(mor)n(e)g(of)h(the)e
(early)30 2552 y(r)n(equests)23 b(fails.)38 b(The)25
b(application)i(may)f(check)f(for)h(failur)n(e)g(of)g(any)g(of)f(the)g
(r)n(equests)e(by)j(testing)30 2665 y(the)c(r)n(equest's)f
Fe(env\(\))f Fr(method.)27 b(System)21 b(exceptions)f(ar)n(e)j(never)f
(raised)h(by)f(this)g(method.)30 2916 y Fm(send)p 232
2916 V 33 w(multiple)p 623 2916 V 33 w(requests)p 1003
2916 V 34 w(deferred\(\))93 b Fr(will)34 b(initiate)f(an)g(invocation)g
(of)g(each)g(of)f(the)g(given)30 3029 y(r)n(equests,)f(and)g(r)n(eturn)
g(without)f(waiting)i(for)f(the)f(r)n(eply)-10 b(.)53
b(At)31 b(some)f(point)h(in)h(the)e(futur)n(e)h(the)30
3142 y(application)23 b(must)e(r)n(etrieve)h(the)f(r)n(eply)g(by)h
(calling)h Fe(get)p 2022 3142 V 32 w(next)p 2274 3142
V 31 w(response\(\))p Fr(,)17 b(which)22 b(r)n(eturns)30
3255 y(a)32 b(completed)e(r)n(equest.)53 b(If)32 b(no)f(r)n(equests)f
(have)i(yet)e(completed)g(it)i(will)h(block.)55 b(This)31
b(method)30 3368 y(never)26 b(thr)n(ows)g(exceptions)f(-)i(the)f(r)n
(equest's)f Fe(env\(\))f Fr(method)i(must)g(be)h(used)e(to)h(determine)
f(if)30 3481 y(an)e(exception)e(was)i(generated.)j(If)c(not)g(then)g
(any)g(r)n(eturned)f(values)i(may)g(then)f(be)h(queried.)171
3594 y Fe(poll)p 396 3594 V 31 w(next)p 647 3594 V 31
w(response\(\))44 b Fr(r)n(eturns)j(TRUE)g(if)i(ther)n(e)e(ar)n(e)h
(any)h(completed)d(r)n(equests,)30 3707 y(and)38 b(F)-7
b(ALSE)35 b(otherwise,)40 b(without)c(blocking.)73 b(If)37
b(this)g(r)n(eturns)g(tr)o(ue)f(then)h(the)g(next)f(call)k(to)30
3820 y Fe(get)p 200 3820 V 31 w(next)p 451 3820 V 31
w(response\(\))20 b Fr(will)26 b(not)e(block.)34 b(However)-7
b(,)24 b(if)h(another)f(thr)n(ead)g(may)h(also)g(be)f(call-)30
3932 y(ing)33 b Fe(get)p 363 3932 V 32 w(next)p 615 3932
V 31 w(response\(\))c Fr(then)j(it)i(could)f(r)n(etrieve)g(the)f
(completed)g(message)g(\002rst)h(-)h(in)30 4045 y(which)23
b(case)g(this)f(thr)n(ead)g(might)h(block.)171 4158 y(Ther)n(e)c(ar)n
(e)h(no)f(guarantee)g(as)h(to)f(the)g(or)n(der)f(in)i(which)h(r)n
(eplies)e(will)i(be)e(r)n(eceived.)27 b(If)20 b(multiple)30
4271 y(thr)n(eads)f(ar)n(e)g(using)g(this)g(interface)h(then)f(it)g(is)
h(not)f(even)g(guaranteed)f(that)h(a)h(thr)n(ead)f(will)i(r)n(eceive)30
4384 y(r)n(eplies)j(to)g(the)g(r)n(equests)e(it)j(sent.)33
b(Any)24 b(thr)n(ead)g(may)h(r)n(eceive)g(r)n(eplies)f(to)g(r)n
(equests)e(sent)i(by)g(any)30 4497 y(other)k(thr)n(ead.)46
b(It)28 b(is)h(legal)g(to)f(call)j Fe(get)p 1452 4497
V 31 w(next)p 1703 4497 V 31 w(response\(\))25 b Fr(even)j(if)i(no)e(r)
n(equests)f(have)i(yet)30 4610 y(been)24 b(invoked)f(-)i(in)g(which)f
(case)h(the)e(calling)j(thr)n(ead)e(blocks)g(until)h(another)e(thr)n
(ead)h(invokes)g(a)30 4723 y(r)n(equest)d(and)i(the)e(r)n(eply)i(is)f
(r)n(eceived.)p eop
%%Page: 115 121
115 120 bop 150 981 a Fl(Chapter)44 b(12)150 1398 y Fn(The)52
b(Dynamic)f(Skeleton)h(Interface)150 1862 y Fr(The)32
b(Dynamic)h(Skeleton)e(Interface)h(\(or)g(DSI\))g(allows)h
(applications)g(to)f(pr)n(ovide)g(implemen-)150 1975
y(tations)27 b(of)h(the)f(operations)f(on)i(CORBA)f(objects)h(without)e
(static)i(knowledge)e(of)h(the)g(object's)150 2088 y(interface.)h(It)22
b(is)h(the)f(server)n(-side)f(equivalent)i(of)f(the)g(Dynamic)i
(Invocation)f(Interface.)291 2203 y(This)36 b(chapter)f(pr)n(esents)f
(the)h(Dynamic)i(Skeleton)d(Interface)h(and)h(explains)g(how)f(to)g
(use)150 2316 y(it.)90 b(An)43 b(toy)g(example)g(use)f(of)i(the)e(DSI)h
(can)i(be)e(found)f(in)i(the)f(omniORB2)h(distribution)150
2429 y(in)35 b(the)f Fe(<top>/src/exampl)o(es)o(/d)o(si)28
b Fr(dir)n(ectory)-10 b(.)64 b(For)34 b(further)g(information)h(r)n
(efer)g(to)f(the)150 2542 y(Dynamic)j(Skeleton)c(Interface)i(and)g(C++)
h(Mapping)f(sections)f(of)i(the)e(CORBA)h(2)h(speci\002ca-)150
2655 y(tion)22 b([OMG96a)s(].)150 2967 y Fj(12.1)119
b(Overview)150 3183 y Fr(When)23 b(an)h(ORB)g(r)n(eceives)g(an)g
(invocation)h(r)n(equest,)d(the)h(information)h(includes)g(the)f
(object)h(r)n(ef-)150 3296 y(er)n(ence)h(and)h(the)f(name)h(of)g(the)f
(operation.)37 b(T)-8 b(ypically)26 b(this)g(information)g(is)g(used)e
(by)i(the)f(ORB)150 3409 y(to)32 b(select)h(an)g(instance)g(of)g(an)h
(object)f(and)g(call)i(into)e(the)f(implementation)h(of)g(the)f
(operation)150 3522 y(\(which)d(knows)e(how)h(to)g(unmarshal)h(the)f
(parameters)g(etc.\).)44 b(The)28 b(Dynamic)i(Skeleton)d(Inter)n(-)150
3635 y(face)i(however)d(makes)i(this)g(information)g(dir)n(ectly)g
(available)j(to)c(the)g(application)j(-)e(so)f(that)h(it)150
3748 y(can)19 b(implement)e(the)g(operation)g(\(or)g(pass)g(it)h(on)g
(to)f(another)g(server\))g(without)g(static)g(knowledge)150
3861 y(of)22 b(the)g(interface.)28 b(In)22 b(fact)h(it)f(is)h(not)e
(even)h(necessary)f(for)h(the)f(server)g(to)h(always)h(implement)f(the)
150 3973 y(same)h(interface)f(on)h(any)f(particular)i(object!)291
4089 y(T)-8 b(o)30 b(pr)n(ovide)g(an)h(implementation)g(for)g(one)f(or)
g(mor)n(e)h(objects)f(an)h(application)h(must)e(sub-)150
4202 y(class)e Fe(DynamicImplemen)o(tat)o(io)o(n)22 b
Fr(and)27 b(override)g(the)g(method)g Fe(invoke\(\))p
Fr(.)40 b(An)27 b(instance)150 4314 y(of)20 b(this)g(class)h(is)f(r)n
(egister)n(ed)e(with)j(the)e(BOA)h(and)g(is)h(assigned)e(an)h(object)g
(r)n(efer)n(ence)g(\(see)f(below\).)150 4427 y(When)25
b(the)g(ORB)h(r)n(eceives)g(a)g(r)n(equest)f(for)h(that)f(object)h(the)
f Fe(invoke\(\))e Fr(method)h(is)i(called)h(and)150 4540
y(will)d(be)e(passed)f(a)j Fe(ServerRequest)16 b Fr(object)23
b(which)g(pr)n(ovides:)286 4737 y Fo(\017)46 b Fr(the)22
b(operation)g(name)286 4934 y Fo(\017)46 b Fr(context)22
b(strings)286 5131 y Fo(\017)46 b Fr(access)23 b(to)f(the)g(parameters)
286 5327 y Fo(\017)46 b Fr(a)23 b(way)g(to)f(set)f(the)h(r)n(eturned)f
(values)286 5524 y Fo(\017)46 b Fr(a)23 b(way)g(to)f(thr)n(ow)g(user)n
(-de\002ned)e(exceptions.)1794 5778 y(1)-5 b(15)p eop
%%Page: 116 122
116 121 bop 30 100 a Fr(1)-5 b(16)957 b Ff(CHAPTER)22
b(12.)51 b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7
b(ACE)30 356 y Fj(12.2)119 b(DSI)29 b(T)-11 b(ypes)30
575 y Fi(12.2.1)99 b(DynamicImplementation)30 757 y Fr(This)30
b(class)h(must)f(be)h(sub-classed)f(by)g(the)g(application)i(to)e(pr)n
(ovide)g(an)h(implementation)f(for)30 870 y(DSI)22 b(objects.)28
b(The)22 b(method)f Fe(invoke\(\))e Fr(will)24 b(be)e(called)i(for)e
(each)h(operation)f(invocation.)30 1084 y Fd(namespace)48
b(CORBA)h({)130 1184 y(...)130 1284 y(class)f(BOA)i({)229
1383 y(...)229 1483 y(class)f(DynamicImplementation)d({)229
1583 y(public:)329 1682 y(DynamicImplementation\(\);)329
1782 y(virtual)i(\230DynamicImplementation\(\);)329 1981
y(virtual)g(void)h(invoke\(ServerRequest_ptr)d(request,)1325
2081 y(Environment&)i(env\))h(throw\(\))f(=)i(0;)229
2280 y(protected:)329 2380 y(Object_ptr)e(_this\(\);)329
2479 y(//)h(Must)g(only)g(be)h(called)f(from)g(within)f(invoke\(\).)g
(Caller)h(must)g(release)329 2579 y(//)g(the)h(reference)e(returned.)
329 2778 y(BOA_ptr)g(_boa\(\);)329 2878 y(//)h(Must)g(only)g(be)h
(called)f(from)g(within)f(invoke\(\).)g(Caller)h(must)g(NOT)329
2977 y(//)g(release)g(the)g(reference)f(returned.)229
3077 y(};)229 3177 y(...)130 3276 y(};)130 3376 y(...)30
3475 y(};)30 3746 y Fi(12.2.2)99 b(ServerRequest)30 3928
y Fr(A)22 b Fe(ServerRequest)16 b Fr(object)22 b(pr)n(ovides)f(the)g
(interface)i(between)d(a)j(dynamic)f(implementation)30
4040 y(and)h(the)e(ORB.)30 4255 y Fd(namespace)48 b(CORBA)h({)130
4354 y(...)130 4454 y(class)f(ServerRequest)g({)130 4554
y(public:)229 4653 y(virtual)h(const)g(char*)298 b(op_name\(\);)229
4753 y(virtual)49 b(OperationDef_ptr)e(op_def\(\);)229
4852 y(virtual)i(Context_ptr)297 b(ctx\(\);)229 4952
y(virtual)49 b(void)647 b(params\(NVList_ptr)46 b(parameters\);)229
5052 y(virtual)j(void)647 b(result\(Any*)47 b(value\);)229
5151 y(virtual)i(void)647 b(exception\(Any*)47 b(value\);)229
5351 y(static)i(ServerRequest_ptr)e(_duplicate\(ServerRequest_ptr\);)
229 5450 y(static)i(ServerRequest_ptr)e(_nil\(\);)130
5550 y(};)p eop
%%Page: 117 123
117 122 bop 150 100 a Ff(12.3.)52 b(CREA)-7 b(TING)21
b(DYNAMIC)i(IMPLEMENT)-7 b(A)g(TIONS)1179 b Fr(1)-5 b(17)250
356 y Fd(...)150 456 y(};)150 773 y Fj(12.3)119 b(Creating)29
b(Dynamic)h(Implementations)150 990 y Fr(The)21 b(application)h(must)f
(override)f(the)h Fe(invoke\(\))c Fr(method)j(of)i Fe(DynamicImpleme)o
(nt)o(at)o(io)o(n)150 1103 y Fr(to)g(pr)n(ovide)g(an)h(implementation)g
(for)f(DSI)h(objects.)k(This)22 b(method)g(must)g(behave)g(as)h
(follows:)286 1330 y Fo(\017)46 b Fr(It)26 b(may)g(be)g(called)h
(concurr)n(ently)e(by)h(multiple)h(thr)n(eads)e(of)h(execution,)f(and)h
(so)g(must)f(be)377 1443 y(thr)n(ead-safe.)286 1643 y
Fo(\017)46 b Fr(It)23 b(may)h(not)e(thr)n(ow)h(any)g(exceptions.)29
b(User)n(-de\002ned)21 b(exceptions)g(ar)n(e)j(passed)e(in)h(a)h(value)
377 1756 y(of)34 b(type)e(Any)h(and)g(given)h(to)f Fe(ServerRequest:)o
(:e)o(xc)o(ept)o(io)o(n\()o(\))p Fr(,)d(and)k(system)d(ex-)377
1869 y(ceptions)24 b(may)h(be)g(passed)e(via)j(the)e
Fe(env)g Fr(parameter)-7 b(.)33 b(Since)25 b(the)f(methods)f(pr)n
(ovided)h(by)377 1982 y Fe(ServerRequest)16 b Fr(may)22
b(thr)n(ow)f(system)f(exceptions,)g(the)h(application)i(must)e(catch)h
(any)377 2095 y(such)h(exception,)e(duplicate)h(it)h(and)g(place)g(the)
f(value)h(in)g Fe(env)p Fr(.)286 2294 y Fo(\017)46 b
Fr(The)20 b(operations)f(on)h(the)g Fe(ServerRequest)15
b Fr(object)20 b(must)g(be)h(carried)g(out)e(in)j(the)d(corr)n(ect)377
2407 y(or)n(der)-7 b(,)22 b(as)h(described)e(below)-8
b(.)150 2680 y Fi(12.3.1)99 b(Operations)25 b(on)g(the)g(ServerRequest)
150 2863 y Fe(op)p 265 2863 28 4 v 32 w(name\(\))32 b
Fr(will)k(r)n(eturn)e(the)g(name)h(of)g(the)f(operation,)i(and)f(may)g
(be)g(called)h(at)f(any)f(time.)150 2976 y(For)26 b(attribute)g(access)
h(the)f(operation)g(name)h(is)g(the)f(IDL)g(name)h(of)g(the)f
(attribute,)h(pr)n(e\002xed)e(by)p 150 3089 V 177 3089
a Fe(get)p 347 3089 V 59 w Fr(or)p 519 3089 V 60 w Fe(set)p
717 3089 V 31 w Fr(.)42 b(If)27 b(the)f(operation)g(name)i(is)f(not)f
(r)n(ecognised)g(a)i Fe(CORBA::BAD)p 3056 3089 V 28 w(OPERATION)150
3202 y Fr(exception)23 b(should)h(be)g(passed)f(back)j(thr)n(ough)d
Fe(env)p Fr(.)32 b(This)25 b(will)h(allow)f(the)f(ORB)g(to)g(then)g
(see)f(if)150 3315 y(it)g(is)g(one)e(of)i(the)f(standar)n(d)g(object)g
(operations.)291 3431 y(Firstly)i Fe(params\(\))c Fr(must)k(be)g
(called)i(passing)d(a)i Fe(CORBA::NVList)2759 3398 y
Fk(1)2815 3431 y Fr(which)g(must)f(be)g(ini-)150 3544
y(tialised)19 b(to)f(contain)i(the)e(type)f(and)i(mode)f(of)h(the)g
(parameters.)25 b(The)18 b(ORB)h(consumes)f(this)g(value)150
3657 y(and)29 b(will)i(r)n(elease)e(it)g(when)g(the)g(operation)f(is)h
(complete.)47 b(At)29 b(this)g(point)g(any)g Fq(in)p
Fr(/)p Fq(inout)h Fr(ar)n(gu-)150 3770 y(ments)d(will)i(be)f
(unmarshalled,)h(and)f(when)f(this)g(operation)g(r)n(eturns)f(their)i
(values)g(will)h(be)f(in)150 3883 y(the)23 b Fe(NVList)p
Fr(.)29 b(The)24 b(application)h(may)f(set)f(the)g(value)i(of)f
Fq(inout)p Fr(/)p Fq(out)g Fr(ar)n(guments)f(by)h(modifying)150
3996 y(this)e(parameter)g(list.)291 4112 y(If)36 b(the)f(operation)g
(has)h(user)n(-context)e(information,)40 b(then)35 b
Fe(ctx\(\))e Fr(must)j(be)f(called)i(after)150 4224 y
Fe(params\(\))19 b Fr(to)j(r)n(etrieve)g(it.)291 4340
y Fe(result\(\))d Fr(must)i(then)g(be)h(called)h(exactly)f(once)f(if)i
(the)e(operation)g(has)h(a)g(non-void)g(r)n(eturn)150
4453 y(value)27 b(\(unless)f(an)h(exception)e(is)h(thr)n(own\).)39
b(The)25 b(value)j(passed)c(should)i(be)g(an)h(Any)e(allocated)150
4566 y(with)e Fe(new)p Fr(,)e(and)h(will)i(be)f(fr)n(eed)f(by)g(the)g
(ORB.)291 4682 y(At)32 b(any)h(point)f(in)h(the)e(above)i(sequence)e
Fe(exception\(\))c Fr(may)33 b(be)g(called)g(to)f(set)f(a)j(user)n(-)
150 4795 y(de\002ned)26 b(exception,)i(or)f(a)i(system)d(exception)g
(may)j(be)e(inserted)f(into)i(the)f Fe(env)g Fr(parameter)g(of)150
4908 y(the)22 b Fe(invoke\(\))d Fr(method.)27 b(If)c(this)f(happens)f
(then)h(no)h(further)e(operations)h(should)f(be)i(invoked)150
5021 y(on)f(the)g Fe(ServerRequest)17 b Fr(object,)22
b(and)h(the)f Fe(invoke\(\))d Fr(method)i(should)h(r)n(eturn.)291
5137 y(W)-5 b(ithin)29 b(the)f Fe(invoke\(\))d Fr(method)p
1559 5137 V 60 w Fe(this\(\))h Fr(and)p 2131 5137 V 61
w Fe(boa\(\))g Fr(may)j(be)g(called)g(to)f(obtain)h(the)150
5250 y(object)f(r)n(efer)n(ence)f(and)h(BOA)f(r)n(efer)n(ence)h(r)n
(espectively)-10 b(.)42 b(These)26 b(methods)g(may)j(not)e(be)g(used)g
(at)150 5363 y(any)c(other)e(time.)p 150 5462 1368 4
v 255 5518 a Fh(1)284 5550 y Fg(obtained)f(by)e(calling)h
Fc(CORBA::ORB::create)p 1749 5550 23 4 v 24 w(list\(\))p
eop
%%Page: 118 124
118 123 bop 30 100 a Fr(1)-5 b(18)957 b Ff(CHAPTER)22
b(12.)51 b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7
b(ACE)30 356 y Fj(12.4)119 b(Registering)30 b(Dynamic)f(Objects)30
568 y Fr(T)-8 b(o)20 b(use)h(a)h Fe(DynamicImpleme)o(nt)o(at)o(ion)14
b Fr(a)22 b(CORBA)g(object)f(must)f(be)i(cr)n(eated)e(and)i(associated)
30 681 y(with)f(the)f(implementation.)28 b(The)20 b(way)h(in)h(which)g
(this)e(is)i(done)e(is)h(not)f(de\002ned)g(by)h(the)f(CORBA)30
794 y(2.0)j(speci\002cation,)g(so)f(the)g(following)g(method)g(is)g
(omniORB2)i(speci\002c:)30 998 y Fd(namespace)48 b(CORBA)h({)130
1098 y(...)130 1197 y(class)f(BOA)i({)229 1297 y(...)229
1397 y(Object_ptr)e(create_dynamic_object\(DynamicImpleme)o(ntatio)o
(n_ptr)43 b(dir,)1873 1496 y(const)49 b(char*)g(intfRepoId\);)229
1596 y(...)130 1696 y(};)130 1795 y(...)30 1895 y(};)171
2111 y Fr(Ownership)33 b(of)g(the)g Fe(DynamicImplemen)o(ta)o(ti)o(on)
27 b Fr(object)33 b(is)h(taken)e(over)i(by)f(the)g(ORB,)30
2224 y(and)f(it)g(will)h(be)f(deleted)d(when)i(associated)g(the)g
(object)h(is)g(destr)n(oyed.)52 b(The)31 b(r)n(eturned)f(object)30
2337 y(may)j(then)f(be)h(enter)n(ed)e(into)h(the)g(object)h(table)g
(with)g(a)g(call)i(to)d Fe(BOA::obj)p 2785 2337 28 4
v 29 w(is)p 2924 2337 V 32 w(ready\(\))e Fr(as)30 2450
y(usual,)23 b(and)f(will)i(then)e(start)g(accepting)g(operation)g
(invocations.)171 2564 y(For)j(some)f(applications)j(it)e(will)i(not)e
(be)g(possible)g(to)g(r)n(egister)f(all)j(DSI)e(objects)g(in)h(advance)
30 2676 y(of)c(invocations)g(arriving.)29 b(In)21 b(this)g(case)h(DSI)g
(objects)f(can)i(be)e(cr)n(eated)g(on)h(demand)f(in)h(the)f(same)30
2789 y(way)i(as)f(normal)i(objects)e(-)h(see)e(section)h(5.6.)30
3093 y Fj(12.5)119 b(Example)30 3305 y Fr(This)36 b(implementation)g
(of)g Fe(DynamicImplemen)o(ta)o(ti)o(on:)o(:i)o(nv)o(ok)o(e\()o(\))30
b Fr(is)37 b(taken)e(fr)n(om)i(an)30 3418 y(example)59
b(which)g(can)h(be)f(found)f(in)h(the)g(omniORB2)g(distribution.)136
b(The)58 b(operation)30 3531 y(\223echoString\224)22
b(is)h(declar)n(ed)f(in)i(IDL)e(as:)30 3735 y Fd(string)49
b(echoString\(in)e(string)i(mesg\);)30 3951 y Fr(Her)n(e)22
b(is)g(the)g(Dynamic)i(Implementation)e(Routine:)30 4155
y Fd(void)30 4255 y(MyDynImpl::invoke\(CORBA::ServerRequ)o(est_pt)o(r)
44 b(re-)30 4354 y(quest,)49 b(CORBA::Environment&)d(env\))130
4454 y(throw\(\))30 4554 y({)130 4653 y(try)j({)229 4753
y(if\()g(strcmp\(request->op_name\(\),)c("echoString"\))j(\))329
4852 y(throw)h(CORBA::BAD_OPERATION\(0,)c(CORBA::COMPLETED_NO\);)229
5052 y(CORBA::NVList_ptr)i(args;)229 5151 y(orb->create_list\(0,)g
(args\);)229 5251 y(CORBA::Any)h(a;)229 5351 y
(a.replace\(CORBA::_tc_string,)d(0\);)229 5450 y(args->add_value\("",)i
(a,)i(CORBA::ARG_IN\);)p eop
%%Page: 119 125
119 124 bop 150 100 a Ff(12.5.)52 b(EXAMPLE)2615 b Fr(1)-5
b(19)349 356 y Fd(request->params\(args\);)349 555 y(CORBA::Any&)48
b(input_any)g(=)i(*\(args->item\(0\)->value\(\)\);)349
655 y(CORBA::String_var)d(input;)349 754 y(input_any)h(>>=)i
(input.out\(\);)349 954 y(CORBA::Any*)e(result)h(=)g(new)h
(CORBA::Any\(\);)349 1053 y(*result)f(<<=)g
(CORBA::Any::from_string\(input._retn)o(\(\),)44 b(0\);)349
1153 y(request->result\(result\);)250 1253 y(})250 1352
y(catch\(CORBA::SystemException&)g(ex\){)349 1452 y
(env.exception\(CORBA::Exception::_dupl)o(icate)o(\(&ex\))o(\);)250
1551 y(})250 1651 y(catch\(...\){)349 1751 y(cout)49
b(<<)h("echo_dsiimpl:)d(MyDynImpl::invoke)g(-)i(caught)g(an")549
1850 y(")g(unknown)g(exception.")e(<<)j(endl;)349 1950
y(env.exception\(new)d(CORBA::UNKNOWN\(0,)g(CORBA::COMPLETED_NO\)\);)
250 2050 y(})150 2149 y(})p eop
%%Page: 120 126
120 125 bop 30 100 a Fr(120)952 b Ff(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)p
eop
%%Page: 121 127
121 126 bop 150 980 a Fl(Appendix)44 b(A)150 1397 y Fn(hosts)p
656 1397 62 4 v 74 w(access\(5\))150 1847 y Fi(DESCRIPTION)150
2027 y Fr(This)29 b(manual)i(page)d(describes)g(a)i(simple)f(access)g
(contr)n(ol)h(language)f(that)g(is)g(based)g(on)g(client)150
2140 y(\(host)22 b(name/addr)n(ess,)g(user)g(name\),)h(and)h(server)e
(\(pr)n(ocess)g(name,)h(host)f(name/addr)n(ess\))g(pat-)150
2253 y(terns.)41 b(Examples)27 b(ar)n(e)h(given)f(at)h(the)e(end.)42
b(The)26 b(impatient)i(r)n(eader)f(is)g(encouraged)f(to)h(skip)g(to)150
2366 y(the)22 b(EXAMPLES)e(section)i(for)h(a)g(quick)g(intr)n
(oduction.)291 2480 y(An)65 b(extended)e(version)i(of)g(the)g(access)g
(contr)n(ol)g(language)g(is)h(described)e(in)i(the)150
2593 y(hosts)p 366 2593 28 4 v 31 w(options\(5\))29 b(document.)48
b(The)29 b(extensions)f(ar)n(e)i(turned)e(on)i(at)f(pr)n(ogram)h(build)
g(time)g(by)150 2706 y(building)23 b(with)g(-DPROCESS)p
1232 2706 V 33 w(OPTIONS.)291 2820 y(In)c(the)g(following)h(text,)e
Fq(daemon)i Fr(is)g(the)f(the)f(pr)n(ocess)g(name)i(of)f(a)h(network)e
(daemon)h(pr)n(ocess,)150 2933 y(and)25 b Fq(client)g
Fr(is)g(the)f(name)h(and/or)f(addr)n(ess)f(of)i(a)g(host)f(r)n
(equesting)f(service.)33 b(Network)23 b(daemon)150 3046
y(pr)n(ocess)e(names)i(ar)n(e)g(speci\002ed)e(in)i(the)f(inetd)g
(con\002guration)g(\002le.)150 3311 y Fi(ACCESS)i(CONTROL)h(FILES)150
3491 y Fr(The)d(access)g(contr)n(ol)h(softwar)n(e)f(consults)g(two)f
(\002les.)28 b(The)22 b(sear)n(ch)h(stops)d(at)j(the)f(\002rst)g
(match:)286 3712 y Fo(\017)46 b Fr(Access)37 b(will)h(be)f(granted)f
(when)h(a)h(\(daemon,client\))f(pair)h(matches)f(an)g(entry)f(in)i(the)
377 3824 y Fe(/etc/hosts.allo)o(w)17 b Fr(\002le.)286
4018 y Fo(\017)46 b Fr(Otherwise,)24 b(access)h(will)h(be)f(denied)e
(when)h(a)h(\(daemon,client\))g(pair)h(matches)e(an)h(entry)377
4131 y(in)e(the)f Fe(/etc/hosts.deny)16 b Fr(\002le.)286
4325 y Fo(\017)46 b Fr(Otherwise,)22 b(access)g(will)i(be)f(granted.)
291 4546 y(A)f(non-existing)f(access)g(contr)n(ol)h(\002le)g(is)g(tr)n
(eated)f(as)h(if)g(it)h(wer)n(e)e(an)h(empty)f(\002le.)27
b(Thus,)21 b(access)150 4659 y(contr)n(ol)i(can)g(be)g(turned)e(of)n(f)
i(by)g(pr)n(oviding)f(no)g(access)h(contr)n(ol)g(\002les.)150
4923 y Fi(ACCESS)h(CONTROL)h(RULES)150 5103 y Fr(Each)d(access)f(contr)
n(ol)g(\002le)g(consists)f(of)h(zer)n(o)h(or)e(mor)n(e)h(lines)h(of)f
(text.)26 b(These)20 b(lines)h(ar)n(e)g(pr)n(ocessed)150
5216 y(in)i(or)n(der)f(of)g(appearance.)28 b(The)22 b(sear)n(ch)h
(terminates)f(when)f(a)j(match)f(is)g(found.)286 5437
y Fo(\017)46 b Fr(A)35 b(newline)f(character)h(is)g(ignor)n(ed)e(when)h
(it)h(is)f(pr)n(eceded)f(by)h(a)h(backslash)g(character)-7
b(.)377 5550 y(This)23 b(permits)e(you)h(to)g(br)n(eak)h(up)f(long)g
(lines)h(so)f(that)g(they)g(ar)n(e)h(easier)f(to)g(edit.)1792
5778 y(121)p eop
%%Page: 122 128
122 127 bop 30 100 a Fr(122)1862 b Ff(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))166 356 y
Fo(\017)h Fr(Blank)26 b(lines)f(or)g(lines)h(that)f(begin)g(with)g(a)h
Fe(#)f Fr(character)h(ar)n(e)g(ignor)n(ed.)35 b(This)25
b(permits)g(you)257 469 y(to)d(insert)g(comments)g(and)h(whitespace)e
(so)h(that)g(the)g(tables)h(ar)n(e)g(easier)f(to)g(r)n(ead.)166
676 y Fo(\017)46 b Fr(All)27 b(other)e(lines)h(should)f(satisfy)h(the)f
(following)h(format,)h(things)e(between)g([])i(being)e(op-)257
789 y(tional:)k Fe(daemon)p 874 789 V 30 w(list)52 b(:)109
b(client)p 1670 789 V 30 w(list)53 b([)h(:)109 b(shell)p
2521 789 V 30 w(command)51 b(])171 1026 y(daemon)p 506
1026 V 30 w(list)27 b Fr(is)h(a)h(list)f(of)g(one)g(or)g(mor)n(e)g
(daemon)f(pr)n(ocess)g(names)h(\(ar)n(gv[0])j(values\))d(or)30
1139 y(wildcar)n(ds)23 b(\(see)f(below\).)171 1257 y
Fe(client)p 506 1257 V 30 w(list)c Fr(is)i(a)g(list)g(of)g(one)f(or)g
(mor)n(e)h(host)e(names,)i(host)e(addr)n(esses,)g(patterns)g(or)h
(wild-)30 1370 y(car)n(ds)k(\(see)f(below\))g(that)h(will)h(be)e
(matched)h(against)f(the)g(client)h(host)f(name)h(or)f(addr)n(ess.)171
1487 y(The)d(mor)n(e)h(complex)g(forms)g Fe(daemon@host)15
b Fr(and)20 b Fe(user@host)c Fr(ar)n(e)k(explained)g(in)g(the)f(sec-)30
1600 y(tions)j(on)g(server)g(endpoint)f(patterns)g(and)h(on)h(client)g
(username)e(lookups,)g(r)n(espectively)-10 b(.)171 1718
y(List)22 b(elements)f(should)h(be)g(separated)f(by)i(blanks)g(and/or)f
(commas.)171 1836 y(W)-5 b(ith)20 b(the)f(exception)f(of)i(NIS)f
(\(YP\))g(netgr)n(oup)f(lookups,)h(all)i(access)e(contr)n(ol)h(checks)f
(ar)n(e)h(case)30 1949 y(insensitive.)30 2234 y Fi(P)-7
b(A)e(TTERNS)30 2420 y Fr(The)22 b(access)g(contr)n(ol)h(language)g
(implements)f(the)f(following)i(patterns:)166 2657 y
Fo(\017)46 b Fr(A)36 b(string)e(that)i(begins)f(with)g(a)h
Fe(.)67 b Fr(character)-7 b(.)68 b(A)35 b(host)g(name)h(is)f(matched)h
(if)g(the)f(last)257 2770 y(components)27 b(of)i(its)g(name)g(match)h
(the)e(speci\002ed)g(pattern.)46 b(For)28 b(example,)i(the)e(pattern)
257 2883 y Fe(.tue.nl)20 b Fr(matches)i(the)g(host)g(name)g
Fe(wzv.win.tue.nl)p Fr(.)166 3090 y Fo(\017)46 b Fr(A)35
b(string)g(that)g(ends)f(with)h(a)h Fe(.)66 b Fr(character)-7
b(.)67 b(A)35 b(host)f(addr)n(ess)g(is)h(matched)h(if)g(its)f(\002rst)
257 3203 y(numeric)k(\002elds)f(match)i(the)d(given)i(string.)75
b(For)38 b(example,)k(the)c(pattern)g Fe(131.155.)257
3316 y Fr(matches)33 b(the)g(addr)n(ess)e(of)j(\(almost\))g(every)e
(host)g(on)h(the)f(Eindhoven)g(University)h(net-)257
3429 y(work)22 b(\()p Fe(131.155.x.x)p Fr(\).)166 3636
y Fo(\017)46 b Fr(A)30 b(string)f(that)g(begins)g(with)h(an)60
b(character)30 b(is)g(tr)n(eated)f(as)g(an)i(NIS)d(\(formerly)i(YP\))g
(net-)257 3749 y(gr)n(oup)j(name.)62 b(A)33 b(host)g(name)h(is)g
(matched)f(if)i(it)f(is)g(a)g(host)f(member)h(of)f(the)g(speci\002ed)
257 3862 y(netgr)n(oup.)47 b(Netgr)n(oup)27 b(matches)i(ar)n(e)h(not)f
(supported)e(for)i(daemon)g(pr)n(ocess)f(names)h(or)257
3975 y(for)23 b(client)g(user)e(names.)166 4182 y Fo(\017)46
b Fr(An)29 b(expr)n(ession)e(of)h(the)g(form)h Fe(n.n.n.n/m.m.m.m)22
b Fr(is)29 b(interpr)n(eted)e(as)i(a)g(\223net/mask\224)257
4295 y(pair)-7 b(.)182 b(A)73 b(host)g(addr)n(ess)f(is)i(matched)f(if)i
(\223net\224)f(is)f(equal)h(to)f(the)g(bitwise)257 4408
y(AND)54 b(of)g(the)f(addr)n(ess)f(and)i(the)f(\223mask\224.)122
b(For)53 b(example,)61 b(the)53 b(net/mask)g(pat-)257
4521 y(tern)44 b Fe(131.155.72.0/2)o(55.)o(25)o(5.)o(25)o(4.)o(0)38
b Fr(matches)45 b(every)e(addr)n(ess)g(in)i(the)f(range)257
4634 y Fe(131.155.72.0)18 b Fr(thr)n(ough)j Fe(131.155.73.255)p
Fr(.)30 4919 y Fi(WILDCARDS)30 5106 y Fr(The)h(access)g(contr)n(ol)h
(language)g(supports)d(explicit)j(wildcar)n(ds:)30 5343
y Fe(ALL)44 b Fr(The)22 b(universal)h(wildcar)n(d,)h(always)f(matches.)
30 5550 y Fe(LOCAL)43 b Fr(Matches)22 b(any)h(host)e(whose)h(name)h
(does)e(not)g(contain)j(a)f(dot)e(character)-7 b(.)p
eop
%%Page: 123 129
123 128 bop 3434 100 a Fr(123)150 356 y Fe(UNKNOWN)42
b Fr(Matches)28 b(any)g(user)f(whose)f(name)i(is)g(unknown,)g(and)g
(matches)g(any)g(host)f(whose)377 469 y(name)35 b(or)g(addr)n(ess)e(ar)
n(e)i(unknown.)63 b(This)35 b(pattern)f(should)f(be)i(used)f(with)g
(car)n(e:)53 b(host)377 582 y(names)23 b(may)g(be)f(unavailable)j(due)d
(to)g(temporary)f(name)i(server)e(pr)n(oblems.)28 b(A)22
b(network)377 695 y(addr)n(ess)29 b(will)i(be)f(unavailable)i(when)e
(the)f(softwar)n(e)g(cannot)h(\002gur)n(e)f(out)g(what)h(type)e(of)377
808 y(network)21 b(it)i(is)g(talking)f(to.)150 1005 y
Fe(KNOWN)43 b Fr(Matches)25 b(any)g(user)f(whose)g(name)i(is)f(known,)f
(and)i(matches)f(any)g(host)f(whose)g(name)377 1118 y(and)e(addr)n(ess)
e(ar)n(e)h(known.)27 b(This)21 b(pattern)f(should)g(be)h(used)f(with)h
(car)n(e:)28 b(host)21 b(names)g(may)377 1231 y(be)f(unavailable)i(due)
d(to)g(temporary)f(name)i(server)f(pr)n(oblems.)26 b(A)20
b(network)e(addr)n(ess)g(will)377 1343 y(be)28 b(unavailable)j(when)d
(the)f(softwar)n(e)h(cannot)g(\002gur)n(e)f(out)g(what)i(type)d(of)i
(network)f(it)h(is)377 1456 y(talking)23 b(to.)150 1654
y Fe(PARANOID)42 b Fr(Matches)32 b(any)g(host)f(whose)g(name)i(does)e
(not)g(match)i(its)f(addr)n(ess.)56 b(When)32 b(tcpd)377
1766 y(is)27 b(built)h(with)f(-DP)-8 b(ARANOID)26 b(\(default)h
(mode\),)g(it)g(dr)n(ops)f(r)n(equests)f(fr)n(om)i(such)g(clients)377
1879 y(even)j(befor)n(e)f(looking)h(at)g(the)f(access)h(contr)n(ol)g
(tables.)50 b(Build)30 b(without)f(-DP)-8 b(ARANOID)377
1992 y(when)22 b(you)g(want)g(mor)n(e)h(contr)n(ol)g(over)f(such)g(r)n
(equests.)150 2262 y Fi(OPERA)-9 b(TORS)150 2443 y Fe(EXCEPT)43
b Fr(Intended)49 b(use)i(is)i(of)f(the)f(form:)87 b Fe(list)p
2087 2443 28 4 v 31 w(1)54 b(EXCEPT)e(list)p 2829 2443
V 31 w(2)p Fr(;)66 b(this)52 b(constr)o(uct)377 2556
y(matches)25 b(anything)f(that)g(matches)h Fe(list)p
1882 2556 V 31 w(1)f Fr(unless)g(it)h(matches)f Fe(list)p
2928 2556 V 31 w(2)p Fr(.)34 b(The)24 b Fe(EXCEPT)377
2669 y Fr(operator)17 b(can)i(be)f(used)e(in)j Fe(daemon)p
1652 2669 V 30 w(lists)d Fr(and)i(in)h Fe(client)p 2573
2669 V 30 w(lists)p Fr(.)24 b(The)17 b Fe(EXCEPT)e Fr(op-)377
2782 y(erator)25 b(can)g(be)g(nested:)31 b(if)26 b(the)e(contr)n(ol)h
(language)g(would)g(permit)f(the)h(use)f(of)h(par)n(enthe-)377
2895 y(ses,)c Fe(a)54 b(EXCEPT)e(b)i(EXCEPT)e(c)22 b
Fr(would)g(parse)g(as)h Fe(\(a)54 b(EXCEPT)d(\(b)j(EXCEPT)e(c\)\))p
Fr(.)150 3164 y Fi(SHELL)24 b(COMMANDS)150 3346 y Fr(If)32
b(the)e(\002rst-matched)h(access)h(contr)n(ol)f(r)o(ule)h(contains)g(a)
g(shell)f(command,)k(that)c(command)h(is)150 3459 y(subjected)26
b(to)g Fe(\045<letter>)d Fr(substitutions)i(\(see)i(next)f(section\).)
40 b(The)27 b(r)n(esult)f(is)h(executed)f(by)h(a)150
3572 y(/bin/sh)c(child)g(pr)n(ocess)e(with)h(standar)n(d)g(input,)f
(output)g(and)h(err)n(or)g(connected)e(to)i(/dev/null.)150
3685 y(Specify)27 b(an)g Fe(&)g Fr(at)g(the)g(end)f(of)h(the)f(command)
i(if)g(you)e(do)g(not)h(want)g(to)f(wait)i(until)f(it)g(has)g(com-)150
3798 y(pleted.)291 3913 y(Shell)44 b(commands)g(should)f(not)g(r)n(ely)
h(on)g(the)f(P)-8 b(A)h(TH)43 b(setting)f(of)i(the)f(inetd.)91
b(Instead,)150 4026 y(they)55 b(should)g(use)g(absolute)h(path)f
(names,)64 b(or)56 b(they)f(should)g(begin)h(with)g(an)h(explicit)150
4139 y(P)-8 b(A)h(TH=whatever)21 b(statement.)291 4254
y(The)37 b(hosts)p 697 4254 V 31 w(options\(5\))g(document)g(describes)
f(an)j(alternative)f(language)f(that)h(uses)e(the)150
4367 y(shell)23 b(command)g(\002eld)f(in)h(a)g(dif)n(fer)n(ent)g(and)g
(incompatible)g(way)-10 b(.)150 4636 y Fi(\045)24 b(EXP)-7
b(ANSIONS)150 4818 y Fr(The)22 b(following)h(expansions)e(ar)n(e)i
(available)j(within)d(shell)f(commands:)-50 5043 y Fe(\045a)54
b(\(\045A\))43 b Fr(The)22 b(client)h(\(server\))f(host)g(addr)n(ess.)
223 5240 y Fe(\045c)44 b Fr(Client)30 b(information:)43
b(user@host,)28 b(user@addr)n(ess,)h(a)h(host)e(name,)k(or)d(just)g(an)
h(addr)n(ess,)377 5353 y(depending)21 b(on)h(how)g(much)h(information)g
(is)g(available.)223 5550 y Fe(\045d)44 b Fr(The)22 b(daemon)g(pr)n
(ocess)g(name)g(\(ar)n(gv[0])j(value\).)p eop
%%Page: 124 130
124 129 bop 30 100 a Fr(124)1862 b Ff(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))-170 356 y
Fe(\045h)54 b(\(\045H\))43 b Fr(The)22 b(client)h(\(server\))f(host)g
(name)h(or)f(addr)n(ess,)f(if)i(the)f(host)g(name)h(is)f(unavailable.)
-170 546 y Fe(\045n)54 b(\(\045N\))43 b Fr(The)22 b(client)h
(\(server\))f(host)g(name)h(\(or)f(\224unknown\224)g(or)h
(\224paranoid\224\).)103 736 y Fe(\045p)44 b Fr(The)22
b(daemon)g(pr)n(ocess)g(id.)103 926 y Fe(\045s)44 b Fr(Server)30
b(information:)46 b(daemon@host,)30 b(daemon@addr)n(ess,)h(or)g(just)f
(a)i(daemon)e(name,)257 1039 y(depending)21 b(on)h(how)g(much)h
(information)g(is)g(available.)103 1229 y Fe(\045u)44
b Fr(The)22 b(client)h(user)f(name)h(\(or)f(\224unknown\224\).)103
1419 y Fe(\045\045)44 b Fr(Expands)22 b(to)g(a)h(single)f
Fe(\045)g Fr(character)-7 b(.)171 1635 y(Characters)37
b(in)h(\045)f(expansions)f(that)g(may)i(confuse)e(the)g(shell)h(ar)n(e)
g(r)n(eplaced)g(by)g(under)n(-)30 1748 y(scor)n(es.)30
2006 y Fi(SER)-7 b(VER)24 b(ENDPOINT)g(P)-7 b(A)e(TTERNS)30
2185 y Fr(In)29 b(or)n(der)f(to)g(distinguish)g(clients)h(by)g(the)f
(network)f(addr)n(ess)g(that)i(they)f(connect)g(to,)i(use)e(pat-)30
2297 y(terns)21 b(of)i(the)f(form:)171 2411 y Fe(process)p
561 2411 V 30 w(name@host)p 1086 2411 V 28 w(pattern)52
b(:)108 b(client)p 2044 2411 V 30 w(list)53 b(...)171
2525 y Fr(Patterns)22 b(like)i(these)e(can)j(be)e(used)f(when)h(the)g
(machine)i(has)f(dif)n(fer)n(ent)f(internet)f(addr)n(esses)30
2637 y(with)i(dif)n(fer)n(ent)h(internet)e(hostnames.)32
b(Service)25 b(pr)n(oviders)e(can)i(use)f(this)g(facility)i(to)e(of)n
(fer)h(FTP)-12 b(,)30 2750 y(GOPHER)29 b(or)h(WWW)f(ar)n(chives)i(with)
f(internet)e(names)i(that)f(may)i(even)e(belong)g(to)g(dif)n(fer)n(ent)
30 2863 y(or)n(ganisations.)57 b(See)31 b(also)i(the)f(\223twist\224)g
(option)g(in)h(the)f(hosts)p 2276 2863 V 31 w(options\(5\))g(document.)
56 b(Some)30 2976 y(systems)25 b(\(Solaris,)j(Fr)n(eeBSD\))e(can)h
(have)h(mor)n(e)e(than)h(one)f(internet)g(addr)n(ess)f(on)i(one)f
(physical)30 3089 y(interface;)21 b(with)g(other)f(systems)f(you)h(may)
h(have)h(to)e(r)n(esort)g(to)g(SLIP)g(or)h(PPP)g(pseudo)d(interfaces)30
3202 y(that)34 b(live)h(in)g(a)f(dedicated)f(network)g(addr)n(ess)f
(space.)62 b(.sp)34 b(The)f Fe(host)p 2615 3202 V 31
w(pattern)e Fr(obeys)i(the)30 3315 y(same)g(syntax)f(r)o(ules)g(as)h
(host)f(names)g(and)h(addr)n(esses)e(in)i Fe(client)p
2474 3315 V 30 w(list)e Fr(context.)57 b(Usually)-10
b(,)30 3428 y(server)22 b(endpoint)f(information)i(is)g(available)i
(only)d(with)h(connection-oriented)d(services.)30 3686
y Fi(CLIENT)25 b(USERNAME)e(LOOKUP)30 3865 y Fr(When)29
b(the)g(client)h(host)e(supports)f(the)i(RFC)h(931)h(pr)n(otocol)e(or)g
(one)g(of)g(its)h(descendants)d(\(T)-7 b(AP)-12 b(,)30
3977 y(IDENT)-7 b(,)29 b(RFC)g(1413\))j(the)d(wrapper)f(pr)n(ograms)h
(can)i(r)n(etrieve)e(additional)h(information)g(about)30
4090 y(the)f(owner)h(of)g(a)h(connection.)50 b(Client)31
b(username)e(information,)k(when)c(available,)35 b(is)c(logged)30
4203 y(together)20 b(with)j(the)e(client)j(host)d(name,)i(and)f(can)i
(be)e(used)f(to)h(match)i(patterns)d(like:)171 4317 y
Fe(daemon)p 506 4317 V 30 w(list)53 b(:)108 b(...)g(user)p
1465 4317 V 31 w(pattern@host)p 2156 4317 V 27 w(pattern)52
b(...)171 4430 y Fr(The)27 b(daemon)g(wrappers)f(can)i(be)g(con\002gur)
n(ed)e(at)i(compile)g(time)f(to)g(perform)g(r)o(ule-driven)30
4543 y(username)18 b(lookups)g(\(default\))i(or)f(to)f(always)i(interr)
n(ogate)e(the)g(client)i(host.)26 b(In)19 b(the)f(case)h(of)h(r)o(ule-)
30 4656 y(driven)28 b(username)g(lookups,)g(the)f(above)i(r)o(ule)g
(would)f(cause)g(username)f(lookup)h(only)g(when)30 4769
y(both)22 b(the)g Fe(daemon)p 719 4769 V 30 w(list)f
Fr(and)i(the)e Fe(host)p 1535 4769 V 31 w(pattern)f Fr(match.)171
4883 y(A)g(user)f(pattern)g(has)h(the)f(same)h(syntax)f(as)h(a)g
(daemon)g(pr)n(ocess)e(pattern,)h(so)g(the)h(same)f(wild-)30
4995 y(car)n(ds)35 b(apply)g(\(netgr)n(oup)e(membership)i(is)g(not)f
(supported\).)62 b(One)35 b(should)f(not)g(get)g(carried)30
5108 y(away)23 b(with)g(username)e(lookups,)g(though.)166
5324 y Fo(\017)46 b Fr(The)39 b(client)h(username)e(information)i
(cannot)f(be)g(tr)o(usted)f(when)g(it)i(is)f(needed)e(most,)257
5437 y(i.e.)91 b(when)43 b(the)g(client)h(system)e(has)i(been)f(compr)n
(omised.)90 b(In)43 b(general,)48 b(ALL)43 b(and)257
5550 y(\(UN\)KNOWN)22 b(ar)n(e)h(the)f(only)g(user)g(name)h(patterns)e
(that)h(make)h(sense.)p eop
%%Page: 125 131
125 130 bop 3434 100 a Fr(125)286 356 y Fo(\017)46 b
Fr(Username)29 b(lookups)g(ar)n(e)h(possible)f(only)h(with)g(TCP-based)
g(services,)h(and)f(only)g(when)377 469 y(the)18 b(client)i(host)d(r)o
(uns)i(a)g(suitable)g(daemon;)h(in)f(all)h(other)e(cases)h(the)f(r)n
(esult)g(is)h(\223unknown\224.)286 696 y Fo(\017)46 b
Fr(A)c(well-known)f(UNIX)f(kernel)h(bug)g(may)h(cause)g(loss)f(of)h
(service)f(when)g(username)377 809 y(lookups)25 b(ar)n(e)i(blocked)e
(by)h(a)h(\002r)n(ewall.)40 b(The)26 b(wrapper)f(README)g(document)g
(describes)377 921 y(a)e(pr)n(ocedur)n(e)f(to)g(\002nd)g(out)g(if)h
(your)f(kernel)g(has)g(this)g(bug.)286 1148 y Fo(\017)46
b Fr(Username)30 b(lookups)g(may)i(cause)f(noticeable)g(delays)g(for)g
(non-UNIX)e(users.)52 b(The)31 b(de-)377 1261 y(fault)e(timeout)f(for)g
(username)g(lookups)e(is)j(10)g(seconds:)37 b(too)28
b(short)f(to)h(cope)f(with)i(slow)377 1374 y(networks,)20
b(but)j(long)f(enough)f(to)h(irritate)h(PC)g(users.)291
1635 y(Selective)33 b(username)g(lookups)e(can)j(alleviate)h(the)e
(last)g(pr)n(oblem.)60 b(For)33 b(example,)i(a)f(r)o(ule)150
1748 y(like:)291 1871 y Fe(daemon)p 626 1871 28 4 v 30
w(list)53 b(:)109 b(@pcnetgroup)49 b(ALL@ALL)291 1994
y Fr(would)26 b(match)h(members)f(of)h(the)f(pc)g(netgr)n(oup)f
(without)g(doing)h(username)g(lookups,)f(but)150 2107
y(would)d(perform)g(username)g(lookups)f(with)h(all)i(other)e(systems.)
150 2422 y Fi(DETECTING)j(ADDRESS)f(SPOOFING)h(A)-9 b(TT)g(ACKS)150
2618 y Fr(A)29 b(\003aw)i(in)f(the)f(sequence)e(number)j(generator)e
(of)h(many)h(TCP/IP)g(implementations)f(allows)150 2731
y(intr)o(uders)k(to)h(easily)g(impersonate)f(tr)o(usted)f(hosts)h(and)h
(to)g(br)n(eak)g(in)h(via,)j(for)c(example,)j(the)150
2844 y(r)n(emote)22 b(shell)h(service.)28 b(The)22 b(IDENT)g(\(RFC931)i
(etc.\))29 b(service)22 b(can)i(be)f(used)e(to)h(detect)g(such)g(and)
150 2957 y(other)f(host)h(addr)n(ess)f(spoo\002ng)g(attacks.)291
3080 y(Befor)n(e)j(accepting)i(a)g(client)g(r)n(equest,)e(the)h
(wrappers)f(can)i(use)e(the)h(IDENT)f(service)i(to)f(\002nd)150
3193 y(out)18 b(that)g(the)g(client)h(did)f(not)g(send)f(the)h(r)n
(equest)f(at)i(all.)27 b(When)18 b(the)g(client)h(host)f(pr)n(ovides)f
(IDENT)150 3305 y(service,)j(a)g(negative)f(IDENT)f(lookup)g(r)n(esult)
h(\(the)g(client)h(matches)f Fe(UNKNOWN@host)p Fr(\))c(is)k(str)n(ong)
150 3418 y(evidence)j(of)h(a)g(host)e(spoo\002ng)g(attack.)291
3541 y(A)e(positive)g(IDENT)g(lookup)f(r)n(esult)h(\(the)g(client)g
(matches)h Fe(KNOWN@host)p Fr(\))15 b(is)20 b(less)e(tr)o(ustwor)n(-)
150 3654 y(thy)-10 b(.)43 b(It)27 b(is)h(possible)f(for)h(an)h(intr)o
(uder)e(to)g(spoof)g(both)g(the)g(client)i(connection)e(and)h(the)f
(IDENT)150 3767 y(lookup,)j(although)e(doing)h(so)f(is)i(much)g(har)n
(der)f(than)g(spoo\002ng)e(just)i(a)h(client)f(connection.)48
b(It)150 3880 y(may)23 b(also)g(be)f(that)h(the)f(client's)g(IDENT)g
(server)g(is)g(lying.)291 4003 y(Note:)k(IDENT)c(lookups)f(don't)h
(work)f(with)i(UDP)g(services.)150 4317 y Fi(EXAMPLES)150
4514 y Fr(The)32 b(language)h(is)f(\003exible)i(enough)d(that)h(dif)n
(fer)n(ent)h(types)e(of)h(access)h(contr)n(ol)g(policy)g(can)g(be)150
4627 y(expr)n(essed)27 b(with)j(a)h(minimum)g(of)f(fuss.)49
b(Although)29 b(the)g(language)h(uses)e(two)h(access)h(contr)n(ol)150
4740 y(tables,)k(the)d(most)g(common)h(policies)f(can)i(be)f
(implemented)e(with)i(one)f(of)h(the)f(tables)g(being)150
4853 y(trivial)24 b(or)f(even)f(empty)-10 b(.)291 4975
y(When)24 b(r)n(eading)h(the)f(examples)g(below)g(it)h(is)g(important)g
(to)f(r)n(ealise)h(that)f(the)g(allow)i(table)f(is)150
5088 y(scanned)d(befor)n(e)h(the)f(deny)g(table,)h(that)g(the)f(sear)n
(ch)h(terminates)f(when)h(a)g(match)h(is)f(found,)f(and)150
5201 y(that)g(access)h(is)g(granted)e(when)h(no)g(match)h(is)g(found)f
(at)h(all.)291 5324 y(The)29 b(examples)g(use)f(host)h(and)g(domain)h
(names.)48 b(They)28 b(can)j(be)e(impr)n(oved)g(by)h(including)150
5437 y(addr)n(ess)j(and/or)i(network/netmask)d(information,)38
b(to)d(r)n(educe)f(the)g(impact)i(of)e(temporary)150
5550 y(name)23 b(server)e(lookup)h(failur)n(es.)p eop
%%Page: 126 132
126 131 bop 30 100 a Fr(126)1862 b Ff(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))30 356 y Fi(MOSTL)-9
b(Y)25 b(CLOSED)30 542 y Fr(In)19 b(this)g(case,)h(access)f(is)h
(denied)e(by)i(default.)26 b(Only)20 b(explicitly)g(authorised)e(hosts)
g(ar)n(e)i(permitted)30 655 y(access.)171 772 y(The)i(default)g(policy)
h(\(no)g(access\))g(is)f(implemented)g(with)g(a)i(trivial)g(deny)d
(\002le:)30 998 y Fd(/etc/hosts.deny:)229 1098 y(ALL:)49
b(ALL)171 1332 y Fr(This)29 b(denies)e(all)j(service)f(to)f(all)i
(hosts,)f(unless)e(they)h(ar)n(e)h(permitted)e(access)i(by)f(entries)g
(in)30 1445 y(the)22 b(allow)h(\002le.)171 1563 y(The)f(explicitly)h
(authorised)e(hosts)g(ar)n(e)i(listed)f(in)h(the)f(allow)i(\002le.)k
(For)21 b(example:)30 1789 y Fd(/etc/hosts.allow:)179
1888 y(ALL:)49 b(LOCAL)g(@some_netgroup)179 1988 y(ALL:)g(.foobar.edu)f
(EXCEPT)h(terminalserver.foobar.edu)171 2223 y Fr(The)21
b(\002rst)h(r)o(ule)g(permits)f(access)h(fr)n(om)g(hosts)f(in)h(the)f
(local)j(domain)e(\(no)g(.)28 b(in)22 b(the)g(host)f(name\))30
2335 y(and)i(fr)n(om)h(members)f(of)g(the)g Fe(some)p
1299 2335 V 31 w(netgroup)d Fr(netgr)n(oup.)28 b(The)22
b(second)g(r)o(ule)i(permits)e(access)30 2448 y(fr)n(om)f(all)h(hosts)d
(in)j(the)d Fe(foobar.edu)e Fr(domain)k(\(notice)f(the)g(leading)h
(dot\),)f(with)g(the)g(exception)30 2561 y(of)j Fe(terminalserver)o(.f)
o(oo)o(bar)o(.e)o(du)o Fr(.)30 2843 y Fi(MOSTL)-9 b(Y)25
b(OPEN)30 3029 y Fr(Her)n(e,)c(access)i(is)g(granted)e(by)i(default;)f
(only)g(explicitly)h(speci\002ed)f(hosts)f(ar)n(e)i(r)n(efused)e
(service.)171 3147 y(The)e(default)h(policy)g(\(access)g(granted\))f
(makes)g(the)g(allow)i(\002le)f(r)n(edundant)f(so)g(that)g(it)h(can)h
(be)30 3260 y(omitted.)27 b(The)22 b(explicitly)h(non-authorised)e
(hosts)g(ar)n(e)i(listed)f(in)h(the)e(deny)h(\002le.)28
b(For)21 b(example:)30 3485 y Fd(/etc/hosts.deny:)179
3585 y(ALL:)49 b(some.host.name,)f(.some.domain)179 3685
y(ALL)i(EXCEPT)e(in.fingerd:)g(other.host.name,)f(.other.domain)171
3919 y Fr(The)35 b(\002rst)g(r)o(ule)g(denies)f(some)h(hosts)f(and)h
(domains)h(all)h(services;)k(the)35 b(second)f(r)o(ule)h(still)30
4032 y(permits)22 b(\002nger)f(r)n(equests)g(fr)n(om)i(other)e(hosts)g
(and)i(domains.)30 4314 y Fi(BOOBY)j(TRAPS)30 4500 y
Fr(The)35 b(next)f(example)h(permits)g(tftp)f(r)n(equests)f(fr)n(om)j
(hosts)e(in)i(the)e(local)j(domain)f(\(notice)f(the)30
4613 y(leading)25 b(dot\).)32 b(Requests)22 b(fr)n(om)j(any)g(other)e
(hosts)g(ar)n(e)i(denied.)32 b(Instead)23 b(of)i(the)e(r)n(equested)f
(\002le,)30 4726 y(a)h(\002nger)f(pr)n(obe)g(is)h(sent)e(to)h(the)g(of)
n(fending)g(host.)27 b(The)22 b(r)n(esult)g(is)g(mailed)i(to)e(the)g
(super)o(user)-7 b(.)30 5052 y Fd(/etc/hosts.allow:)179
5151 y(in.tftpd:)49 b(LOCAL,)f(.my.domain)30 5351 y(/etc/hosts.deny:)
179 5450 y(in.tftpd:)h(ALL:)g(\(/some/where/safe\\_finger)c(-l)k
(@\045h)g(|)h(\\)379 5550 y(/usr/ucb/mail)d(-s)j(\045d-\045h)e(root\))h
(&)p eop
%%Page: 127 133
127 132 bop 3434 100 a Fr(127)291 356 y(The)37 b Fe(safe)p
706 356 28 4 v 31 w(finger)f Fr(command)i(comes)g(with)g(the)f(tcpd)g
(wrapper)g(and)h(should)f(be)h(in-)150 469 y(stalled)33
b(in)i(a)f(suitable)g(place.)62 b(It)33 b(limits)h(possible)f(damage)h
(fr)n(om)g(data)g(sent)f(by)g(the)g(r)n(emote)150 582
y(\002nger)22 b(server)-7 b(.)27 b(It)22 b(gives)g(better)f(pr)n
(otection)h(than)g(the)g(standar)n(d)g(\002nger)g(command.)291
695 y(The)36 b(expansion)g(of)h(the)f(\045h)h(\(client)h(host\))e(and)h
(\045d)g(\(service)g(name\))g(sequences)e(is)i(de-)150
808 y(scribed)22 b(in)h(the)f(section)g(on)g(shell)h(commands.)291
920 y(W)-8 b(arning:)27 b(do)21 b(not)g(booby-trap)g(your)g(\002nger)g
(daemon,)g(unless)f(you)h(ar)n(e)h(pr)n(epar)n(ed)f(for)g(in\002-)150
1033 y(nite)h(\002nger)g(loops.)291 1146 y(On)34 b(network)d(\002r)n
(ewall)k(systems)c(this)i(trick)g(can)h(be)f(carried)h(even)f(further)
-7 b(.)59 b(The)32 b(typical)150 1259 y(network)24 b(\002r)n(ewall)j
(only)f(pr)n(ovides)f(a)h(limited)h(set)e(of)h(services)f(to)g(the)h
(outer)e(world.)38 b(All)26 b(other)150 1372 y(services)h(can)i(be)f
(\224bugged\224)g(just)f(like)i(the)e(above)h(tftp)g(example.)44
b(The)27 b(r)n(esult)h(is)g(an)h(excellent)150 1485 y(early-warning)23
b(system.)150 1740 y Fi(DIAGNOSTICS)150 1917 y Fr(An)i(err)n(or)g(is)h
(r)n(eported)d(when)i(a)h(syntax)e(err)n(or)h(is)g(found)g(in)h(a)g
(host)e(access)i(contr)n(ol)f(r)o(ule;)i(when)150 2030
y(the)i(length)f(of)h(an)h(access)g(contr)n(ol)f(r)o(ule)g(exceeds)f
(the)g(capacity)j(of)e(an)h(internal)g(buf)n(fer;)j(when)150
2143 y(an)h(access)f(contr)n(ol)g(r)o(ule)h(is)f(not)g(terminated)f(by)
h(a)h(newline)f(character;)39 b(when)33 b(the)f(r)n(esult)h(of)150
2255 y(expansion)25 b(would)g(over\003ow)f(an)i(internal)g(buf)n(fer;)i
(when)c(a)j(system)c(call)28 b(fails)f(that)e(shouldn)3519
2241 y(\264)3519 2255 y(t.)150 2368 y(All)e(pr)n(oblems)g(ar)n(e)g(r)n
(eported)d(via)k(the)e(syslog)f(daemon.)150 2623 y Fi(FILES)150
2800 y Fe(/etc/hosts.allo)o(w)p Fr(,)16 b(\(daemon,client\))23
b(pairs)g(that)f(ar)n(e)h(granted)e(access.)150 2913
y Fe(/etc/hosts.deny)o Fr(,)c(\(daemon,client\))22 b(pairs)h(that)f(ar)
n(e)h(denied)f(access.)150 3168 y Fi(SEE)j(ALSO)150 3345
y Fr(tcpd\(8\))e(tcp/ip)f(daemon)h(wrapper)e(pr)n(ogram.)150
3457 y(tcpdchk\(8\),)h(tcpdmatch\(8\),)i(test)d(pr)n(ograms.)150
3712 y Fi(BUGS)150 3889 y Fr(If)29 b(a)h(name)f(server)f(lookup)g
(times)h(out,)g(the)f(host)g(name)i(will)g(not)e(be)h(available)j(to)d
(the)f(access)150 4002 y(contr)n(ol)23 b(softwar)n(e,)e(even)h(though)g
(the)f(host)h(is)h(r)n(egister)n(ed.)291 4115 y(Domain)37
b(name)e(server)g(lookups)f(ar)n(e)h(case)h(insensitive;)41
b(NIS)34 b(\(formerly)i(YP\))f(netgr)n(oup)150 4228 y(lookups)21
b(ar)n(e)i(case)g(sensitive.)150 4483 y Fi(AUTHOR)150
4660 y Fr(W)-5 b(ietse)21 b(V)-10 b(enema)22 b(\(wietse@wzv)-10
b(.win.tue.nl\))150 4772 y(Department)22 b(of)g(Mathematics)h(and)g
(Computing)f(Science)150 4885 y(Eindhoven)g(University)f(of)i(T)-8
b(echnology)150 4998 y(Den)23 b(Dolech)g(2,)f(P)-12 b(.O.)23
b(Box)f(513,)150 5111 y(5600)j(MB)d(Eindhoven,)f(The)h(Netherlands)p
eop
%%Page: 128 134
128 133 bop 30 100 a Fr(128)1862 b Ff(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))p eop
%%Page: 129 135
129 134 bop 150 1020 a Fn(Bibliography)150 1482 y Fr([OMG96a])48
b Fq(The)30 b(Common)g(Object)g(Request)h(Br)n(oker:)44
b(Ar)n(chitectur)n(e)32 b(and)f(Speci\002cation)p Fr(,)h(Revision)434
1595 y(2.0,)23 b(OMG,)g(Updated)e(July)i(1996.)150 1783
y([OMG96b])48 b Fq(CORBAservices:)36 b(Common)26 b(Object)i(Services)g
(Speci\002cation)p Fr(,)h(OMG,)e(Updated)e(July)434 1896
y(1996.)150 2083 y([Richar)n(dson96a])47 b Fq(The)30
b(OMNI)f(Thr)n(ead)i(Abstraction)p Fr(,)h(T)-8 b(ristan)29
b(Richar)n(dson,)h(ORL,)f(22)h(October)434 2196 y(1996.)150
2384 y([Richar)n(dson96b])47 b Fq(The)26 b(OMNI)e(Development)j(Envir)n
(onment)f(V)-8 b(ersion)26 b(4.0)p Fr(,)g(T)-8 b(ristan)24
b(Richar)n(dson,)434 2497 y(ORL,)e(5)h(November)f(1996.)1792
5778 y(129)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
