%!PS-Adobe-2.0
%%Creator: dvips(k) 5.78 Copyright 1998 Radical Eye Software (www.radicaleye.com)
%%Title: omniORB2.dvi
%%Pages: 139
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Palatino-Roman Palatino-Italic Helvetica Courier
%%+ Palatino-Bold
%%EndComments
%DVIPSCommandLine: dvips -o omniORB2.ps omniORB2.dvi
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 1999.09.22:1927
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 2 string 0 1 255{IE S dup 360 add 36 4 index cvrs cvn
put}for pop 65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley
X /rulex X V}B /V{}B /RV statusdict begin /product where{pop false[
(Display)(NeXT)(LaserWriter 16/600)]{dup length product length le{dup
length product exch 0 exch getinterval eq{pop true exit}if}{pop}ifelse}
forall}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont cvx]cvx def}def /ObliqueSlant
{dup sin S cos div neg}B /SlantFont{4 index mul add}def /ExtendFont{3 -1
roll mul exch}def /ReEncodeFont{/Encoding exch def}def end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (omniORB2.dvi)
@start /Fa 138[51 28 1[32 3[51 8[42 18[60 2[69 5[32 73[{
TeXBase1Encoding ReEncodeFont}8 83.022 /Palatino-Bold
rf /Fb 134[45 2[45 45 45 45 45 1[45 45 45 45 45 45 1[45
3[45 45 45 1[45 14[45 2[45 11[45 45 45 6[45 16[45 45
40[{TeXBase1Encoding ReEncodeFont}25 74.7198 /Courier
rf /Fc 103[50 26[50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 1[50
1[50 50 50 1[50 50 50 50 50 50 50 50 1[50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 1[50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 33[{TeXBase1Encoding ReEncodeFont}89
83.022 /Courier rf /Fd 166[61 61 91 66 71 56 48 61 71
55 71 76 86 56 66 30 31 76 69 51 56 70 64 56 71 7[45
45 45 45 45 45 45 45 45 45 1[23 30 1[55 1[30 30 40[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}40 90.9091
/Palatino-Roman rf /Fe 136[54 1[42 25 29 29 1[37 33 42
58 2[21 1[37 37 1[29 37 30 35 33 38[19 37 1[37 7[22 19
46[{TeXBase1Encoding ReEncodeFont}22 74.7198 /Palatino-Italic
rf /Ff 134[42 39 62 42 45 24 32 30 42 45 41 43 66 22
42 17 22 43 42 25 36 46 33 41 37 9[75 54 58 46 39 50
1[45 59 62 71 46 1[25 25 62 57 42 46 58 53 46 58 6[19
1[37 37 37 1[37 37 37 37 37 45 19 25 19 45 29 25 25 21
35[45 45 2[{TeXBase1Encoding ReEncodeFont}66 74.7198
/Palatino-Roman rf /Fg 198[25 25 25 25 25 25 25 25 25
25 48[{TeXBase1Encoding ReEncodeFont}10 49.8132 /Palatino-Roman
rf /Fh 134[55 50 83 55 61 33 44 39 61 61 55 61 89 33
61 33 33 61 55 39 50 61 44 61 50 7[66 66 100 78 78 66
61 72 1[61 83 83 100 61 78 1[39 83 83 55 61 83 72 66
78 6[25 50 50 50 50 50 50 50 50 50 50 29 25 8[89 34[61
2[{TeXBase1Encoding ReEncodeFont}63 99.6264 /Palatino-Bold
rf /Fi 133[60 66 60 100 66 73 40 53 47 73 73 66 73 106
40 73 40 40 73 66 47 60 73 53 73 60 7[80 1[120 1[93 80
73 86 100 73 100 100 120 73 93 1[47 100 100 66 73 100
86 80 93 7[60 60 60 60 60 60 60 60 60 60 1[30 40 1[72
40[73 2[{TeXBase1Encoding ReEncodeFont}62 119.552 /Palatino-Bold
rf /Fj 198[33 33 33 33 33 33 33 33 33 33 48[{
TeXBase1Encoding ReEncodeFont}10 66.4176 /Palatino-Roman
rf /Fk 135[86 3[57 1[67 1[105 1[105 4[57 105 2[86 105
2[86 29[124 1[134 7[86 86 86 86 86 86 86 86 86 86 48[{
TeXBase1Encoding ReEncodeFont}22 172.188 /Palatino-Bold
rf /Fl 134[51 45 76 51 56 30 40 35 56 56 51 56 81 30
56 30 30 56 51 35 45 56 40 56 45 9[91 71 71 61 56 66
1[56 76 76 91 56 2[35 76 76 1[56 76 66 61 71 3[55 2[23
45 45 45 45 45 45 45 45 45 45 1[23 30 23 55 1[30 30 6[25
30[56 2[{TeXBase1Encoding ReEncodeFont}64 90.9091 /Palatino-Bold
rf /Fm 134[115 103 1[115 126 69 92 80 1[126 115 126 184
69 126 69 69 126 115 80 103 126 92 126 103 10[161 1[138
126 149 1[126 172 1[207 126 2[80 4[172 149 138 161 11[103
2[103 6[125 1[69 69 40[{TeXBase1Encoding ReEncodeFont}41
206.559 /Palatino-Bold rf /Fn 133[55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55
55 55 55 1[55 1[55 55 55 55 55 55 55 55 55 55 1[55 55
55 55 55 55 1[55 55 55 55 55 55 55 55 55 55 1[55 55 55
1[55 1[55 55 55 55 55 55 55 55 55 55 55 55 55 1[55 55
55 55 55 55 55 55 1[55 33[{TeXBase1Encoding ReEncodeFont}81
90.9091 /Courier rf
%DVIPSBitmapFont: Fo cmsy10 10.95 3
/Fo 3 111 df<EB0FFCEB3FFF90B512C0000314F04880488048804880A2481580A3B712
C0AA6C1580A36C1500A26C5C6C5C6C5C6C5CC614C0013F90C7FCEB0FFC22227BA72D>15
D<19301978A2197C193CA2193E191EA2191F737EA2737E737EA2737E737E1A7C1A7EF21F
80F20FC0F207F0007FBB12FCBDFCA26C1AFCCDEA07F0F20FC0F21F80F27E001A7C624F5A
4F5AA24F5A4F5AA24FC7FC191EA2193E193CA2197C1978A2193050307BAE5B>33
D<126012F07EA21278127CA2123C123EA2121E121FA27E7FA212077FA212037FA212017F
A212007FA21378137CA27FA2131E131FA27F80A2130780A2130380A2130180A2130080A2
1478147CA2143C143EA2141E141FA26E7EA2140781A2140381A2140181A2140081A21578
157CA2153C153EA2151E151FA2811680A2150716C0A21503ED0180225B7BC32D>110
D E
%EndDVIPSBitmapFont
/Fp 134[60 3[66 33 60 40 1[66 66 66 1[27 2[27 66 66 1[66
66 1[66 66 13[80 8[60 3[73 2[86 1[80 7[66 66 4[66 66
66 66 3[33 44[{TeXBase1Encoding ReEncodeFont}28 119.552
/Helvetica rf /Fq 134[45 45 66 45 51 30 35 35 42 45 40
51 71 25 40 25 25 45 45 25 35 45 37 42 40 10[66 1[56
51 61 2[71 71 86 3[30 3[56 71 61 56 66 68 5[23 2[45 45
1[45 45 45 45 45 1[23 1[23 2[30 30 37[48 2[{
TeXBase1Encoding ReEncodeFont}52 90.9091 /Palatino-Italic
rf /Fr 75[30 31[45 45 24[45 51 47 76 51 55 30 39 36 51
55 50 53 80 26 51 21 26 53 51 30 44 56 40 50 45 3[30
1[30 61 61 61 91 66 71 56 48 61 71 55 71 76 86 56 66
30 31 76 69 51 56 70 64 56 71 68 2[55 1[23 23 45 45 45
45 45 45 45 45 45 45 55 23 30 23 55 35 30 30 25 71 76
1[45 1[25 29[55 55 2[{TeXBase1Encoding ReEncodeFont}86
90.9091 /Palatino-Roman rf /Fs 137[68 1[39 51 47 2[65
1[106 3[35 70 66 1[57 73 53 66 60 12[73 63 80 5[73 7[93
85 1[93 19[40 6[93 38[{TeXBase1Encoding ReEncodeFont}23
119.552 /Palatino-Roman rf /Ft 137[117 125 1[88 82 2[113
120 182 3[60 120 2[99 126 14[161 127 1[138 2[162 7[158
4[126 9[103 5[103 3[52 6[57 39[{TeXBase1Encoding ReEncodeFont}21
206.559 /Palatino-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 639 415 a Ft(The)51 b(omniORB2)i(version)e(2.8)1230
673 y(User)15 b('s)51 b(Guide)1594 1795 y Fs(Sai-Lai)28
b(Lo)1269 1945 y Fr(\()p Fq(email:)h(slo@uk.r)n(esear)n(ch.att.com)p
Fr(\))1457 2094 y Fs(David)f(Riddoch)1267 2243 y Fr(\()p
Fq(email:)h(djr@uk.r)n(esear)n(ch.att.com)p Fr(\))1038
2393 y Fs(A)-9 b(T&T)31 b(Laboratories)f(Cambridge)1548
4452 y Fr(22nd)23 b(Sept,)e(1999)p eop
%%Page: 2 2
2 1 bop 171 356 a Fp(Changes)36 b(and)e(Additions)n(,)h(22nd)g(Sept)f
(1999)166 526 y Fo(\017)46 b Fr(chapter)22 b(2)i(-)f(added)e
(description)g(on)i(BOA)f(and)h(ORB)f(shutdown.)166 707
y Fo(\017)46 b Fr(Chapter)23 b(4)g(-)g(updates)e(to)h(command-line)h
(options)166 888 y Fo(\017)46 b Fr(Chapter)22 b(7)g(-)g(updates)e(to)h
(idle)g(connection)g(shutdown.)26 b(Added)19 b(desciption)i(on)g(the)g
(new)257 1001 y(r)n(emote)h(call)i(timeout)e(featur)n(e.)171
1171 y Fp(Changes)36 b(and)e(Additions)n(,)h(1st)f(J)n(uly)e(1999)166
1363 y Fo(\017)46 b Fr(Chapter)23 b(1)g(-)g(updates)e(to)h(featur)n(es)
f(and)i(setup)e(information)166 1543 y Fo(\017)46 b Fr(Chapter)23
b(3)g(-)g(added)e(notes)g(on)h(incompatibility)j(with)d(pr)n(e-omniORB)
h(2.8.0)g(r)n(eleases.)166 1724 y Fo(\017)46 b Fr(Chapter)23
b(4)g(-)g(updates)e(to)h(command-line)h(options)f(and)g
(con\002guration)g(variables.)166 1905 y Fo(\017)46 b
Fr(Chapter)23 b(5)g(-)g(new)f(command-line)i(option)166
2086 y Fo(\017)46 b Fr(Chapter)23 b(9)g(-)g(updates)e(on)h(the)g(new)g
(Any)g(and)g(T)-8 b(ypeCode)21 b(behaviour)i(and)f(added)g(notes)257
2198 y(on)h(incompatibility)h(with)e(pr)n(e-omniORB)h(2.8.0)g(r)n
(eleases.)166 2379 y Fo(\017)46 b Fr(Chapter)30 b(10)h(-)f(added)e
(note)h(to)g(indicate)i(that)e(the)g(implementation)h(has)g(not)f(been)
g(up-)257 2492 y(dated)22 b(to)g(CORBA)g(2.3)i(yet.)166
2673 y Fo(\017)46 b Fr(Chapter)17 b(1)-5 b(1)18 b(-)g(added)e(note)g
(on)h(the)f(change)h(in)h(the)e(default)h(value)h(of)f
Fn(CORBA::diiThrow)o(sS)o(ys)o(Ex)o(cep)o(ti)o(on)o(s)p
Fr(.)166 2853 y Fo(\017)46 b Fr(Chapter)30 b(12)h(-)f(added)e(note)h
(to)g(indicate)i(that)e(the)g(implementation)h(has)g(not)f(been)g(up-)
257 2966 y(dated)k(to)h(CORBA)g(2.3)g(yet.)61 b(Added)32
b(note)h(on)h(new)f(way)h(to)g(pass)f(system)f(exception)257
3079 y(back)24 b(in)f(the)f Fn(invoke\(\))d Fr(method.)171
3271 y Fp(Changes)36 b(and)e(Additions)n(,)h(8th)f(J)n(une)g(1999)166
3463 y Fo(\017)46 b Fr(Chapter)23 b(9)g(-)g(corr)n(ection,)f(r)n
(ecursive)g(T)-8 b(ypeCodes)20 b(ar)n(e)j(supported)166
3644 y Fo(\017)46 b Fr(Chapter)23 b(1)-5 b(1)23 b(-)g(corr)n(ection,)f
(usage)g(of)h(CORBA::ORB::cr)n(eate)p 2420 3644 28 4
v 31 w(foo\(\))171 3844 y Fp(Changes)36 b(and)e(Additions)n(,)h(22nd)g
(F)l(ebr)r(uar)t(y)f(1999)166 4036 y Fo(\017)46 b Fr(Chapter)23
b(1)-5 b(1)23 b(-)g(expanded)e(and)i(updated)171 4237
y Fp(Changes)36 b(and)e(Additions)n(,)h(30)f(Sept)g(1998)166
4429 y Fo(\017)46 b Fr(Chapter)23 b(1)g(-)g(updates)e(to)h(featur)n(es)
f(and)i(setup)e(information)166 4610 y Fo(\017)46 b Fr(Chapter)23
b(2)g(-)g(new)f(example)g(on)h(tie)f(implementation)g(templates)166
4790 y Fo(\017)46 b Fr(Chapter)21 b(4)h(-)g(updates)e(to)h
(command-line)h(options)e(and)i(a)g(new)e(section)h(on)g(initial)i
(object)257 4903 y(r)n(efer)n(ence)f(bootstrapping.)166
5084 y Fo(\017)46 b Fr(Chapter)23 b(5)g(-)g(new)f(section)g(on-demand)f
(object)i(loading)166 5265 y Fo(\017)46 b Fr(Chapter)17
b(7)h(-)f(new)g(r)o(untime)g(con\002guration)g(variable)i
Fn(omniORB::maxTc)o(pC)o(onn)o(ec)o(ti)o(on)o(Pe)o(rSe)o(rv)o(er)o
Fr(.)166 5445 y Fo(\017)46 b Fr(New)22 b(chapter)g(-)h(Dynamic)h
(Management)e(of)h(Any)f(V)-8 b(alues)p eop
%%Page: 3 3
3 2 bop 150 1022 a Fm(Contents)150 1560 y Fl(1)91 b(Introduction)2713
b(1)286 1675 y Fr(1.1)96 b(Featur)n(es)86 b(.)45 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(1)495 1790 y(1.1.1)110 b(CORBA)23 b(2)g(compliant)68
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(1)495 1904
y(1.1.2)110 b(Multithr)n(eading)67 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)125 b(1)495 2019 y(1.1.3)110 b(Portability)53
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(2)495 2133 y(1.1.4)110 b(Missing)23 b(featur)n(es)86
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(2)286
2248 y(1.2)96 b(Setting)22 b(Up)g(Y)-8 b(our)21 b(Envir)n(onment)49
b(.)c(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(3)286 2363 y(1.3)96
b(Platform)24 b(speci\002c)e(variables)51 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)125 b(3)150 2569 y Fl(2)91 b(The)23 b(Basics)2798
b(5)286 2684 y Fr(2.1)96 b(The)22 b(Echo)h(Object)g(Example)81
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(5)286 2799
y(2.2)96 b(Specifying)23 b(the)e(Echo)i(interface)f(in)i(IDL)72
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)125 b(5)286 2913 y(2.3)96 b(Generating)22
b(the)g(C++)i(stubs)77 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(6)286 3028 y(2.4)96 b(A)23 b(Quick)g(T)-8 b(our)22
b(of)g(the)g(C++)i(stubs)81 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125
b(7)495 3143 y(2.4.1)110 b(Object)24 b(Refer)n(ence)76
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(7)495
3257 y(2.4.2)110 b(Object)24 b(Implementation)k(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)125 b(9)286 3372 y(2.5)96
b(W)-7 b(riting)23 b(the)f(object)h(implementation)72
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(10)286 3486 y(2.6)96 b(W)-7
b(riting)23 b(the)f(client)72 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)84 b(1)-5 b(1)286 3601 y(2.7)96 b(Example)23
b(1)g(-)g(Colocated)g(Client)g(and)f(Implementation)50
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(12)495 3716 y(2.7.1)110 b(ORB/BOA)23 b(initialisation)58
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(13)495 3830 y(2.7.2)110
b(ORB/BOA)23 b(shutdown)79 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(14)495 3945 y(2.7.3)110 b(Object)24 b(initialisation)38
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(14)495 4060
y(2.7.4)110 b(Client)24 b(invocation)59 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)79 b(14)495 4174 y(2.7.5)110 b(Object)24
b(disposal)66 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(15)286 4289 y(2.8)96 b(Example)23 b(2)g(-)g(Dif)n(fer)n(ent)h(Addr)n
(ess)c(Spaces)77 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(15)495 4404 y(2.8.1)110
b(Object)24 b(Implementation:)j(Generating)22 b(a)h(Stringi\002ed)e
(Object)i(Refer)n(ence)56 b(16)495 4518 y(2.8.2)110 b(Client:)29
b(Using)22 b(a)h(Stringi\002ed)e(Object)j(Refer)n(ence)k(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(16)495
4633 y(2.8.3)110 b(Catching)24 b(System)d(Exceptions)89
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)79 b(17)495 4747 y(2.8.4)110 b(Lifetime)23
b(of)f(an)i(Object)f(Implementation)60 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(17)286 4862 y(2.9)96
b(Example)23 b(3)g(-)g(Using)f(the)g(COS)h(Naming)g(Service)34
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(18)495 4977 y(2.9.1)110 b(Obtaining)24 b(the)e(Root)f(Context)h
(Object)h(Refer)n(ence)38 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)79 b(18)495 5091 y(2.9.2)110 b(The)22 b(Naming)h(Service)g
(Interface)34 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(19)286 5206 y(2.10)51
b(Example)23 b(4)g(-)g(Using)f(tie)g(implementation)h(templates)57
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(19)286 5321 y(2.1)-5 b(1)56 b(Sour)n(ce)23 b(Listing)57
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(20)495 5435 y(2.1)-5 b(1.1)70 b(echo)p 978 5435 28
4 v 33 w(i.cc)60 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(20)495 5550 y(2.1)-5 b(1.2)70 b(gr)n(eeting.cc)42
b(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(21)1820 5778 y(iii)p eop
%%Page: 4 4
4 3 bop 375 356 a Fr(2.1)-5 b(1.3)70 b(eg1.cc)30 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(22)375 469 y(2.1)-5 b(1.4)70 b(eg2)p 811 469 28 4 v
33 w(impl.cc)83 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)79 b(24)375 583 y(2.1)-5 b(1.5)70 b(eg2)p 811 583
V 33 w(clt.cc)37 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(25)375 696 y(2.1)-5 b(1.6)70 b(eg3)p
811 696 V 33 w(impl.cc)83 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(27)375 809 y(2.1)-5 b(1.7)70 b(eg3)p
811 809 V 33 w(clt.cc)37 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(31)375 923 y(2.1)-5 b(1.8)70
b(eg3)p 811 923 V 33 w(tieimpl.cc)51 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(34)375 1036 y(2.1)-5 b(1.9)70
b(dir)-7 b(.mk)76 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)79 b(38)30 1240 y Fl(3)91 b(IDL)23 b(to)f(C++)h
(Language)f(Mapping)1889 b(39)166 1354 y Fr(3.1)96 b(Incompatibilities)
24 b(with)f(pr)n(e-2.8.0)g(r)n(eleases)64 b(.)45 b(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(39)30 1558 y Fl(4)91 b(The)23 b(omniORB2)e(API)2359
b(41)166 1672 y Fr(4.1)96 b(ORB)23 b(and)g(BOA)f(initialisation)j
(options)82 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(41)166 1785 y(4.2)96
b(Run-time)23 b(T)-8 b(racing)23 b(and)f(Diagnostic)h(Messages)51
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(42)166 1898 y(4.3)96 b(Server)22 b(Name)38 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(43)166 2012 y(4.4)96 b(Object)24 b(Keys)84 b(.)45 b(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(43)166
2125 y(4.5)96 b(GIOP)24 b(Message)c(Size)56 b(.)45 b(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(44)166 2238 y(4.6)96
b(Initial)24 b(Object)f(Refer)n(ence)f(Bootstrapping)55
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(44)166 2352 y(4.7)96 b(GIOP)24 b(Lowest)c(Common)j
(Denominator)f(Mode)31 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)79 b(46)166 2465 y(4.8)96 b(T)-8
b(rapping)22 b(omniORB2)h(Internal)g(Err)n(ors)71 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)79 b(46)30 2670 y Fl(5)91 b(The)23 b(Basic)h(Object)f
(Adaptor)f(\(BOA\))1834 b(47)166 2783 y Fr(5.1)96 b(BOA)23
b(Initialisation)42 b(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(47)166 2896 y(5.2)96 b(Object)24 b(Registration)66
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(49)166 3010 y(5.3)96 b(Object)24 b(Disposal)70 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(49)166 3123 y(5.4)96 b(BOA)23 b(Shutdown)58 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(50)166 3236 y(5.5)96 b(Unsupported)20 b(functions)33
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(51)166
3350 y(5.6)96 b(Loading)22 b(Objects)h(On)g(Demand)74
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(51)30 3554 y Fl(6)91
b(Interface)26 b(T)-8 b(ype)21 b(Checking)2175 b(53)166
3667 y Fr(6.1)96 b(Intr)n(oduction)56 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(53)166 3781
y(6.2)96 b(Basic)24 b(Interface)e(T)-8 b(ype)21 b(Checking)40
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(54)166 3894 y(6.3)96
b(Interface)22 b(Inheritance)75 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)79 b(55)30 4099 y Fl(7)91 b(Connection)22
b(Management)2145 b(59)166 4212 y Fr(7.1)96 b(Backgr)n(ound)73
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)79 b(59)166 4325 y(7.2)96 b(The)22 b(Model)59 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(59)166 4439 y(7.3)96 b(Idle)22 b(Connection)h(Shutdown)d(and)j
(Remote)e(Call)k(T)-5 b(imeout)65 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)79 b(60)166 4552 y(7.4)96 b(Inter)n(operability)22
b(Considerations)50 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(61)166
4665 y(7.5)96 b(Connection)23 b(Acceptance)i(.)45 b(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)79 b(62)30 4870 y Fl(8)91 b(Proxy)23
b(Objects)2615 b(63)166 4983 y Fr(8.1)96 b(System)21
b(Exception)h(Handlers)67 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(63)375 5096 y(8.1.1)110 b(CORBA::TRANSIENT)19 b(handlers)25
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)79 b(64)375 5210 y(8.1.2)110 b(CORBA::COMM)p
1347 5210 V 33 w(F)-7 b(AILURE)60 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(66)375 5323 y(8.1.3)110 b(CORBA::SystemException)29
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)79 b(66)166 5436 y(8.2)96 b(Pr)n(oxy)22
b(Object)i(Factories)73 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)79 b(67)375 5550 y(8.2.1)110 b(Backgr)n(ound)55 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(67)p eop
%%Page: 5 5
5 4 bop 495 356 a Fr(8.2.2)110 b(An)23 b(Example)46 b(.)f(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(68)786 470 y(8.2.2.1)124
b(De\002ne)22 b(a)h(new)f(pr)n(oxy)g(class)60 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(68)786 585 y(8.2.2.2)124 b(De\002ne)22 b(a)h(new)f(pr)n(oxy)g
(factory)h(class)28 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(69)495 699 y(8.2.3)110 b(Further)21 b(Considerations)86
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(70)150 905 y Fl(9)91
b(T)-8 b(ype)22 b(Any)g(and)g(T)-8 b(ypeCode)2164 b(71)286
1020 y Fr(9.1)96 b(Example)23 b(using)f(type)f(Any)43
b(.)j(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(71)495
1134 y(9.1.1)110 b(T)-8 b(ype)21 b(Any)h(in)h(IDL)75
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(71)495
1248 y(9.1.2)110 b(Inserting)21 b(and)i(Extracting)f(Basic)h(T)-8
b(ypes)21 b(fr)n(om)i(an)g(Any)49 b(.)c(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
79 b(72)495 1363 y(9.1.3)110 b(Inserting)21 b(and)i(Extracting)f
(Constr)o(ucted)f(T)-8 b(ypes)20 b(fr)n(om)k(an)f(Any)33
b(.)46 b(.)f(.)g(.)g(.)79 b(73)286 1477 y(9.2)96 b(T)-8
b(ype)21 b(Any)h(in)h(omniORB2)81 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(75)286 1592 y(9.3)96 b(T)-8 b(ypeCode)21
b(in)i(omniORB2)64 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(78)286 1706 y(9.4)96 b(Sour)n(ce)23 b(Listing)57 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(80)495 1820 y(9.4.1)110 b(anyExample)p 1293 1820 28
4 v 33 w(impl.cc)62 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(80)495 1935 y(9.4.2)110 b(anyExample)p 1293 1935 V
33 w(clt.cc)85 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(84)150 2141 y Fl(10)46 b(Dynamic)23 b(Management)g(of)g(Any)e(V)-10
b(alues)1638 b(89)286 2255 y Fr(10.1)51 b(C++)24 b(mapping)69
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(89)286 2370 y(10.2)51 b(The)22 b(DynAny)g(Interface)74
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(93)495
2484 y(10.2.1)65 b(Example:)28 b(extract)22 b(data)h(values)g(fr)n(om)g
(an)g(Any)80 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(93)786 2599 y(10.2.1.1)g(Iterate)21 b(thr)n(ough)h(the)f(components)
61 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(94)786 2713 y(10.2.1.2)g(Extract)22 b(basic)i(type)d(components)39
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(94)786 2827 y(10.2.1.3)g(Extract)22 b(complex)h(components)31
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)79
b(95)786 2942 y(10.2.1.4)g(Clean-up)74 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)79 b(95)495 3056 y(10.2.2)65 b(Example:)28 b(insert)22
b(data)h(values)g(into)f(an)h(Any)h(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)79 b(96)786 3170 y(10.2.2.1)g(Insert)21
b(basic)j(type)d(components)i(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)79 b(97)786 3285 y(10.2.2.2)g(Insert)21
b(complex)i(components)83 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)79 b(98)286 3399 y(10.3)51 b(The)22
b(DynStr)o(uct)g(Interface)79 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)79 b(99)286 3514 y(10.4)51 b(The)22 b(DynSequence)f(Interface)76
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(100)286 3628
y(10.5)51 b(The)22 b(DynArray)g(Interface)78 b(.)46 b(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)34 b(101)286 3742 y(10.6)51 b(The)22
b(DynEnum)g(Interface)73 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
34 b(101)286 3857 y(10.7)51 b(The)22 b(DynUnion)h(Interface)63
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(101)495
3971 y(10.7.1)65 b(Thr)n(ee)22 b(Categories)g(of)g(Union)32
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)34 b(102)495 4085 y(10.7.2)65
b(Example:)28 b(extract)22 b(data)h(values)g(fr)n(om)g(a)g(union)71
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(102)786 4200 y(10.7.2.1)79 b(Explicit)23 b(default)g(union)48
b(.)d(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)34 b(102)786 4314 y(10.7.2.2)79 b(Implicit)24
b(default)e(union)40 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(104)786 4429
y(10.7.2.3)79 b(No)22 b(default)g(union)j(.)45 b(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(104)495 4543 y(10.7.3)65 b(Example:)28 b(insert)22
b(data)h(values)g(into)f(a)h(union)83 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(104)786 4657 y(10.7.3.1)79
b(Ambiguous)22 b(usage)53 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(105)286
4772 y(10.8)51 b(Duplicate)24 b(DynAny)e(Refer)n(ences)27
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(106)286 4886 y(10.9)51
b(Other)23 b(Operations)63 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)34 b(106)150 5092 y Fl(1)m(1)49 b(The)23
b(Dynamic)f(Invocation)g(Interface)1729 b(109)286 5207
y Fr(1)-5 b(1.1)56 b(Overview)29 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(109)286
5321 y(1)-5 b(1.2)56 b(Pseudo)21 b(Objects)85 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(109)495 5435 y(1)-5 b(1.2.1)70 b(Request)85 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(10)495 5550 y(1)g(1.2.2)70 b(NamedV)-8 b(alue)85
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(10)p eop
%%Page: 6 6
6 5 bop 375 356 a Fr(1)-5 b(1.2.3)70 b(NVList)48 b(.)d(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)f(1)-5 b(1)g(1)375
469 y(1)g(1.2.4)70 b(Context)23 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)f(1)-5 b(1)g(1)375 582
y(1)g(1.2.5)70 b(ContextList)77 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(12)375 695 y(1)g(1.2.6)70
b(ExceptionList)62 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
39 b(1)-5 b(12)375 808 y(1)g(1.2.7)70 b(UnknownUserException)25
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)39 b(1)-5 b(12)375 920 y(1)g(1.2.8)70
b(Envir)n(onment)84 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)39 b(1)-5 b(13)166 1033 y(1)g(1.3)56 b(Cr)n(eating)23
b(Requests)36 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)39 b(1)-5 b(13)375 1146 y(1)g(1.3.1)70 b(Examples)86
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(14)166 1259 y(1)g(1.4)56 b(Invoking)22 b(Operations)68
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(15)166 1372 y(1)g(1.5)56 b(Multiple)23 b(Requests)35
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)39
b(1)-5 b(16)30 1576 y Fl(12)46 b(The)23 b(Dynamic)f(Skeleton)h
(Interface)1807 b(1)m(19)166 1689 y Fr(12.1)51 b(Overview)29
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)39 b(1)-5 b(19)166 1802 y(12.2)51 b(DSI)23
b(T)-8 b(ypes)87 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)34 b(120)375 1915 y(12.2.1)65
b(DynamicImplementation)79 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34
b(120)375 2028 y(12.2.2)65 b(ServerRequest)31 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(120)166
2141 y(12.3)51 b(Cr)n(eating)23 b(Dynamic)i(Implementations)73
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)34 b(121)375 2253 y(12.3.1)65 b(Operations)22
b(on)h(the)e(ServerRequest)36 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(121)166 2366
y(12.4)51 b(Registering)21 b(Dynamic)j(Objects)80 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)34 b(122)166 2479 y(12.5)51
b(Example)75 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)34 b(122)30 2683 y Fl(A)65 b(hosts)p
388 2683 28 4 v 33 w(access\(5\))2543 b(125)p eop
%%Page: 1 7
1 6 bop 150 982 a Fk(Chapter)44 b(1)150 1400 y Fm(Introduction)150
1848 y Fr(OmniORB2)21 b(is)f(an)h(Object)f(Request)e(Br)n(oker)g
(\(ORB\))j(that)e(implements)g(the)g(2.3)i(speci\002cation)f(of)150
1961 y(the)h(Common)i(Object)f(Request)e(Br)n(oker)h(Ar)n(chitectur)n
(e)h(\(CORBA\))g([OMG99a)s(])2964 1928 y Fj(1)3001 1961
y Fr(.)28 b(It)22 b(has)g(passed)150 2074 y(the)c(Open)g(Gr)n(oup)h
(CORBA)f(compliant)i(testsuite)c(and)j(is)g(one)e(of)i(the)f(thr)n(ee)g
(ORBs)g(to)g(have)h(been)150 2187 y(granted)i(the)h(CORBA)h(brand)g(in)
g(June)f(1999)1730 2154 y Fj(2)1769 2187 y Fr(.)291 2303
y(This)j(user)f(guide)h(tells)g(you)f(how)h(to)f(use)h(omniORB2)h(to)e
(develop)g(CORBA)i(applications.)150 2416 y(It)c(assumes)f(a)j(basic)f
(understanding)e(of)i(CORBA.)291 2532 y(In)i(this)f(chapter)-7
b(,)25 b(we)g(give)g(an)g(overview)g(of)g(the)f(main)i(featur)n(es)e
(of)h(omniORB2)g(and)g(what)150 2645 y(you)d(need)f(to)h(do)g(to)g
(setup)f(your)g(envir)n(onment)i(to)f(r)o(un)g(omniORB2.)150
2962 y Fi(1.1)119 b(Features)150 3183 y Fh(1.1.1)99 b(CORBA)25
b(2)f(compliant)150 3366 y Fr(OmniORB2)19 b(implements)e(the)f
(Internet)g(Inter)n(-ORB)g(Pr)n(otocol)h(\(IIOP\).)h(This)f(pr)n
(otocol)g(pr)n(ovides)150 3479 y(omniORB2)32 b(the)g(means)f(of)h
(achieving)h(inter)n(operability)f(with)g(the)f(ORBs)g(implemented)g
(by)150 3592 y(other)24 b(vendors.)35 b(In)25 b(fact,)i(this)e(is)h
(the)f(native)h(pr)n(otocol)f(used)f(by)h(omniORB2)h(for)g(the)e
(commu-)150 3705 y(nication)30 b(amongst)e(its)h(objects)f(r)n(esiding)
h(in)g(dif)n(fer)n(ent)g(addr)n(ess)f(spaces.)46 b(Mor)n(eover)-7
b(,)30 b(the)e(IDL)150 3818 y(to)e(C++)h(language)f(mapping)h(pr)n
(ovided)e(by)h(omniORB2)h(conforms)f(to)g(the)g(latest)f(r)n(evision)i
(of)150 3930 y(the)i(CORBA)h(speci\002cation.)50 b(T)-8
b(ype)28 b(Any)h(and)h(T)-8 b(ypeCode)27 b(ar)n(e)k(now)e(supported)e
(\(intr)n(oduced)150 4043 y(in)d(version)f(2.5.0\).)31
b(DynAny)22 b(is)i(supported)c(since)j(2.6.0.)31 b(The)23
b(Dynamic)h(Invocation)g(Interface)150 4156 y(and)19
b(Dynamic)i(Skeleton)c(Interface)h(ar)n(e)i(supported)c(since)j(2.7.0.)
27 b(The)19 b(C++)h(mapping)f(has)g(been)150 4269 y(updated)i(to)h(the)
g(CORBA)g(2.3)i(speci\002cation)e(since)h(2.8.0.)150
4543 y Fh(1.1.2)99 b(Multithreading)150 4726 y Fr(OmniORB2)32
b(is)e(fully)h(multithr)n(eaded.)50 b(T)-8 b(o)29 b(achieve)i(low)g
(IIOP)f(call)i(over)n(head,)f(unnecessary)150 4839 y(call-multiplexing)
26 b(is)f(eliminated.)33 b(At)23 b(any)h(time,)h(ther)n(e)e(is)h(at)h
(most)e(one)g(call)j(in-\003ight)f(in)g(each)150 4952
y(communication)30 b(channel)f(between)e(two)h(addr)n(ess)f(spaces.)44
b(T)-8 b(o)28 b(do)g(so)g(without)f(limiting)j(the)150
5065 y(level)c(of)f(concurr)n(ency)-10 b(,)25 b(new)g(channels)g
(connecting)f(the)h(two)f(addr)n(ess)g(spaces)g(ar)n(e)i(cr)n(eated)e
(on)150 5178 y(demand)i(and)g(cached)g(when)g(ther)n(e)f(ar)n(e)h(mor)n
(e)g(concurr)n(ent)g(calls)i(in)e(pr)n(ogr)n(ess.)37
b(Each)26 b(channel)p 150 5277 1368 4 v 255 5334 a Fg(1)284
5365 y Ff(Most)e(of)g(the)h(2.3)f(featur)o(es)g(have)h(been)f
(implemented.)39 b(The)24 b(featur)o(es)g(still)f(missing)g(in)h(this)h
(r)o(elease)d(is)i(listed)150 5457 y(in)19 b(1.1.4.)k(Wher)o(e)18
b(possible,)f(backwar)o(d)h(compatibility)h(has)g(been)g(maintained)h
(up)e(to)h(speci\002cation)g(2.0.)255 5518 y Fg(2)284
5550 y Ff(Mor)o(e)f(information)g(can)i(be)f(found)f(at)i
Fe(http://www)l(.opengr)o(oup.or)o(g/pr)o(ess/7jun99)p
2634 5550 23 4 v 27 w(b.htm)1837 5778 y Fr(1)p eop
%%Page: 2 8
2 7 bop 30 100 a Fr(2)2062 b Fd(CHAPTER)22 b(1.)51 b(INTRODUCTION)30
356 y Fr(is)34 b(served)f(by)h(a)g(dedicated)f(thr)n(ead.)62
b(This)34 b(arrangement)f(pr)n(ovides)g(maximal)j(concurr)n(ency)30
469 y(and)27 b(eliminates)f(any)h(thr)n(ead)f(switching)g(in)h(either)f
(of)h(the)e(addr)n(ess)h(spaces)f(to)h(pr)n(ocess)f(a)j(call.)30
582 y(Furthermor)n(e,)k(to)g(maximise)h(the)f(thr)n(oughput)e(in)j(pr)n
(ocessing)e(lar)n(ge)h(call)i(ar)n(guments,)g(lar)n(ge)30
695 y(data)c(elements)f(ar)n(e)i(sent)e(as)h(soon)f(as)h(they)f(ar)n(e)
i(pr)n(ocessed)d(while)i(the)g(other)e(ar)n(guments)i(ar)n(e)30
808 y(being)22 b(marshalled.)30 1089 y Fh(1.1.3)99 b(Portability)30
1275 y Fr(At)26 b(A)-7 b(T&T)25 b(Laboratories,)h(the)f(ability)j(to)d
(tar)n(get)h(a)h(single)e(sour)n(ce)h(tr)n(ee)f(to)h(multiple)g
(platforms)30 1388 y(is)33 b(very)g(important.)59 b(This)33
b(is)g(dif)n(\002cult)h(to)f(achieve)h(if)g(the)e(IDL)h(to)g(C++)h
(mapping)f(for)g(these)30 1501 y(platforms)27 b(ar)n(e)h(dif)n(fer)n
(ent.)42 b(W)-8 b(e)27 b(avoid)h(this)f(pr)n(oblem)g(by)h(making)f(sur)
n(e)g(that)g(only)g(one)g(IDL)g(to)30 1614 y(C++)e(mapping)g(is)g
(used.)32 b(W)-8 b(e)24 b(r)o(un)h(several)g(\003avours)f(of)h(Unices,)
g(W)-5 b(indows)23 b(NT)-7 b(,)24 b(W)-5 b(indows)24
b(95)30 1727 y(and)29 b(our)g(in-house)f(developed)f(systems)g(for)i
(our)g(own)g(har)n(dwar)n(e.)48 b(OmniORB2)30 b(have)g(been)30
1840 y(ported)25 b(to)h(all)i(these)c(platforms.)40 b
Fl(The)26 b(IDL)h(to)f(C++)h(mapping)e(for)i(these)h(targets)g(are)g
(all)g(the)30 1952 y(same)p Fr(.)171 2070 y(OmniORB2)22
b(uses)d(r)n(eal)i(C++)g(exceptions)e(and)h(nested)e(classes.)27
b(W)-8 b(e)20 b(stay)f(with)i(the)e(CORBA)30 2183 y(speci\002cation's)
27 b(standar)n(d)f(mapping)h(as)f(much)i(as)e(possible)g(and)h(do)f
(not)g(use)g(the)g(alternative)30 2296 y(mappings)c(for)h(C++)g
(dialects.)28 b(The)22 b(only)g(exception)g(is)g(the)g(mapping)h(of)f
Fl(modules)p Fr(.)171 2413 y(Starting)27 b(with)g(2.6.0,)j(the)c(code)h
(generated)e(by)j(the)e(IDL)h(compiler)h(of)g(omniORB2)g(can)g(be)30
2526 y(compiled)d(using)f Fl(C++)h(classes)i Fr(or)e
Fl(namespaces)h Fr(to)e(r)n(epr)n(esent)f(IDL)i Fl(modules)f
Fr(depending)e(on)30 2639 y(the)g(availability)k(of)d(namespace)f
(support)f(in)i(the)f(compiler)-7 b(.)171 2756 y(OmniORB2)28
b(r)n(elies)e(on)f(the)g(native)i(thr)n(ead)e(libraries)j(to)d(pr)n
(ovide)h(the)f(multithr)n(eading)h(ca-)30 2869 y(pability)-10
b(.)45 b(A)27 b(small)j(class)e(library)h(\(omnithr)n(ead)f([Richar)n
(dson96a)r(]\))g(is)g(used)f(to)g(encapsulated)30 2982
y(the)f(\(possibly)g(dif)n(fer)n(ent\))g(APIs)g(of)g(the)g(native)h
(thr)n(ead)f(libraries.)41 b(In)26 b(the)g(application)h(code,)g(it)30
3095 y(is)f(r)n(ecommended)f(but)h(not)f(mandatory)h(to)f(use)g(this)h
(class)h(library)g(for)f(thr)n(ead)g(management.)30 3208
y(It)g(should)f(be)i(easy)e(to)h(port)g(omnithr)n(ead)g(to)g(any)g
(platform)h(that)f(either)g(supports)e(the)i(POSIX)30
3321 y(thr)n(ead)c(standar)n(d)g(or)g(has)h(a)g(thr)n(ead)f(package)h
(that)f(supports)e(similar)k(capabilities.)30 3602 y
Fh(1.1.4)99 b(Missing)25 b(features)30 3788 y Fr(OmniORB2)30
b(is)g(not)e(\(yet\))g(a)i(complete)e(implementation)h(of)g(the)f
(CORBA)h(2.3)h(cor)n(e.)47 b(The)28 b(fol-)30 3901 y(lowing)23
b(is)f(a)h(list)g(of)g(the)f(missing)g(featur)n(es.)166
4135 y Fo(\017)46 b Fr(The)31 b(BOA)g(only)f(support)f(the)h
(persistent)f(server)h(activation)j(policy)-10 b(.)53
b(Other)30 b(dynamic)257 4248 y(activation)24 b(and)f(deactivation)g
(policies)g(ar)n(e)g(not)f(supported.)166 4453 y Fo(\017)46
b Fr(OmniORB2)28 b(does)e(not)g(has)g(its)h(own)f(Interface)g
(Repository)-10 b(.)38 b(However)-7 b(,)26 b(it)h(can)g(act)h(as)f(a)
257 4566 y(client)c(to)f(an)h(IR.)166 4771 y Fo(\017)46
b Fr(The)22 b(POA)h(is)g(curr)n(ently)f(under)f(development.)166
4977 y Fo(\017)46 b Fr(The)23 b(IDL)h(types)e(wchar)-7
b(,)25 b(wstring,)e(\002xed,)g(valuetype)g(and)h(native)g(ar)n(e)g(not)
g(supported)d(in)257 5090 y(this)i(r)n(elease.)171 5324
y(These)86 b(featur)n(es)g(may)i(be)f(implemented)f(in)i(the)e(short)g
(to)h(medium)g(term.)30 5437 y(It)78 b(is)h(best)f(to)g(check)g(out)g
(the)g(latest)g(status)f(on)i(the)e(omniORB2)j(home)e(page)30
5550 y(\()p Fn(http://www.uk.r)o(ese)o(ar)o(ch)o(.a)o(tt)o(.co)o(m/)o
(om)o(ni)o(OR)o(B/o)o(mn)o(iO)o(RB)o(.h)o(tml)o Fr(\).)p
eop
%%Page: 3 9
3 8 bop 150 100 a Fd(1.2.)51 b(SETTING)21 b(UP)i(YOUR)f(ENVIRONMENT)
1629 b Fr(3)150 356 y Fi(1.2)119 b(Setting)30 b(Up)g(Y)-9
b(our)29 b(Environment)150 576 y Fr(At)23 b(A)-7 b(T&T)22
b(Laboratories)h(Cambridge,)g(you)g(should)f(use)g(the)g(OMNI)h
(Development)g(Envir)n(on-)150 689 y(ment)d(\(ODE\))i([Richar)n
(dson96b)r(])f(and)g(the)f(OMNI)h(tr)n(ee)f(version)g(5.0)i(or)e(above)
h(to)g(compile)g(your)150 802 y(pr)n(ograms.)42 b(If)27
b(this)g(is)h(the)e(case,)j(ther)n(e)d(is)i(no)f(extra)g(setup)e(you)i
(have)h(to)e(do)h(other)f(than)i(those)150 915 y(described)21
b(in)j(the)d(ODE)i(documentation.)291 1032 y(If)30 b(you)f(ar)n(e)h(r)o
(unning)g(omniORB2)g(at)g(other)e(sites,)j(you)d(\(or)i(your)f(system)f
(administrator\))150 1145 y(should)22 b(install)h(omniORB2)g(by)g
(following)g(the)f(instr)o(uctions)g(in)h(the)e(installation)j(notes.)
286 1379 y Fo(\017)46 b Fr(On)27 b(Unix)g(platforms,)g(the)f(omniORB2)h
(r)o(untime)f(looks)g(for)g(the)g(envir)n(onment)g(variable)377
1492 y Fn(OMNIORB)p 767 1492 28 4 v 30 w(CONFIG)p Fr(.)k(If)k(this)f
(variable)j(is)d(de\002ned,)h(it)g(contains)f(the)g(pathname)g(of)h
(the)377 1605 y(omniORB2)29 b(con\002guration)e(\002le.)44
b(If)28 b(the)g(variable)i(is)e(not)f(set,)h(omniORB2)h(will)g(use)e
(the)377 1718 y(compiled-in)d(pathname)e(to)g(locate)h(the)f(\002le.)
286 1923 y Fo(\017)46 b Fr(On)30 b(ARM/A)-7 b(TMos,)29
b(the)f(omniORB2)h(r)o(untime)g(looks)f(for)h(con\002guration)f
(information)377 2036 y(in)23 b(the)f(\002le)h Fn(omniORB.cfg)p
Fr(.)286 2242 y Fo(\017)46 b Fr(On)j(W)-5 b(in32)49 b(platforms)e(\(W)
-5 b(indows)47 b(NT)-7 b(,)47 b(W)-5 b(indows)47 b('95\),)55
b(omniORB2)49 b(\002rst)e(checks)377 2354 y(the)38 b(envir)n(onment)h
(variable)i(\()p Fn(OMNIORB)p 1883 2354 V 30 w(CONFIG)p
Fr(\))36 b(to)j(obtain)g(the)f(pathname)h(of)g(the)377
2467 y(con\002guration)47 b(\002le.)101 b(If)47 b(this)g(is)g(not)f
(set,)52 b(it)47 b(then)g(attempts)e(to)i(obtain)g(con\002gura-)377
2580 y(tion)k(data)f(in)h(the)f(system)f(r)n(egistry)-10
b(.)110 b(It)50 b(sear)n(ches)g(for)h(the)e(data)i(under)f(the)f(key)
377 2693 y Fn(HKEY)p 602 2693 V 31 w(LOCAL)p 908 2693
V 31 w(MACHINE)p Fo(n)p Fn(SOFTWARE)o Fo(n)p Fn(ORL)o
Fo(n)p Fn(omn)o(iOR)o(B)p Fo(n)p Fn(2.)o(0)291 2928 y
Fr(The)27 b(con\002guration)h(\002le)f(is)h(used)f(to)g(obtain)h(an)h
(object)e(r)n(efer)n(ence)h(for)f(the)g(COSS)i(Naming)150
3041 y(Service.)f(The)22 b(entry)f(in)i(the)f(con\002guration)g(\002le)
h(should)e(be)i(speci\002ed)e(in)i(the)f(following)h(form:)291
3158 y Fn(NAMESERVICE)50 b(<stringified)f(IOR)k(for)g(the)g(COSS)g
(Naming)f(Service>)291 3275 y Fr(Comments)22 b(in)h(the)f
(con\002guration)g(\002le)h(should)e(be)i(pr)n(e\002xed)e(with)i(a)g
(#.)291 3393 y(On)106 b(W)-5 b(in32)107 b(platforms,)126
b(the)105 b(stringi\002ed)f(IOR)h(can)i(be)e(placed)h(in)g(the)150
3506 y(system)c(r)n(egistry)-10 b(,)123 b(in)105 b(the)e(\(string\))h
(value)h Fn(NAMESERVICE)p Fr(,)99 b(under)k(the)g(key)150
3618 y Fn(HKEY)p 375 3618 V 31 w(LOCAL)p 681 3618 V 30
w(MACHINE)p Fo(n)p Fn(SOFTWARE)p Fo(n)p Fn(ORL)o Fo(n)p
Fn(omn)o(iO)o(RB)o Fo(n)p Fn(2.0)o Fr(.)291 3736 y(Since)23
b(2.6.0,)g(two)f(other)f(entries)h(ar)n(e)h(supported:)314
3975 y Fn(ORBInitialHost)48 b(<hostname)i(string>)314
4088 y(ORBInitialPort)e(<port)k(number)g(\(1-65535\)>)291
4322 y Fr(The)25 b(corr)n(esponding)f(entries)h(under)g(the)g(W)-5
b(in32)27 b(system)d(r)n(egistry)h(is)h(the)f(key)g(with)h(name)150
4435 y Fn(ORBInitialHost)16 b Fr(and)23 b Fn(ORBInitialPort)p
Fr(.)291 4553 y(The)31 b(two)g(entries)g(pr)n(ovide)g(information)i(to)
e(the)g(ORB)g(to)h(locate)g(a)g(bootstrap)e(service)i(at)150
4665 y(r)o(untime.)67 b(The)34 b(bootstrap)h(service)g(is)h(able)g(to)f
(r)n(eturn)g(the)g(initial)i(object)e(r)n(efer)n(ence)g(for)h(the)150
4778 y(COSS)31 b(Naming)g(Service)f(and)g(others.)50
b(This)30 b(is)g(now)g(the)g(r)n(ecommended)f(way)h(to)g(con\002gur)n
(e)150 4891 y(omniORB2.)e(Mor)n(e)23 b(details)f(ar)n(e)h(pr)n(ovided)f
(in)h(section)f(4.6.)150 5217 y Fi(1.3)119 b(Platform)29
b(speci\002c)h(variables)150 5437 y Fr(T)-8 b(o)23 b(compile)h
(omniORB2)h(pr)n(ograms)e(corr)n(ectly)-10 b(,)23 b(several)h(C++)h(pr)
n(epr)n(ocessor)c(de\002nes)h Fl(must)i Fr(be)150 5550
y(speci\002ed)d(to)h(identify)g(the)g(tar)n(get)g(platform.)p
eop
%%Page: 4 10
4 9 bop 30 100 a Fr(4)2062 b Fd(CHAPTER)22 b(1.)51 b(INTRODUCTION)p
30 368 3686 4 v 28 480 4 113 v 80 447 a Fr(Platform)p
996 480 V 615 w(CPP)23 b(de\002nes)p 3714 480 V 30 484
3686 4 v 28 597 4 113 v 80 563 a(Sun)f(Solaris)h(2.5)p
996 597 V 383 w Fn(__sparc__)105 b(__sunos__)g(__OSVERSION__=5)p
3714 597 V 30 600 3686 4 v 28 713 4 113 v 80 679 a Fr(Digital)24
b(Unix)f(3.2)p 996 713 V 336 w Fn(__alpha__)105 b(__osf1__)160
b(__OSVERSION__=3)p 3714 713 V 30 716 3686 4 v 28 829
4 113 v 80 795 a Fr(HPUX)21 b(10.x)p 996 829 V 523 w
Fn(__hppa__)106 b(__hpux__)160 b(__OSVERSION__=)o(10)p
3714 829 V 30 832 3686 4 v 28 945 4 113 v 80 912 a Fr(HPUX)21
b(1)-5 b(1.x)p 996 945 V 528 w Fn(__hppa__)106 b(__hpux__)160
b(__OSVERSION__=)o(11)p 3714 945 V 30 949 3686 4 v 28
1062 4 113 v 80 1028 a Fr(IBM)22 b(AIX)f(4.x)p 996 1062
V 473 w Fn(__aix__)106 b(__powerpc__)159 b(__OSVERSION__=4)p
3714 1062 V 30 1065 3686 4 v 28 1178 4 113 v 80 1144
a Fr(Linux)22 b(2.0)i(\(x86\))p 996 1178 V 374 w Fn(__x86__)215
b(__linux__)105 b(__OSVERSION__=2)p 3714 1178 V 30 1181
3686 4 v 28 1294 4 113 v 80 1260 a Fr(Linux)22 b(2.0)i(\(alpha\))p
996 1294 V 287 w Fn(__alpha__)214 b(__linux__)105 b(__OSVERSION__=2)p
3714 1294 V 30 1297 3686 4 v 28 1410 4 113 v 80 1376
a Fr(Linux)22 b(2.0)i(\(powerpc\))p 996 1410 V 155 w
Fn(__powerpc__)214 b(__linux__)105 b(__OSVERSION__=)o(2)p
3714 1410 V 30 1414 3686 4 v 28 1527 4 113 v 80 1493
a Fr(W)-5 b(indows/NT)21 b(3.5)p 996 1527 V 260 w Fn(__x86__)215
b(__NT__)270 b(__OSVERSION__=3)103 b(__WIN32__)p 3714
1527 V 30 1530 3686 4 v 28 1643 4 113 v 80 1609 a Fr(W)-5
b(indows/NT)21 b(4.0)p 996 1643 V 260 w Fn(__x86__)215
b(__NT__)270 b(__OSVERSION__=4)103 b(__WIN32__)p 3714
1643 V 30 1646 3686 4 v 28 1759 4 113 v 80 1725 a Fr(W)-5
b(indows/95)p 996 1759 V 436 w Fn(__x86__)52 b(__WIN32__)p
3714 1759 V 30 1762 3686 4 v 28 1875 4 113 v 80 1841
a Fr(OpenVMS)21 b(6.x)i(\(alpha\))p 996 1875 V 101 w
Fn(__alpha__)214 b(__vms)271 b(__OSVERSION__=6)p 3714
1875 V 30 1879 3686 4 v 28 1991 4 113 v 80 1958 a Fr(OpenVMS)21
b(6.x)i(\(vax\))p 996 1991 V 182 w Fn(__vax__)215 b(__vms)271
b(__OSVERSION__=)o(6)p 3714 1991 V 30 1995 3686 4 v 28
2108 4 113 v 80 2074 a Fr(SGI)22 b(Irix)h(6.x)p 996 2108
V 519 w Fn(__mips__)215 b(__irix__)269 b(__OSVERSION__=6)p
3714 2108 V 30 2111 3686 4 v 28 2224 4 113 v 80 2190
a Fr(Reliant)23 b(Unix)f(5.43)p 996 2224 V 282 w Fn(__mips__)215
b(__SINIX__)269 b(__OSVERSION__=)o(5)p 3714 2224 V 30
2227 3686 4 v 28 2340 4 113 v 80 2306 a Fr(A)-7 b(TMos)21
b(4.0)p 996 2340 V 538 w Fn(__arm__)215 b(__atmos__)105
b(__OSVERSION__=4)p 3714 2340 V 30 2343 3686 4 v 28 2456
4 113 v 80 2423 a Fr(NextStep)20 b(3.x)p 996 2456 V 458
w Fn(__m68k__)106 b(__nextstep__)158 b(__OSVERSION__=3)p
3714 2456 V 30 2460 3686 4 v 28 2573 4 113 v 80 2539
a Fr(Unixwar)n(e)23 b(7)p 996 2573 V 503 w Fn(__x86__)161
b(__uw7__)269 b(__OSVERSION__=5)p 3714 2573 V 30 2576
3686 4 v 171 2750 a Fr(The)24 b(pr)n(epr)n(ocessor)f(de\002nes)g(for)h
(new)g(platform)i(ports)d(not)h(listed)g(above)h(can)h(be)f(found)f(in)
30 2863 y(the)h(corr)n(esponding)f(platform)i(con\002guration)f
(\002les.)37 b(For)25 b(instance,)h(the)f(platform)h(con\002gura-)30
2976 y(tion)18 b(\002le)g(for)g(Sun)g(Solaris)h(2.6)g(is)f(in)h
Fn(mk/platforms/s)o(un4)p 2198 2976 28 4 v 26 w(sosV)p
2445 2976 V 31 w(5.6.mk)p Fr(.)k(The)18 b(pr)n(epr)n(ocess)30
3089 y(de\002nes)j(to)h(identify)g(a)h(platform)g(is)g(the)f(value)h
(of)g(the)e(make)i(variable)i Fn(IMPORT)p 2883 3089 V
30 w(CPPFLAGS)p Fr(.)171 3202 y(In)f(a)g(single)f(sour)n(ce)g
(multi-tar)n(get)h(envir)n(onment,)g(you)f(can)h(put)f(the)g(pr)n(epr)n
(ocessor)f(de\002nes)30 3315 y(as)k(the)f(command-line)i(ar)n(guments)e
(for)h(the)f(compiler)-7 b(.)38 b(Alternately)-10 b(,)25
b(you)g(could)h(cr)n(eate)g(a)g(sit-)30 3428 y(edef.h)i(\002le)h(in)h
(the)f(same)g(dir)n(ectory)f(as)i Fn(omniORB2/CORBA.)o(h)p
Fr(.)42 b(W)-7 b(rite)29 b(into)g(the)g(\002le)g(the)g(ap-)30
3540 y(pr)n(opriate)21 b(set)g(of)h(pr)n(epr)n(ocessor)e(de\002nes)g
(and)i(add)g Fn(#include)51 b(<omniORB2/sited)o(ef)o(.h)o(>)30
3653 y Fr(at)23 b(the)f(beginning)g(of)h Fn(omniORB2/CORBA)p
1583 3653 V 26 w(sysdep.h)p Fr(.)p eop
%%Page: 5 11
5 10 bop 150 983 a Fk(Chapter)44 b(2)150 1402 y Fm(The)52
b(Basics)150 1851 y Fr(In)29 b(this)g(chapter)-7 b(,)31
b(we)e(go)f(thr)n(ough)h(thr)n(ee)f(examples)h(to)g(illustrate)g(the)g
(practical)i(steps)c(to)i(use)150 1964 y(omniORB2.)f(By)21
b(going)g(thr)n(ough)g(the)g(sour)n(ce)h(code)f(of)h(each)g(example,)g
(the)f(essential)g(concepts)150 2077 y(and)g(APIs)e(ar)n(e)i(intr)n
(oduced.)26 b(If)21 b(you)f(have)h(no)g(pr)n(evious)f(experience)f
(with)h(using)h(CORBA,)f(you)150 2190 y(should)28 b(study)f(this)i
(chapter)g(in)g(detail.)47 b(Ther)n(e)28 b(ar)n(e)i(pointers)d(to)i
(other)e(essential)i(documents)150 2303 y(you)22 b(should)f(be)i
(familiar)i(with.)291 2420 y(If)32 b(you)f(have)h(experience)e(with)i
(using)f(other)g(ORBs,)i(you)e(should)f(still)j(go)e(thr)n(ough)f(this)
150 2533 y(chapter)f(because)g(it)h(pr)n(ovides)e(important)h
(information)h(about)f(the)g(featur)n(es)g(and)g(APIs)f(that)150
2646 y(ar)n(e)g(necessarily)f(omniORB2)h(speci\002c.)42
b(For)27 b(instance,)h(the)f(object)g(implementation)g(skeleton)150
2759 y(is)c(cover)n(ed)f(in)h(section)f(2.4.2.)150 3083
y Fi(2.1)119 b(The)29 b(Echo)i(Object)e(Example)150 3303
y Fr(Our)e(example)f(is)g(an)h(object)f(which)h(has)f(only)g(one)f
(method.)38 b(The)25 b(method)g(simply)i(echos)e(the)150
3416 y(ar)n(gument)d(string.)27 b(W)-8 b(e)22 b(have)h(to:)264
3649 y(1.)45 b(de\002ne)22 b(the)f(object)i(interface)g(in)g(IDL;)264
3854 y(2.)45 b(use)22 b(the)g(IDL)g(compiler)h(to)f(generate)f(the)h
(stub)g(code)2250 3821 y Fj(1)2286 3854 y Fr(;)264 4058
y(3.)45 b(pr)n(ovide)22 b(the)g(object)h(implementation;)264
4263 y(4.)45 b(write)22 b(the)g(client)h(code.)291 4497
y(The)43 b(sour)n(ce)g(code)f(of)i(this)f(example)g(is)h(included)f(in)
h(the)f(last)g(section)g(of)g(this)g(chap-)150 4609 y(ter)-7
b(.)87 b(A)42 b(make\002le)g(written)f(to)h(be)g(used)f(under)h(the)f
(OMNI)h(Development)g(Envir)n(onment)150 4722 y(\(ODE\))24
b([Richar)n(dson96b)q(])f(is)g(also)f(included.)150 5047
y Fi(2.2)119 b(Specifying)30 b(the)f(Echo)i(interface)d(in)i(IDL)150
5266 y Fr(W)-8 b(e)22 b(de\002ne)f(an)i(object)g(interface,)f(called)i
(Echo,)e(as)g(follows:)p 150 5370 1368 4 v 255 5427 a
Fg(1)284 5458 y Ff(The)e(stub)g(code)f(is)f(the)i(C++)g(code)f(that)i
(pr)o(ovides)c(the)k(object)f(mapping)f(as)h(de\002ned)f(in)g(the)h
(CORBA)f(2.0)h(speci-)150 5550 y(\002cation.)1837 5778
y Fr(5)p eop
%%Page: 6 12
6 11 bop 30 100 a Fr(6)2269 b Fd(CHAPTER)21 b(2.)52 b(THE)21
b(BASICS)30 456 y Fc(interface)48 b(Echo)h({)229 555
y(string)g(echoString\(in)e(string)i(mesg\);)30 655 y(};)171
1025 y Fr(If)26 b(you)f(ar)n(e)h(new)g(to)f(IDL,)g(you)g(can)i(learn)f
(about)g(its)g(syntax)f(in)h(Chapter)g(3)g(of)g(the)f(CORBA)30
1138 y(speci\002cation)e(2.0)g([OMG99a)s(].)171 1263
y(For)35 b(the)h(moment,)i(you)d(only)h(need)f(to)g(know)g(that)h(the)f
(interface)h(consists)f(of)h(a)h(single)30 1375 y(operation,)25
b(echoString,)f(which)i(takes)e(a)i(string)f(as)g(an)h(ar)n(gument)f
(and)g(r)n(eturns)f(a)i(copy)f(of)g(the)30 1488 y(same)e(string.)171
1613 y(The)j(interface)h(is)f(written)g(in)h(a)g(\002le,)g(called)g
Fn(echo.idl)p Fr(.)36 b(If)27 b(you)e(ar)n(e)i(using)f(ODE,)h(all)g
(IDL)30 1726 y(\002les)20 b(should)g(have)h(the)f(same)h(extension-)e
Fn(.idl)g Fr(and)i(should)f(be)h(placed)f(in)i(the)e
Fn(idl)f Fr(dir)n(ectory)30 1839 y(of)j(your)f(export)g(tr)n(ee.)27
b(This)22 b(is)g(done)f(so)g(that)h(the)g(stub)f(code)h(will)h(be)f
(generated)e(automatically)30 1952 y(and)j(kept)e(up-to-date)g(with)h
(your)g(IDL)g(\002le.)171 2076 y(For)j(simplicity)-10
b(,)26 b(the)f(interface)g(is)h(de\002ned)d(in)j(the)f(global)h(IDL)f
(namespace.)36 b(This)25 b(practice)30 2189 y(should)g(be)h(avoided)f
(for)h(the)f(sake)g(of)h(object)g(r)n(eusuability)-10
b(.)38 b(If)26 b(every)f(CORBA)g(developer)g(de-)30 2302
y(\002nes)i(their)g(interfaces)g(in)i(the)e(global)h(IDL)f(namespace,)i
(ther)n(e)e(is)h(a)g(danger)e(of)i(name)g(clashes)30
2415 y(between)d(two)g(independently)e(de\002ned)i(interfaces.)38
b(Ther)n(efor)n(e,)26 b(it)g(is)g(better)f(to)h(qualify)h(your)30
2528 y(interfaces)d(by)h(de\002ning)e(them)h(inside)h
Fn(module)d Fr(names.)33 b(Of)25 b(course,)f(this)g(does)f(not)h
(eliminate)30 2641 y(the)c(chance)h(of)g(a)g(name)g(clash)g(unless)f
(some)f(form)i(of)g(naming)g(convention)f(is)h(agr)n(eed)f(globally)-10
b(.)30 2754 y(Nevertheless,)20 b(a)j(well-chosen)f(module)g(name)h(can)
g(help)g(a)g(lot.)30 3124 y Fi(2.3)119 b(Generating)28
b(the)i(C++)h(stubs)30 3358 y Fr(Fr)n(om)23 b(the)g(IDL)g(\002le,)h(we)
f(use)f(the)h(IDL)g(compiler)h(to)f(pr)n(oduce)f(the)h(C++)h(mapping)g
(of)f(the)g(inter)n(-)30 3471 y(face.)28 b(The)22 b(IDL)g(compiler)h
(for)g(omniORB2)g(is)f(called)i Fn(omniidl2)p Fr(.)g(Given)f(the)f(IDL)
g(\002le,)g Fn(omni-)30 3584 y(idl2)i Fr(pr)n(oduces)h(two)g(stub)g
(\002les:)34 b(a)27 b(C++)f(header)f(\002le)h(and)g(a)h(C++)f(sour)n
(ce)g(\002le.)37 b(For)25 b(example,)30 3697 y(fr)n(om)e(the)f(\002le)h
Fn(echo.idl)p Fr(,)c(the)i(following)i(\002les)g(ar)n(e)g(pr)n(oduced:)
166 3967 y Fo(\017)46 b Fn(echo.hh)166 4202 y Fo(\017)g
Fn(echoSK.cc)171 4472 y Fr(If)20 b(you)e(ar)n(e)i(using)f(ODE,)g(you)g
(don't)g(need)f(to)g(invoke)h(omniidl2)i(explicitly)-10
b(.)27 b(In)20 b(the)e(example)30 4585 y(\002le)23 b
Fn(dir.mk)p Fr(,)c(we)k(have)g(the)e(following)i(line:)30
4954 y Fc(CORBA_INTERFACES)47 b(=)i(echo)171 5324 y Fr(That)28
b(is)f(all)i(we)f(need)e(to)h(instr)o(uct)g(ODE)h(to)f(generate)f(the)h
(stubs.)42 b(Remember)-7 b(,)28 b(you)f(won't)30 5437
y(\002nd)h(the)f(stubs)g(in)h(your)f(working)g(dir)n(ectory)g(because)h
(all)h(stubs)e(ar)n(e)i(written)e(into)h(the)f Fn(stub)30
5550 y Fr(dir)n(ectory)22 b(at)g(the)g(top)g(level)h(of)g(your)e(build)
j(tr)n(ee.)p eop
%%Page: 7 13
7 12 bop 150 100 a Fd(2.4.)51 b(A)23 b(QUICK)g(T)n(OUR)f(OF)h(THE)f
(C++)h(STUBS)1658 b Fr(7)150 356 y Fi(2.4)119 b(A)30
b(Quick)f(T)-13 b(our)30 b(of)g(the)f(C++)i(stubs)150
573 y Fr(The)20 b(C++)h(stubs)e(conform)i(to)f(the)f(mapping)i
(de\002ned)d(in)j(the)f(CORBA)g(2.0)i(speci\002cation)e(\(chap-)150
686 y(ter)32 b(16-18\).)59 b(It)32 b(is)h(important)f(to)g(understand)e
(the)i(mapping)g(befor)n(e)g(you)g(start)g(writing)g(any)150
799 y(serious)21 b(CORBA)i(applications.)291 915 y(Befor)n(e)f(going)f
(any)i(further)-7 b(,)22 b(it)h(is)f(worth)g(knowing)g(what)g(the)g
(mapping)h(looks)e(like.)150 1190 y Fh(2.4.1)99 b(Object)25
b(Reference)150 1374 y Fr(The)i(use)h(of)g(an)g(object)g(interface)g
(denotes)e(an)j(object)f(r)n(efer)n(ence.)43 b(For)28
b(the)f(example)h(interface)150 1487 y(Echo,)j(the)e(C++)h(mapping)g
(for)f(its)h(object)f(r)n(efer)n(ence)g(is)h Fn(Echo)p
2408 1487 28 4 v 31 w(ptr)p Fr(.)48 b(The)29 b(type)f(is)i(de\002ned)e
(in)150 1599 y(echo.hh.)f(The)22 b(r)n(elevant)h(section)f(of)g(the)g
(code)g(is)h(r)n(epr)n(oduced)d(below:)150 1918 y Fc(class)49
b(Echo;)150 2017 y(typedef)g(Echo*)f(Echo_ptr;)150 2217
y(class)h(Echo)g(:)h(public)e(virtual)h(omniObject,)f(public)g(vir-)150
2316 y(tual)h(CORBA::Object)e({)150 2416 y(public:)250
2615 y(virtual)h(char)h(*)100 b(echoString)48 b(\()h(const)g(char)g(*)
100 b(mesg)49 b(\))g(=)h(0;)250 2715 y(static)e(Echo_ptr)h(_nil\(\);)
250 2814 y(static)f(Echo_ptr)h(_duplicate\(Echo_ptr\);)250
2914 y(static)f(Echo_ptr)h(_narrow\(CORBA::Object_ptr\);)250
3113 y(...)g(//)g(methods)g(generated)f(for)h(internal)g(use)150
3213 y(};)291 3541 y Fr(In)33 b(a)h(compliant)h(application,)i(the)c
(operations)e(de\002ned)h(in)i(an)g(object)f(interface)h(should)150
3654 y Fl(only)e Fr(be)g(invoked)g(via)i(an)f(object)f(r)n(efer)n
(ence.)57 b(This)32 b(is)h(done)e(by)i(using)f(arr)n(ow)g(\(\223)p
Fo(!)p Fr(\224\))i(on)f(an)150 3767 y(object)19 b(r)n(efer)n(ence.)26
b(For)19 b(example,)h(the)f(call)i(to)e(the)f(operation)h
Fn(echoString)c Fr(would)k(be)g(written)150 3880 y(as)k
Fn(obj)p Fo(!)p Fn(echoString\()o(me)o(sg)o(\))p Fr(.)291
3996 y(It)h(should)g(be)h(noted)e(that)h(the)g(concr)n(ete)g(type)f(of)
i(an)g(object)g(r)n(efer)n(ence)f(is)h(opaque,)f(i.e.)34
b(you)150 4109 y(must)f(not)f(make)i(any)f(assumption)g(about)g(how)g
(an)h(object)f(r)n(efer)n(ence)g(is)g(implemented.)59
b(In)150 4222 y(our)21 b(example,)g(even)h(though)e Fn(Echo)p
1448 4222 V 31 w(ptr)g Fr(is)i(implemented)e(as)i(a)g(pointer)e(to)h
(the)g(class)h Fn(Echo)p Fr(,)e(it)150 4335 y(should)26
b(not)h(be)g(used)f(as)i(a)f(C++)i(pointer)-7 b(,)27
b(i.e.)42 b(conversion)26 b(to)h(void*,)i(arithmetic)f(operations,)150
4448 y(and)f(r)n(elational)i(operations,)e(including)h(test)e(for)h
(equality)g(using)g Fl(operation==)h Fr(must)f(not)f(be)150
4561 y(performed)21 b(on)h(the)g(type.)291 4677 y(In)28
b(addition)f(to)h Fn(echoString)p Fr(,)c(the)j(mapping)h(also)g
(de\002nes)e(thr)n(ee)h(static)i(member)e(func-)150 4790
y(tions)e(in)h(the)f(class)h(Echo:)p 1106 4790 V 67 w
Fn(nil)p Fr(,)p 1352 4790 V 57 w Fn(duplicate)p Fr(,)d(and)p
2105 4790 V 58 w Fn(narrow)p Fr(.)35 b(Note)24 b(that)h(these)f(ar)n(e)
j(opera-)150 4903 y(tions)22 b(on)g(an)h(object)g(r)n(efer)n(ence.)291
5019 y(The)p 466 5019 V 49 w Fn(nil)17 b Fr(function)g(r)n(eturns)f(a)i
(nil)g(object)f(r)n(efer)n(ence)g(of)h(the)e(Echo)h(interface.)26
b(The)17 b(following)150 5132 y(call)24 b(is)f(guaranteed)e(to)h(r)n
(eturn)g(TRUE:)150 5450 y Fc(CORBA::Boolean)47 b(true_result)h(=)i
(CORBA::is_nil\(Echo::_nil\(\)\);)p eop
%%Page: 8 14
8 13 bop 30 100 a Fr(8)2269 b Fd(CHAPTER)21 b(2.)52 b(THE)21
b(BASICS)171 356 y Fr(Remember)-7 b(,)37 b Fn(CORBA::is)p
1163 356 28 4 v 28 w(nil\(\))c Fr(is)h(the)g(only)g(compliant)h(way)g
(to)f(check)g(if)h(an)g(object)30 469 y(r)n(efer)n(ence)22
b(is)h(nil.)28 b(Y)-8 b(ou)22 b(should)g(not)f(use)h(the)g(equality)g
(operator==.)171 582 y(The)p 364 582 V 67 w Fn(duplicate)30
b Fr(function)35 b(r)n(eturns)f(a)h(new)f(object)g(r)n(efer)n(ence)g
(of)h(the)f(Echo)g(interface.)30 695 y(The)22 b(new)h(object)g(r)n
(efer)n(ence)f(can)i(be)f(used)f(inter)n(changeably)h(with)g(the)g(old)
f(object)h(r)n(efer)n(ence)g(to)30 808 y(perform)f(an)h(operation)f(on)
g(the)g(same)g(object.)171 920 y(All)90 b(CORBA)e(objects)g(inherit)h
(fr)n(om)g(the)f(generic)h(object)f Fn(CORBA::Object)p
Fr(.)30 1033 y Fn(CORBA::Object)p 750 1033 V 27 w(ptr)49
b Fr(is)i(the)e(object)i(r)n(efer)n(ence)e(for)i Fn(CORBA::Object)p
Fr(.)105 b(Any)50 b(object)30 1146 y(r)n(efer)n(ence)36
b(is)h(ther)n(efor)n(e)e(conceptually)i(inherited)e(fr)n(om)j
Fn(CORBA::Object)p 2840 1146 V 26 w(ptr)p Fr(.)69 b(In)36
b(other)30 1259 y(wor)n(ds,)60 b(an)55 b(object)e(r)n(efer)n(ence)h
(such)f(as)h Fn(Echo)p 1833 1259 V 31 w(ptr)f Fr(can)i(be)f(used)e(in)i
(places)g(wher)n(e)g(a)30 1372 y Fn(CORBA::Object)p 750
1372 V 27 w(ptr)21 b Fr(is)i(expected.)171 1485 y(The)p
358 1485 V 61 w Fn(narrow)j Fr(function)j(takes)e(an)j(ar)n(gument)e
(of)h(the)f(type)f Fn(CORBA::Object)p 3082 1485 V 27
w(ptr)g Fr(and)30 1598 y(r)n(eturns)21 b(a)i(new)e(object)h(r)n(efer)n
(ence)g(of)g(the)f(Echo)h(interface.)28 b(If)22 b(the)f(actual)j(\(r)o
(untime\))e(type)f(of)h(the)30 1711 y(ar)n(gument)j(object)g(r)n(efer)n
(ence)g(can)i(be)e(widened)f(to)h Fn(Echo)p 2092 1711
V 31 w(ptr)p Fr(,)p 2336 1711 V 57 w Fn(narrow)e Fr(will)k(r)n(eturn)e
(a)h(valid)30 1824 y(object)c(r)n(efer)n(ence.)28 b(Otherwise)21
b(it)i(will)h(r)n(eturn)e(a)h(nil)g(object)g(r)n(efer)n(ence.)171
1937 y(T)-8 b(o)32 b(indicate)i(that)f(an)g(object)g(r)n(efer)n(ence)f
(will)j(no)d(longer)h(be)g(accessed,)h(you)e(can)i(call)h(the)30
2050 y Fn(CORBA::release)16 b Fr(operation.)27 b(Its)22
b(signatur)n(e)g(is)g(as)h(follows:)30 2345 y Fc(class)49
b(CORBA)g({)179 2445 y(static)g(void)g(release\(CORBA::Object_ptr)c
(obj\);)179 2544 y(...)50 b(//)f(other)g(methods)30 2644
y(};)171 2853 y Fr(Y)-8 b(ou)28 b(should)f(not)h(use)g(an)h(object)g(r)
n(efer)n(ence)f(once)g(you)g(have)h(called)h Fn(CORBA::release)o
Fr(.)30 2966 y(This)e(is)h(because)f(the)g(associated)g(r)n(esour)n
(ces)f(may)i(have)g(been)f(deallocated.)45 b(Notice)28
b(that)h(we)30 3079 y(ar)n(e)f(r)n(eferring)f(to)g(the)g(r)n(esour)n
(ces)g(associated)g(with)g(the)g(object)h(r)n(efer)n(ence)f(and)g
Fl(not)g(the)i(object)30 3192 y(implementation)p Fr(.)50
b(Her)n(e)29 b(is)h(a)g(concr)n(ete)f(example,)i(if)g(the)e
(implementation)g(of)h(an)g(object)g(r)n(e-)30 3305 y(sides)d(in)i(a)g
(dif)n(fer)n(ent)f(addr)n(ess)f(space,)i(then)f(a)h(call)h(to)e
Fn(CORBA::release)22 b Fr(will)30 b(only)e(caused)30
3418 y(the)h(r)n(esour)n(ces)f(associated)h(with)h(the)f(object)g(r)n
(efer)n(ence)g(in)h(the)f(curr)n(ent)h(addr)n(ess)e(space)h(to)g(be)30
3531 y(deallocated.)f(The)21 b(object)i(implementation)f(in)i(the)d
(other)h(addr)n(ess)f(space)h(is)h(unaf)n(fected.)171
3644 y(As)35 b(described)g(above,)40 b(the)35 b(equality)h(operator==)e
(should)h(not)h(be)g(used)e(on)i(object)g(r)n(ef-)30
3757 y(er)n(ences.)114 b(T)-8 b(o)51 b(test)g(if)h(two)f(object)h(r)n
(efer)n(ences)f(ar)n(e)h(equivalent,)59 b(the)51 b(member)h(function)p
30 3869 V 57 3869 a Fn(is)p 172 3869 V 32 w(equivalent)22
b Fr(of)27 b(the)f(generic)g(object)g Fn(CORBA::Object)21
b Fr(can)27 b(be)g(used.)38 b(Her)n(e)26 b(is)g(an)h(ex-)30
3982 y(ample)c(of)g(its)f(usage:)30 4278 y Fc(Echo_ptr)48
b(A;)30 4378 y(...)597 b(//)50 b(initialised)d(A)j(to)f(a)h(valid)f
(object)g(reference)30 4477 y(Echo_ptr)f(B)i(=)g(A;)30
4577 y(CORBA::Boolean)d(true_result)h(=)i(A->_is_equivalent\(B\);)30
4676 y(//)f(Note:)g(the)h(above)e(call)i(is)f(guaranteed)f(to)h(be)h
(TRUE)171 4985 y Fr(Y)-8 b(ou)36 b(have)i(now)f(been)g(intr)n(oduced)f
(to)h(most)f(of)i(the)e(operations)g(that)h(can)i(be)e(invoked)30
5098 y(via)29 b Fn(Echo)p 406 5098 V 30 w(ptr)p Fr(.)41
b(The)26 b(generic)g(object)h Fn(CORBA::Object)22 b Fr(pr)n(ovides)k(a)
i(few)f(mor)n(e)g(operations)30 5211 y(and)33 b(all)i(of)e(them)g(can)h
(be)f(invoked)f(via)j Fn(Echo)p 1746 5211 V 31 w(ptr)p
Fr(.)58 b(These)32 b(operations)f(deal)j(mainly)g(with)30
5324 y(CORBA)-7 b('s)21 b(dynamic)h(interfaces.)27 b(Y)-8
b(ou)19 b(do)h(not)h(have)g(to)f(understand)f(them)h(in)i(or)n(der)e
(to)g(use)g(the)30 5437 y(C++)28 b(mapping)g(pr)n(ovided)e(via)j(the)d
(stubs.)42 b(For)26 b(details,)i(please)f(r)n(ead)g(the)g(CORBA)g
(speci\002ca-)30 5550 y(tion)22 b([OMG99a)s(])h(chapter)f(17.)p
eop
%%Page: 9 15
9 14 bop 150 100 a Fd(2.4.)51 b(A)23 b(QUICK)g(T)n(OUR)f(OF)h(THE)f
(C++)h(STUBS)1658 b Fr(9)291 356 y(Since)20 b(object)g(r)n(efer)n
(ences)f(must)h(be)g(r)n(eleased)f(explicitly)-10 b(,)20
b(their)g(usage)f(is)h(pr)n(one)f(to)h(err)n(or)f(and)150
469 y(can)k(lead)g(to)f(memory)g(leakage.)27 b(The)22
b(mapping)h(de\002nes)d(the)i Fl(object)h(reference)j(variable)e
Fr(type)150 582 y(to)e(make)h(life)g(easier)-7 b(.)28
b(In)22 b(our)g(example,)g(the)g(variable)j(type)c Fn(Echo)p
2500 582 28 4 v 31 w(var)g Fr(is)i(de\002ned)3108 549
y Fj(2)3143 582 y Fr(.)291 695 y(The)k Fn(Echo)p 696
695 V 31 w(var)f Fr(is)i(mor)n(e)f(convenient)g(to)g(use)f(because)i
(it)f(will)i(automatically)g(r)n(elease)e(its)150 808
y(object)g(r)n(efer)n(ence)g(when)f(it)i(is)f(deallocated)g(or)g(when)g
(assigned)f(a)i(new)f(object)g(r)n(efer)n(ence.)41 b(For)150
920 y(many)30 b(operations,)f(mixing)i(data)f(of)f(type)f
Fn(Echo)p 1951 920 V 31 w(var)h Fr(and)g Fn(Echo)p 2579
920 V 31 w(ptr)g Fr(is)g(possible)g(without)150 1033
y(any)24 b(explicit)h(operations)e(or)h(castings)1550
1000 y Fj(3)1587 1033 y Fr(.)33 b(For)23 b(instance,)i(the)e(operation)
g Fn(echoString)d Fr(can)25 b(be)150 1146 y(called)f(using)e(the)f(arr)
n(ow)i(\(\223)p Fo(!)p Fr(\224\))h(on)f(a)g Fn(Echo)p
1753 1146 V 31 w(var)p Fr(,)e(as)h(one)g(can)i(do)e(with)g(a)h
Fn(Echo)p 3053 1146 V 31 w(ptr)p Fr(.)291 1259 y(The)f(usage)g(of)g
Fn(Echo)p 1049 1259 V 31 w(var)g Fr(is)g(illustrated)g(below:)150
1551 y Fc(Echo_var)48 b(a;)150 1651 y(Echo_ptr)g(p)i(=)g(...)248
b(//)50 b(somehow)e(obtain)h(an)g(object)g(reference)150
1850 y(a)h(=)f(p;)747 b(//)50 b(a)f(assumes)g(ownership)f(of)h(p,)h
(must)f(not)g(use)g(p)h(anymore)150 2049 y(Echo_var)e(b)i(=)g(a;)298
b(//)50 b(implicit)e(_duplicate)150 2249 y(p)i(=)f(...)697
b(//)50 b(somehow)e(obtain)h(another)f(object)h(reference)150
2448 y(a)h(=)f(Echo::_duplicate\(p\);)246 b(//)49 b(release)g(old)g
(object)f(reference)1595 2547 y(//)h(a)h(now)f(holds)g(a)g(copy)g(of)h
(p.)150 2801 y Fh(2.4.2)99 b(Object)25 b(Implementation)150
2978 y Fr(Unlike)i(the)f(client)i(side)f(of)g(an)g(object,)h(i.e.)42
b(the)26 b(use)h(of)g(object)g(r)n(efer)n(ences,)g(the)f(CORBA)i(spec-)
150 3091 y(i\002cation)e(2.0)g(deliberately)f(leave)h(many)f(of)h(the)e
(necessary)g(functionalities)i(to)f(implement)g(an)150
3204 y(object)i(unspeci\002ed.)38 b(As)27 b(a)g(consequence,)f(it)h(is)
g(very)f(unlikely)g(the)g(implementation)h(code)f(of)150
3317 y(an)21 b(object)f(on)g(top)f(of)i(two)e(dif)n(fer)n(ent)h(ORBs)g
(can)h(be)g(identical.)27 b(However)-7 b(,)20 b(most)f(of)i(the)e(code)
h(ar)n(e)150 3430 y(expected)26 b(to)i(be)g(portable.)44
b(In)28 b(particular)-7 b(,)30 b(the)e(body)f(of)h(an)h(operation)e
(implementation)h(can)150 3543 y(normally)23 b(be)g(ported)e(with)h(no)
g(or)h(little)g(modi\002cation.)291 3655 y(OmniORB2)34
b(uses)d(C++)i(inheritance)g(to)e(pr)n(ovide)h(the)g(skeleton)e(code)i
(for)g(object)g(imple-)150 3768 y(mentation.)52 b(For)30
b(each)h(object)g(interface,)i(a)e(skeleton)e(class)i(is)g(generated.)
51 b(In)30 b(our)g(example,)150 3881 y(the)23 b(skeleton)f(class)p
878 3881 V 58 w Fn(sk)p 1021 3881 V 32 w(Echo)g Fr(is)i(generated)e
(for)i(the)f(Echo)h(IDL)g(interface.)33 b(An)23 b(object)h(imple-)150
3994 y(mentation)29 b(can)i(be)e(written)g(by)g(cr)n(eating)h(an)g
(implementation)g(class)g(that)f(derives)g(fr)n(om)h(the)150
4107 y(skeleton)21 b(class.)291 4220 y(The)30 b(skeleton)e(class)p
1065 4220 V 64 w Fn(sk)p 1207 4220 V 32 w(Echo)h Fr(is)h(de\002ned)f
(in)i Fn(echo.hh)p Fr(.)48 b(The)30 b(r)n(elevant)h(section)e(of)i(the)
150 4333 y(code)22 b(is)h(r)n(epr)n(oduced)d(below)-8
b(.)150 4625 y Fc(class)49 b(_sk_Echo)f(:)100 b(public)48
b(virtual)h(Echo)g({)150 4725 y(public:)250 4824 y(_sk_Echo\(const)e
(omniORB::objectKey&)f(k\);)250 4924 y(virtual)i(char)h(*)100
b(echoString)48 b(\()h(const)g(char)g(*)100 b(mesg)49
b(\))g(=)h(0;)250 5023 y(Echo_ptr)397 b(_this\(\);)p
150 5095 1368 4 v 255 5151 a Fg(2)284 5183 y Ff(In)52
b(omniORB2,)59 b(all)51 b(object)h(r)o(efer)o(ence)d(variable)i(types)f
(ar)o(e)h(instantiated)h(fr)o(om)e(the)i(template)f(type)p
150 5274 23 4 v 172 5274 a(CORBA)p 442 5274 V 27 w(ObjRef)p
697 5274 V 27 w(V)-7 b(ar)h(.)255 5335 y Fg(3)284 5367
y Ff(However)g(,)33 b(the)d(implementation)g(of)f(the)h(type)f
(conversion)h(operator\(\))e(between)i(Echo)p 2963 5367
V 27 w(var)g(and)g(Echo)p 3448 5367 V 27 w(ptr)150 5458
y(varies)15 b(slightly)f(among)i(dif)o(fer)o(ent)e(C++)i(compilers,)f
(you)g(may)g(need)g(to)h(do)f(an)i(explicit)d(casting)i(when)h(the)f
(compiler)150 5550 y(complains)j(about)g(the)g(conversion)g(being)f
(ambiguous.)p eop
%%Page: 10 16
10 15 bop 30 100 a Fr(10)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fc(void)597 b(_obj_is_ready\(BOA_ptr\);)130
456 y(void)g(_dispose\(\);)130 555 y(BOA_ptr)447 b(_boa\(\);)130
655 y(omniORB::objectKey)46 b(_key\(\);)130 754 y(...)j(//)g(methods)g
(generated)f(for)h(internal)g(use)30 854 y(};)171 1187
y Fr(The)26 b(code)h(fragment)f(shows)g(the)g(only)h(member)g
(functions)g(that)g(can)g(be)g(used)f(in)i(the)e(ob-)30
1300 y(ject)18 b(implementation)g(code.)25 b(Other)18
b(member)f(functions)h(ar)n(e)g(generated)e(for)i(internal)g(use)f
(only)-10 b(.)30 1413 y Fl(Unless)25 b(speci\002ed)g(otherwise,)g(the)g
(description)g(below)f(is)g(omniORB2)f(speci\002c.)34
b Fr(The)23 b(func-)30 1525 y(tions)f(ar)n(e:)30 1759
y Fl(echoString)45 b Fr(it)24 b(is)g(thr)n(ough)e(this)i(abstract)g
(function)g(that)f(an)h(implementation)g(class)g(pr)n(ovides)257
1871 y(the)k(implementation)h(of)f(the)g Fn(echoString)c
Fr(operation.)45 b(Notice)27 b(that)i(its)f(signatur)n(e)g(is)257
1984 y(the)j(same)h(as)g(the)f Fn(echoString)c Fr(function)32
b(that)f(can)i(be)f(invoked)e(via)k(the)c Fn(Echo)p 3260
1984 28 4 v 31 w(ptr)257 2097 y Fr(object)k(r)n(efer)n(ence.)63
b Fl(The)34 b(signature)h(of)f(this)h(function)f(is)h(speci\002ed)g(by)
f(the)h(CORBA)257 2210 y(speci\002cation)p Fr(.)p 35
2414 V 63 2414 a Fl(this)46 b Fr(this)20 b(function)h(r)n(eturns)e(an)i
(object)f(r)n(efer)n(ence)g(for)h(the)f(tar)n(get)g(object.)27
b(The)19 b(r)n(eturned)g(value)257 2527 y(must)25 b(be)g(deallocated)g
(via)i Fn(CORBA::release)o Fr(.)j(See)24 b(2.7)i(for)g(an)f(example)g
(of)h(how)e(this)257 2640 y(function)f(is)g(used.)p 35
2844 V 63 2844 a Fl(obj)p 205 2844 V 32 w(is)p 307 2844
V 33 w(ready)46 b Fr(this)34 b(function)g(tells)g(the)g(Basic)h(Object)
f(Adaptor)2400 2811 y Fj(4)2471 2844 y Fr(\(BOA\))g(that)g(the)g
(object)g(is)257 2957 y(r)n(eady)c(to)f(serve.)49 b(Until)30
b(this)g(function)g(is)g(called,)i(the)d(BOA)h(would)f(not)g(serve)g
(any)h(in-)257 3070 y(coming)23 b(calls)h(to)e(this)g(object.)28
b(See)22 b(2.7)h(for)g(an)g(example)f(of)h(how)f(this)g(function)h(is)g
(used.)p 35 3274 V 63 3274 a Fl(dispose)45 b Fr(this)23
b(function)f(tells)h(the)f(BOA)g(to)g(dispose)f(of)h(the)g(object.)28
b(The)22 b(BOA)g(will)i(stop)d(serv-)257 3387 y(ing)32
b(incoming)h(calls)g(of)f(this)f(object)h(and)g(r)n(emove)g(any)g(r)n
(esour)n(ces)e(associated)h(with)h(it.)257 3500 y(See)22
b(2.7)h(for)g(an)g(example)f(of)h(how)f(this)g(function)h(is)g(used.)p
35 3704 V 63 3704 a Fl(boa)45 b Fr(this)22 b(function)h(r)n(eturns)e(a)
i(r)n(efer)n(ence)f(to)g(the)g(BOA)h(that)f(serves)f(this)h(object.)p
35 3908 V 63 3908 a Fl(key)45 b Fr(this)37 b(function)h(r)n(eturns)f
(the)g(key)g(that)g(the)g(ORB)h(used)e(to)i(identify)f(this)g(object.)
74 b(The)257 4021 y(type)27 b Fn(omniORB::object)o(Ke)o(y)22
b Fr(is)29 b(opaque)e(to)h(application)h(code.)44 b(The)28
b(function)g Fn(om-)257 4134 y(niORB::keyToOct)o(etS)o(eq)o(ue)o(nc)o
(e)20 b Fr(can)26 b(be)g(used)e(to)h(convert)g(the)g(key)g(to)g(a)h
(sequence)257 4246 y(of)d(octets.)30 4570 y Fi(2.5)119
b(W)-9 b(riting)29 b(the)h(object)f(implementation)30
4790 y Fr(Y)-8 b(ou)30 b(de\002ne)g(an)i(implementation)f(class)h(to)e
(pr)n(ovide)h(the)g(object)g(implementation.)54 b(Ther)n(e)30
b(is)30 4902 y(little)23 b(constraint)e(on)h(how)g(you)f(design)g(your)
g(implementation)h(class)h(except)e(that)h(it)h(has)f(to)f(in-)30
5015 y(herit)e(fr)n(om)i(the)d(stubs')h(skeleton)f(class)i(and)g(to)f
(implement)g(all)j(the)c(abstract)j(functions)e(de\002ned)30
5128 y(in)27 b(the)e(skeleton)f(class.)40 b(Each)26 b(of)h(these)d
(abstract)j(functions)f(corr)n(esponds)e(to)h(an)i(operation)e(of)30
5241 y(the)c(interface.)28 b(They)21 b(ar)n(e)i(hooks)d(for)i(the)g
(ORB)g(to)f(perform)h(upcalls)h(to)e(your)g(implementation.)171
5358 y(Her)n(e)h(is)h(a)g(simple)f(implementation)h(of)g(the)e(Echo)i
(object.)p 30 5462 1368 4 v 135 5518 a Fg(4)164 5550
y Ff(The)c(interface)g(of)f(a)h(BOA)g(is)f(described)f(in)i(chapter)g
(8)g(of)f(the)i(CORBA)e(speci\002cation.)p eop
%%Page: 11 17
11 16 bop 150 100 a Fd(2.6.)51 b(WRITING)22 b(THE)f(CLIENT)2162
b Fr(1)-5 b(1)150 356 y Fc(class)49 b(Echo_i)g(:)g(public)g(virtual)f
(_sk_Echo)h({)150 456 y(public:)250 555 y(Echo_i\(\))f({})250
655 y(virtual)g(\230Echo_i\(\))g({})250 754 y(virtual)g(char)h(*)h
(echoString\(const)d(char)i(*mesg\);)150 854 y(};)150
1053 y(char)g(*)150 1153 y(Echo_i::echoString\(const)c(char)k(*mesg\))g
({)250 1253 y(char)g(*p)g(=)h(CORBA::string_dup\(mesg\);)250
1352 y(return)e(p;)150 1452 y(})291 1666 y Fr(Ther)n(e)22
b(ar)n(e)h(thr)n(ee)e(points)h(to)g(note)f(her)n(e:)150
1855 y Fl(Storage)i(Responsibilities)47 b Fr(A)28 b(string,)h(which)g
(is)g(used)e(as)i(an)g(IN)f(ar)n(gument)g(and)h(the)f(r)n(eturn)377
1968 y(value)g(of)f Fn(echoString)p Fr(,)c(is)k(a)g(variable)i(size)e
(data)g(type.)39 b(Other)27 b(examples)f(of)h(variable)377
2081 y(size)33 b(data)g(types)d(include)j(sequences,)f(type)f
(\223any\224,)36 b(etc.)57 b(For)32 b(these)f(data)h(types,)h(you)377
2194 y(must)24 b(be)g(clear)h(about)f(who's)f(r)n(esponsibility)h(to)f
(allocate)i(and)g(r)n(elease)e(their)h(associated)377
2307 y(storage.)k(As)22 b(a)i(r)o(ule)f(of)g(thumb,)g(the)f(client)h
(\(or)g(the)g(caller)h(to)e(the)g(implementation)h(func-)377
2419 y(tions\))29 b(owns)e(the)h(storage)f(of)i(all)h(IN)e(ar)n
(guments,)h(the)f(object)h(implementation)f(\(or)h(the)377
2532 y(callee\))e(must)e(copy)g(the)g(data)h(if)g(it)g(wants)f(to)g(r)n
(etain)h(a)h(copy)-10 b(.)36 b(For)25 b(OUT)g(ar)n(guments)g(and)377
2645 y(r)n(eturn)34 b(values,)k(the)c(object)h(implementation)f
(allocates)i(the)e(storage)f(and)i(passes)e(the)377 2758
y(ownership)25 b(to)h(the)f(client.)40 b(The)26 b(client)g(must)g(r)n
(elease)g(the)g(storage)e(when)i(the)g(variables)377
2871 y(will)33 b(no)e(longer)g(be)h(used.)53 b(For)31
b(details,)i(please)e(r)n(efer)g(to)g(T)-8 b(able)32
b(24-27)i(of)d(the)g(CORBA)377 2984 y(speci\002cation.)150
3173 y Fl(Multi-threading)46 b Fr(As)18 b(omniORB2)h(is)f(fully)h
(multithr)n(eaded,)f(multiple)h(thr)n(eads)e(may)i(perform)377
3286 y(the)f(same)g(upcall)i(to)e(your)g(implementation)g(concurr)n
(ently)-10 b(.)26 b(It)18 b(is)g(up)g(to)g(your)g(implemen-)377
3399 y(tation)26 b(to)g(synchr)n(onise)f(the)h(thr)n(eads')f(accesses)h
(to)f(shar)n(ed)h(data.)39 b(In)26 b(our)g(simple)h(exam-)377
3512 y(ple,)20 b(we)g(have)g(no)g(shar)n(ed)f(data)i(to)e(pr)n(otect)g
(so)g(no)h(thr)n(ead)g(synchr)n(onisation)f(is)h(necessary)-10
b(.)150 3701 y Fl(Instantiation)47 b Fr(Y)-8 b(ou)20
b(must)h(not)g(instantiate)g(an)h(implementation)f(as)h(automatic)g
(variables.)29 b(In-)377 3814 y(stead,)19 b(you)g(should)g(always)h
(instantiate)f(an)i(implementation)e(using)h(the)e(new)i(operator)-7
b(,)377 3926 y(i.e.)45 b(its)29 b(storage)d(is)j(allocated)g(on)f(the)g
(heap.)45 b(The)28 b(r)n(eason)g(behind)g(this)g(r)n(estriction)g(will)
377 4039 y(become)23 b(clear)g(in)g(section)f(2.7.)150
4340 y Fi(2.6)119 b(W)-9 b(riting)29 b(the)h(client)150
4552 y Fr(Her)n(e)22 b(is)g(an)i(example)e(of)h(how)f(a)h
Fn(Echo)p 1539 4552 28 4 v 31 w(ptr)e Fr(object)i(r)n(efer)n(ence)f(is)
g(used.)150 4753 y Fc(void)150 4852 y(hello\(CORBA::Object_ptr)46
b(obj\))150 4952 y({)250 5052 y(Echo_var)i(e)i(=)f
(Echo::_narrow\(obj\);)794 b(//)49 b(line)g(1)250 5251
y(if)g(\(CORBA::is_nil\(e\)\))e({)1245 b(//)49 b(line)g(2)349
5351 y(cerr)g(<<)h("hello:)e(cannot)h(invoke)g(on)g(a)h(nil)f(object)g
(refer-)150 5450 y(ence.\\n")f(<<)i(endl;)349 5550 y(return;)p
eop
%%Page: 12 18
12 17 bop 30 100 a Fr(12)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fc(})130 555 y(CORBA::String_var)46
b(src)k(=)f(\(const)g(char*\))g("Hello!";)97 b(//)50
b(line)f(3)130 655 y(CORBA::String_var)d(dest;)1294 b(//)50
b(line)f(4)130 854 y(dest)g(=)g(e->echoString\(src\);)1142
b(//)50 b(line)f(5)130 1053 y(cerr)g(<<)g("I)h(said,\\"")e(<<)h(src)h
(<<)f("\\".")379 1153 y(<<)g(")h(The)f(Object)g(said,\\"")f(<<)h(dest)h
(<<"\\"")e(<<)i(endl;)30 1253 y(})171 1426 y Fr(Brie\003y)-10
b(,)22 b(the)f(function)i Fn(hello)e Fr(accepts)h(a)h(generic)f(object)
g(r)n(efer)n(ence.)27 b(The)22 b(object)h(r)n(efer)n(ence)30
1539 y(\()p Fn(obj)p Fr(\))i(is)h(narr)n(owed)f(to)g
Fn(Echo)p 1120 1539 28 4 v 30 w(ptr)p Fr(.)36 b(If)26
b(the)f(object)g(r)n(efer)n(ence)g(r)n(eturned)f(by)i
Fn(Echo::)p 3098 1539 V 30 w(narrow)30 1652 y Fr(is)j(not)e(nil,)k(the)
d(operation)f Fn(echoString)d Fr(is)29 b(invoked.)45
b(Finally)-10 b(,)30 b(both)e(the)g(ar)n(gument)g(to)g(and)30
1765 y(the)22 b(r)n(eturn)g(value)h(of)g Fn(echoString)18
b Fr(ar)n(e)23 b(printed)e(to)h(cerr)-7 b(.)171 1878
y(The)24 b(example)g(also)g(illustrates)g(how)g(T)p 1581
1878 V 32 w(var)h(types)d(ar)n(e)j(used.)31 b(As)24 b(it)g(was)g
(explained)g(in)h(the)30 1991 y(pr)n(evious)d(section,)f(T)p
793 1991 V 32 w(var)j(types)c(take)h(car)n(e)i(of)g(storage)d
(allocation)k(and)f(r)n(elease)e(automatically)30 2104
y(when)h(variables)i(of)f(the)f(type)f(ar)n(e)i(assigned)e(to)h(or)g
(when)g(the)g(variables)i(go)e(out)g(of)g(scope.)171
2217 y(In)g(line)g(1,)h(the)e(variable)j Fn(e)d Fr(takes)g(over)h(the)f
(storage)f(r)n(esponsibility)i(of)g(the)f(object)h(r)n(efer)n(ence)30
2330 y(r)n(eturned)31 b(by)i Fn(Echo::)p 882 2330 V 30
w(narrow)p Fr(.)56 b(The)33 b(object)g(r)n(efer)n(ence)f(is)h(r)n
(eleased)f(by)h(the)f(destr)o(uctor)f(of)30 2443 y Fn(e)p
Fr(.)55 b(It)31 b(is)h(called)h(automatically)g(when)e(the)g(function)h
(r)n(eturns.)54 b(Line)31 b(2)i(and)f(5)g(shows)e(how)i(a)30
2556 y Fn(Echo)p 255 2556 V 31 w(var)25 b Fr(variable)j(is)f(used.)37
b(As)26 b(said)g(earlier)-7 b(,)28 b Fn(Echo)p 2022 2556
V 31 w(var)d Fr(type)g(can)i(be)f(used)f(inter)n(change-)30
2668 y(ably)e(with)g Fn(Echo)p 658 2668 V 31 w(ptr)e
Fr(type.)171 2781 y(The)90 b(ar)n(gument)f(and)i(the)e(r)n(eturn)h
(value)g(of)h Fn(echoString)86 b Fr(ar)n(e)k(stor)n(ed)f(in)30
2894 y Fn(CORBA::String)p 750 2894 V 27 w(var)26 b Fr(variable)j
Fn(src)d Fr(and)h Fn(dest)e Fr(r)n(espectively)-10 b(.)40
b(The)27 b(strings)e(managed)i(by)30 3007 y(the)h(variables)i(ar)n(e)f
(deallocated)g(by)f(the)g(destr)o(uctor)f(of)i Fn(CORBA::String)p
2775 3007 V 26 w(var)p Fr(.)45 b(It)28 b(is)h(called)30
3120 y(automatically)k(when)e(the)f(function)i(r)n(eturns.)52
b(Line)31 b(5)h(shows)e(how)h Fn(CORBA::String)p 3265
3120 V 26 w(var)30 3233 y Fr(variables)36 b(ar)n(e)g(used.)63
b(They)34 b(can)i(be)e(used)g(in)h(place)h(of)f(a)g(string)f(\(for)h
(which)h(the)e(mapping)30 3346 y(is)39 b Fn(char*)52
b Fr(\))491 3313 y Fj(5)529 3346 y Fr(.)78 b(As)38 b(used)g(in)h(line)h
(3,)j(assigning)c(a)h(constant)e(string)g(\()p Fn(const)53
b(char*)p Fr(\))37 b(to)i(a)30 3459 y Fn(CORBA::String)p
750 3459 V 27 w(var)25 b Fr(causes)h(the)g(string)g(to)g(be)h(copied.)
39 b(On)27 b(the)f(other)n(hand,)g(assigning)h(a)30 3572
y Fn(char*)g Fr(to)i(a)h Fn(CORBA::String)p 1236 3572
V 27 w(var)p Fr(,)f(as)h(used)e(in)i(line)g(5,)h(causes)e(the)f(latter)
h(to)g(assume)g(the)30 3685 y(ownership)21 b(of)i(the)f(string)970
3652 y Fj(6)1006 3685 y Fr(.)171 3798 y(Under)c(the)h(C++)i(mapping,)f
(T)p 1259 3798 V 32 w(var)g(types)e(ar)n(e)i(pr)n(ovided)f(for)g(all)i
(the)e(non-basic)i(data)e(types.)30 3910 y(It)h(is)h(obvious)g(that)f
(one)h(should)e(use)h(automatic)i(variables)g(whenever)e(possible)g
(both)g(to)h(avoid)30 4023 y(memory)i(leak)h(and)g(to)f(maximise)i
(performance.)31 b(However)-7 b(,)23 b(when)g(one)g(has)h(to)f
(allocate)i(data)30 4136 y(items)33 b(on)f(the)g(heap,)j(it)e(is)h(a)f
(good)e(practice)j(to)e(use)g(the)g(T)p 2187 4136 V 33
w(var)i(types)d(to)h(manage)h(the)f(heap)30 4249 y(storage.)30
4541 y Fi(2.7)119 b(Example)29 b(1)h(-)g(Colocated)g(Client)g(and)f
(Implementation)30 4752 y Fr(Having)35 b(intr)n(oduced)e(the)g(client)i
(and)f(the)f(object)h(implementation,)j(we)c(can)i(now)f(describe)30
4865 y(how)23 b(to)g(link)h(up)f(the)f(two)h(via)i(the)d(ORB.)h(In)g
(this)g(section,)g(we)g(describe)f(an)i(example)g(in)g(which)30
4978 y(both)29 b(the)g(client)h(and)f(the)g(object)g(implementation)g
(ar)n(e)h(in)g(the)f(same)g(addr)n(ess)f(space.)48 b(In)29
b(the)30 5091 y(next)g(two)g(sections,)h(we)g(shall)h(describe)e(the)g
(case)h(wher)n(e)f(the)g(two)g(ar)n(e)h(in)h(dif)n(fer)n(ent)f(addr)n
(ess)30 5204 y(spaces.)p 30 5278 1368 4 v 135 5334 a
Fg(5)164 5365 y Ff(A)19 b(conversion)g(operator\(\))e(of)i
(CORBA::String)p 1567 5365 23 4 v 25 w(var)g(converts)g(a)g
(CORBA::String)p 2580 5365 V 25 w(var)g(to)g(a)g(char*.)135
5427 y Fg(6)164 5458 y Ff(Please)i(r)o(efer)f(to)h(the)i(CORBA)d
(speci\002cation)i(16.7)g(for)f(the)h(details)f(of)g(the)h(String)p
2552 5458 V 27 w(var)f(mapping.)31 b(Other)21 b(T)p 3318
5458 V 27 w(var)30 5550 y(types)d(ar)o(e)g(also)g(cover)o(ed)f(in)i
(chapter)h(16.)p eop
%%Page: 13 19
13 18 bop 150 100 a Fd(2.7.)51 b(EXAMPLE)21 b(1)i(-)g(COLOCA)-7
b(TED)24 b(CLIENT)d(AND)h(IMPLEMENT)-7 b(A)g(TION)515
b Fr(13)291 356 y(The)22 b(code)g(for)g(this)h(example)f(is)h(r)n(epr)n
(oduced)e(below:)150 525 y Fc(int)150 625 y(main\(int)48
b(argc,)h(char)g(**argv\))150 724 y({)250 824 y(CORBA::ORB_ptr)e(orb)i
(=)h(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)143
b(//)49 b(line)h(1)250 924 y(CORBA::BOA_ptr)d(boa)i(=)h
(orb->BOA_init\(argc,argv,"omniORB2_)o(BOA"\))o(;)44
b(//)49 b(line)h(2)250 1123 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)
1642 b(//)49 b(line)h(3)250 1222 y(myobj->_obj_is_ready\(boa\);)1788
b(//)49 b(line)h(4)250 1422 y(boa->impl_is_ready\(0,1\);)1888
b(//)49 b(line)h(5)250 1621 y(Echo_ptr)e(myobjRef)g(=)i
(myobj->_this\(\);)1342 b(//)49 b(line)h(6)250 1721 y
(hello\(myobjRef\);)2288 b(//)49 b(line)h(7)250 1820
y(CORBA::release\(myobjRef\);)1838 b(//)49 b(line)h(8)250
2019 y(myobj->_dispose\(\);)2188 b(//)49 b(line)h(9)250
2219 y(boa->destory\(\);)2338 b(//)49 b(line)h(10)250
2418 y(orb->NP_destory\(\);)2188 b(//)49 b(line)h(11)250
2617 y(return)e(0;)150 2717 y(})291 2899 y Fr(The)25
b(example)g(illustrates)g(several)g(important)g(interactions)f(among)i
(the)e(ORB,)h(the)f(object)150 3012 y(implementation)f(and)f(the)g
(client.)28 b(Her)n(e)22 b(ar)n(e)h(the)f(details:)150
3262 y Fh(2.7.1)99 b(ORB/BOA)26 b(initialisation)150
3439 y Fl(line)d(1)46 b Fr(The)30 b(ORB)h(is)f(initialised)i(by)f
(calling)h(the)e Fn(CORBA::ORB)p 2494 3439 28 4 v 28
w(init)f Fr(function.)52 b(The)30 b(func-)377 3552 y(tion)k(uses)f(the)
g(3r)n(d)h(ar)n(gument)g(to)f(determine)g(which)h(ORB)g(should)f(be)h
(r)n(eturned.)60 b(T)-8 b(o)377 3665 y(use)36 b(omniORB2,)k(this)c(ar)n
(gument)g(must)g(either)f(be)h(\223omniORB2\224)i(or)e(NULL.)f(If)h(it)
h(is)377 3777 y(NULL,)32 b(ther)n(e)g(must)g(be)h(an)h(ar)n(gument,)h
(-ORBid)e(\223omniORB2\224,)k(in)d Fn(argv)p Fr(.)58
b(Like)32 b(any)377 3890 y(command-line)23 b(ar)n(guments)d(understood)
e(by)k(the)e(ORB,)h(it)h(will)g(be)g(r)n(emoved)e(fr)n(om)i(ar)n(gv)377
4003 y(when)28 b Fn(CORBA::ORB)p 1186 4003 V 28 w(init)f
Fr(r)n(eturns.)45 b(Ther)n(efor)n(e,)29 b(an)g(application)h(is)f(not)f
(r)n(equir)n(ed)g(to)377 4116 y(handle)22 b(any)g(command-line)i(ar)n
(guments)d(it)h(does)f(not)g(understand.)26 b(If)c(the)f(ORB)h(identi-)
377 4229 y(\002er)k(is)g(not)g(\223omniORB2\224,)i(the)e
(initialisation)i(will)g(fail)g(and)e(a)h(nil)g Fn(ORB)p
2944 4229 V 31 w(ptr)e Fr(will)j(be)e(r)n(e-)377 4342
y(turned.)k(If)24 b(supplied,)e(omniORB2)i(also)g(r)n(eads)f(the)g
(con\002guration)g(\002le)h Fn(omniORB.cfg)p Fr(.)377
4455 y(Among)i(other)g(things,)h(the)f(\002le)h(pr)n(ovides)f(a)i(list)
f(of)g(initial)i(object)e(r)n(efer)n(ences.)39 b(One)27
b(ex-)377 4568 y(ample)f(of)f(these)e(object)i(r)n(efer)n(ences)f(is)h
(the)f(naming)h(service.)35 b(Its)24 b(use)g(will)i(be)f(discussed)377
4681 y(in)30 b(section)f(2.9.1.)51 b(If)29 b(any)h(err)n(or)f(occurs)h
(during)f(the)g(pr)n(ocessing)f(of)i(the)f(con\002guration)377
4794 y(\002le,)23 b(the)f(system)e(exception)i(CORBA::INITIALIZE)c(is)
23 b(raised.)150 4971 y Fl(line)g(2)46 b Fr(The)38 b(BOA)h(is)g
(initialised)i(by)d(calling)j(the)d(ORB's)h Fn(BOA)p
2468 4971 V 32 w(init)p Fr(.)75 b(The)38 b(3r)n(d)i(ar)n(gument)377
5084 y(must)23 b(either)f(be)i(\223omniORB2)p 1469 5084
V 33 w(BOA)-7 b(\224)24 b(or)f(NULL.)f(If)h(it)h(is)f(NULL,)f(then)g
Fn(argv)g Fr(must)h(con-)377 5197 y(tain)j(an)g(ar)n(gument,)f(-BOAid)g
(\223omniORB2)p 1948 5197 V 34 w(BOA)-7 b(\224.)25 b(If)h(the)e(BOA)h
(identi\002er)g(is)g(not)f(\223om-)377 5310 y(niORB2)p
694 5310 V 34 w(BOA)-7 b(\224,)36 b(the)f(initialisation)j(will)g(fail)
f(and)f(a)h(nil)g(BOA)p 2692 5310 V 32 w(ptr)f(will)h(be)f(r)n
(eturned.)377 5423 y(Like)20 b Fn(ORB)p 744 5423 V 31
w(init)p Fr(,)f(any)i(command-line)h(ar)n(guments)d(understood)f(by)i
Fn(BOA)p 3035 5423 V 32 w(init)e Fr(will)k(be)377 5536
y(r)n(emoved)g(fr)n(om)h Fn(argv)p Fr(.)p eop
%%Page: 14 20
14 19 bop 30 100 a Fr(14)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fh(2.7.2)99 b(ORB/BOA)26 b(shutdown)30
533 y Fl(line)d(10)47 b Fr(Shutdown)29 b(the)h(BOA)g(permanently)-10
b(.)51 b(This)31 b(call)i(causes)d(the)g(ORB)h(to)f(r)n(elease)g(all)i
(its)257 646 y(BOA)23 b(r)n(esour)n(ces,)e(e.g.)26 b(worker)c(thr)n
(eads.)30 826 y Fl(line)h(1)m(1)46 b Fr(Shutdown)22 b(the)g(ORB)h
(permanently)-10 b(.)29 b(This)23 b(call)i(causes)e(the)f(ORB)h(to)g(r)
n(elease)g(its)g(inter)n(-)257 939 y(nal)h(r)n(esour)n(ces,)d(e.g.)27
b(internal)c(thr)n(eads.)171 1131 y(These)k(two)g(calls)j(ar)n(e)f
(particularly)g(important)f(when)g(writing)g(a)h(CORBA)g(DLL)e(on)h(W)
-5 b(in-)30 1244 y(dows)21 b(NT)g(that)h(is)g(to)g(be)g(used)e(fr)n(om)
j(ActiveX.)f(If)g(these)e(calls)j(ar)n(e)g(absent,)e(the)h(application)
h(will)30 1357 y(hang)g(when)e(the)h(CORBA)h(DLL)f(is)h(unloaded.)30
1608 y Fh(2.7.3)99 b(Object)25 b(initialisation)30 1785
y Fl(line)e(3)46 b Fr(An)23 b(instance)f(of)h(the)f(Echo)g(object)g(is)
h(initialised)h(using)e(the)f Fn(new)h Fr(operator)-7
b(.)30 1965 y Fl(line)23 b(4)46 b Fr(The)23 b(object's)p
809 1965 28 4 v 57 w Fn(obj)p 1007 1965 V 31 w(is)p 1148
1965 V 32 w(ready)e Fr(is)j(called.)33 b(This)23 b(function)h(informs)g
(the)f(BOA)h(that)f(this)257 2078 y(object)e(is)f(r)n(eady)h(to)f
(serve.)26 b(Until)21 b(this)f(function)h(is)f(called,)i(the)e(BOA)g
(will)i(not)e(accept)h(any)257 2191 y(invocation)j(on)e(the)g(object)g
(and)h(will)h(not)e(perform)g(any)g(upcall)i(to)e(the)g(object.)30
2372 y Fl(line)h(5)46 b Fr(The)30 b(BOA)-7 b('s)31 b
Fn(impl)p 999 2372 V 31 w(is)p 1140 2372 V 31 w(ready)e
Fr(is)i(called.)53 b(This)30 b(function)h(tells)f(the)g(BOA)g(the)g
(imple-)257 2485 y(mentation)22 b(is)g(r)n(eady)-10 b(.)27
b(After)22 b(this)g(call,)h(the)f(BOA)g(will)h(accept)g(IIOP)e(r)n
(equests)g(fr)n(om)h(other)257 2597 y(addr)n(ess)f(spaces.)27
b(Ther)n(e)22 b(ar)n(e)h(2)g(points)f(to)g(note)f(her)n(e:)344
2778 y(1.)45 b Fn(boa)p Fo(!)p Fn(impl)p 938 2778 V 30
w(is)p 1078 2778 V 32 w(ready)16 b Fr(can)k(be)f(called)h(any)f(time)g
(after)g Fn(BOA)p 2665 2778 V 32 w(init)e Fr(is)i(called)h(\(line)457
2891 y(2\).)34 b(In)24 b(other)g(wor)n(ds,)f(object)i(instances)e(can)j
(be)e(initialised)i(and)e(advertised)f(to)h(the)457 3004
y(BOA)f(befor)n(e)f(or)g(after)h(this)f(function)h(is)g(called.)344
3143 y(2.)45 b(The)c(2nd)g(ar)n(gument)1238 3110 y Fj(7)1316
3143 y Fr(to)g Fn(impl)p 1662 3143 V 31 w(is)p 1803 3143
V 32 w(ready)e Fr(tells)i(the)g(ORB)g(whether)e(this)i(call)457
3256 y(should)31 b(be)h(non-blocking.)55 b(The)31 b(default)h(value)g
(of)g(this)f(ar)n(gument)h(is)g(F)-7 b(ALSE\(0\))457
3369 y(and)23 b(the)e(call)j(will)g(block)e(inde\002nitely)g(within)g
(the)g(ORB.)g(If)g(ther)n(e)f(ar)n(e)i(mor)n(e)f(things)457
3482 y(the)31 b(main)h(thr)n(ead)f(should)g(do)f(after)i(it)f(calls)i
Fn(impl)p 2328 3482 V 31 w(is)p 2469 3482 V 32 w(ready)p
Fr(,)e(as)g(it)h(is)f(the)g(case)457 3595 y(in)36 b(this)g(example,)i
(the)d(non-blocking)g(option)g(\(TRUE=1\))h(should)e(be)i(speci\002ed.)
457 3708 y(Whether)24 b(the)h(main)i(thr)n(ead)e(blocks)h(in)g(this)f
(call)i(or)f(not,)f(the)g(ORB)g(is)h(not)f(af)n(fected)457
3820 y(because)36 b(its)h(functions)f(ar)n(e)h(pr)n(ovided)f(by)g
(other)f(thr)n(eads)h(spawned)f(internally)-10 b(.)457
3933 y(Notice)32 b(that)g(the)f(signatur)n(e)h(of)g Fn(impl)p
1849 3933 V 31 w(is)p 1990 3933 V 32 w(ready)e Fr(in)i(the)g(CORBA)g
(speci\002cation)457 4046 y(does)22 b(not)h(have)h(the)e(2nd)i(ar)n
(gument)1760 4013 y Fj(8)1796 4046 y Fr(.)31 b(Ther)n(efor)n(e,)22
b(calling)j Fn(impl)p 2801 4046 V 31 w(is)p 2942 4046
V 32 w(ready)c Fr(with)457 4159 y(the)h(non-blocking)h(option)e(is)i
(omniORB2)g(speci\002c.)30 4410 y Fh(2.7.4)99 b(Client)25
b(invocation)30 4587 y Fl(line)e(6)46 b Fr(The)36 b(object)h(r)n(efer)n
(ence)f(is)g(obtained)h(fr)n(om)g(the)f(implementation)g(by)h(calling)p
3182 4587 V 71 w Fn(this)p Fr(.)257 4700 y(Like)53 b(any)h(object)g(r)n
(efer)n(ence,)61 b(the)53 b(r)n(eturn)g(value)i(of)p
2330 4700 V 87 w(this)e(must)g(be)h(r)n(eleased)f(by)257
4813 y Fn(CORBA::release)17 b Fr(when)22 b(it)g(is)h(no)f(longer)g
(needed.)30 4994 y Fl(line)h(7)46 b Fr(Call)30 b Fn(hello)c
Fr(with)i(this)f(object)h(r)n(efer)n(ence.)43 b(The)27
b(ar)n(gument)h(is)g(widened)e(implicitly)k(to)257 5107
y(the)22 b(generic)g(object)h(r)n(efer)n(ence)f Fn(CORBA::Object)p
2089 5107 V 26 w(ptr)p Fr(.)p 30 5187 1368 4 v 135 5242
a Fg(7)164 5274 y Ff(The)c(1st)g(ar)o(gument)f(is)g(a)h(pointer)e(to)i
(the)g(implementation)g(de\002nition)g(and)g(is)e(always)i(ignor)o(ed)d
(by)j(omniORB2.)135 5335 y Fg(8)164 5367 y Ff(The)d(CORBA)f
(speci\002cation)h(does)f(not)h(specify)f(when)i Fb(impl)p
1937 5367 23 4 v 26 w(is)p 2053 5367 V 26 w(ready)e Ff(should)g(r)o
(eturn.)21 b(Many)15 b(ORB)f(vendors)30 5458 y(choose)19
b(to)h(implement)g Fb(impl)p 924 5458 V 26 w(is)p 1040
5458 V 27 w(ready)f Ff(as)h(blocking)f(until)h(a)g(certain)g(time-out)g
(value)g(is)f(exceeded.)24 b(In)d(a)f(single)30 5550
y(thr)o(eaded)e(implementation)h(this)g(is)f(necessary)g(to)h(give)f
(the)h(ORB)f(the)h(time)g(to)g(serve)e(incoming)i(r)o(equests.)p
eop
%%Page: 15 21
15 20 bop 150 100 a Fd(2.8.)51 b(EXAMPLE)21 b(2)i(-)g(DIFFERENT)d
(ADDRESS)i(SP)-8 b(ACES)1251 b Fr(15)150 356 y Fl(line)23
b(8)46 b Fr(Release)22 b(the)g(object)g(r)n(efer)n(ence.)291
581 y(One)f(of)g(the)f(important)h(characteristic)h(of)f(an)g(object)g
(r)n(efer)n(ence)f(is)i(that)e(it)h(is)g(completely)g(lo-)150
694 y(cation)h(transpar)n(ent.)k(A)c(client)f(can)i(invoke)d(on)i(the)e
(object)h(using)g(its)g(object)g(r)n(efer)n(ence)g(without)150
807 y(any)f(need)e(to)h(know)g(whether)f(the)h(object)g(is)h(colocated)
f(in)h(the)f(same)h(addr)n(ess)e(space)h(or)h(r)n(esided)150
920 y(in)j(a)g(dif)n(fer)n(ent)g(addr)n(ess)e(space.)291
1035 y(In)k(case)g(of)h(colocated)f(client)g(and)h(object)f
(implementation,)g(omniORB2)h(is)f(able)h(to)f(short-)150
1148 y(cir)n(cuit)31 b(the)d(client)h(calls)i(to)d(dir)n(ect)h(calls)i
(on)d(the)h(implementation)g(methods.)45 b(The)28 b(cost)h(of)g(an)150
1261 y(invocation)k(is)f(r)n(educed)f(to)h(that)f(of)i(a)f(function)h
(call.)58 b(This)32 b(optimisation)f(is)i(applicable)h
Fl(not)150 1374 y(only)d Fr(to)g(object)h(r)n(efer)n(ences)f(r)n
(eturned)f(by)i(the)p 1863 1374 28 4 v 64 w(this)g(function)g(but)g(to)
f(any)h(object)g(r)n(efer)n(ences)150 1487 y(that)22
b(ar)n(e)i(passed)d(ar)n(ound)h(within)h(the)f(same)g(addr)n(ess)g
(space)g(or)g(r)n(eceived)h(fr)n(om)g(other)f(addr)n(ess)150
1600 y(spaces)g(via)i(IIOP)e(calls.)150 1870 y Fh(2.7.5)99
b(Object)25 b(disposal)150 2052 y Fl(line)e(9)46 b Fr(T)-8
b(o)21 b(dispose)f(of)i(an)g(object)g(implementation)g(and)g(r)n
(elease)f(all)i(the)e(r)n(esour)n(ces)g(associated)377
2165 y(with)31 b(it,)i(the)p 867 2165 V 62 w Fn(dispose)28
b Fr(function)j(is)g(called.)53 b(In)30 b(fact,)k(this)c(is)h(the)f
Fl(only)f Fr(clean)j(way)f(to)377 2277 y(get)i(rid)h(of)g(an)h(object)f
(implementation.)62 b(Even)33 b(though)g(the)g(object)h(is)g(cr)n
(eated)g(using)377 2390 y(the)27 b(new)g(operator)f(in)i(the)e
(application)j(code,)f(the)f(application)h(should)f(never)g(call)i(the)
377 2503 y(delete)21 b(operator)g(on)i(the)e(object)i(dir)n(ectly)-10
b(.)291 2728 y(Once)30 b(an)g(application)h(calls)p 1352
2728 V 64 w Fn(dispose)c Fr(on)i(an)h(object)g(implementation,)h(the)e
(pointer)g(to)150 2841 y(the)22 b(object)i(should)e(not)g(be)i(used)e
(any)h(mor)n(e.)29 b(At)23 b(the)g(time)g(the)p 2412
2841 V 55 w Fn(dispose)d Fr(call)26 b(is)d(made,)g(ther)n(e)150
2954 y(may)31 b(be)g(other)e(thr)n(eads)h(invoking)g(on)g(the)g
(object,)i(omniORB2)f(ensur)n(es)e(that)i(all)h(these)d(calls)150
3067 y(ar)n(e)k(completed)f(befor)n(e)g(r)n(emoving)h(the)f(object)g
(fr)n(om)h(its)g(internal)g(tables)g(and)f(r)n(eleasing)h(the)150
3180 y(r)n(esour)n(ces)i(associated)g(with)h(it.)68 b(The)35
b(storage)f(associated)h(with)h(the)f(object)h(is)g(r)n(eleased)f(by)
150 3293 y(omniORB2)22 b(using)e(the)g(delete)g(operator)-7
b(.)26 b(This)21 b(is)g(why)g(all)h(object)f(implementation)g(should)f
(be)150 3406 y(initialised)k(using)e(the)f(new)h(operator)g(\(section)g
(2.5\).)291 3521 y(The)38 b(disposal)f(of)h(an)h(object)f
(implementation)g(by)g(omniORB2)h(may)f(also)h(be)f(deferr)n(ed)150
3634 y(when)28 b Fl(colocated)i Fr(clients)f(continue)f(to)g(hold)h(on)
f(to)h(copies)f(of)h(the)f(object's)g(r)n(efer)n(ence)3290
3601 y Fj(9)3327 3634 y Fr(.)46 b(This)150 3747 y(behavior)23
b(is)g(to)f(pr)n(event)g(the)f(short-cir)n(cuited)i(calls)h(fr)n(om)f
(the)f(clients)g(to)g(fail)j(unpr)n(edictably)-10 b(.)291
3862 y(T)i(o)31 b(summarise,)j(an)e(application)i(can)e(make)g(no)g
(assumption)f(as)h(to)f(when)g(the)g(object)h(is)150
3975 y(disposed)h(by)i(omniORB2)h(after)g(the)p 1550
3975 V 67 w Fn(dispose)d Fr(call)k(r)n(eturns.)65 b(If)36
b(it)f(is)h(necessary)e(to)h(have)150 4088 y(better)28
b(contr)n(ol)g(on)h(when)f(to)g(stop)g(serving)g(incoming)i(r)n
(equests,)e(the)g(work)g(should)g(be)g(done)150 4201
y(by)j(the)f(object)h(implementation)g(itself,)i(such)e(as)g(by)g
(keeping)e(track)i(of)g(the)f(curr)n(ent)h(serving)150
4314 y(state.)150 4628 y Fi(2.8)119 b(Example)29 b(2)h(-)g(Dif)n
(ferent)d(Address)i(Spaces)150 4844 y Fr(In)f(this)g(example,)h(the)f
(client)h(and)f(the)f(object)i(implementation)f(r)n(eside)f(in)i(two)e
(dif)n(fer)n(ent)i(ad-)150 4957 y(dr)n(ess)e(spaces.)45
b(The)28 b(code)g(of)h(this)f(example)h(is)g(almost)f(the)g(same)h(as)g
(the)e(pr)n(evious)h(example.)150 5070 y(The)20 b(only)h(dif)n(fer)n
(ence)g(is)g(the)f(extra)h(work)e(need)h(to)g(be)h(done)f(to)g(pass)g
(the)g(object)h(r)n(efer)n(ence)g(fr)n(om)150 5183 y(the)h(object)g
(implementation)h(to)f(the)g(client.)p 150 5280 1368
4 v 255 5335 a Fg(9)284 5367 y Ff(Object)f(r)o(efer)o(ences)c(held)j
(by)f(clients)h(in)g(other)g(addr)o(ess)d(spaces)j(will)f(not)h(pr)o
(event)g(the)g(object)g(implementation)150 5458 y(fr)o(om)j(being)i
(disposed)d(of.)40 b(If)24 b(these)h(clients)f(invoke)g(on)h(the)g
(object)h(after)e(it)g(is)g(disposed,)g(the)h(system)e(exception)150
5550 y(INV)p 295 5550 23 4 v 27 w(OBJREF)17 b(is)h(raised.)p
eop
%%Page: 16 22
16 21 bop 30 100 a Fr(16)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)171 356 y Fr(The)30 b(simplest)g(\(and)i(quite)e
(primitive\))i(way)f(to)f(pass)g(an)i(object)e(r)n(efer)n(ence)h
(between)e(two)30 469 y(addr)n(ess)e(spaces)g(is)h(to)g(pr)n(oduce)f(a)
h(stringi\002ed)f(version)g(of)i(the)e(object)h(r)n(efer)n(ence)f(and)h
(to)g(pass)30 582 y(this)c(string)g(to)f(the)h(client)h(as)f(a)h
(command-line)h(ar)n(gument.)33 b(The)24 b(string)f(is)i(then)e
(converted)g(by)30 695 y(the)j(client)h(into)g(a)g(pr)n(oper)f(object)g
(r)n(efer)n(ence.)40 b(This)27 b(method)e(is)i(used)e(in)j(this)e
(example.)40 b(In)27 b(the)30 808 y(next)j(example,)i(we)e(shall)h
(intr)n(oduce)f(a)h(better)e(way)i(of)f(passing)g(the)g(object)g(r)n
(efer)n(ence)g(using)30 920 y(the)22 b(COS)h(Naming)g(Service.)30
1189 y Fh(2.8.1)99 b(Object)25 b(Implementation:)30 b(Generating)24
b(a)h(Stringi\002ed)g(Object)g(Reference)30 1371 y Fr(The)k
Fn(main)g Fr(function)h(of)h(the)e(object)h(implementation)g(side)g(is)
g(r)n(epr)n(oduced)e(below)-8 b(.)50 b(The)30 b(full)30
1483 y(listing)23 b(\()p Fn(eg2)p 504 1483 28 4 v 31
w(impl.cc)p Fr(\))d(can)k(be)e(found)g(at)h(the)f(end)f(of)i(this)f
(chapter)-7 b(.)30 1696 y Fc(int)30 1796 y(main\(int)48
b(argc,)h(char)g(**argv\))30 1896 y({)130 1995 y(CORBA::ORB_ptr)e(orb)i
(=)h(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130
2095 y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 2294 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
2394 y(myobj->_obj_is_ready\(boa\);)130 2593 y({)229
2693 y(Echo_var)g(myobjRef)f(=)i(myobj->_this\(\);)229
2792 y(CORBA::String_var)d(p;)229 2991 y(p)j(=)f
(orb->object_to_string\(myobjRef\);)592 b(//line)49 b(1)229
3191 y(cerr)g(<<)h("'")f(<<)g(\(char*\)p)g(<<)g("'")g(<<)h(endl;)130
3290 y(})130 3490 y(boa->impl_is_ready\(\);)195 b(//)49
b(block)g(here)g(indefinitely)1375 3589 y(//)g(See)h(the)f(explanation)
f(in)h(example)g(1)130 3689 y(return)f(0;)30 3788 y(})171
4012 y Fr(The)60 b(stringi\002ed)g(object)g(r)n(efer)n(ence)g(is)h
(obtained)f(by)h(calling)i(the)d(ORB's)g(function)p 30
4125 V 57 4125 a Fn(object)p 392 4125 V 30 w(to)p 532
4125 V 32 w(string)28 b Fr(\(line)k(1\).)53 b(This)30
b(is)h(a)g(sequence)e(starting)h(with)h(the)f(signatur)n(e)g
(\223IOR:\224)30 4238 y(and)i(followed)f(by)h(a)g(hexadecimal)h
(string.)54 b(All)33 b(CORBA)f(2.0)g(compliant)h(ORBs)e(ar)n(e)h(able)h
(to)30 4351 y(convert)d(the)f(string)g(into)h(its)g(internal)g(r)n(epr)
n(esentation)e(of)j(a)f(so-called)h(Inter)n(operable)d(Object)30
4464 y(Refer)n(ence)34 b(\(IOR\).)h(The)f(IOR)h(contains)g(the)f
(location)i(information)f(and)g(a)h(key)d(to)i(uniquely)30
4577 y(identify)27 b(the)f(object)h(implementation)g(in)g(its)g(own)f
(addr)n(ess)g(space)2452 4544 y Fj(10)2522 4577 y Fr(.)41
b(Fr)n(om)27 b(the)g(IOR,)f(an)i(ob-)30 4690 y(ject)23
b(r)n(efer)n(ence)f(can)h(be)g(constr)o(ucted.)30 4958
y Fh(2.8.2)99 b(Client:)31 b(Using)25 b(a)g(Stringi\002ed)f(Object)i
(Reference)30 5140 y Fr(The)j(stringi\002ed)f(object)i(r)n(efer)n(ence)
f(is)h(passed)e(to)h(the)g(client)i(as)f(a)g(command-line)h(ar)n
(gument.)30 5253 y(The)g(client)h(uses)f(the)g(ORB's)g(function)h
Fn(string)p 1818 5253 V 30 w(to)p 1958 5253 V 32 w(object)d
Fr(to)i(convert)g(the)g(string)g(into)h(a)30 5366 y(generic)d(object)g
(r)n(efer)n(ence)g(\()p Fn(CORBA::Object)p 1763 5366
V 27 w(ptr)p Fr(\).)48 b(The)29 b(r)n(elevant)h(section)f(of)g(the)g
(code)g(is)p 30 5462 1368 4 v 111 5518 a Fg(10)164 5550
y Ff(Notice)19 b(that)h(the)g(object)f(key)f(is)g(not)h(globally)f
(unique)g(acr)o(oss)g(addr)o(ess)f(spaces.)p eop
%%Page: 17 23
17 22 bop 150 100 a Fd(2.8.)51 b(EXAMPLE)21 b(2)i(-)g(DIFFERENT)d
(ADDRESS)i(SP)-8 b(ACES)1251 b Fr(17)150 356 y(r)n(epr)n(oduced)18
b(below)-8 b(.)27 b(The)19 b(full)i(listing)f(\()p Fn(eg2)p
1725 356 28 4 v 32 w(clt.cc)p Fr(\))d(can)k(be)f(found)f(at)h(the)g
(end)f(of)h(this)f(chap-)150 469 y(ter)-7 b(.)150 645
y Fc(try)49 b({)250 744 y(CORBA::Object_var)d(obj)k(=)f
(orb->string_to_object\(argv[1]\);)250 844 y(hello\(obj\);)150
944 y(})150 1043 y(catch\(CORBA::COMM_FAILURE&)c(ex\))k({)250
1143 y(...)g(//)g(code)g(to)h(handle)f(communication)e(failure)150
1243 y(})150 1493 y Fh(2.8.3)99 b(Catching)25 b(System)g(Exceptions)150
1670 y Fr(When)33 b(omniORB2)i(detects)d(an)j(err)n(or)e(condition,)j
(it)f(may)f(raise)g(a)h(system)d(exception.)61 b(The)150
1783 y(CORBA)26 b(speci\002cation)h(de\002nes)d(a)j(series)e(of)i
(exceptions)d(covering)j(most)e(of)i(the)e(err)n(or)h(condi-)150
1896 y(tions)31 b(that)h(an)g(ORB)g(may)g(encounter)-7
b(.)54 b(The)31 b(client)h(may)g(choose)f(to)g(catch)i(these)d
(exceptions)150 2009 y(and)21 b(r)n(ecover)f(fr)n(om)h(the)f(err)n(or)g
(condition)1610 1976 y Fj(1)l(1)1677 2009 y Fr(.)27 b(For)20
b(instance,)g(the)g(code)g(fragment,)h(shown)e(in)i(sec-)150
2122 y(tion)27 b(2.8.2,)j(catches)d(the)g(system)e(exception)i(COMM)p
2078 2122 V 33 w(F)-7 b(AILURE)26 b(which)i(indicates)f(that)g(com-)150
2235 y(munication)d(with)e(the)g(object)g(implementation)h(in)g
(another)f(addr)n(ess)f(space)h(has)h(failed.)291 2348
y(All)30 b(system)d(exceptions)h(inherit)h(fr)n(om)h(the)e(class)i
Fn(CORBA::SystemE)o(xc)o(ep)o(ti)o(on)p Fr(.)41 b(W)-5
b(ith)150 2461 y(compilers)42 b(that)g(support)e(R)m(TTI)1349
2428 y Fj(12)s(13)1488 2461 y Fr(,)i(a)h(single)f(catch)h
Fn(CORBA::SystemE)o(xc)o(ep)o(tio)o(n)36 b Fr(will)150
2573 y(catch)23 b(all)i(the)c(dif)n(fer)n(ent)i(system)e(exceptions)g
(thr)n(own)h(by)g(omniORB2.)291 2686 y(When)f(omniORB2)i(detects)d(an)i
(internal)h(inconsistency)e(that)g(is)h(most)f(likely)i(to)e(be)h
(caused)150 2799 y(by)g(a)h(bug)f(in)h(the)e(r)o(untime,)h(it)g(raises)
g(the)f(exception)g Fn(omniORB::fatalEx)o(ce)o(pt)o(io)o(n)p
Fr(.)h(When)150 2912 y(this)j(exception)f(is)i(raised,)f(it)h(is)f(not)
g(sensible)g(to)f(pr)n(oceed)h(with)g(any)g(operation)g(that)g
(involves)150 3025 y(the)20 b(ORB's)h(r)o(untime.)27
b(It)20 b(is)h(best)f(to)g(exit)g(the)g(pr)n(ogram)h(immediately)-10
b(.)27 b(The)21 b(exception)e(str)o(uctur)n(e)150 3138
y(carries)34 b(by)g Fn(omniORB::fatalE)o(xc)o(ep)o(tio)o(n)28
b Fr(contains)34 b(the)f(exact)h(location)g(\(the)g(\002le)g(name)150
3251 y(and)22 b(the)f(line)h(number\))g(wher)n(e)f(the)g(exception)f
(is)i(raised.)27 b(Y)-8 b(ou)21 b(ar)n(e)h(str)n(ongly)e(encourage)h
(to)g(\002le)150 3364 y(a)i(bug)g(r)n(eport)e(and)i(point)f(out)f(the)h
(location.)150 3615 y Fh(2.8.4)99 b(Lifetime)24 b(of)h(an)g(Object)g
(Implementation)150 3792 y Fr(It)c(may)g(be)g(obvious)h(but)f(it)g(has)
g(to)g(stated)f(that)h(an)h(object)f(implementation)g(exists)f(only)h
(for)g(the)150 3904 y(duration)29 b(of)g(the)g(pr)n(ocess's)f
(lifetime.)49 b(When)28 b(the)h(same)g(pr)n(ogram)h(is)f(r)o(un)g
(again,)j(a)e(dif)n(fer)n(ent)150 4017 y(instance)35
b(of)g(the)f(object)h(implementation)g(is)g(cr)n(eated.)64
b(Mor)n(e)35 b(signi\002cantly)-10 b(,)38 b Fl(the)d(IOR,)f(and)150
4130 y(hence)e(the)h(object)f(reference,)37 b(of)32 b(this)h(instance)g
(is)g(dif)n(ferent)h(from)e(that)h(of)f(the)g(previous)150
4243 y(run)p Fr(.)291 4356 y(For)e(instance,)i(if)g(you)d(look)h(at)h
(the)f(stringi\002ed)f(object)i(r)n(efer)n(ence)f(pr)n(oduced)f(by)h
(the)g(pr)n(o-)150 4469 y(gram)g Fn(eg2)p 562 4469 V
31 w(impl)f Fr(in)h(dif)n(fer)n(ent)g(r)o(uns,)g(they)f(ar)n(e)h(all)h
(dif)n(fer)n(ent.)50 b(The)29 b(implication)j(is)d(that)h(you)150
4582 y(cannot)23 b(stor)n(e)f(away)i(the)e(stringi\002ed)g(object)h(r)n
(efer)n(ence)g(and)g(expect)f(to)h(be)g(able)h(to)f(use)f(it)h(again)
150 4695 y(later)g(when)f(the)f(original)j(pr)n(ogram)e(r)o(un)h(has)g
(terminated.)291 4808 y(For)31 b(system)f(services)i(and)g(other)e
(applications,)35 b(it)d(may)g(be)g(desirable)g(to)f(have)i
(\223persis-)150 4921 y(tent\224)27 b(object)h(implementations.)43
b(The)27 b(objects)h(ar)n(e)g(\223persistent\224)e(in)j(the)e(sense)f
(that)i(they)e(can)p 150 5000 1368 4 v 233 5056 a Fg(1)m(1)284
5088 y Ff(If)17 b(a)f(system)g(exception)f(is)h(not)h(caught,)g(the)g
(C++)g(r)o(untime)f(will)g(call)h(the)f Fb(terminate)f
Ff(function.)23 b(This)16 b(function)150 5179 y(is)i(defaulted)g(to)h
(abort)g(the)g(whole)g(pr)o(ocess)e(and)i(on)g(some)f(system)g(will)g
(cause)h(a)g(cor)o(e)e(\002le)i(to)g(be)f(pr)o(oduced.)231
5242 y Fg(12)284 5273 y Ff(Run)i(T)l(ime)e(T)-7 b(ype)18
b(Identi\002cation)231 5335 y Fg(13)284 5367 y Ff(A)j(noticeable)f
(exception)g(is)f(the)i(GNU)g(C++)f(compiler)f(\(version)g(2.7.2\).)27
b(It)21 b(doesn't)f(support)f(R)m(TTI)h(unless)f(the)150
5458 y(compilation)i(\003ag)g(-frtti)f(is)h(speci\002ed.)28
b(The)20 b(omniORB2)h(r)o(untime)g(is)f(not)i(compiled)d(with)j(the)f
(-frtti)g(\003ag.)29 b(It)21 b(is)g(said)150 5550 y(that)f(R)m(TTI)f
(will)f(be)h(pr)o(operly)d(supported)h(in)i(the)g(upcoming)g(version)f
(2.8.)p eop
%%Page: 18 24
18 23 bop 30 100 a Fr(18)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fr(be)d(contacted)g(using)f(the)h(same)g
(IOR)g(when)g(they)f(ar)n(e)h(instantiated)g(in)h(dif)n(fer)n(ent)f(pr)
n(ogram)g(r)o(uns.)30 469 y(T)-8 b(o)25 b(pr)n(ovide)g(this)g
(functionality)-10 b(,)27 b(omniORB2)f(needs)e(to)h(be)g(pr)n(ovided)g
(with)g(two)g(pieces)g(of)g(in-)30 582 y(formation:)39
b(the)28 b(\(network\))e(location)j(and)f(the)g(object)g(key)-10
b(.)43 b(The)28 b(details)f(of)i(how)e(this)h(can)h(be)30
695 y(done)21 b(will)j(be)f(described)e(in)i(the)f(later)h(part)f(of)h
(this)f(manual.)171 809 y(Alternatively)-10 b(,)35 b(an)e(indir)n
(ection)g(fr)n(om)g(textual)g(pathnames)f(to)g(object)h(r)n(efer)n
(ences)f(can)h(be)30 921 y(used.)49 b(Applications)31
b(can)g(r)n(egister)d(object)j(implementations)e(at)i(r)o(untime)f(to)g
(a)g(naming)h(ser)n(-)30 1034 y(vice)g(and)e(bind)h(them)f(to)g
(\002xed)g(pathnames.)49 b(Clients)30 b(can)g(bind)g(to)f(the)g(object)
h(implementa-)30 1147 y(tions)c(at)g(r)o(untime)g(by)g(asking)g(the)g
(naming)h(service)f(to)f(r)n(esolve)h(the)f(pathnames)h(to)g(the)f
(object)30 1260 y(r)n(efer)n(ences.)37 b(CORBA)26 b(de\002nes)f(a)h
(naming)h(service,)g(which)g(is)f(a)h(component)d(of)i(the)g(Common)30
1373 y(Object)f(Services)g(\(COS\))h([OMG99b)r(],)g(that)e(can)i(be)e
(used)g(for)g(this)h(purpose.)32 b(The)24 b(next)g(section)30
1486 y(describes)d(an)j(example)e(of)h(how)f(to)g(use)f(the)h(COS)i
(Naming)f(Service.)30 1791 y Fi(2.9)119 b(Example)29
b(3)h(-)g(Using)g(the)g(COS)f(Naming)h(Service)30 2003
y Fr(In)c(this)f(example,)i(the)e(object)h(implementation)g(uses)f(the)
g(COS)i(Naming)f(Service)g([OMG99b)s(])30 2116 y(to)36
b(pass)f(on)h(the)f(object)h(r)n(efer)n(ence)g(to)g(the)f(client.)69
b(This)36 b(method)f(is)h(by-far)h(mor)n(e)f(practical)30
2229 y(than)27 b(using)g(stringi\002ed)f(object)h(r)n(efer)n(ences.)40
b(The)27 b(full)h(listing)f(of)h(the)e(object)h(implementation)30
2342 y(\()p Fn(eg3)p 230 2342 28 4 v 32 w(impl.cc)p Fr(\))19
b(and)k(the)f(client)h(\()p Fn(eg3)p 1459 2342 V 32 w(clt.cc)p
Fr(\))d(can)j(be)g(found)f(at)h(the)e(end)h(of)h(this)f(chapter)-7
b(.)171 2456 y(The)23 b(object)h(r)n(efer)n(ence)f(is)h(bound)f(to)g
(the)f(pathname)i(\223)p Fl(test)p Fr(/)p Fl(Echo)p Fr(\224)2546
2423 y Fj(14)2618 2456 y Fr(.)31 b(The)23 b(pathname)h(con-)30
2569 y(sists)17 b(of)h(the)f(context)g Fl(test)i Fr(and)f(the)f(object)
h(name)h Fl(Echo)p Fr(.)25 b(Both)17 b(the)g(context)g(and)h(the)f
(object)h(name)30 2682 y(has)24 b(an)h(attribute)e Fl(kind)p
Fr(.)31 b(This)24 b(attribute)f(is)i(a)f(string)f(that)h(is)g(intended)
e(to)i(be)g(used)e(to)i(describe)30 2795 y(the)19 b(name)h(in)h(a)f
(syntax-independent)d(way)-10 b(.)27 b(The)19 b(naming)i(service)e
(does)g(not)g(interpr)n(et,)g(assign,)30 2908 y(or)26
b(manage)h(these)d(values.)39 b(However)25 b(both)h(the)g(name)g(and)h
(the)e(kind)h(attribute)g(must)f(match)30 3021 y(for)g(a)h(name)f
(lookup)f(to)g(succeed.)34 b(In)25 b(this)f(example,)i(the)e
Fl(kind)g Fr(values)h(for)g Fl(test)i Fr(and)e Fl(Echo)f
Fr(ar)n(e)30 3134 y(chosen)k(to)g(be)g(\223my)p 748 3134
V 33 w(context\224)g(and)h(\223Object\224)h(r)n(espectively)-10
b(.)45 b(This)29 b(is)g(an)g(arbitrary)g(choice)g(for)30
3246 y(ther)n(e)22 b(is)g(no)h(standar)n(dised)e(set)g(of)i(kind)f
(values.)30 3507 y Fh(2.9.1)99 b(Obtaining)25 b(the)g(Root)h(Context)f
(Object)g(Reference)30 3686 y Fr(The)d(initial)j(contact)e(with)g(the)f
(Naming)h(Service)g(can)g(be)g(established)f(via)i(what)f(we)f(called)i
(the)30 3799 y Fl(root)17 b Fr(context.)25 b(The)16 b(object)h(r)n
(efer)n(ence)g(to)g(the)f(r)n(oot)h(context)f(is)h(pr)n(ovided)f(by)h
(the)g(ORB)g(and)g(can)h(be)30 3912 y(obtained)26 b(by)h(calling)i
Fn(resolve)p 1224 3912 V 29 w(initial)p 1638 3912 V 30
w(references)p Fr(.)35 b(The)26 b(following)h(code)f(fragment)30
4025 y(shows)21 b(how)h(it)h(is)g(used:)30 4329 y Fc(CORBA::ORB_ptr)47
b(orb)i(=)h(CORBA::ORB_init\(argc,argv,"omniORB2")o(\);)30
4529 y(CORBA::Object_var)d(initServ;)30 4628 y(initServ)h(=)i
(orb->resolve_initial_references\("Na)o(meSer)o(vice"\))o(;)30
4827 y(CosNaming::NamingContext_var)45 b(rootContext;)30
4927 y(rootContext)j(=)h(CosNaming::NamingContext::_narrow\(ini)o
(tServ\))o(;)p 30 5005 1368 4 v 111 5061 a Fg(14)164
5093 y Ff(A)29 b(pathname,)i(or)d(in)g(the)h(Naming)f(Service's)f
(terminology-)f(a)j Fe(compound)f(name)p Ff(,)i(is)e(a)g(sequence)g(of)
g(textual)30 5185 y(names.)38 b(Each)24 b(name)g(component)h(except)e
(the)h(last)g(one)g(is)f(bound)h(to)f(a)h(naming)g(context.)39
b(A)23 b(naming)h(context)h(is)30 5276 y(analogous)h(to)g(a)g(dir)o
(ectory)e(in)i(a)g(\002ling)g(system,)g(it)h(can)f(contain)i(names)e
(of)g(object)h(r)o(efer)o(ences)c(or)j(other)f(naming)30
5367 y(contexts.)44 b(The)26 b(last)g(name)g(component)h(is)e(bound)h
(to)g(an)h(object)g(r)o(efer)o(ence.)42 b(Note:)37 b('/')25
b(is)h(pur)o(ely)e(a)i(notation)h(to)30 5458 y(separate)c(two)i
(components)f(in)g(the)g(pathname.)40 b(It)24 b(does)f(not)h(appear)g
(in)g(the)g Fe(compound)g(name)g Ff(that)h(is)e(r)o(egister)o(ed)30
5550 y(with)d(the)f(Naming)g(Service.)p eop
%%Page: 19 25
19 24 bop 150 100 a Fd(2.10.)52 b(EXAMPLE)20 b(4)k(-)f(USING)e(TIE)h
(IMPLEMENT)-7 b(A)g(TION)20 b(TEMPLA)-7 b(TES)630 b Fr(19)291
568 y(Remember)-7 b(,)57 b(omniORB2)51 b(constr)o(ucts)e(its)i
(internal)g(list)f(of)h(initial)i(r)n(efer)n(ences)c(at)i(ini-)150
681 y(tialisation)62 b(time)e(using)g(the)g(information)h(pr)n(ovided)e
(in)i(the)f(con\002guration)g(\002le)g Fn(om-)150 794
y(niORB.cfg)p Fr(.)88 b(If)44 b(this)f(\002le)h(is)h(not)e(pr)n(esent,)
k(the)c(internal)h(list)h(will)g(be)f(empty)e(and)i Fn(re-)150
907 y(solve)p 430 907 28 4 v 30 w(initial)p 845 907 V
30 w(references)18 b Fr(will)24 b(raise)f(a)g(CORBA::ORB::InvalidName)f
(exception.)150 1162 y Fh(2.9.2)99 b(The)25 b(Naming)g(Service)g
(Interface)150 1339 y Fr(It)17 b(is)i(beyond)d(the)i(scope)e(of)j(this)
e(chapter)h(to)f(describe)h(in)g(detail)g(the)g(Naming)g(Service)g
(interface.)150 1452 y(Y)-8 b(ou)20 b(should)h(consult)g(the)f
(CORBAservices)h(speci\002cation)h([OMG99b)r(])g(\(chapter)f(3\).)28
b(The)21 b(code)150 1565 y(listed)e(in)i Fn(eg3)p 660
1565 V 31 w(impl.cc)c Fr(and)j Fn(eg3)p 1432 1565 V 31
w(clt.cc)d Fr(ar)n(e)k(good)d(examples)h(of)h(how)g(the)f(service)g
(can)i(be)150 1678 y(used.)26 b(Please)d(spend)d(time)j(to)f(study)f
(the)h(examples)g(car)n(efully)-10 b(.)150 1976 y Fi(2.10)119
b(Example)29 b(4)h(-)g(Using)g(tie)f(implementation)h(templates)150
2187 y Fr(Since)19 b(2.6.0,)i(a)f(new)f(command-line)h(option)f(\()p
Fn(-t)p Fr(\))g(has)g(been)g(added)f(to)h Fn(omniidl2)p
Fr(.)k(When)18 b(this)150 2300 y(\003ag)26 b(is)f(speci\002ed,)g
Fn(omniidl2)d Fr(generates)h(an)j(extra)f(template)g(class)h(for)f
(each)h(interface.)36 b(This)150 2413 y(template)22 b(class)h(can)g(be)
g(used)e(to)h(tie)h(a)g(C++)g(class)g(to)f(the)g(skeleton)f(class)i(of)
f(the)g(interface.)291 2526 y(The)e(sour)n(ce)g(code)g(in)i
Fn(eg3)p 1227 2526 V 31 w(tieimpl.cc)16 b Fr(at)22 b(the)e(end)f(of)i
(this)g(chapter)f(illustrates)h(how)f(the)150 2639 y(template)j(class)h
(can)g(be)g(used.)29 b(The)23 b(code)g(is)h(almost)f(identical)i(to)e
Fn(eg3)p 2681 2639 V 31 w(impl.cc)e Fr(with)i(only)h(a)150
2752 y(few)e(changes.)291 2865 y(Firstly)-10 b(,)32 b(the)f
(implementation)g(class)h Fn(Echo)p 1872 2865 V 31 w(i)f
Fr(does)e(not)i(inherit)g(fr)n(om)h(any)f(stub)g(classes.)150
2978 y(This)c(is)h(the)f(main)i(bene\002t)e(of)h(using)f(the)g
(template)g(class)h(because)f(ther)n(e)g(ar)n(e)h(applications)h(in)150
3091 y(which)j(it)g(is)g(dif)n(\002cult)g(to)f(r)n(equir)n(e)h(every)f
(implementation)g(class)h(to)f(subclass)h(fr)n(om)g(CORBA)150
3203 y(classes.)291 3316 y(Secondly)-10 b(,)28 b(the)g(instantiation)g
(of)h(a)g(CORBA)f(object)g(now)g(involves)h(cr)n(eating)f(an)h
(instance)150 3429 y(of)22 b(the)f(implementation)g(class)i
Fl(and)e Fr(an)h(instance)g(of)g(the)e(template.)27 b(Her)n(e)21
b(is)h(the)f(r)n(elevant)h(code)150 3542 y(fragment:)349
3741 y Fc(class)49 b(Echo_i)g({)g(...)h(};)349 3941 y(Echo_i)f(*myimpl)
f(=)i(new)f(Echo_i\(\);)349 4040 y(_tie_Echo<Echo_i,1>)e(*myobj)h(=)i
(new)f(_tie_Echo<Echo_i,1>\(myimpl\);)349 4140 y
(myobj->_obj_is_ready\(boa\);)291 4352 y Fr(For)19 b(interface)i
Fn(Echo)p Fr(,)d(the)h(name)i(of)f(its)f(tie)h(implementation)g
(template)f(is)p 2926 4352 V 53 w Fn(tie)p 3123 4352
V 32 w(Echo)p Fr(.)25 b(The)150 4465 y(\002rst)e(template)g(parameter)g
(is)h(the)e(implementation)i(class)g(that)f(contains)h(an)g
(implementation)150 4578 y(of)k(each)g(of)g(the)f(operations)f
(de\002ned)g(in)i(the)f(interface.)43 b(The)27 b(second)g(template)g
(parameter)g(is)150 4691 y(a)32 b(boolean)f(\003ag.)53
b(When)31 b(the)f(\003ag)i(is)f(TRUE)f(\(1\),)k(as)d(it)g(is)g(in)h
(this)f(example,)i(the)d(ORB)h(would)150 4804 y(call)g
Fn(delete)c Fr(on)i(the)f(implementation)i(object)f(\()p
Fn(myimpl)p Fr(\))e(when)p 2575 4804 V 61 w Fn(dispose)g
Fr(is)i(invoked)f(on)150 4917 y Fn(myobj)p Fr(.)43 b(When)28
b(the)f(\003ag)i(is)f(F)-7 b(ALSE)27 b(\(0\),)k Fn(delete)25
b Fr(would)j(not)g(be)g(called.)46 b(Instantiating)27
b(this)150 5030 y(template)33 b(with)g(the)g(\003ag)h(set)e(to)h(F)-7
b(ALSE)32 b(is)h(useful)g(when)g(the)g(same)g(implementation)h(class)
150 5143 y(is)27 b(used)e(to)h(implement)h(multiple)g(interfaces.)40
b(In)27 b(this)f(situation,)h(the)f(same)h(implementation)150
5256 y(would)f(be)g(used)f(as)h(the)g(ar)n(gument)g(to)f(a)i(number)f
(of)h(tie)f(template)f(instantiations.)39 b(Pr)n(ovided)150
5369 y(that)25 b(only)f(one)h(of)g(the)f(instantiation)h(has)g(the)f
(\003ag)h(set)f(to)h(TRUE,)e(the)h(object)h(implementation)150
5482 y(would)d(not)g(be)g(deleted)f(mor)n(e)h(than)h(once!)p
eop
%%Page: 20 26
20 25 bop 30 100 a Fr(20)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fi(2.1)l(1)118 b(Source)30
b(Listing)30 570 y Fh(2.1)l(1.1)99 b(echo)p 591 570 30
4 v 36 w(i.cc)30 728 y Fc(//)49 b(echo_i.cc)g(-)g(This)g(source)g(code)
g(demonstrates)f(an)h(implmentation)e(of)j(the)30 828
y(//)647 b(object)49 b(interface)f(Echo.)h(It)g(is)h(part)f(of)g(the)h
(three)e(examples)30 928 y(//)647 b(used)49 b(in)h(Chapter)e(2)i("The)f
(Basics")f(of)i(the)f(om-)30 1027 y(niORB2)g(user)g(guide.)30
1127 y(//)30 1226 y(#include)f(<string.h>)30 1326 y(#include)g
("echo.hh")30 1525 y(class)h(Echo_i)g(:)g(public)g(virtual)f(_sk_Echo)h
({)30 1625 y(public:)130 1725 y(Echo_i\(\))f({})130 1824
y(virtual)g(\230Echo_i\(\))g({})130 1924 y(virtual)g(char)h(*)h
(echoString\(const)d(char)i(*mesg\);)30 2023 y(};)30
2223 y(char)g(*)30 2322 y(Echo_i::echoString\(const)c(char)k(*mesg\))g
({)130 2422 y(char)g(*p)g(=)h(CORBA::string_dup\(mesg\);)130
2522 y(return)e(p;)30 2621 y(})p eop
%%Page: 21 27
21 26 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(21)150 356 y Fh(2.1)l(1.2)99 b(greeting.cc)150 514
y Fc(//)49 b(greeting.cc)f(-)i(This)f(source)g(code)g(demonstrates)e
(the)i(use)h(of)f(an)h(object)150 614 y(//)747 b(reference)48
b(by)h(a)h(client)f(to)g(perform)g(an)g(operation)f(on)i(an)150
713 y(//)747 b(object.)48 b(It)i(is)f(part)g(of)h(the)f(three)g
(examples)f(used)150 813 y(//)747 b(in)49 b(Chapter)g(2)g("The)g
(Basics")g(of)g(the)h(om-)150 912 y(niORB2)f(user)g(guide.)150
1012 y(//)150 1112 y(#include)f(<iostream.h>)150 1211
y(#include)g("echo.hh")150 1411 y(void)150 1510 y
(hello\(CORBA::Object_ptr)e(obj\))150 1610 y({)250 1709
y(Echo_var)i(e)i(=)f(Echo::_narrow\(obj\);)250 1909 y(if)g
(\(CORBA::is_nil\(e\)\))e({)349 2008 y(cerr)i(<<)h("hello:)e(cannot)h
(invoke)g(on)g(a)h(nil)f(object)g(refer-)150 2108 y(ence.\\n")f(<<)i
(endl;)349 2208 y(return;)250 2307 y(})250 2507 y(CORBA::String_var)c
(src)k(=)f(\(const)g(char*\))g("Hello!";)250 2606 y(CORBA::String_var)d
(dest;)250 2805 y(dest)j(=)g(e->echoString\(src\);)250
3005 y(cerr)g(<<)g("I)h(said,\\"")e(<<)h(src)h(<<)f("\\".")499
3104 y(<<)g(")h(The)f(Object)g(said,\\"")f(<<)h(dest)h(<<"\\"")e(<<)i
(endl;)150 3204 y(})p eop
%%Page: 22 28
22 27 bop 30 100 a Fr(22)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fh(2.1)l(1.3)99 b(eg1.cc)30
568 y Fc(//)49 b(eg1.cc)g(-)h(This)f(is)g(the)h(source)e(code)h(of)h
(example)e(1)i(used)f(in)g(Chapter)g(2)30 668 y(//)498
b("The)49 b(Basics")f(of)i(the)f(omniORB2)f(user)h(guide.)30
768 y(//)30 867 y(//)498 b(In)49 b(this)g(example,)g(both)g(the)g
(object)g(implementation)e(and)i(the)30 967 y(//)498
b(client)48 b(are)i(in)f(the)g(same)g(process.)30 1067
y(//)30 1166 y(//)g(Usage:)g(eg1)30 1266 y(//)30 1365
y(#include)f(<iostream.h>)30 1465 y(#include)g("echo.hh")30
1664 y(#include)g("echo_i.cc")30 1764 y(#include)g("greeting.cc")30
1963 y(int)30 2063 y(main\(int)g(argc,)h(char)g(**argv\))30
2163 y({)130 2262 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 2362
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 2561 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
2661 y(//)g(Note:)g(all)g(implementation)e(objects)i(must)g(be)g
(instantiated)f(on)h(the)130 2760 y(//)g(heap)g(using)g(the)g(new)h
(operator.)130 2960 y(myobj->_obj_is_ready\(boa\);)130
3059 y(//)f(Tell)g(the)g(BOA)h(the)f(object)g(is)g(ready)g(to)g(serve.)
130 3159 y(//)g(This)g(call)g(is)h(omniORB2)e(specific.)130
3258 y(//)130 3358 y(//)h(This)g(call)g(is)h(equivalent)e(to)h(the)g
(following)f(call)h(sequence:)130 3458 y(//)248 b(Echo_ptr)49
b(myobjRef)f(=)i(myobj->_this\(\);)130 3557 y(//)248
b(boa->obj_is_ready\(myobjRef\);)130 3657 y(//)g
(CORBA::release\(myobjRef\);)130 3856 y(boa->impl_is_ready\(0,1\);)130
3956 y(//)49 b(Tell)g(the)g(BOA)h(we)f(are)g(ready)g(and)g(to)h(return)
f(immediately)e(once)i(it)h(has)130 4055 y(//)f(done)g(its)g(stuff.)g
(It)h(is)f(omniORB2)f(specific)h(to)g(call)g(impl_is_ready\(\))130
4155 y(//)g(with)g(the)g(extra)g(2nd)h(argument-)e(CORBA::Boolean)f
(NonBlocking,)130 4255 y(//)i(which)g(is)g(set)h(to)f(TRUE)g(\(1\))g
(in)h(this)f(case.)130 4454 y(Echo_ptr)f(myobjRef)g(=)i
(myobj->_this\(\);)130 4554 y(//)f(Obtain)g(an)g(object)g(reference.)
130 4653 y(//)g(Note:)g(always)g(use)g(_this\(\))f(to)i(obtain)f(an)g
(object)g(reference)f(from)h(the)130 4753 y(//)348 b(object)49
b(implementation.)130 4952 y(hello\(myobjRef\);)130 5151
y(CORBA::release\(myobjRef\);)130 5251 y(//)g(Dispose)g(of)g(the)g
(object)g(reference.)130 5450 y(myobj->_dispose\(\);)130
5550 y(//)g(Dispose)g(of)g(the)g(object)g(implementation.)p
eop
%%Page: 23 29
23 28 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(23)250 356 y Fc(//)49 b(This)g(call)g(is)h(omniORB2)e(specific.)
250 456 y(//)h(Note:)g(*never*)f(call)i(the)f(delete)f(operator)h(or)g
(the)g(dtor)h(of)f(the)g(object)250 555 y(//)348 b(directly)48
b(because)h(the)g(BOA)g(needs)g(to)h(be)f(informed.)250
655 y(//)250 754 y(//)g(This)g(call)g(is)h(equivalent)e(to)h(the)g
(following)f(call)h(sequence:)250 854 y(//)248 b(Echo_ptr)49
b(myobjRef)f(=)i(myobj->_this\(\);)250 954 y(//)248 b
(boa->dispose\(myobjRef\);)250 1053 y(//)g(CORBA::release\(myobjRef\);)
250 1253 y(boa->destory\(\);)250 1452 y(orb->NP_destory\(\);)250
1651 y(return)48 b(0;)150 1751 y(})p eop
%%Page: 24 30
24 29 bop 30 100 a Fr(24)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fh(2.1)l(1.4)99 b(eg2)p 536
356 30 4 v 36 w(impl.cc)30 568 y Fc(//)49 b(eg2_impl.cc)f(-)i(This)f
(is)g(the)h(source)e(code)h(of)h(example)e(2)i(used)f(in)g(Chap-)30
668 y(ter)g(2)30 768 y(//)747 b("The)49 b(Basics")f(of)i(the)f
(omniORB2)f(user)h(guide.)30 867 y(//)30 967 y(//)747
b(This)49 b(is)g(the)h(object)e(implementation.)30 1067
y(//)30 1166 y(//)h(Usage:)g(eg2_impl)30 1266 y(//)30
1365 y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(printed)g(to)g(cerr)g(as)h(a)30 1465 y(//)398 b(stringified)48
b(IOR.)h(This)g(string)g(should)f(be)i(used)f(as)g(the)h(argu-)30
1565 y(ment)f(to)30 1664 y(//)398 b(eg2_clt.)30 1764
y(//)30 1864 y(#include)48 b(<iostream.h>)30 1963 y(#include)g
("omnithread.h")30 2063 y(#include)g("echo.hh")30 2262
y(#include)g("echo_i.cc")30 2461 y(int)30 2561 y(main\(int)g(argc,)h
(char)g(**argv\))30 2661 y({)130 2760 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 2860
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 3059 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)130
3159 y(myobj->_obj_is_ready\(boa\);)130 3358 y({)229
3458 y(Echo_var)g(myobjRef)f(=)i(myobj->_this\(\);)229
3557 y(CORBA::String_var)d(p)j(=)f(orb->object_to_string\(myobjRef\);)
229 3657 y(cerr)g(<<)h("'")f(<<)g(\(char*\)p)g(<<)g("'")g(<<)h(endl;)
130 3757 y(})130 3956 y(boa->impl_is_ready\(\);)130 4055
y(//)f(Tell)g(the)g(BOA)h(we)f(are)g(ready.)g(The)g(BOA's)g(default)g
(be-)30 4155 y(haviour)f(is)i(to)f(block)130 4255 y(//)g(on)g(this)h
(call)f(indefinitely.)130 4454 y(//)g(Call)g(boa->impl_shutdown\(\))d
(from)j(another)g(thread)f(would)h(unblock)g(the)130
4554 y(//)g(main)g(thread)g(from)g(impl_is_ready\(\).)130
4653 y(//)130 4753 y(//)g(To)g(properly)g(shutdown)f(the)h(BOA)h(and)f
(the)g(ORB,)g(add)g(the)h(follow-)30 4852 y(ing)f(calls)130
4952 y(//)g(after)g(impl_is_ready\(\))e(returns.)130
5052 y(//)130 5151 y(//)i(boa->destroy\(\);)130 5251
y(//)g(orb->NP_destory\(\);)130 5450 y(return)f(0;)30
5550 y(})p eop
%%Page: 25 31
25 30 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(25)150 356 y Fh(2.1)l(1.5)99 b(eg2)p 656 356 30
4 v 36 w(clt.cc)150 568 y Fc(//)49 b(eg2_clt.cc)f(-)i(This)f(is)h(the)f
(source)f(code)i(of)f(example)f(2)i(used)f(in)h(Chap-)150
668 y(ter)f(2)150 768 y(//)697 b("The)49 b(Basics")g(of)g(the)g
(omniORB2)g(user)g(guide.)150 867 y(//)150 967 y(//)697
b(This)49 b(is)h(the)f(client.)f(The)i(object)e(refer-)150
1067 y(ence)h(is)h(given)e(as)i(a)150 1166 y(//)697 b(stringified)48
b(IOR)h(on)g(the)h(command)e(line.)150 1266 y(//)150
1365 y(//)h(Usage:)g(eg2_clt)g(<object)f(reference>)150
1465 y(//)150 1565 y(#include)g(<iostream.h>)150 1664
y(#include)g("echo.hh")150 1864 y(#include)g("greeting.cc")150
2063 y(extern)h(void)g(hello\(CORBA::Object_ptr)c(obj\);)150
2262 y(int)150 2362 y(main)k(\(int)g(argc,)g(char)g(**argv\))150
2461 y({)250 2561 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 2661
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 2860 y(if)f(\(argc)g(<)h(2\))f({)349
2960 y(cerr)g(<<)h("usage:)e(eg2_clt)h(<object)f(reference>")g(<<)h
(endl;)349 3059 y(return)g(1;)250 3159 y(})250 3358 y(try)g({)349
3458 y(CORBA::Object_var)e(obj)i(=)h(orb->string_to_object\(argv[1]\);)
349 3557 y(hello\(obj\);)250 3657 y(})250 3757 y
(catch\(CORBA::COMM_FAILURE&)45 b(ex\))k({)349 3856 y(cerr)g(<<)h
("Caught)e(system)h(exception)f(COMM_FAILURE,)f(unable)i(to)h(con-)150
3956 y(tact)f(the)g(")598 4055 y(<<)h("object.")e(<<)h(endl;)250
4155 y(})250 4255 y(catch\(omniORB::fatalException&)44
b(ex\))49 b({)349 4354 y(cerr)g(<<)h("Caught)e(omniORB2)h
(fatalException.)e(This)i(indi-)150 4454 y(cates)g(a)h(bug)f(is)g
(caught)g(")598 4554 y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h
(bug)f(report.\\n")598 4653 y(<<)h("The)f(exception)f(was)h(thrown)g
(in)g(file:)g(")h(<<)f(ex.file\(\))f(<<)i("\\n")598 4753
y(<<)g(")1394 b(line:)49 b(")h(<<)f(ex.line\(\))f(<<)i("\\n")598
4852 y(<<)g("The)f(error)g(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)
j(endl;)250 4952 y(})250 5052 y(catch\(...\))e({)349
5151 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception.")e(<<)j(endl;)250
5251 y(})250 5450 y(orb->NP_destory\(\);)p eop
%%Page: 26 32
26 31 bop 30 100 a Fr(26)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fc(return)48 b(0;)30 456
y(})p eop
%%Page: 27 33
27 32 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(27)150 356 y Fh(2.1)l(1.6)99 b(eg3)p 656 356 30
4 v 36 w(impl.cc)150 568 y Fc(//)49 b(eg3_impl.cc)f(-)i(This)f(is)g
(the)h(source)e(code)h(of)h(example)e(3)i(used)f(in)g(Chap-)150
668 y(ter)g(2)150 768 y(//)747 b("The)49 b(Basics")f(of)i(the)f
(omniORB2)f(user)h(guide.)150 867 y(//)150 967 y(//)747
b(This)49 b(is)g(the)h(object)e(implementation.)150 1067
y(//)150 1166 y(//)h(Usage:)g(eg3_impl)150 1266 y(//)150
1365 y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(registered)f(with)h(the)150 1465 y(//)398 b(COS)49 b(naming)g
(service.)f(The)i(client)e(uses)h(the)h(naming)e(service)h(to)150
1565 y(//)398 b(locate)49 b(this)g(object.)150 1664 y(//)150
1764 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i(bound)f(to)
g(is)g(as)h(follows:)150 1864 y(//)697 b(root)99 b([context])150
1963 y(//)747 b(|)150 2063 y(//)697 b(text)99 b([context])48
b(kind)h([my_context])150 2163 y(//)747 b(|)150 2262
y(//)697 b(Echo)99 b([object])f(kind)49 b([Object])150
2362 y(//)150 2561 y(#include)f(<iostream.h>)150 2661
y(#include)g("omnithread.h")150 2760 y(#include)g("echo.hh")150
2960 y(#include)g("echo_i.cc")150 3159 y(static)h(CORBA::Boolean)e
(bindObjectToName\(CORBA::ORB_ptr,COR)o(BA::O)o(bject)o(_ptr\);)150
3358 y(int)150 3458 y(main\(int)h(argc,)h(char)g(**argv\))150
3557 y({)250 3657 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 3757
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 3956 y(Echo_i)e(*myobj)h(=)h(new)f(Echo_i\(\);)250
4055 y(myobj->_obj_is_ready\(boa\);)250 4255 y({)349
4354 y(Echo_var)g(myobjRef)f(=)i(myobj->_this\(\);)349
4454 y(if)g(\(!bindObjectToName\(orb,myobjRef\)\))43
b({)449 4554 y(return)49 b(1;)349 4653 y(})250 4753 y(})250
4952 y(boa->impl_is_ready\(\);)250 5052 y(//)g(Tell)g(the)g(BOA)h(we)f
(are)g(ready.)g(The)g(BOA's)g(default)g(be-)150 5151
y(haviour)g(is)g(to)g(block)250 5251 y(//)g(on)h(this)f(call)g
(indefinitely.)250 5450 y(//)g(Call)g(boa->impl_shutdown\(\))d(from)j
(another)g(thread)f(would)h(unblock)g(the)250 5550 y(//)g(main)g
(thread)g(from)g(impl_is_ready\(\).)p eop
%%Page: 28 34
28 33 bop 30 100 a Fr(28)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fc(//)130 456 y(//)49 b(To)g(properly)g
(shutdown)f(the)h(BOA)h(and)f(the)g(ORB,)g(add)g(the)h(follow-)30
555 y(ing)f(calls)130 655 y(//)g(after)g(impl_is_ready\(\))e(returns.)
130 754 y(//)130 854 y(//)i(boa->destroy\(\);)130 954
y(//)g(orb->NP_destory\(\);)130 1153 y(return)f(0;)30
1253 y(})30 1551 y(static)30 1651 y(CORBA::Boolean)30
1751 y(bindObjectToName\(CORBA::ORB_ptr)c(orb,CORBA::Object_ptr)i
(obj\))30 1850 y({)130 1950 y(CosNaming::NamingContext_var)e
(rootContext;)130 2149 y(try)49 b({)229 2249 y(//)h(Obtain)e(a)i
(reference)e(to)i(the)f(root)g(context)f(of)i(the)f(Name)g(service:)229
2348 y(CORBA::Object_var)e(initServ;)229 2448 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)229
2647 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))229 2747 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)229 2847 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)229
2946 y(if)g(\(CORBA::is_nil\(rootContext\)\))329 3046
y({)428 3145 y(cerr)g(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)428 3245 y(return)f(0;)329 3345 y(})130 3444
y(})130 3544 y(catch\(CORBA::ORB::InvalidName&)44 b(ex\))49
b({)229 3644 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)e([does)h
(not)g(exist].")g(<<)g(endl;)229 3743 y(return)g(0;)130
3843 y(})130 4142 y(try)g({)229 4241 y(//)h(Bind)f(a)g(context)g
(called)g("test")f(to)i(the)f(root)g(context:)229 4441
y(CosNaming::Name)e(contextName;)229 4540 y(contextName.length\(1\);)
229 4640 y(contextName[0].id)147 b(=)49 b(\(const)g(char*\))g("test";)
197 b(//)50 b(string)f(copied)229 4740 y(contextName[0].kind)e(=)i
(\(const)g(char*\))g("my_context";)e(//)i(string)g(copied)229
4839 y(//)h(Note)f(on)g(kind:)g(The)g(kind)g(field)g(is)h(used)f(to)g
(indicate)g(the)g(type)229 4939 y(//)h(of)f(the)g(object.)g(This)g(is)g
(to)h(avoid)f(conventions)e(such)j(as)f(that)g(used)229
5038 y(//)h(by)f(files)g(\(name.type)f(--)h(e.g.)g(test.ps)g(=)h
(postscript)e(etc.\))229 5238 y(CosNaming::NamingContext_var)d
(testContext;)229 5337 y(try)k({)329 5437 y(//)g(Bind)g(the)h(context)e
(to)i(root,)e(and)i(assign)e(testContext)g(to)i(it:)329
5537 y(testContext)e(=)h(rootContext->bind_new_context\(context)o
(Name\))o(;)p eop
%%Page: 29 35
29 34 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(29)349 356 y Fc(})349 456 y
(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)449 555 y(//)g(If)h(the)f(context)g(already)f(exists,)h
(this)g(excep-)150 655 y(tion)g(will)g(be)h(raised.)449
754 y(//)f(In)h(this)f(case,)g(just)g(resolve)f(the)i(name)f(and)g
(assign)g(testContext)449 854 y(//)g(to)h(the)f(object)g(returned:)449
954 y(CORBA::Object_var)e(tmpobj;)449 1053 y(tmpobj)i(=)g
(rootContext->resolve\(contextName\);)449 1153 y(testContext)f(=)h
(CosNaming::NamingContext::_narrow\(tmp)o(obj\);)449
1253 y(if)g(\(CORBA::is_nil\(testContext\)\))c({)549
1352 y(cerr)k(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g(<<)i
(endl;)549 1452 y(return)e(0;)449 1551 y(})349 1651 y(})349
1850 y(//)i(Bind)f(the)g(object)g(\(obj\))g(to)g(testContext,)f(naming)
g(it)i(Echo:)349 1950 y(CosNaming::Name)d(objectName;)349
2050 y(objectName.length\(1\);)349 2149 y(objectName[0].id)147
b(=)49 b(\(const)g(char*\))g("Echo";)148 b(//)49 b(string)g(copied)349
2249 y(objectName[0].kind)e(=)i(\(const)g(char*\))g("Object";)f(//)h
(string)g(copied)349 2548 y(//)h(Bind)f(obj)g(with)g(name)g(Echo)g(to)h
(the)f(testContext:)349 2647 y(try)h({)449 2747 y
(testContext->bind\(objectName,obj\);)349 2847 y(})349
2946 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)449 3046 y(testContext->rebind\(objectName,obj\))o(;)349
3145 y(})349 3245 y(//)h(Note:)f(Using)f(rebind\(\))h(will)g(overwrite)
f(any)h(Object)g(previ-)150 3345 y(ously)g(bound)349
3444 y(//)349 b(to)49 b(/test/Echo)f(with)h(obj.)349
3544 y(//)349 b(Alternatively,)47 b(bind\(\))h(can)i(be)f(used,)g
(which)g(will)g(raise)g(a)349 3644 y(//)349 b
(CosNaming::NamingContext::Already)o(Bound)43 b(excep-)150
3743 y(tion)49 b(if)h(the)f(name)349 3843 y(//)349 b(supplied)48
b(is)h(already)g(bound)g(to)g(an)h(object.)349 4042 y(//)g(Amendment:)e
(When)h(using)g(OrbixNames,)e(it)j(is)f(neces-)150 4142
y(sary)g(to)h(first)e(try)i(bind)349 4241 y(//)g(and)f(then)g(rebind,)g
(as)g(rebind)g(on)g(it's)g(own)g(will)g(throw)g(a)h(Not-)150
4341 y(Foundexception)d(if)349 4441 y(//)j(the)f(Name)g(has)g(not)h
(already)e(been)h(bound.)g([This)g(is)g(incorrect)f(be-)150
4540 y(haviour)h(-)349 4640 y(//)h(it)f(should)g(just)g(bind].)250
4740 y(})250 4839 y(catch)g(\(CORBA::COMM_FAILURE&)c(ex\))50
b({)349 4939 y(cerr)f(<<)h("Caught)e(system)h(exception)f
(COMM_FAILURE,)f(unable)i(to)h(con-)150 5038 y(tact)f(the)g(")598
5138 y(<<)h("naming)e(service.")g(<<)i(endl;)349 5238
y(return)f(0;)250 5337 y(})250 5437 y(catch)g
(\(omniORB::fatalException&)c(ex\))k({)349 5537 y(throw;)p
eop
%%Page: 30 36
30 35 bop 30 100 a Fr(30)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)130 356 y Fc(})130 456 y(catch)48 b(\(...\))h({)229
555 y(cerr)g(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)30 655 y(vice."<<)g(endl;)229 754
y(return)h(0;)130 854 y(})130 954 y(return)f(1;)30 1053
y(})p eop
%%Page: 31 37
31 36 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(31)150 356 y Fh(2.1)l(1.7)99 b(eg3)p 656 356 30
4 v 36 w(clt.cc)150 568 y Fc(//)49 b(eg3_clt.cc)f(-)i(This)f(is)h(the)f
(source)f(code)i(of)f(example)f(3)i(used)f(in)h(Chap-)150
668 y(ter)f(2)150 768 y(//)697 b("The)49 b(Basics")g(of)g(the)g
(omniORB2)g(user)g(guide.)150 867 y(//)150 967 y(//)697
b(This)49 b(is)h(the)f(client.)f(It)i(uses)f(the)g(COSS)g(naming)g
(service)150 1067 y(//)697 b(to)49 b(obtain)g(the)g(object)g
(reference.)150 1166 y(//)150 1266 y(//)g(Usage:)g(eg3_clt)150
1365 y(//)150 1465 y(//)150 1565 y(//)398 b(On)50 b(startup,)e(the)h
(client)g(lookup)g(the)g(object)f(refer-)150 1664 y(ence)h(from)g(the)
150 1764 y(//)398 b(COS)49 b(naming)g(service.)150 1864
y(//)150 1963 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i
(bound)f(to)g(is)g(as)h(follows:)150 2063 y(//)697 b(root)99
b([context])150 2163 y(//)747 b(|)150 2262 y(//)697 b(text)99
b([context])48 b(kind)h([my_context])150 2362 y(//)747
b(|)150 2461 y(//)697 b(Echo)99 b([object])f(kind)49
b([Object])150 2561 y(//)150 2760 y(#include)f(<iostream.h>)150
2860 y(#include)g("echo.hh")150 3059 y(#include)g("greeting.cc")150
3258 y(extern)h(void)g(hello\(CORBA::Object_ptr)c(obj\);)150
3458 y(static)k(CORBA::Object_ptr)d(getObjectReference\(CORBA::ORB_ptr)
e(orb\);)150 3657 y(int)150 3757 y(main)49 b(\(int)g(argc,)g(char)g
(**argv\))150 3856 y({)250 3956 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 4055
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 4255 y(try)f({)349 4354 y(CORBA::Object_var)e(obj)i(=)h
(getObjectReference\(orb\);)349 4454 y(hello\(obj\);)250
4554 y(})250 4653 y(catch\(CORBA::COMM_FAILURE&)45 b(ex\))k({)349
4753 y(cerr)g(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 4852 y(tact)f(the)g(")598 4952
y(<<)h("object.")e(<<)h(endl;)250 5052 y(})250 5151 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)349
5251 y(cerr)g(<<)h("Caught)e(omniORB2)h(fatalException.)e(This)i(indi-)
150 5351 y(cates)g(a)h(bug)f(is)g(caught)g(")598 5450
y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h(bug)f(report.\\n")598
5550 y(<<)h("The)f(exception)f(was)h(thrown)g(in)g(file:)g(")h(<<)f
(ex.file\(\))f(<<)i("\\n")p eop
%%Page: 32 38
32 37 bop 30 100 a Fr(32)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)478 356 y Fc(<<)50 b(")1394 b(line:)49
b(")h(<<)f(ex.line\(\))f(<<)i("\\n")478 456 y(<<)g("The)f(error)g
(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)j(endl;)130
555 y(})130 655 y(catch\(...\))e({)229 754 y(cerr)h(<<)h("Caught)e(a)i
(system)f(exception.")e(<<)j(endl;)130 854 y(})130 1053
y(orb->NP_destory\(\);)130 1253 y(return)e(0;)30 1352
y(})30 1551 y(static)30 1651 y(CORBA::Object_ptr)30 1751
y(getObjectReference\(CORBA::ORB_ptr)c(orb\))30 1850
y({)130 1950 y(CosNaming::NamingContext_var)g(rootContext;)130
2149 y(try)49 b({)229 2249 y(//)h(Obtain)e(a)i(reference)e(to)i(the)f
(root)g(context)f(of)i(the)f(Name)g(service:)229 2348
y(CORBA::Object_var)e(initServ;)229 2448 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)229
2647 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))229 2747 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)229 2847 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)229
2946 y(if)g(\(CORBA::is_nil\(rootContext\)\))329 3046
y({)428 3145 y(cerr)g(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)428 3245 y(return)f(CORBA::Object::_nil\(\);)329
3345 y(})130 3444 y(})130 3544 y(catch\(CORBA::ORB::InvalidName&)44
b(ex\))49 b({)229 3644 y(cerr)g(<<)h("Service)e(required)g(is)i
(invalid)e([does)h(not)g(exist].")g(<<)g(endl;)229 3743
y(return)g(CORBA::Object::_nil\(\);)130 3843 y(})130
4142 y(//)g(Create)g(a)g(name)g(object,)g(containing)f(the)h(name)g
(test/context:)130 4241 y(CosNaming::Name)e(name;)130
4341 y(name.length\(2\);)130 4540 y(name[0].id)147 b(=)50
b(\(const)f(char*\))f("test";)348 b(//)49 b(string)g(copied)130
4640 y(name[0].kind)e(=)j(\(const)f(char*\))f("my_context";)g(//)h
(string)g(copied)130 4740 y(name[1].id)147 b(=)50 b(\(const)f(char*\))f
("Echo";)130 4839 y(name[1].kind)f(=)j(\(const)f(char*\))f("Object";)
130 4939 y(//)h(Note)g(on)h(kind:)e(The)i(kind)f(field)g(is)g(used)g
(to)h(indicate)e(the)h(type)130 5038 y(//)g(of)g(the)h(object.)e(This)h
(is)h(to)f(avoid)g(conventions)f(such)h(as)g(that)g(used)130
5138 y(//)g(by)g(files)g(\(name.type)f(--)i(e.g.)f(test.ps)f(=)i
(postscript)e(etc.\))130 5437 y(CORBA::Object_ptr)e(obj;)130
5537 y(try)j({)p eop
%%Page: 33 39
33 38 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(33)349 356 y Fc(//)50 b(Resolve)e(the)h(name)h(to)f(an)g(object)g
(reference,)f(and)h(as-)150 456 y(sign)g(the)g(reference)349
555 y(//)h(returned)e(to)h(a)h(CORBA::Object:)349 655
y(obj)g(=)f(rootContext->resolve\(name\);)250 754 y(})250
854 y(catch\(CosNaming::NamingContext::N)o(otFoun)o(d&)44
b(ex\))349 954 y({)449 1053 y(//)49 b(This)g(exception)g(is)g(thrown)g
(if)g(any)g(of)h(the)f(components)f(of)h(the)449 1153
y(//)g(path)g([contexts)g(or)g(the)g(object])g(aren't)f(found:)449
1253 y(cerr)h(<<)g("Context)g(not)g(found.")f(<<)i(endl;)449
1352 y(return)f(CORBA::Object::_nil\(\);)349 1452 y(})250
1551 y(catch)g(\(CORBA::COMM_FAILURE&)c(ex\))50 b({)349
1651 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 1751 y(tact)f(the)g(")598 1850
y(<<)h("naming)e(service.")g(<<)i(endl;)349 1950 y(return)f
(CORBA::Object::_nil\(\);)250 2050 y(})250 2149 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)349
2249 y(throw;)250 2348 y(})250 2448 y(catch)g(\(...\))f({)349
2548 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)150 2647 y(vice."<<)g(endl;)349
2747 y(return)h(CORBA::Object::_nil\(\);)250 2847 y(})250
2946 y(return)f(obj;)150 3046 y(})p eop
%%Page: 34 40
34 39 bop 30 100 a Fr(34)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fh(2.1)l(1.8)99 b(eg3)p 536
356 30 4 v 36 w(tieimpl.cc)30 568 y Fc(//)49 b(eg3_tieimpl.cc)f(-)h
(This)g(example)g(is)g(similar)g(to)g(eg3_impl.cc)f(ex-)30
668 y(cept)h(that)30 768 y(//)896 b(the)50 b(tie)f(implementation)e
(skeleton)h(is)i(used.)30 867 y(//)30 967 y(//)747 b(This)49
b(is)g(the)h(object)e(implementation.)30 1067 y(//)30
1166 y(//)h(Usage:)g(eg3_tieimpl)30 1266 y(//)30 1365
y(//)398 b(On)50 b(startup,)e(the)h(object)g(reference)f(is)h
(registered)f(with)h(the)30 1465 y(//)398 b(COS)49 b(naming)g(service.)
f(The)i(client)e(uses)h(the)h(naming)e(service)h(to)30
1565 y(//)398 b(locate)49 b(this)g(object.)30 1664 y(//)30
1764 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)i(bound)f(to)
g(is)g(as)h(follows:)30 1864 y(//)697 b(root)99 b([context])30
1963 y(//)747 b(|)30 2063 y(//)697 b(text)99 b([context])48
b(kind)h([my_context])30 2163 y(//)747 b(|)30 2262 y(//)697
b(Echo)99 b([object])f(kind)49 b([Object])30 2362 y(//)30
2561 y(#include)f(<iostream.h>)30 2661 y(#include)g("omnithread.h")30
2760 y(#include)g("echo.hh")30 3059 y(//)h(Real)g(implementation,)f
(notice)g(that)h(it)h(does)f(not)g(in-)30 3159 y(herit)g(from)g(any)g
(stub)g(class)30 3258 y(class)g(Echo_i)g({)30 3358 y(public:)130
3458 y(Echo_i\(\))f({})130 3557 y(virtual)g(\230Echo_i\(\))g({})130
3657 y(virtual)g(char)h(*)h(echoString\(const)d(char)i(*mesg\);)30
3757 y(};)30 3956 y(char)g(*)30 4055 y(Echo_i::echoString\(const)c
(char)k(*mesg\))g({)130 4155 y(char)g(*p)g(=)h
(CORBA::string_dup\(mesg\);)130 4255 y(return)e(p;)30
4354 y(})30 4653 y(static)h(CORBA::Boolean)e
(bindObjectToName\(CORBA::ORB_ptr,COR)o(BA::O)o(bject)o(_ptr\);)30
4852 y(int)30 4952 y(main\(int)h(argc,)h(char)g(**argv\))30
5052 y({)130 5151 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 5251
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 5450 y(Echo_i)e(*myimpl)h(=)g(new)h(Echo_i\(\);)130
5550 y(_tie_Echo<Echo_i,1>)c(*myobj)j(=)g(new)g
(_tie_Echo<Echo_i,1>\(myimpl\);)p eop
%%Page: 35 41
35 40 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(35)250 356 y Fc(myobj->_obj_is_ready\(boa\);)250
555 y({)349 655 y(Echo_var)49 b(myobjRef)f(=)i(myobj->_this\(\);)349
754 y(if)g(\(!bindObjectToName\(orb,myobjRef\)\))43 b({)449
854 y(return)49 b(1;)349 954 y(})250 1053 y(})250 1253
y(boa->impl_is_ready\(\);)250 1352 y(//)g(Tell)g(the)g(BOA)h(we)f(are)g
(ready.)g(The)g(BOA's)g(default)g(be-)150 1452 y(haviour)g(is)g(to)g
(block)250 1551 y(//)g(on)h(this)f(call)g(indefinitely.)250
1751 y(return)f(0;)150 1850 y(})150 2149 y(static)150
2249 y(CORBA::Boolean)150 2348 y(bindObjectToName\(CORBA::ORB_ptr)c
(orb,CORBA::Object_ptr)i(obj\))150 2448 y({)250 2548
y(CosNaming::NamingContext_var)e(rootContext;)250 2747
y(try)49 b({)349 2847 y(//)h(Obtain)e(a)i(reference)e(to)i(the)f(root)g
(context)f(of)i(the)f(Name)g(service:)349 2946 y(CORBA::Object_var)e
(initServ;)349 3046 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)349
3245 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))349 3345 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)349 3444 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)349
3544 y(if)g(\(CORBA::is_nil\(rootContext\)\))449 3644
y({)549 3743 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)549 3843 y(return)e(0;)449 3942 y(})250 4042
y(})250 4142 y(catch\(CORBA::ORB::InvalidName&)c(ex\))49
b({)349 4241 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)e([does)h
(not)g(exist].")g(<<)g(endl;)349 4341 y(return)g(0;)250
4441 y(})250 4740 y(try)g({)349 4839 y(//)h(Bind)f(a)g(context)g
(called)g("test")f(to)i(the)f(root)g(context:)349 5038
y(CosNaming::Name)e(contextName;)349 5138 y(contextName.length\(1\);)
349 5238 y(contextName[0].id)147 b(=)49 b(\(const)g(char*\))g("test";)
197 b(//)50 b(string)f(copied)349 5337 y(contextName[0].kind)e(=)i
(\(const)g(char*\))g("my_context";)e(//)i(string)g(copied)349
5437 y(//)h(Note)f(on)g(kind:)g(The)g(kind)g(field)g(is)h(used)f(to)g
(indicate)g(the)g(type)349 5537 y(//)h(of)f(the)g(object.)g(This)g(is)g
(to)h(avoid)f(conventions)e(such)j(as)f(that)g(used)p
eop
%%Page: 36 42
36 41 bop 30 100 a Fr(36)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)229 356 y Fc(//)50 b(by)f(files)g(\(name.type)f(--)h
(e.g.)g(test.ps)g(=)h(postscript)e(etc.\))229 555 y
(CosNaming::NamingContext_var)d(testContext;)229 655
y(try)k({)329 754 y(//)g(Bind)g(the)h(context)e(to)i(root,)e(and)i
(assign)e(testContext)g(to)i(it:)329 854 y(testContext)e(=)h
(rootContext->bind_new_context\(context)o(Name\))o(;)229
954 y(})229 1053 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o
(nd&)44 b(ex\))49 b({)329 1153 y(//)g(If)h(the)f(context)g(already)f
(exists,)h(this)g(excep-)30 1253 y(tion)g(will)g(be)h(raised.)329
1352 y(//)f(In)h(this)f(case,)g(just)g(resolve)f(the)i(name)f(and)g
(assign)g(testContext)329 1452 y(//)g(to)h(the)f(object)g(returned:)329
1551 y(CORBA::Object_var)e(tmpobj;)329 1651 y(tmpobj)i(=)g
(rootContext->resolve\(contextName\);)329 1751 y(testContext)f(=)h
(CosNaming::NamingContext::_narrow\(tmp)o(obj\);)329
1850 y(if)g(\(CORBA::is_nil\(testContext\)\))c({)428
1950 y(cerr)50 b(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g(<<)i
(endl;)428 2050 y(return)f(0;)329 2149 y(})229 2249 y(})229
2448 y(//)h(Bind)f(the)g(object)g(\(obj\))g(to)g(testContext,)f(naming)
g(it)i(Echo:)229 2548 y(CosNaming::Name)d(objectName;)229
2647 y(objectName.length\(1\);)229 2747 y(objectName[0].id)147
b(=)49 b(\(const)g(char*\))g("Echo";)148 b(//)49 b(string)g(copied)229
2847 y(objectName[0].kind)e(=)i(\(const)g(char*\))g("Object";)f(//)h
(string)g(copied)229 3145 y(//)h(Bind)f(obj)g(with)g(name)g(Echo)g(to)h
(the)f(testContext:)229 3245 y(try)g({)329 3345 y
(testContext->bind\(objectName,obj\);)229 3444 y(})229
3544 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)329 3644 y(testContext->rebind\(objectName,obj\))o(;)229
3743 y(})229 3843 y(//)h(Note:)f(Using)f(rebind\(\))h(will)g(overwrite)
f(any)h(Object)g(previ-)30 3942 y(ously)g(bound)229 4042
y(//)349 b(to)49 b(/test/Echo)f(with)h(obj.)229 4142
y(//)349 b(Alternatively,)47 b(bind\(\))h(can)i(be)f(used,)g(which)g
(will)g(raise)g(a)229 4241 y(//)349 b
(CosNaming::NamingContext::Already)o(Bound)43 b(excep-)30
4341 y(tion)49 b(if)g(the)h(name)229 4441 y(//)349 b(supplied)48
b(is)h(already)g(bound)g(to)g(an)h(object.)229 4640 y(//)g(Amendment:)e
(When)h(using)g(OrbixNames,)e(it)j(is)f(neces-)30 4740
y(sary)g(to)g(first)g(try)h(bind)229 4839 y(//)g(and)f(then)g(rebind,)g
(as)g(rebind)g(on)g(it's)g(own)g(will)g(throw)g(a)h(Not-)30
4939 y(Foundexception)d(if)229 5038 y(//)j(the)f(Name)g(has)g(not)h
(already)e(been)h(bound.)g([This)g(is)g(incorrect)f(be-)30
5138 y(haviour)g(-)229 5238 y(//)i(it)f(should)g(just)g(bind].)130
5337 y(})130 5437 y(catch)f(\(CORBA::COMM_FAILURE&)e(ex\))k({)229
5537 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)p eop
%%Page: 37 43
37 42 bop 150 100 a Fd(2.1)-5 b(1.)52 b(SOURCE)22 b(LISTING)2341
b Fr(37)150 356 y Fc(tact)49 b(the)g(")598 456 y(<<)h("naming)e
(service.")g(<<)i(endl;)349 555 y(return)f(0;)250 655
y(})250 754 y(catch)g(\(omniORB::fatalException&)c(ex\))k({)349
854 y(throw;)250 954 y(})250 1053 y(catch)g(\(...\))f({)349
1153 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)150 1253 y(vice."<<)g(endl;)349
1352 y(return)h(0;)250 1452 y(})250 1551 y(return)f(1;)150
1651 y(})p eop
%%Page: 38 44
38 43 bop 30 100 a Fr(38)2224 b Fd(CHAPTER)21 b(2.)52
b(THE)21 b(BASICS)30 356 y Fh(2.1)l(1.9)99 b(dir)-5 b(.mk)30
514 y Fc(#)50 b(dir.mk)e(-)i(This)f(is)g(the)h(makefile)e(to)h(compile)
g(all)g(the)g(example)g(pro-)30 614 y(grams)g(used)g(in)30
713 y(#)498 b(Chapter)48 b(2)i(The)f(Basics.)30 813 y(#)498
b(This)49 b(makefile)f(is)i(to)f(be)h(used)f(under)g(the)g(OMNI)g
(develop-)30 912 y(ment)g(environment.)30 1012 y(#)30
1112 y(CXXSRCS)f(=)i(greeting.cc)e(eg1.cc)h(\\)528 1211
y(eg2_impl.cc)f(eg2_clt.cc)g(\\)528 1311 y(eg3_impl.cc)g(eg3_clt.cc)30
1510 y(DIR_CPPFLAGS)g(=)h($\(CORBA_CPPFLAGS\))30 1709
y(CORBA_INTERFACES)e(=)i(echo)30 1909 y(eg1)398 b(=)50
b($\(patsubst)e(\045,$\(BinPattern\),eg1\))30 2008 y(eg2_impl)148
b(=)50 b($\(patsubst)e(\045,$\(BinPattern\),eg2_impl\))30
2108 y(eg2_clt)198 b(=)50 b($\(patsubst)e
(\045,$\(BinPattern\),eg2_clt\))30 2208 y(eg3_impl)148
b(=)50 b($\(patsubst)e(\045,$\(BinPattern\),eg3_impl\))30
2307 y(eg3_clt)198 b(=)50 b($\(patsubst)e
(\045,$\(BinPattern\),eg3_clt\))30 2507 y(all::)h($\(eg1\))g
($\(eg2_impl\))e($\(eg2_clt\))98 b($\(eg3_impl\))48 b($\(eg3_clt\))30
2706 y(clean::)428 2805 y($\(RM\))h($\(eg1\))g($\(eg2_impl\))f
($\(eg2_clt\))g($\(eg3_impl\))g($\(eg3_clt\))30 3005
y($\(eg1\):)g(eg1.o)h($\(CORBA_STUB_OBJS\))e($\(CORBA_LIB_DEPEND\))428
3104 y(@\(libs="$\(CORBA_LIB\)";)f($\(CXXExecutable\)\))30
3304 y($\(eg2_impl\):)i(eg2_impl.o)g($\(CORBA_STUB_OBJS\))e
($\(CORBA_LIB_DEPEND\))428 3403 y(@\(libs="$\(CORBA_LIB\)";)g
($\(CXXExecutable\)\))30 3602 y($\(eg2_clt\):)i(eg2_clt.o)g
($\(CORBA_STUB_OBJS\))e($\(CORBA_LIB_DEPEND\))428 3702
y(@\(libs="$\(CORBA_LIB\)";)g($\(CXXExecutable\)\))30
3901 y($\(eg3_impl\):)i(eg3_impl.o)g($\(CORBA_STUB_OBJS\))e
($\(CORBA_LIB_DEPEND\))428 4001 y(@\(libs="$\(CORBA_LIB\)";)g
($\(CXXExecutable\)\))30 4200 y($\(eg3_clt\):)i(eg3_clt.o)g
($\(CORBA_STUB_OBJS\))e($\(CORBA_LIB_DEPEND\))428 4300
y(@\(libs="$\(CORBA_LIB\)";)g($\(CXXExecutable\)\))p
eop
%%Page: 39 45
39 44 bop 150 979 a Fk(Chapter)44 b(3)150 1394 y Fm(IDL)52
b(to)g(C++)g(Language)g(Mapping)150 1855 y Fr(Now)24
b(that)h(you)f(ar)n(e)i(familiar)i(with)d(the)f(basics,)i(it)g(is)f
(important)g(to)f(familiar)k(yourselves)23 b(with)150
1968 y(the)30 b(IDL)g(to)g(C++)h(language.)51 b(The)30
b(mapping)h(is)f(described)g(in)h(detail)f(in)h([OMG99a)s(].)51
b(If)31 b(you)150 2081 y(have)36 b(not)g(done)f(so,)j(you)d(should)h
(obtain)g(a)h(copy)e(of)h(the)g(document)f(and)h(use)f(that)h(as)g(the)
150 2194 y(pr)n(ogramming)23 b(guide)e(to)h(omniORB2.)291
2307 y(The)31 b(speci\002cation)g(is)h(not)e(an)i(easy)e(r)n(ead.)54
b(The)31 b(alternative)h(is)f(to)g(use)f(one)h(of)g(the)f(books)150
2420 y(on)36 b(CORBA)g(pr)n(ogramming)h(that)f(has)g(begun)f(to)h
(appear)-7 b(.)69 b(For)35 b(instance,)40 b(the)35 b(\223Advanced)150
2533 y(CORBA)18 b(Pr)n(ogramming)h(with)f(C++\224)h(by)f(Michi)h
(Henning)e(and)i(Steve)e(V)-5 b(inoski)17 b(includes)h(many)150
2646 y(example)23 b(code)e(bits)i(to)f(illustrate)h(how)f(to)g(use)f
(the)h(CORBA)h(2.3)g(C++)h(mapping.)150 2944 y Fi(3.1)119
b(Incompatibilities)29 b(with)g(pre-2.8.0)f(releases)150
3155 y Fr(Befor)n(e)i(2.8.0,)k(omniORB2)e(implements)f(the)g(CORBA)g
(2.0)h(C++)g(mapping.)54 b(Since)32 b(2.8.0,)i(the)150
3268 y(mapping)20 b(has)g(been)g(updated)e(to)i(CORBA)g(2.3.)27
b(Unfortunately)-10 b(,)19 b(to)h(comply)g(with)g(the)f(CORBA)150
3381 y(2.3)29 b(speci\002cation,)h(it)f(is)f(necessary)f(to)h(change)h
(the)e(semantics)i(of)f(a)h(few)f(APIs)g(in)h(a)g(way)f(that)150
3494 y(is)23 b(incompatible)i(with)e(older)f(omniORB2)i(r)n(eleases.)29
b(The)22 b(incompatible)i(changes)f(ar)n(e)h(limited)150
3607 y(to:)264 3819 y(1.)45 b(the)22 b(extraction)g(of)h(string,)e
(object)i(r)n(efer)n(ence)f(and)g(typecode)f(fr)n(om)i(an)g(Any)-10
b(.)264 4007 y(2.)45 b(the)34 b(DII)g(interface)g(now)g(defaults)f(to)h
(r)n(eport)f(a)i(system)d(exception)h(by)h(raising)h(a)f(C++)377
4120 y(exception)22 b(instead)f(of)i(r)n(eturning)f(the)g(exception)f
(as)i(an)g(envir)n(onment)f(value.)291 4333 y(The)33
b(changes)g(ar)n(e)h(minor)h(and)e(r)n(equir)n(es)h(minimal)i(changes)d
(to)g(the)g(application)i(sour)n(ce)150 4445 y(code.)48
b Fl(However)-5 b(,)31 b(it)g(is)f(not)f(possible)h(to)g(detect)h(the)f
(old)g(usage)g(at)g(compile)g(time.)50 b(In)30 b(par)n(-)150
4558 y(ticular)-5 b(,)24 b(unmodi\002ed)c(code)j(that)g(use)g(the)f(af)
n(fected)k(Any)21 b(extraction)j(operators)g(would)d(most)150
4671 y(certainly)j(cause)g(runtime)f(errors)h(to)f(occur)-5
b(.)291 4784 y Fr(T)d(o)34 b(smooth)g(the)h(transition)f(fr)n(om)i(the)
e(old)h(usage)f(to)h(the)f(new)-8 b(,)37 b(an)f(ORB)f(con\002guration)
150 4897 y(variable)24 b Fn(omniORB::omniO)o(RB)p 1381
4897 28 4 v 26 w(27)p 1517 4897 V 32 w(CompatibleAnyEx)o(tr)o(ac)o(tio)
o(n)16 b Fr(can)22 b(be)g(set)f(to)g(r)n(evert)150 5010
y(the)26 b(any)g(extraction)g(operators)f(to)g(the)h(old)g(semantics.)
39 b(Mor)n(e)26 b(information)h(can)h(be)e(found)g(in)150
5123 y(chapter)c(9.)1815 5778 y(39)p eop
%%Page: 40 46
40 45 bop 30 100 a Fr(40)1223 b Fd(CHAPTER)22 b(3.)51
b(IDL)22 b(T)n(O)h(C++)h(LANGUAGE)d(MAPPING)p eop
%%Page: 41 47
41 46 bop 150 979 a Fk(Chapter)44 b(4)150 1394 y Fm(The)52
b(omniORB2)f(API)150 1839 y Fr(In)19 b(this)g(chapter)-7
b(,)19 b(we)f(intr)n(oduce)h(the)f(omniORB2)i(API.)e(The)h(purpose)d
(of)k(this)e(API)h(is)g(to)g(pr)n(ovide)150 1952 y(access)h(points)g
(to)f(omniORB2)i(speci\002c)g(functionalities)g(that)f(ar)n(e)h(not)e
(cover)n(ed)h(by)g(the)g(CORBA)150 2065 y(speci\002cation.)61
b(Obviously)-10 b(,)36 b(if)f(you)d(use)h(this)g(API)g(in)h(your)f
(application,)k(that)c(part)h(of)f(your)150 2178 y(code)24
b(is)i(not)e(going)h(to)f(be)i(portable)f(to)f(r)o(un)h(unchanged)g(on)
g(other)f(vendors')g(ORBs.)35 b(T)-8 b(o)24 b(make)150
2291 y(it)29 b(easier)g(to)g(identify)g(omniORB2)h(dependent)c(code,)k
(this)f(API)f(is)i(de\002ned)d(under)h(the)h(name)150
2404 y(space)22 b(\223omniORB\224)882 2371 y Fj(1)921
2404 y Fr(.)150 2703 y Fi(4.1)119 b(ORB)30 b(and)f(BOA)g
(initialisation)g(options)150 2914 y Fn(CORBA::ORB)p
705 2914 28 4 v 28 w(init)21 b Fr(accepts)h(the)g(following)h
(command-line)h(ar)n(guments:)150 3128 y Fn(-ORBid)52
b(``omniORB2'')40 b Fr(The)22 b(identi\002er)f(supplied)h(must)g(be)g
(\223omniORB2\224.)150 3316 y Fn(-ORBtraceLevel)48 b(<level>)42
b Fr(See)22 b(section)g(4.2.)150 3504 y Fn(-ORBserverName)48
b(<string>)42 b Fr(See)22 b(section)f(4.3.)150 3692 y
Fn(-ORBtcAliasExpa)o(nd)48 b(<0)53 b(or)h(1>)45 b Fr(See)21
b(section)h(9.2.)150 3880 y Fn(-ORBgiopMaxMsgS)o(iz)o(e)48
b(<size)53 b(in)g(bytes>)43 b Fr(See)22 b(section)f(4.5.)150
4069 y Fn(-ORBInitialHost)48 b(<string>)42 b Fr(See)21
b(section)h(4.6.)150 4257 y Fn(-ORBInitialPort)48 b(<1-65535>)41
b Fr(See)22 b(section)f(4.6.)150 4445 y Fn(-ORBdiiThrowsSy)o(sE)o(xc)o
(ep)o(tio)o(ns)48 b(<0)53 b(or)h(1>)45 b Fr(See)21 b(section)h(1)-5
b(1.4.)150 4633 y Fn(-ORBinConScanPe)o(ri)o(od)48 b(<0-max)k(integer>)
42 b Fr(See)21 b(section)h(7.3.)150 4821 y Fn(-ORBoutConScanP)o(er)o
(io)o(d)48 b(<0-max)k(integer>)42 b Fr(See)22 b(section)f(7.3.)150
5009 y Fn(-ORBclientCallT)o(im)o(eO)o(ut)o(Per)o(io)o(d)48
b(<0-max)k(integer>)42 b Fr(See)21 b(section)h(7.3.)150
5198 y Fn(-ORBserverCallT)o(im)o(eO)o(ut)o(Per)o(io)o(d)48
b(<0-max)k(integer>)42 b Fr(See)21 b(section)h(7.3.)150
5386 y Fn(-ORBscanGranula)o(ri)o(ty)48 b(<0-max)k(integer>)42
b Fr(See)21 b(section)h(7.3.)p 150 5462 1368 4 v 255
5518 a Fg(1)284 5550 y Ff(omniORB)c(is)h(a)g(class)f(name)h(if)g(the)g
(C++)g(compiler)e(does)h(not)h(support)f(the)i(namespace)f(keywor)o(d.)
1815 5778 y Fr(41)p eop
%%Page: 42 48
42 47 bop 30 100 a Fr(42)1865 b Fd(CHAPTER)21 b(4.)52
b(THE)21 b(OMNIORB2)i(API)30 356 y Fn(-ORBverifyObjec)o(tE)o(xi)o(st)o
(sAn)o(dT)o(yp)o(e)48 b(<0)54 b(or)g(1>)44 b Fr(See)22
b(section)g(4.7.)30 546 y Fn(-ORBlcdMode)40 b Fr(See)22
b(secion)g(4.7)30 735 y Fn(-ORBabortOnInte)o(rn)o(al)o(Er)o(ror)48
b(<0)53 b(or)h(1>)44 b Fr(See)22 b(section)g(4.8.)30
925 y Fn(-ORBhelp)42 b Fr(List)22 b(all)i(ORB)e(command)h(line)h
(options.)171 1140 y Fn(BOA)p 341 1140 28 4 v 31 w(init)d
Fr(accepts)i(the)e(following)i(command-line)h(ar)n(guments:)30
1355 y Fn(-BOAid)52 b(``omniORB2)p 967 1355 V 28 w(BOA'')43
b Fr(The)22 b(identi\002er)g(supplied)f(must)h(be)h(\223omniORB2)p
3087 1355 V 33 w(BOA)-7 b(\224.)30 1545 y Fn(-BOAiiop)p
475 1545 V 29 w(port)53 b(<port)f(number>)42 b Fr(This)23
b(option)f(tells)h(the)f(BOA)h(which)h(TCP/IP)f(port)f(to)257
1658 y(use)35 b(to)g(accept)h(IIOP)f(calls.)69 b(If)35
b(this)h(option)e(is)i(not)f(speci\002ed,)j(the)c(BOA)i(will)h(use)e
(an)257 1771 y(arbitrary)24 b(port)d(assigned)g(by)i(the)f(operating)f
(system.)30 1961 y Fn(-BOAno)p 365 1961 V 30 w(bootstrap)p
890 1961 V 29 w(agent)43 b Fr(See)21 b(section)h(4.6.)30
2150 y Fn(-BOAiiop)p 475 2150 V 29 w(name)p 724 2150
V 31 w(port)53 b(<hostname[:por)o(t)48 b(number]>)42
b Fr(This)27 b(options)f(tells)h(the)f(BOA)257 2263 y(the)c(hostname)g
(and)g(optionally)h(the)f(port)f(number)i(to)f(use.)27
b(See)21 b(below)i(for)f(details.)30 2453 y Fn(-BOAhelp)42
b Fr(List)22 b(all)i(BOA)e(command)h(line)h(options.)171
2668 y(By)19 b(default,)h(the)f(BOA)h(can)g(work)f(out)g(the)g(IP)g
(addr)n(ess)g(of)h(the)f(host)f(machine.)28 b(This)20
b(addr)n(ess)30 2781 y(is)28 b(r)n(ecor)n(ded)f(in)i(the)e(object)h(r)n
(efer)n(ences)f(of)h(the)f(local)j(objects.)43 b(However)-7
b(,)28 b(when)g(the)f(host)g(has)30 2894 y(multiple)35
b(network)e(interfaces)h(and)h(multiple)g(IP)g(addr)n(esses,)g(it)g
(may)g(be)g(desirable)f(for)h(the)30 3007 y(application)21
b(to)e(contr)n(ol)g(what)h(addr)n(ess)e(the)h(BOA)g(should)g(use.)26
b(This)19 b(can)i(be)e(done)g(by)g(de\002ning)30 3120
y(the)f(envir)n(onment)f(variable)k Fn(OMNIORB)p 1444
3120 V 29 w(USEHOSTNAME)14 b Fr(to)j(contain)i(the)f(pr)n(eferr)n(ed)f
(host)g(name)30 3233 y(or)23 b(IP)h(addr)n(ess)e(in)j(dot-numeric)e
(form.)32 b(Alternatively)-10 b(,)23 b(the)g(same)h(can)h(be)f
(acheived)g(using)f(the)30 3346 y Fn(-BOAiiop)p 475 3346
V 29 w(name)p 724 3346 V 31 w(port)e Fr(option.)171 3459
y(As)e(de\002ned)g(in)h(the)f(CORBA)h(speci\002cation,)g(any)g
(command-line)h(ar)n(guments)e(understood)30 3572 y(by)g(the)f(ORB/BOA)
h(will)h(be)f(r)n(emoved)f(fr)n(om)i Fn(argv)d Fr(when)h(the)h
(initialisation)i(functions)d(r)n(eturn.)30 3685 y(Ther)n(efor)n(e,)32
b(an)f(application)h(is)f(not)f(r)n(equir)n(ed)h(to)f(handle)h(any)g
(command-line)h(ar)n(guments)e(it)30 3798 y(does)21 b(not)h
(understand.)30 4100 y Fi(4.2)119 b(Run-time)30 b(T)-13
b(racing)29 b(and)h(Diagnostic)f(Messages)30 4312 y Fr(OmniORB2)j(uses)
d(the)h(C++)h(iostr)n(eam)g Fn(cerr)e Fr(to)h(output)f(any)h(tracing)h
(and)g(diagnostic)f(mes-)30 4425 y(sages.)63 b(Some)34
b(or)h(all)h(of)f(these)e(messages)g(can)j(be)e(turned-on/of)n(f)g(by)h
(setting)e(the)h(variable)30 4538 y Fn(omniORB::traceL)o(ev)o(el)o
Fr(.)22 b(The)g(type)f(de\002nition)h(of)h(the)f(variable)i(is:)30
4740 y Fc(CORBA::ULong)48 b(omniORB::traceLevel)e(=)j(1;)100
b(//)49 b(The)g(default)g(value)g(is)g(1)171 4955 y Fr(At)22
b(the)g(moment,)g(the)g(following)g(trace)h(levels)g(ar)n(e)g
(de\002ned:)30 5170 y Fl(level)h(0)46 b Fr(turn)22 b(of)n(f)h(all)h
(tracing)f(and)g(informational)h(messages)30 5360 y Fl(level)g(1)46
b Fr(informational)24 b(messages)d(only)30 5550 y Fl(level)j(2)46
b Fr(the)21 b(above)i(plus)g(con\002guration)f(information)p
eop
%%Page: 43 49
43 48 bop 150 100 a Fd(4.3.)51 b(SER)-5 b(VER)21 b(NAME)2489
b Fr(43)150 356 y Fl(level)24 b(5)46 b Fr(the)28 b(above)h(plus)g
(noti\002cations)f(when)h(server)f(thr)n(eads)g(ar)n(e)h(cr)n(eated)g
(or)f(communica-)377 469 y(tion)23 b(endpoints)d(ar)n(e)j(shutdown)150
665 y Fl(level)h(10-20)47 b Fr(the)22 b(above)h(plus)f(execution)g
(traces)150 861 y Fl(level)i(25)46 b Fr(the)32 b(above)g(plus)g(hex)g
(dump)f(of)i(all)g(data)g(sent)e(and)h(r)n(eceived)g(by)g(the)g(ORB)g
(via)h(its)377 974 y(network)21 b(connections.)291 1197
y(The)e(variable)j(can)f(be)f(changed)f(by)h(assignment)f(inside)g
(your)g(applications.)28 b(It)19 b(can)i(also)f(be)150
1310 y(changed)26 b(by)g(specifying)g(the)g(command-line)i(option:)34
b Fn(-ORBtraceLevel)48 b(<level>)p Fr(.)37 b(For)150
1423 y(instance:)150 1635 y Fc($)50 b(eg2_impl)e(-ORBtraceLevel)f(5)150
1947 y Fi(4.3)119 b(Server)29 b(Name)150 2162 y Fr(Applications)18
b(can)i(optionally)e(speci\002ed)f(a)i(name)g(to)f(identify)g(the)g
(server)f(pr)n(ocess.)25 b(At)18 b(the)g(mo-)150 2275
y(ment,)k(this)h(name)g(is)h(only)e(used)g(by)h(the)f(host-based)g
(access)h(contr)n(ol)g(module.)28 b(See)22 b(section)g(7.5)150
2388 y(for)h(details.)291 2503 y(The)f(name)h(is)g(stor)n(ed)e(in)i
(the)e(variable)k Fn(omniORB::server)o(Na)o(me)o Fr(.)150
2715 y Fc(CORBA::String_var)47 b(omniORB::serverName;)291
2938 y Fr(The)28 b(variable)j(can)e(be)f(changed)g(by)h(assignment)e
(inside)i(your)e(applications.)47 b(It)28 b(can)h(also)150
3051 y(be)23 b(changed)f(by)g(specifying)g(the)g(command-line)i
(option:)j Fn(-ORBserverName)48 b(<string>)p Fr(.)150
3362 y Fi(4.4)119 b(Object)29 b(Keys)150 3578 y Fr(OmniORB2)24
b(uses)d(a)i(data)g(type)e Fn(omniORB::object)o(Ke)o(y)16
b Fr(to)22 b(uniquely)g(identify)g(each)h(object)150
3691 y(implementation.)59 b(This)33 b(is)g(an)g(opaque)f(data)i(type)d
(and)i(can)h(only)f(be)g(manipulated)g(by)g(the)150 3803
y(following)23 b(functions:)150 4015 y Fc(void)49 b
(omniORB::generateNewKey\(omniORB::obj)o(ectKe)o(y)44
b(&k\);)291 4239 y Fn(omniORB::genera)o(te)o(Ne)o(wKe)o(y)29
b Fr(r)n(eturns)34 b(a)i(new)e Fn(objectKey)p Fr(.)62
b(The)35 b(r)n(eturn)f(value)i(is)150 4351 y(guaranteed)e(to)g(be)h
(unique)g(among)g(the)f(keys)f(generated)g(during)i(this)f(pr)n(ogram)h
(r)o(un.)66 b(On)150 4464 y(the)34 b(platforms)h(that)f(have)h(a)h(r)n
(ealtime)f(clock)h(and)f(unique)f(pr)n(ocess)f(identi\002ers,)k(a)e
(str)n(onger)150 4577 y(assertion)23 b(can)j(be)f(made,)g(i.e.)34
b(the)23 b(keys)g(ar)n(e)j(guaranteed)d(to)h(be)h(unique)f(among)g(all)
j(keys)c(ever)150 4690 y(generated)d(on)j(the)e(same)i(machine.)150
4902 y Fc(const)49 b(unsigned)f(int)h(omniORB::hash_table_size;)150
5002 y(int)g(omniORB::hash\(omniORB::objectKey&)44 b(k\);)291
5225 y Fn(omniORB::hash)14 b Fr(r)n(eturns)19 b(the)g(hash)g(value)i
(of)f(an)g Fn(objectKey)p Fr(.)j(The)c(value)h(r)n(eturned)e(by)150
5338 y(this)j(function)g(is)g(always)h(between)d(0)j(and)f
Fn(omniORB:hash)p 2334 5338 28 4 v 27 w(table)p 2636
5338 V 31 w(size)53 b(-)h(1)20 b Fr(inclusively)-10 b(.)150
5550 y Fc(omniORB::objectKey)46 b(omniORB::nullkey\(\);)p
eop
%%Page: 44 50
44 49 bop 30 100 a Fr(44)1865 b Fd(CHAPTER)21 b(4.)52
b(THE)21 b(OMNIORB2)i(API)171 356 y Fn(omniORB::nullke)o(y)32
b Fr(always)39 b(r)n(eturns)e(the)g(same)h Fn(objectKey)d
Fr(value.)75 b(This)38 b(key)f(is)30 469 y(guaranteed)21
b(to)h(hash)h(to)f(0.)30 659 y Fc(int)49 b(operator==\(const)e
(omniORB::objectKey)g(&k1,const)h(om-)30 759 y(niORB::objectKey)f
(&k2\);)30 858 y(int)i(operator!=\(const)e(omniORB::objectKey)g
(&k1,const)h(om-)30 958 y(niORB::objectKey)f(&k2\);)171
1162 y Fn(ObjectKeys)27 b Fr(can)32 b(be)f(tested)d(for)j(equality)g
(using)f(the)h(overloaded)e Fn(operator==)e Fr(and)30
1275 y Fn(operator!=)p Fr(.)30 1465 y Fc(omniORB::seqOctets*)30
1565 y(omniORB::keyToOctetSequence\(const)44 b(omniORB::objectKey)i
(&k1\);)30 1764 y(omniORB::objectKey)30 1863 y
(omniORB::octetSequenceToKey\(const)e(omniORB::seqOctets&)i(seq\);)171
2067 y Fn(omniORB::keyToO)o(ct)o(et)o(Seq)o(ue)o(nc)o(e)29
b Fr(takes)k(an)i Fn(objectKey)c Fr(and)j(r)n(eturns)f(its)i(exter)n(-)
30 2180 y(nalised)25 b(r)n(epr)n(esentation)e(in)j(the)e(form)h(of)g(a)
h(sequence)d(of)i(octets.)34 b(The)24 b(same)h(sequence)e(can)j(be)30
2293 y(converted)i(back)i(to)f(an)h Fn(objectKey)c Fr(using)j
Fn(omniORB::octetS)o(eq)o(ue)o(nc)o(eT)o(oKe)o(y)p Fr(.)42
b(If)30 b(the)30 2406 y(supplied)25 b(sequence)g(is)h(not)g(an)h
Fn(objectKey)p Fr(,)c Fn(omniORB::octetS)o(equ)o(en)o(ce)o(To)o(Ke)o(y)
e Fr(raises)30 2519 y(a)i Fn(CORBA::MARSHAL)17 b Fr(exception.)30
2816 y Fi(4.5)119 b(GIOP)29 b(Message)g(Size)30 3013
y Fr(omniORB2)j(sets)d(a)j(limit)g(on)f(the)f(GIOP)h(message)f(size)h
(that)g(can)h(be)f(sent)e(or)i(r)n(eceived.)53 b(The)30
3113 y(value)23 b(can)h(be)e(obtained)h(by)f(calling:)30
3280 y Fc(size_t)49 b(omniORB::MaxMessageSize\(\);)30
3460 y Fr(and)23 b(can)g(be)g(changed)f(by:)30 3650 y
Fc(void)49 b(omniORB::MaxMessageSize\(size_t)44 b(newvalue\);)30
3854 y Fr(or)22 b(by)h(the)f(command-line)h(option)f
Fn(-ORBgiopMaxMsgS)o(iz)o(e)p Fr(.)171 3967 y(The)32
b(exact)g(value)h(is)f(somewhat)f(arbitrary)-10 b(.)57
b(The)31 b(r)n(eason)h(such)f(a)i(limit)h(exists)c(is)j(to)e(pr)n(o-)30
4080 y(vide)c(some)f(way)h(to)g(pr)n(otect)f(the)g(server)g(side)g(fr)n
(om)i(r)n(esour)n(ce)e(exhaustion.)40 b(Think)27 b(about)g(the)30
4193 y(case)22 b(when)g(the)f(server)g(r)n(eceives)h(a)h(r)n(ogue)e
(GIOP\(IIOP\))i(r)n(equest)e(message)g(that)h(contains)g(a)h(se-)30
4306 y(quence)j(length)f(\002eld)h(set)g(to)f(2**31.)42
b(W)-5 b(ith)26 b(a)h(r)n(easonable)g(message)e(size)i(limit,)h(the)e
(server)f(can)30 4419 y(r)n(eject)d(this)h(r)n(ogue)e(message)g
(straight)h(away)-10 b(.)30 4716 y Fi(4.6)119 b(Initial)28
b(Object)h(Reference)g(Bootstrapping)30 4927 y Fr(Starting)e(fr)n(om)h
(2.6.0,)h(a)f(new)f(mechanism)h(is)f(available)k(for)c(the)g(ORB)g(r)o
(untime)g(to)g(obtain)h(the)30 5040 y(initial)22 b(object)e(r)n(efer)n
(ences)f(to)g(CORBA)i(services.)26 b(Pr)n(eviously)-10
b(,)20 b(it)g(is)g(necessary)f(to)g(write)h(the)f(IOR)30
5153 y(string)g(of)g(these)f(services)g(in)i(the)f(con\002guration)g
(\002le)g(\(section)g(1.2\).)28 b(Now)18 b(the)h(object)g(r)n(efer)n
(ences)30 5265 y(can)i(be)f(obtained)f(fr)n(om)i(a)f(bootstrap)e
(service.)27 b(The)19 b(bootstrap)g(service)g(is)h(a)h(special)f
(object)g(with)30 5378 y(the)i(object)g(key)g('INIT')f(and)i(the)f
(following)h(interface)1954 5345 y Fj(2)1991 5378 y Fr(.:)p
30 5462 1368 4 v 135 5518 a Fg(2)164 5550 y Ff(This)c(interface)g(is)f
(\002rst)g(de\002ned)g(by)h(Sun's)g(NEO)f(and)h(is)f(in)h(used)f(in)h
(Sun's)g(JavaIDL)p eop
%%Page: 45 51
45 50 bop 150 100 a Fd(4.6.)51 b(INITIAL)20 b(OBJECT)j(REFERENCE)d
(BOOTSTRAPPING)1081 b Fr(45)399 356 y Fc(//)50 b(IDL)399
456 y(module)f(CORBA)g({)549 555 y(interface)f(InitialReferences)e({)
748 655 y(Object)i(get\(in)h(ORB::ObjectId)f(id\);)748
754 y(//)h(returns)g(the)g(initial)f(object)h(reference)f(of)i(the)f
(service)748 854 y(//)g(identified)f(by)i(<id>.)e(For)i(example)e(the)h
(id)h(for)f(the)g(COSS)748 954 y(//)g(Naming)g(service)f(is)i
("NameService".)748 1153 y(ORB::ObjectIdList)c(list\(\);)748
1253 y(//)j(returns)g(the)g(list)g(of)g(service)g(id)g(that)g(this)h
(agent)e(knows)h(of)748 1352 y(//)g(their)g(initial)g(object)f
(reference.)549 1452 y(};)399 1551 y(};)291 1724 y Fr(By)c(default,)49
b(all)d(omniORB2)f(servers,)j(i.e.)92 b(those)43 b(applications)i(with)
f(the)g(BOA)g(ini-)150 1837 y(tialised,)36 b(contains)e(an)g(instance)g
(of)g(this)f(object)h(and)g(is)f(able)i(to)e(r)n(esponds)f(to)h(r)n
(emote)f(invo-)150 1950 y(cations.)41 b(T)-8 b(o)26 b(pr)n(event)g(the)
h(ORB)f(fr)n(om)i(instantiating)f(this)g(object,)h(the)e(command-line)i
(option)150 2063 y Fn(-BOAno)p 485 2063 28 4 v 30 w(bootstrap)p
1010 2063 V 29 w(agent)20 b Fr(should)i(be)g(speci\002ed.)291
2175 y(In)45 b(particular)-7 b(,)51 b(the)45 b(Naming)g(Service)g
(omniNames)f(is)h(able)h(to)e(r)n(espond)f(to)i(a)g(query)150
2288 y(thr)n(ough)32 b(this)g(interface)h(and)g(r)n(eturns)e(the)h
(object)h(r)n(efer)n(ence)f(of)h(its)g(r)n(oot)f(context.)57
b(In)32 b(ef)n(fect,)150 2401 y(the)e(bootstrap)f(agent)h(pr)n(ovides)g
(a)h(level)h(of)e(indir)n(ection.)53 b(All)31 b(omniORB2)h(clients)e
(still)i(have)150 2514 y(to)c(be)g(supplied)g(with)g(the)g(addr)n(ess)f
(of)h(the)g(bootstrap)f(agent.)45 b(However)27 b(the)h(information)h
(is)150 2627 y(much)34 b(easier)f(to)g(specify)h(than)f(a)i
(stringi\002ed)d(IOR!)i(Another)e(advantage)i(of)f(this)h(appr)n(oach)
150 2740 y(is)29 b(that)g(it)g(is)g(completely)f(compatiable)i(with)f
(JavaIDL.)g(This)g(makes)f(it)h(possible)f(for)h(a)h(client)150
2853 y(written)22 b(in)h(JavaIDL)h(to)e(shar)n(e)g(with)h(a)g(omniORB2)
g(server)e(the)h(same)h(Naming)g(Service.)291 2966 y(The)51
b(addr)n(ess)f(of)i(the)f(bootstrap)f(agent)h(is)h(given)f(by)h(the)f
Fn(ORBInitialHost)45 b Fr(and)150 3079 y Fn(ORBInitialPort)28
b Fr(parameter)34 b(in)h(the)f(omniORB)h(con\002guration)f(\002le)g
(\(section)g(1.2\).)65 b(The)150 3192 y(parameters)35
b(can)h(also)g(be)f(speci\002ed)f(as)i(command-line)h(options)d
(\(section)h(4.1\).)67 b Fn(ORBIni-)150 3305 y(tialHost)22
b Fr(is)k(the)f(host)f(name)i(and)f Fn(ORBInitialPort)20
b Fr(is)25 b(the)g(TCP/IP)h(port)e(number)-7 b(.)37 b(The)150
3418 y(parameter)27 b Fn(ORBInitialPort)21 b Fr(is)27
b(optional.)42 b(If)28 b(it)f(is)h(not)e(speci\002ed,)h(port)g(number)g
(900)i(will)150 3530 y(be)23 b(used.)291 3643 y(During)33
b(initialisation,)38 b(the)32 b(ORB)h(r)n(eads)g(the)f(parameters)g(in)
i(the)e(omniORB)h(con\002gura-)150 3756 y(tion)e(\002le.)56
b(If)31 b(the)g(parameter)g Fn(NAMESERVICE)c Fr(is)32
b(speci\002ed,)g(the)f(stringi\002ed)g(IOR)g(would)g(be)150
3869 y(used)21 b(as)h(the)g(object)g(r)n(efer)n(ence)g(of)g(the)g(r)n
(oot)g(naming)h(context.)j(If)c(the)g(parameter)g(is)g(absent)g(and)150
3982 y(the)35 b(parameter)f Fn(ORBInitialHost)29 b Fr(is)36
b(pr)n(esent,)g(the)f(ORB)g(would)g(contact)g(the)g(bootstrap)150
4095 y(agent)22 b(at)h(the)g(addr)n(ess)e(speci\002ed)h(to)g(obtain)i
(the)e(r)n(oot)g(naming)i(context)d(when)i(the)f(application)150
4208 y(calls)28 b Fn(resolve)p 744 4208 V 29 w(initial)p
1158 4208 V 30 w(reference\(\))p Fr(.)34 b(If)27 b(neither)e(the)h
Fn(NAMESERVICE)21 b Fr(nor)26 b Fn(ORBIni-)150 4321 y(tialHost)17
b Fr(is)k(pr)n(esent,)e(a)i(call)i(to)d Fn(resolve)p
1750 4321 V 29 w(initial)p 2164 4321 V 30 w(reference\(\))15
b Fr(r)n(eturns)20 b(a)h(nil)h(object.)150 4434 y(Finally)-10
b(,)35 b(the)30 b(command)j(line)f(ar)n(gument)f Fn(-ORBInitialHost)25
b Fr(overrides)30 b(any)i(parameters)150 4547 y(in)f(the)f
(con\002guration)f(\002le.)52 b(The)30 b(ORB)g(would)g(always)g
(contact)h(the)f(bootstrap)f(agent)g(at)i(the)150 4660
y(addr)n(ess)21 b(speci\002ed)h(to)g(obtain)h(the)e(r)n(oot)h(naming)i
(context.)291 4772 y(Now)e(we)g(ar)n(e)h(r)n(eady)f(to)g(describe)g(a)h
(simple)g(way)f(to)g(set)g(up)g(omniNames.)264 4945 y(1.)45
b(Start)22 b(omniNames)h(for)f(the)g(\002rst)g(time)h(on)f(a)h(machine)
h(\(e.g.)j(wobble\):)377 5088 y Fn($)54 b(omniNames)d(-start)h(1234)264
5263 y Fr(2.)45 b(Add)22 b(to)g(omniORB.cfg:)377 5406
y Fn(ORBInitialHost)48 b(wobble)377 5550 y(ORBInitialPort)g(1234)p
eop
%%Page: 46 52
46 51 bop 30 100 a Fr(46)1865 b Fd(CHAPTER)21 b(4.)52
b(THE)21 b(OMNIORB2)i(API)144 356 y Fr(3.)45 b(All)24
b(omniORB2)f(applications)g(will)h(now)e(be)h(able)g(to)f(contact)h
(omniNames.)171 568 y(Alternatively)-10 b(,)22 b(the)g(command)h(line)g
(options)e(can)j(be)e(used,)f(for)i(example:)171 681
y Fn($)54 b(eg3)p 450 681 28 4 v 32 w(impl)e(-ORBInitialHost)c(wobble)k
(-ORBInitialPor)o(t)d(1234)j(&)171 794 y($)i(eg3)p 450
794 V 32 w(clt)f(-ORBInitialHos)o(t)48 b(wobble)k(-ORBInitialPort)c
(1234)30 1093 y Fi(4.7)119 b(GIOP)29 b(Lowest)g(Common)j(Denominator)d
(Mode)30 1304 y Fr(Sometimes,)20 b(to)i(cope)f(with)g(bugs)g(in)i
(another)e(ORB,)g(it)h(is)g(necessary)e(to)h(disable)i(various)f(GIOP)
30 1417 y(and)34 b(IIOP)f(featur)n(es)g(in)i(or)n(der)e(to)g(achieve)h
(inter)n(operability)-10 b(.)62 b(If)33 b(the)g(command)i(line)f
(option)30 1530 y Fn(-ORBlcdMode)17 b Fr(or)k(the)g(function)h
Fn(omniORB::enabl)o(eL)o(cdM)o(od)o(e\()o(\))16 b Fr(is)21
b(called,)i(the)e(ORB)g(en-)30 1643 y(ters)26 b(the)g(so-called)h
(\223lowest)f(common)h(denominator)f(mode\224.)41 b(It)26
b(bends)g(over)g(backwar)n(ds)i(to)30 1756 y(cope)20
b(with)h(bugs)f(in)h(the)g(ORB)f(at)h(the)f(other)g(end.)26
b(This)21 b(is)g(pur)n(ely)f(a)i(transitional)f(measur)n(e.)27
b(The)30 1868 y(long)22 b(term)g(solution)g(is)g(to)g(r)n(eport)f(the)h
(bugs)g(to)g(the)f(other)h(vendors)f(and)h(ask)g(them)g(to)g(\002x)h
(them)30 1981 y(expediently)-10 b(.)171 2094 y(By)45
b(default,)51 b(omniORB2)c(uses)d(GIOP)i(LOCA)-7 b(TE)p
2037 2094 V 33 w(REQUEST)44 b(message)h(to)g(verify)h(the)30
2207 y(existence)52 b(of)h(an)h(object)f(prior)g(to)g(the)g(\002rst)f
(invocation.)121 b(If)54 b(another)e(vendor)7 b('s)52
b(ORB)30 2320 y(is)j(known)f(not)h(to)g(be)g(able)h(to)e(handle)h(this)
g(GIOP)h(message,)62 b(set)54 b(the)g(variable)j Fn(om-)30
2433 y(niORB::verifyOb)o(je)o(ct)o(Ex)o(ist)o(sA)o(nd)o(Ty)o(pe)14
b Fr(to)19 b(0)i(would)e(disable)i(this)f(featur)n(e,)g(and)g(hence)30
2546 y(achieve)32 b(inter)n(operability)-10 b(.)55 b(The)32
b(option)e(can)j(also)f(be)f(set)g(via)i(the)e(command)h(line)h(option)
d Fn(-)30 2659 y(ORBverifyObject)o(Ex)o(is)o(ts)o(And)o(Ty)o(pe)o
Fr(.)30 2958 y Fi(4.8)119 b(T)-13 b(rapping)29 b(omniORB2)h(Internal)e
(Errors)30 3155 y Fc(class)49 b(fatalException)e({)30
3255 y(public:)229 3354 y(const)i(char)g(*file\(\))g(const;)229
3454 y(int)g(line\(\))g(const;)229 3554 y(const)g(char)g(*errmsg\(\))f
(const;)30 3653 y(};)171 3866 y Fr(When)21 b(omniORB2)i(detects)d(an)i
(internal)h(inconsistency)e(that)g(is)h(most)f(likely)h(to)g(be)g
(caused)30 3979 y(by)g(a)h(bug)f(in)h(the)e(r)o(untime,)h(it)g(raises)g
(the)f(exception)g Fn(omniORB::fatalEx)o(ce)o(pt)o(io)o(n)p
Fr(.)h(When)30 4092 y(this)j(exception)f(is)i(raised,)f(it)h(is)f(not)g
(sensible)g(to)f(pr)n(oceed)h(with)g(any)g(operation)g(that)g(involves)
30 4205 y(the)20 b(ORB's)h(r)o(untime.)27 b(It)20 b(is)h(best)f(to)g
(exit)g(the)g(pr)n(ogram)h(immediately)-10 b(.)27 b(The)21
b(exception)e(str)o(uctur)n(e)30 4318 y(carries)34 b(by)g
Fn(omniORB::fatalE)o(xc)o(ep)o(tio)o(n)28 b Fr(contains)34
b(the)f(exact)h(location)g(\(the)g(\002le)g(name)30 4430
y(and)22 b(the)f(line)h(number\))g(wher)n(e)f(the)g(exception)f(is)i
(raised.)27 b(Y)-8 b(ou)21 b(ar)n(e)h(str)n(ongly)e(encourage)h(to)g
(\002le)30 4543 y(a)i(bug)g(r)n(eport)e(and)i(point)f(out)f(the)h
(location.)171 4656 y(It)59 b(may)g(help)g(to)f(cause)h(a)h(cor)n
(e-dump)e(and)i(look)e(at)h(the)g(stack)f(trace)h(to)g(locate)30
4769 y(wher)n(e)41 b(the)f(exception)h(was)g(thr)n(own.)84
b(This)41 b(can)h(be)g(done)e(by)h(setting)f(the)h(variable)i
Fn(om-)30 4882 y(niORB::abortOnI)o(nt)o(er)o(na)o(lEr)o(ro)o(r)25
b Fr(to)31 b(1.)54 b(The)31 b(variable)i(can)f(also)g(be)f(set)f(via)j
(the)d(com-)30 4995 y(mand)23 b(line)g(option)f Fn(-ORBabortOnInt)o(er)
o(na)o(lEr)o(ro)o(r)p Fr(.)p eop
%%Page: 47 53
47 52 bop 150 983 a Fk(Chapter)44 b(5)150 1402 y Fm(The)52
b(Basic)f(Object)g(Adaptor)h(\(BOA\))150 1868 y Fr(This)32
b(chapter)g(describes)g(the)g(BOA)g(implementation)g(in)i(omniORB2.)58
b(The)32 b(CORBA)g(speci-)150 1981 y(\002cation)f(de\002nes)d(the)i
(Basic)g(Object)h(Adaptor)e(as)h(the)f(entity)h(that)f(mediates)h
(between)e(object)150 2094 y(implementations)35 b(and)h(the)f(ORB.)g
(Unfortunately)-10 b(,)37 b(the)e(BOA)g(speci\002cation)h(is)g
(incomplete)150 2206 y(and)25 b(does)e(not)i(addr)n(ess)e(the)h
(multi-thr)n(eading)i(issues)d(appr)n(opriately)-10 b(.)34
b(The)25 b(end)f(r)n(esult)g(is)h(that)150 2319 y(dif)n(fer)n(ent)g
(ORB)h(vendors)d(implement)j(dif)n(fer)n(ent)f(extensions)e(to)i(their)
g(BOAs.)35 b(W)-8 b(orse,)24 b(the)h(im-)150 2432 y(plementation)31
b(of)g(the)f(operations)g(de\002ned)g(in)h(the)g(speci\002cation)g(ar)n
(e)h(dif)n(fer)n(ent)f(in)h(dif)n(fer)n(ent)150 2545
y(ORBs.)62 b(Recently)-10 b(,)35 b(a)g(new)e(Object)i(Adaptor)d
(speci\002cation)j(\(the)e(Portable)h(Object)h(Adaptor)n(-)150
2658 y(POA\))26 b(has)g(been)g(adopted)e(and)i(will)h(r)n(eplace)g(the)
e(BOA)h(as)g(the)f(standar)n(d)g(Object)i(Adaptor)e(in)150
2771 y(CORBA.)19 b(The)f(new)g(speci\002cation)h(r)n(ecognises)e(the)h
(compatibility)j(pr)n(oblems)d(of)h(BOA)g(and)g(r)n(ec-)150
2884 y(ommends)25 b(that)g(all)i(BOAs)f(should)e(be)i(consider)n(ed)e
(pr)n(opriety)h(extensions.)35 b(OmniORB2)27 b(will)150
2997 y(support)c(POA)i(in)h(futur)n(e)e(r)n(eleases.)34
b(Until)26 b(then,)e(you)g(have)i(to)e(use)g(the)g(BOA)h(to)g(attach)g
(object)150 3110 y(implementations)d(to)g(the)g(ORB.)291
3227 y(The)g(r)n(est)f(of)h(this)g(chapter)g(describes)f(the)h
(interface)g(of)g(the)g(BOA)g(in)h(detail.)k(It)22 b(is)g(important)150
3340 y(to)30 b(r)n(ecognise)g(that)h(the)f(interface)i(described)e
(below)h(is)g(omniORB2)g(speci\002c)g(and)g(hence)g(the)150
3453 y(code)22 b(using)g(this)g(interface)h(is)g(unlikely)f(to)g(be)h
(portable)f(to)g(other)f(ORBs.)291 3570 y(Unless)f(it)h(is)g(stated)f
(otherwise,)f(the)h(term)h(\223object\224)g(will)i(be)d(used)g(below)h
(to)f(r)n(efer)h(to)f(object)150 3683 y(implementations.)66
b(This)35 b(should)f(not)h(be)h(confused)e(with)h(\223object)h(r)n
(efer)n(ences\224)f(which)h(ar)n(e)150 3796 y(handles)22
b(held)g(by)h(clients.)150 4120 y Fi(5.1)119 b(BOA)29
b(Initialisation)150 4339 y Fr(It)h(takes)f(two)g(steps)g(to)g(put)h
(the)f(BOA)i(into)f(service.)50 b(The)30 b(BOA)g(has)g(to)g(be)g
(initialised)i(using)150 4452 y Fn(BOA)p 320 4452 28
4 v 31 w(init)21 b Fr(and)i(activated)g(using)f Fn(impl)p
1625 4452 V 31 w(is)p 1766 4452 V 32 w(ready)p Fr(.)150
4569 y Fn(BOA)p 320 4569 V 31 w(init)f Fr(is)i(a)g(member)g(of)f(the)g
Fn(CORBA::ORB)c Fr(class.)29 b(Its)21 b(signatur)n(e)h(is:)150
4793 y Fc(BOA_ptr)49 b(BOA_init\(int)e(&)j(argc,)997
4893 y(char)f(**)g(argv,)997 4993 y(const)g(char)g(*)g
(boa_identifier\);)150 5226 y Fr(T)-8 b(ypically)e(,)23
b(it)g(is)f(used)g(in)h(the)e(startup)h(code)g(as)g(follows:)150
5450 y Fc(CORBA::ORB_ptr)47 b(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB2")o(\);)143 b(//)50
b(line)f(1)150 5550 y(CORBA::BOA_ptr)e(boa)i(=)h
(orb->BOA_init\(argc,argv,"omniORB2_BO)o(A"\);)43 b(//)50
b(line)f(2)1815 5778 y Fr(47)p eop
%%Page: 48 54
48 53 bop 30 100 a Fr(48)1159 b Fd(CHAPTER)22 b(5.)51
b(THE)21 b(BASIC)h(OBJECT)h(ADAPT)n(OR)g(\(BOA\))171
356 y Fr(The)k Fn(argv)e Fr(parameters)i(may)h(contain)f(BOA)h
(options.)40 b(These)26 b(options)g(will)j(be)e(r)n(emoved)30
469 y(fr)n(om)i(the)f Fn(argv)f Fr(list)i(when)f Fn(BOA)p
1229 469 28 4 v 31 w(init)f Fr(r)n(eturns.)45 b(Other)28
b(parameters)g(in)h Fn(argv)e Fr(will)j(r)n(emain.)30
582 y(The)22 b(supported)e(options)h(ar)n(e:)30 788 y
Fl(-BOAiiop)p 440 788 V 32 w(port)h Fn(<port)52 b(number)g
(\(0-65535\)>)41 b Fr(Use)28 b(the)g(port)f(number)i(to)f(r)n(eceive)g
(IIOP)257 901 y(r)n(equests.)38 b(This)27 b(option)e(can)j(be)f
(speci\002ed)e(multiple)i(times)g(in)g(the)f(command)h(line)g(and)257
1014 y(the)22 b(BOA)h(would)f(be)g(initialised)i(to)e(listen)g(on)g
(all)i(of)f(the)f(ports.)30 1199 y Fl(-BOAid)g Fn(<id)53
b(\(string\)>)41 b Fr(If)23 b(this)f(option)g(is)h(used)e(the)h(id)g
(must)g(be)h(\223omniORB2)p 3061 1199 V 34 w(BOA)-7 b(\224.)30
1385 y Fl(-BOAiiop)p 440 1385 V 32 w(name)p 699 1385
V 33 w(port)22 b Fn(<hostname[:port)48 b(number]>)42
b Fr(Similar)50 b(to)d Fn(-BOAiiop)p 3185 1385 V 29 w(port)p
Fr(,)257 1498 y(this)23 b(options)e(tells)h(the)g(BOA)g(the)g(hostname)
g(and)g(optionally)h(the)f(port)f(number)i(to)f(use.)171
1704 y(If)k(the)g(thir)n(d)g(ar)n(gument)g(of)g Fn(BOA)p
1330 1704 V 31 w(init)f Fr(is)h(non-nil,)i(it)e(must)g(be)g(the)g
(string)f(constant)g(\223om-)30 1817 y(niORB2)p 347 1817
V 33 w(BOA)-7 b(\224.)23 b(If)g(the)f(ar)n(gument)g(is)h(nil,)g(-BOAid)
g(must)f(be)g(pr)n(esent)f(in)i Fn(argv)p Fr(.)171 1930
y(If)30 b(ther)n(e)g(is)g(any)h(pr)n(oblem)f(in)h(the)f(initialisation)
i(pr)n(ocess,)f(a)g Fn(CORBA::INITIAL)o(IZ)o(E)24 b Fr(ex-)30
2042 y(ception)e(would)g(be)g(raised.)171 2155 y(T)-8
b(o)26 b(r)n(egister)g(an)h(object)g(with)g(the)f(BOA,)g(the)g(method)p
2121 2155 V 59 w Fn(obj)p 2319 2155 V 31 w(is)p 2460
2155 V 32 w(ready)e Fr(should)i(be)h(called)30 2268 y(with)c(the)e(r)n
(eturn)h(value)i(of)e Fn(BOA)p 1177 2268 V 32 w(init)e
Fr(as)j(the)f(ar)n(gument.)171 2381 y Fn(BOA)p 341 2381
V 31 w(init)29 b Fr(is)i(thr)n(ead-safe.)51 b(It)30 b(can)h(be)f
(called)i(multiple)e(times)g(and)h(the)f(same)g Fn(BOA)p
3260 2381 V 31 w(ptr)30 2494 y Fr(will)f(be)f(r)n(eturned.)41
b(However)-7 b(,)28 b(only)g(the)f Fn(argv)f Fr(in)i(the)f(\002rst)g
(call)j(will)f(be)e(scanned,)i(the)e(ar)n(gu-)30 2607
y(ment)22 b(is)h(ignor)n(ed)e(in)j(subsequent)c(calls.)171
2720 y Fn(BOA)p 341 2720 V 31 w(init)57 b Fr(r)n(eturns)h(a)h(pseudo)e
(object)h(of)h(type)e Fn(CORBA::BOA)p 2677 2720 V 28
w(ptr)p Fr(.)135 b(Similar)61 b(to)30 2833 y Fn(CORBA::Object)p
750 2833 V 27 w(ptr)p Fr(,)76 b(the)66 b(pointer)g(can)h(be)g(managed)f
(using)g Fn(CORBA::BOA)p 3240 2833 V 29 w(var)p Fr(,)30
2946 y Fn(BOA::)p 310 2946 V 30 w(duplicate)55 b Fr(and)j
Fn(CORBA::release)o Fr(.)129 b(The)57 b(pointer)g(can)i(be)f(tested)e
(using)30 3059 y Fn(CORBA::is)p 530 3059 V 29 w(nil)31
b Fr(which)h(r)n(eturns)f(tr)o(ue)h(if)h(the)e(pointer)g(is)i
(equivalent)f(to)g(the)f(r)n(eturn)g(value)30 3172 y(of)23
b Fn(BOA::)p 413 3172 V 30 w(nil)p Fr(.)171 3284 y(After)28
b Fn(BOA)p 580 3284 V 31 w(init)f Fr(is)h(called,)j(objects)d(can)h(be)
f(r)n(egister)n(ed.)43 b(However)-7 b(,)29 b(incoming)g(IIOP)f(r)n(e-)
30 3397 y(quests)21 b(would)h(not)g(be)g(despatched)f(until)i
Fn(impl)p 1786 3397 V 31 w(is)p 1927 3397 V 31 w(ready)e
Fr(is)i(called.)30 3590 y Fc(class)49 b(BOA)g({)30 3690
y(public:)179 3790 y(impl_is_ready\(CORBA::ImplementationDef)o(_ptr)43
b(p)50 b(=)g(0,)877 3889 y(CORBA::Boolean)d(NonBlocking)h(=)h(0\);)30
3989 y(};)171 4195 y Fr(One)21 b(of)g(the)f(common)h(pitfall)h(in)f
(using)f(the)g(BOA)h(is)f(to)h(for)n(get)e(to)h(call)j(impl)p
2848 4195 V 34 w(is)p 2947 4195 V 32 w(r)n(eady)-10 b(.)27
b(Until)30 4308 y(this)c(call)j(r)n(eturns,)c(ther)n(e)g(is)i(no)f(thr)
n(ead)g(listening)g(on)h(the)e(port)h(fr)n(om)h(which)g(IIOP)f(r)n
(equests)f(ar)n(e)30 4421 y(r)n(eceived.)28 b(The)21
b(r)n(emote)h(client)h(may)g(hang)g(because)f(of)h(this.)171
4534 y(When)28 b Fn(impl)p 665 4534 V 31 w(is)p 806 4534
V 32 w(ready)e Fr(is)i(called)i(with)e(no)g(ar)n(gument.)45
b(The)27 b(calling)k(thr)n(ead)c(would)h(be)30 4647 y(blocked)e
(inde\002nitely)g(in)i(the)e(function)h(until)g Fn(impl)p
1929 4647 V 31 w(shutdown)c Fr(\(see)j(below\))h(is)g(called.)42
b(The)30 4759 y(thr)n(ead)33 b(that)g(is)g(calling)i
Fn(impl)p 1141 4759 V 31 w(is)p 1282 4759 V 32 w(ready)c
Fr(is)i(not)f(used)g(by)h(the)g(BOA)g(to)f(perform)h(its)g(inter)n(-)30
4872 y(nal)40 b(functions.)78 b(The)39 b(BOA)g(has)h(its)f(own)g(set)f
(of)i(thr)n(eads)e(to)h(pr)n(ocess)f(incoming)i(r)n(equests)30
4985 y(and)34 b(general)f(housekeeping.)57 b(Ther)n(efor)n(e,)35
b(it)f(is)g(not)e(necessary)g(to)h(have)h(a)h(thr)n(ead)e(blocked)30
5098 y(in)27 b(the)e(call)k(if)e(it)f(can)h(be)g(put)e(into)h(use)g
(elsewher)n(e.)37 b(For)26 b(example,)h(the)e(main)j(thr)n(ead)e(may)g
(call)30 5211 y Fn(impl)p 255 5211 V 31 w(is)p 396 5211
V 32 w(ready)17 b Fr(once)h(in)i(non-blocking)f(mode)f(\(see)g(below\))
h(and)g(then)f(enter)f(the)i(event)f(loop)30 5324 y(to)k(handle)h(the)e
(GUI)i(fr)n(ontend.)171 5437 y(If)29 b(non-blocking)g(behaviour)g(is)g
(needed,)f(the)g Fn(NonBlocking)c Fr(ar)n(gument)29 b(should)e(be)i
(set)30 5550 y(to)k(1.)62 b(For)33 b(instance,)j(if)f(you)e(cr)n(eates)
g(a)h(callback)j(object,)f(you)d(might)g(call)j(impl)p
2981 5550 V 34 w(is)p 3080 5550 V 32 w(r)n(eady)e(in)p
eop
%%Page: 49 55
49 54 bop 150 100 a Fd(5.2.)51 b(OBJECT)23 b(REGISTRA)-7
b(TION)2106 b Fr(49)150 356 y(non-blocking)22 b(mode)e(to)h(tell)h(the)
f(BOA)g(to)g(start)g(r)n(eceiving)h(IIOP)f(r)n(equests)f(befor)n(e)h
(sending)f(the)150 469 y(callback)k(object)e(to)f(the)g(r)n(emote)g
(object.)27 b(The)21 b(\002rst)g(ar)n(gument)g Fn(ImplementationDe)o(f)
p 3298 469 28 4 v 26 w(ptr)g Fr(is)150 582 y(ignor)n(ed)h(by)g(the)g
(BOA.)g(Just)g(set)g(the)f(ar)n(gument)i(to)f(nil.)291
699 y Fn(impl)p 516 699 V 31 w(is)p 657 699 V 32 w(ready)g
Fr(is)i(thr)n(ead)f(safe)h(and)g(can)h(be)f(called)h(multiple)f(times.)
32 b(Multiple)24 b(thr)n(eads)150 812 y(can)f(be)g(blocked)f(in)h
Fn(impl)p 1094 812 V 31 w(is)p 1235 812 V 32 w(ready)p
Fr(.)150 1138 y Fi(5.2)119 b(Object)29 b(Registration)150
1359 y Fr(Once)d(the)e(BOA)h(is)g(initialised,)i(objects)e(can)h(be)f
(r)n(egister)n(ed.)33 b(The)25 b(purpose)e(of)i(object)g(r)n(egistra-)
150 1472 y(tion)g(is)g(to)f(let)h(the)f(BOA)h(know)f(of)h(the)f
(existence)f(of)i(the)g(object)f(and)h(to)g(dispatch)f(r)n(equests)f
(for)150 1584 y(the)f(object)g(as)h(upcalls)g(into)g(the)f(object.)291
1702 y(T)-8 b(o)85 b(r)n(egister)e(an)j(object,)101 b(the)p
1621 1702 V 117 w Fn(obj)p 1818 1702 V 31 w(is)p 1959
1702 V 32 w(ready)83 b Fr(function)j(should)e(be)h(called.)p
150 1815 V 177 1815 a Fn(obj)p 347 1815 V 32 w(is)p 489
1815 V 31 w(ready)39 b Fr(is)i(a)h(member)f(function)g(of)g(the)f
(implementation)h(skeleton)e(class.)84 b(The)150 1928
y(function)33 b(should)f(be)g(called)i(only)e(once)g(for)h(each)g
(object.)58 b(The)32 b(call)i(should)e(be)h(made)f(only)150
2041 y(after)23 b(the)e(object)i(is)g(fully)g(initialised.)291
2158 y(The)i(member)h(function)g Fn(obj)p 1362 2158 V
32 w(is)p 1504 2158 V 31 w(ready)e Fr(of)i(the)f(BOA)h(may)g(also)g(be)
g(used)f(to)g(r)n(egister)g(an)150 2271 y(object.)49
b(However)-7 b(,)30 b(this)f(function)h(has)f(been)g(superseded)d(by)p
2440 2271 V 63 w Fn(obj)p 2638 2271 V 31 w(is)p 2779
2271 V 32 w(ready)h Fr(and)j(should)150 2384 y(not)22
b(be)g(used)g(in)h(new)f(application)i(code.)150 2710
y Fi(5.3)119 b(Object)29 b(Disposal)150 2930 y Fr(Once)f(an)h(object)f
(is)g(r)n(egister)n(ed,)f(it)i(is)f(under)f(the)g(management)h(of)g
(the)f(BOA.)h(T)-8 b(o)27 b(r)n(emove)h(the)150 3043
y(object)23 b(fr)n(om)h(the)e(BOA)i(and)f(to)g(delete)e(it)j(\(when)f
(it)g(is)g(safe)h(to)e(do)h(so\),)g(the)p 2801 3043 V
55 w Fn(dispose)d Fr(function)150 3156 y(should)33 b(be)i(called.)p
921 3156 V 97 w Fn(dispose)c Fr(is)k(a)g(member)f(function)h(of)f(the)g
(implementation)g(skeleton)150 3269 y(class.)28 b(The)22
b(function)h(should)f(be)g(called)i(only)e(once)g(for)h(each)g(object.)
291 3386 y(Notice)33 b(the)g(asymmetry)f(in)i(object)f(instantiation)h
(and)g(destr)o(uction.)59 b(T)-8 b(o)32 b(instantiate)i(an)150
3499 y(object,)f(the)e(application)h(code)f(has)g(to)g(call)i(the)e
Fl(new)g Fr(operator)-7 b(.)53 b(T)-8 b(o)30 b(r)n(emove)h(the)g
(object,)i(the)150 3612 y(application)24 b(should)d(never)h(call)j(the)
d(delete)f(operator)g(on)h(the)g(object)g(dir)n(ectly)-10
b(.)291 3730 y(At)20 b(the)f(time)i(the)p 910 3730 V
52 w Fn(dispose)c Fr(call)22 b(is)e(made,)h(ther)n(e)e(may)h(be)h
(other)e(thr)n(eads)g(invoking)h(on)g(the)150 3843 y(object,)27
b(the)e(BOA)h(ensur)n(es)f(that)g(all)j(these)d(calls)i(ar)n(e)g
(completed)e(befor)n(e)h(r)n(emoving)g(the)f(object)150
3956 y(fr)n(om)e(its)g(internal)g(tables)f(and)h(calling)h(the)e
Fl(delete)i Fr(operator)-7 b(.)291 4073 y(Internally)d(,)25
b(the)g(BOA)g(keeps)e(a)j(r)n(efer)n(ence)e(count)h(on)g(each)g
(object.)36 b(Initially)-10 b(,)26 b(the)f(r)n(efer)n(ence)150
4186 y(count)d(is)h(0.)29 b(After)21 b(a)j(call)g(to)p
1155 4186 V 55 w Fn(obj)p 1352 4186 V 31 w(is)p 1493
4186 V 32 w(ready)p Fr(,)c(the)i(r)n(efer)n(ence)g(count)h(is)f(1.)29
b(The)22 b(BOA)g(incr)n(eases)150 4299 y(the)32 b(r)n(efer)n(ence)g
(count)g(by)h(1)g(befor)n(e)f(an)h(upcall)h(into)f(the)f(object)g(is)h
(made.)58 b(The)32 b(count)g(is)h(de-)150 4412 y(cr)n(eased)22
b(by)g(1)g(when)g(the)f(upcall)i(r)n(eturns.)p 1676 4412
V 60 w Fn(dispose)c Fr(decr)n(eases)h(the)i(r)n(efer)n(ence)f(count)h
(by)g(1,)g(if)150 4525 y(the)c(r)n(efer)n(ence)g(count)f(is)i(0,)h(the)
d(delete)g(operator)g(is)i(called.)27 b(If)19 b(the)e(count)h(is)h
(non-zer)n(o,)g(the)e(object)150 4637 y(is)j(marked)g(as)g(disposed.)25
b(The)19 b(object)h(will)i(be)e(deleted)e(when)i(the)f(r)n(efer)n(ence)
h(count)f(eventually)150 4750 y(goes)i(to)h(zer)n(o.)291
4868 y(The)35 b(r)n(efer)n(ence)g(count)g(is)g(also)h(incr)n(eased)f
(by)h(1)g(for)f(each)h(object)f(r)n(efer)n(ence)g(held)g(in)h(the)150
4981 y(same)e(addr)n(ess)g(space.)63 b(Hence,)36 b(the)e
Fl(delete)i Fr(operator)d(will)j(not)d(be)i(called)g(when)f(ther)n(e)g
(ar)n(e)150 5094 y(outstanding)28 b(object)h(r)n(efer)n(ences)f(in)i
(the)f(same)h(addr)n(ess)e(space.)48 b(T)-8 b(o)28 b(ensur)n(e)g(that)i
(an)g(object)f(is)150 5207 y(deleted,)h(all)h(its)f(object)g(r)n(efer)n
(ences)f(in)h(the)f(same)h(addr)n(ess)f(space)h(should)f(be)h(r)n
(eleased)f(using)150 5319 y Fn(CORBA::release)p Fr(.)291
5437 y(Unlike)41 b(colocated)h(object)f(r)n(efer)n(ences,)k(r)n(efer)n
(ences)40 b(held)h(by)h(clients)f(in)h(other)f(addr)n(ess)150
5550 y(spaces)24 b(would)g(not)h(pr)n(event)e(the)i(deletion)e(of)i
(objects.)34 b(If)25 b(these)e(clients)i(invoke)g(on)f(the)g(object)p
eop
%%Page: 50 56
50 55 bop 30 100 a Fr(50)1159 b Fd(CHAPTER)22 b(5.)51
b(THE)21 b(BASIC)h(OBJECT)h(ADAPT)n(OR)g(\(BOA\))30 356
y Fr(after)30 b(it)g(is)g(disposed,)e(the)h(system)f(exception)h(INV)p
1905 356 28 4 v 31 w(OBJREF)g(would)g(be)h(raised.)49
b(The)29 b(dif)n(fer)n(-)30 469 y(ence)j(in)h(semantics)f(is)h(an)f
(undesirable)g(side-ef)n(fect)g(of)h(the)e(curr)n(ent)h(BOA)g
(implementation.)30 582 y(In)24 b(futur)n(e,)g(colocated)g(r)n(efer)n
(ences)g(will)h(have)g(the)f(same)g(semantics)g(as)h(r)n(emote)e(r)n
(efer)n(ences,)h(i.e.)30 695 y(their)e(pr)n(esence)f(will)j(not)e
(delay)g(the)g(deletion)g(of)g(the)g(objects.)171 809
y(Instead)28 b(of)p 611 809 V 61 w Fn(dispose)p Fr(,)g(it)h(may)g(be)g
(useful)g(to)g(have)g(a)h(method)d(to)i(deactivate)g(the)f(object)30
922 y(but)22 b(not)g(deleting)g(it.)28 b(This)22 b(featur)n(e)g(is)h
(not)f(supported)e(in)j(the)f(curr)n(ent)g(BOA)g(implementation.)30
1228 y Fi(5.4)119 b(BOA)29 b(Shutdown)30 1442 y Fr(The)f(BOA)h(can)i
(be)e(withdrawn)f(fr)n(om)i(service)f(using)g(member)g(functions)g
Fn(impl)p 2988 1442 V 31 w(shutdown)30 1555 y Fr(and)23
b Fn(destroy)p Fr(.)30 1762 y Fc(class)49 b(BOA)g({)30
1861 y(public:)179 1961 y(void)g(impl_shutdown\(\);)179
2061 y(void)g(destroy\(\);)30 2160 y(};)171 2379 y Fn(impl)p
396 2379 V 31 w(shutdown)19 b Fr(and)j Fn(destroy)d Fr(ar)n(e)j(the)g
(inverse)f(of)i Fn(impl)p 2397 2379 V 30 w(is)p 2537
2379 V 32 w(ready)d Fr(and)i Fn(BOA)p 3205 2379 V 32
w(init)30 2492 y Fr(r)n(espectively)-10 b(.)171 2606
y Fn(impl)p 396 2606 V 31 w(shutdown)49 b Fr(deactivates)k(the)f(BOA.)g
(When)g(the)g(call)j(r)n(eturns,)k(all)54 b(the)e(inter)n(-)30
2719 y(nal)41 b(thr)n(eads)e(and)h(network)e(connections)i(will)h(be)f
(shutdown.)78 b(Any)40 b(thr)n(ead)f(blocking)i(in)30
2832 y Fn(impl)p 255 2832 V 31 w(is)p 396 2832 V 32 w(ready)26
b Fr(would)j(be)g(unblocked.)45 b(After)28 b(the)h(call,)j(no)c(r)n
(equest)f(fr)n(om)j(other)e(addr)n(ess)30 2945 y(spaces)19
b(will)i(be)f(pr)n(ocessed.)k(In)19 b(other)g(wor)n(ds,)g(the)g(BOA)g
(will)i(be)f(in)g(the)f(same)h(state)e(as)i(it)g(was)g(in)30
3058 y(befor)n(e)g Fn(impl)p 527 3058 V 31 w(is)p 668
3058 V 32 w(ready)e Fr(was)i(called.)28 b(For)19 b(example,)i(a)g(r)n
(emote)e(client)i(may)f(hang)h(if)g(it)f(tries)g(to)30
3171 y(connect)k(to)g(the)f(server)g(after)i Fn(impl)p
1326 3171 V 31 w(shutdown)c Fr(was)j(called)h(because)f(no)g(thr)n(ead)
g(is)h(listening)30 3284 y(on)d(the)g(IIOP)g(port.)171
3398 y Fn(impl)p 396 3398 V 31 w(shutdown)f Fr(does)i(not)h(wait)i(for)
e(incoming)i(r)n(equests)c(to)j(complete)f(befor)n(e)g(it)h(closes)30
3511 y(the)j(network)f(connections.)46 b(The)28 b(r)n(emote)g(clients)h
(will)h(see)e(the)g(network)f(connections)h(shut-)30
3624 y(down)h(and)g(the)g(r)n(eplies)g(may)h(not)f(r)n(each)i(them)e
(even)g(if)h(the)f(upcalls)i(have)f(been)f(completed.)30
3737 y(Ther)n(efor)n(e,)22 b(if)h(the)f(application)i(is)f(to)g
(de\002ne)e(an)j(operation)d(in)j(an)f(IDL)g(interface)g(to)f(shutdown)
30 3850 y(the)g(BOA,)g(the)g(operation)f(should)h(be)h(de\002ned)d(as)j
(an)g(oneway)f(operation.)171 3964 y Fn(impl)p 396 3964
V 31 w(shutdown)14 b Fr(is)j(thr)n(ead-safe)g(and)h(can)g(be)f(called)i
(multiple)e(times.)26 b(The)17 b(call)i(is)e(silently)30
4077 y(ignor)n(ed)24 b(if)i(the)f(BOA)g(has)g(alr)n(eady)h(been)f
(shutdown.)34 b(After)24 b Fn(impl)p 2459 4077 V 31 w(shutdown)e
Fr(is)j(called,)i(the)30 4190 y(BOA)22 b(can)i(be)e(r)n(eactivated)h
(by)g(another)f(call)i(to)e Fn(impl)p 1941 4190 V 31
w(is)p 2082 4190 V 32 w(ready)p Fr(.)171 4304 y(It)e(should)f(be)g
(noted)g(that)h Fn(impl)p 1318 4304 V 30 w(shutdown)d
Fr(does)h(not)i(af)n(fect)h(outgoing)d(network)g(connec-)30
4417 y(tions.)26 b(That)19 b(is,)g(clients)g(in)g(the)g(same)f(addr)n
(ess)g(space)h(will)h(still)f(be)g(able)h(to)e(make)h(calls)h(to)f
(objects)30 4530 y(in)k(other)e(addr)n(ess)h(spaces.)171
4644 y(While)28 b(r)n(emote)e(r)n(equests)g(ar)n(e)i(not)f(deliver)n
(ed)f(after)i Fn(impl)p 2265 4644 V 31 w(shutdown)c Fr(is)j(called,)j
(the)c(cur)n(-)30 4757 y(r)n(ent)19 b(implementation)h(does)f(not)g
(stop)g(colocated)g(clients)h(fr)n(om)h(calling)h(the)d(objects.)26
b(In)20 b(futur)n(e,)30 4870 y(colocated)i(clients)h(will)h(exhibit)f
(the)f(same)g(behaviour)h(as)g(r)n(emote)f(clients.)171
4984 y Fn(destroy)17 b Fr(permanently)j(r)n(emoved)g(the)f(BOA.)h(This)
g(function)h(will)g(call)i Fn(impl)p 2988 4984 V 31 w(shutdown)30
5097 y Fr(implicitly)33 b(if)g(it)e(has)h(not)e(been)h(called.)55
b(When)31 b(this)g(call)j(r)n(eturns,)e(the)f(IIOP)g(port\(s\))f(held)h
(by)30 5210 y(the)22 b(BOA)h(will)i(be)e(fr)n(eed.)29
b(Remote)21 b(clients)j(will)g(see)e(their)h(r)n(equests)e(r)n(efused)h
(by)h(the)f(operating)30 5323 y(system)f(when)h(they)f(try)h(to)g(open)
f(a)j(connection)e(to)g(the)f(IIOP)i(port\(s\).)171 5437
y(After)j Fn(destroy)e Fr(is)j(called,)h(the)e(BOA)h(should)f(not)g(be)
h(used.)39 b(If)27 b(ther)n(e)e(is)i(any)g(objects)f(still)30
5550 y(r)n(egister)n(ed)h(with)j(the)e(BOA,)h(the)g(objects)g(should)f
(not)h(be)g(invoked)f(afterwar)n(ds.)48 b(The)29 b(objects)p
eop
%%Page: 51 57
51 56 bop 150 100 a Fd(5.5.)51 b(UNSUPPOR)m(TED)21 b(FUNCTIONS)1890
b Fr(51)150 356 y(ar)n(e)29 b(not)f(disposed.)44 b(Invoking)27
b(on)i(the)f(objects)g(after)g Fn(destroy)e Fr(would)i(r)n(esult)g(in)h
(unde\002ned)150 469 y(behaviour)-7 b(.)46 b(Initialisation)30
b(of)e(another)g(BOA)g(using)g Fn(BOA)p 2253 469 28 4
v 31 w(init)f Fr(is)h(not)g(supported.)42 b(The)28 b(be-)150
582 y(haviour)23 b(of)g Fn(BOA)p 762 582 V 31 w(init)e
Fr(after)i(this)f(call)i(is)f(unde\002ned.)150 894 y
Fi(5.5)119 b(Unsupported)30 b(functions)150 1110 y Fr(The)21
b(following)g(member)g(functions)g(ar)n(e)h(not)e(implemented.)27
b(Calling)c(these)c(functions)i(do)g(not)150 1223 y(have)i(any)g(ef)n
(fect.)286 1447 y Fo(\017)46 b Fn(Object)p 712 1447 V
30 w(ptr)53 b(create\(...\))286 1644 y Fo(\017)46 b Fn(ReferenceData*)i
(get)p 1365 1644 V 32 w(id\(Object)p 1892 1644 V 28 w(ptr\))286
1840 y Fo(\017)e Fn(Principal)p 877 1840 V 29 w(ptr)53
b(get)p 1289 1840 V 31 w(principal\(Object)p 2199 1840
V 26 w(ptr,Environment)p 3050 1840 V 26 w(ptr\))286 2037
y Fo(\017)46 b Fn(void)53 b(change)p 985 2037 V 30 w(implementation\()o
(Ob)o(je)o(ct)p 2166 2037 V 26 w(ptr,)g(Implementation-)377
2150 y(Def)p 547 2150 V 32 w(ptr\))286 2347 y Fo(\017)46
b Fn(void)53 b(deactivate)p 1205 2347 V 28 w(impl\(Implementa)o(ti)o
(onD)o(ef)p 2439 2347 V 26 w(ptr\))286 2543 y Fo(\017)46
b Fn(void)53 b(deactivate)p 1205 2543 V 28 w(obj\(Object)p
1783 2543 V 28 w(ptr\))150 2856 y Fi(5.6)119 b(Loading)31
b(Objects)e(On)g(Demand)150 3072 y Fr(Since)i(2.5.0,)j(ther)n(e)c(is)h
(limited)h(support)d(for)i(loading)g(objects)g(on)f(demand.)53
b(An)31 b(application)150 3185 y(can)e(r)n(egister)d(a)i(handler)g(for)
f(loading)h(objects)f(dynamically)-10 b(.)45 b(The)27
b(handler)g(should)g(have)h(the)150 3297 y(signatur)n(e)22
b Fn(omniORB::loader)o(::)o(ma)o(pK)o(ey)o(ToO)o(bj)o(ec)o(t)p
2251 3297 V 27 w(t)p Fr(:)250 3510 y Fc(namespace)48
b(omniORB)g({)349 3610 y(...)349 3710 y(class)h(loader)g({)349
3809 y(public:)449 3909 y(typedef)f(CORBA::Object_ptr)f
(\(*mapKeyToObject_t\))f(\(const)j(objec-)150 4009 y(tKey&)g(key\);)449
4108 y(static)g(void)g(set\(mapKeyToObject_t)d(NewKeyToObject\);)349
4208 y(};)250 4307 y(};)291 4531 y Fr(When)34 b(the)f(ORB)h(cannot)g
(locate)g(the)g(tar)n(get)f(object)h(in)g(this)g(addr)n(ess)f(space,)j
(it)e(calls)i(the)150 4644 y(handler)30 b(with)g(the)f(object)h(key)e
(of)i(the)g(tar)n(get.)49 b(The)29 b(handler)h(is)g(expected)e(to)h
(instantiate)h(the)150 4757 y(object,)24 b(either)e(in)i(this)g(addr)n
(ess)e(space)h(or)h(in)g(another)f(addr)n(ess)f(space,)h(and)h(r)n
(eturns)e(the)h(object)150 4870 y(r)n(efer)n(ence)33
b(to)f(the)g(newly)h(instantiated)f(object.)60 b(The)32
b(ORB)h(will)i(then)d(r)n(eply)h(with)g(a)h(LOCA-)150
4983 y(TION)p 389 4983 V 32 w(FOR)m(W)-8 b(ARD)35 b(message)f(to)h
(instr)o(uct)g(the)g(client)h(to)f(r)n(etry)g(using)g(the)g(object)h(r)
n(efer)n(ence)150 5096 y(r)n(eturned)27 b(by)h(the)f(handler)-7
b(.)45 b(When)28 b(the)f(handler)h(r)n(eturns,)h(the)e(ORB)h(assumes)f
(ownership)g(of)150 5209 y(the)j(r)n(eturned)f(value.)53
b(It)30 b(will)i(call)g(CORBA::r)n(elease\(\))e(on)h(the)f(r)n(eturned)
f(value)i(when)f(it)h(has)150 5322 y(\002nished)22 b(with)g(it.)291
5437 y(The)17 b(handler)h(may)g(be)f(called)i(concurr)n(ently)e(by)h
(multi-thr)n(eads.)26 b(Hence)17 b(it)h(must)f(be)g(thr)n(ead-)150
5550 y(safe.)p eop
%%Page: 52 58
52 57 bop 30 100 a Fr(52)1159 b Fd(CHAPTER)22 b(5.)51
b(THE)21 b(BASIC)h(OBJECT)h(ADAPT)n(OR)g(\(BOA\))171
356 y Fr(If)f(the)e(handler)h(cannot)h(load)g(the)e(tar)n(get)h
(object,)g(it)h(should)e(r)n(eturn)h(CORBA::Object::)p
3234 356 28 4 v 32 w(nil\(\).)30 469 y(The)h(object)g(will)i(be)f(tr)n
(eated)e(as)i(non-existing.)171 582 y(The)55 b(application)i(r)n
(egisters)d(the)h(handler)h(with)f(the)g(ORB)h(at)g(r)o(untime)g(using)
f(om-)30 695 y(niORB::loader::set\(\).)34 b(This)25 b(function)h(is)f
(not)g(thr)n(ead-safe.)36 b(Calling)27 b(this)e(function)g(again)i
(will)30 808 y(r)n(eplace)c(the)f(old)g(handler)h(with)f(the)g(new)g
(one.)p eop
%%Page: 53 59
53 58 bop 150 981 a Fk(Chapter)44 b(6)150 1398 y Fm(Interface)53
b(T)-19 b(ype)52 b(Checking)150 1861 y Fr(This)21 b(chapter)g
(describes)g(the)g(mechanism)h(used)e(by)i(omniORB2)g(to)f(ensur)n(e)f
(type)g(safety)h(when)150 1974 y(object)i(r)n(efer)n(ences)f(ar)n(e)h
(exchanged)f(acr)n(oss)h(the)f(network.)27 b(This)22
b(mechanism)i(is)f(handled)f(com-)150 2087 y(pletely)k(within)h(the)e
(ORB.)i(Ther)n(e)f(is)g(no)h(pr)n(ogramming)f(interface)h(visible)h(at)
f(the)f(application)150 2200 y(level.)i(However)-7 b(,)20
b(for)g(the)h(sake)f(of)h(diagnosing)f(the)g(pr)n(oblem)h(when)f(ther)n
(e)g(is)h(a)h(type)d(violation,)150 2313 y(it)32 b(is)g(useful)g(to)f
(understand)f(the)h(underlying)g(mechanism)h(in)h(or)n(der)e(to)g
(interpr)n(et)g(the)g(err)n(or)150 2426 y(conditions)22
b(r)n(eported)e(by)j(the)f(ORB.)150 2737 y Fi(6.1)119
b(Introduction)150 2952 y Fr(In)34 b(GIOP/IIOP)-12 b(,)35
b(an)f(object)g(r)n(efer)n(ence)g(is)h(encoded)d(as)j(an)f(Inter)n
(operable)f(Object)i(Refer)n(ence)150 3065 y(\(IOR\))f(when)e(it)h(is)h
(sent)e(acr)n(oss)h(a)g(network)f(connection.)58 b(The)33
b(IOR)g(contains)g(a)h(Repository)150 3178 y(ID)27 b(\(REPOID\))g(and)g
(one)f(or)h(mor)n(e)g(communication)h(pr)n(o\002les.)40
b(The)26 b(communication)i(pr)n(o\002les)150 3291 y(describe)f(wher)n
(e)h(and)g(how)f(the)h(object)g(can)h(be)f(contacted.)43
b(The)28 b(REPOID)f(is)i(a)f(string)g(which)150 3404
y(uniquely)22 b(identi\002es)g(the)f(IDL)i(interface)f(of)h(the)f
(object.)291 3519 y(Unless)17 b(the)g Fl(ID)h Fr(pragma)g(is)g
(speci\002ed)e(in)i(the)f(IDL,)g(the)g(ORB)h(generates)e(the)h(REPOID)g
(string)150 3632 y(in)27 b(the)e(so-called)i(OMG)g(IDL)f(Format)1519
3599 y Fj(1)1556 3632 y Fr(.)39 b(For)25 b(instance,)i(the)f(REPOID)g
(for)g(the)f Fn(Echo)g Fr(interface)150 3745 y(used)c(in)i(the)f
(examples)g(of)h(chapter)f(2)h(is)g Fn(IDL:Echo:1.0)p
Fr(.)291 3859 y(When)g(interface)g(inheritance)h(is)f(used)f(in)h(the)g
(IDL,)f(the)h(ORB)g(always)h(sends)d(the)h(REPOID)150
3972 y(of)h(the)e(most)h(derived)g(interface.)28 b(For)22
b(example:)150 4184 y Fc(//)49 b(IDL)299 4283 y(interface)g(A)g({)399
4383 y(...)299 4483 y(};)299 4582 y(interface)g(B)g(:)h(A)f({)399
4682 y(...)299 4782 y(};)299 4881 y(interface)g(C)g({)449
4981 y(void)g(op\(in)g(A)g(arg\);)299 5080 y(};)150 5280
y(//)g(C++)299 5379 y(C_ptr)g(server;)p 150 5462 1368
4 v 255 5518 a Fg(1)284 5550 y Ff(For)18 b(further)g(details)g(of)h
(the)g(r)o(epository)d(ID)j(formats,)f(see)g(section)g(6.6)h(in)g(the)h
(CORBA)e(speci\002cation.)1815 5778 y Fr(53)p eop
%%Page: 54 60
54 59 bop 30 100 a Fr(54)1464 b Fd(CHAPTER)21 b(6.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)179 356 y Fc(B_ptr)49
b(objB;)179 456 y(A_ptr)g(objA)g(=)h(objB;)179 555 y
(server->op\(objA\);)296 b(//)50 b(Send)f(B)g(as)h(A)171
767 y Fr(In)23 b(the)g(example,)h(the)e(operation)h(C::op)g(accepts)g
(an)h(object)g(r)n(efer)n(ence)f(of)g(type)f(A.)h(The)g(r)n(eal)30
880 y(type)34 b(of)h(the)f(r)n(efer)n(ence)g(passed)g(to)g(C::op)h(is)g
(B,)f(which)i(inherits)e(fr)n(om)i(A.)f(In)f(this)h(case,)j(the)30
993 y(REPOID)22 b(of)h(B,)f(and)h(not)f(that)g(of)h(A,)f(is)g(sent)g
(acr)n(oss)g(the)g(network.)171 1106 y(The)k(GIOP/IIOP)h
(speci\002cation)g(allows)g(an)g(ORB)f(to)g(send)f(a)i(null)h(string)d
(in)j(the)d(REPOID)30 1219 y(\002eld)30 b(of)g(an)g(IOR.)g(It)f(is)h
(up)g(to)f(the)g(r)n(eceiving)i(end)e(to)g(work)g(out)g(the)g(r)n(eal)i
(type)d(of)i(the)g(object.)30 1332 y(OmniORB2)36 b(never)d(sends)f(out)
i(null)h(strings)e(as)h(REPOID.)f(However)-7 b(,)36 b(it)e(may)h(r)n
(eceive)f(null)30 1445 y(REPOID)23 b(fr)n(om)i(other)d(ORBs.)30
b(In)23 b(that)h(case,)f(it)h(will)h(use)e(the)f(mechanism)j(described)
d(below)i(to)30 1558 y(ensur)n(e)d(type)g(safety)-10
b(.)30 1856 y Fi(6.2)119 b(Basic)29 b(Interface)f(T)-11
b(ype)30 b(Checking)30 2067 y Fr(The)22 b(ORB)g(is)h(pr)n(ovided)f
(with)g(the)g(interface)h(information)g(by)f(the)g(stubs)f(via)j(the)e
(pr)n(oxyObject-)30 2180 y(Factory)f(class.)28 b(For)21
b(an)h(interface)f(A,)h(the)e(stub)h(of)h(A)f(contains)h(a)g(A)p
2394 2180 28 4 v 33 w(pr)n(oxyObjectFactory)e(class.)30
2293 y(This)h(class)h(is)f(derived)g(fr)n(om)h(the)e(pr)n
(oxyObjectFactory)g(class.)28 b(The)21 b(pr)n(oxyObjectFactory)f(is)i
(an)30 2406 y(abstract)h(class)g(which)g(contains)g(3)g(virtual)h
(functions.)30 2705 y Fc(class)49 b(proxyObjectFactory)d({)30
2804 y(public:)130 3004 y(virtual)i(const)h(char)g(*irRepoId\(\))f
(const)h(=)g(0;)130 3203 y(virtual)f(_CORBA_Boolean)97
b(is_a\(const)48 b(char)h(*base_repoId\))f(const)g(=)i(0;)130
3402 y(virtual)e(CORBA::Object_ptr)f(newProxyObject\(Rope)f(*r,)2172
3502 y(CORBA::Octet)i(*key,)2172 3601 y(size_t)h(keysize,)2172
3701 y(IOP::TaggedProfileList)2172 3801 y(*profiles,)2172
3900 y(CORBA::Boolean)e(re-)30 4000 y(lease\))i(=)g(0;)30
4199 y(};)166 4511 y Fo(\017)d Fn(irRepoId)19 b Fr(r)n(eturns)j(the)g
(REPOID)g(of)h(the)e(interface.)166 4698 y Fo(\017)46
b Fn(is)p 372 4698 V 32 w(a)24 b Fr(r)n(eturns)g(tr)o(ue\(1\))h(if)h
(the)e(ar)n(gument)g(is)h(the)f(REPOID)g(of)h(the)f(interface)h(itself)
g(or)f(it)h(is)257 4811 y(that)e(of)f(its)h(base)f(interfaces.)166
4999 y Fo(\017)46 b Fn(newProxyObject)29 b Fr(r)n(eturns)35
b(an)h(object)f(r)n(efer)n(ence)g(based)g(on)g(the)g(information)h
(sup-)257 5112 y(plied)23 b(in)g(the)f(ar)n(guments.)171
5324 y(A)33 b(single)g(instance)g(of)g(every)f(*)p 1321
5324 V 33 w(pr)n(oxyObjectFactory)g(is)h(instantiated)f(at)i(r)o
(untime.)59 b(The)30 5437 y(instances)31 b(ar)n(e)h(enter)n(ed)d(into)i
(a)h(list)g(inside)f(the)f(ORB.)h(The)g(list)g(constitutes)f(all)i(the)
f(interface)30 5550 y(information)23 b(known)f(to)g(the)g(ORB.)p
eop
%%Page: 55 61
55 60 bop 150 100 a Fd(6.3.)51 b(INTERF)-7 b(ACE)21 b(INHERIT)-7
b(ANCE)1959 b Fr(55)291 356 y(When)26 b(the)f(ORB)h(r)n(eceives)g(an)h
(IOR)f(fr)n(om)h(the)e(network,)g(it)i(unmarshals)f(and)h(extracts)e
(the)150 469 y(REPOID)d(fr)n(om)i(the)d(IOR.)i(At)f(this)g(point,)g
(the)g(ORB)g(has)h(two)e(pieces)h(of)h(information)g(in)g(hand:)264
709 y(1.)45 b(The)22 b(REPOID)h(of)f(the)g(object)g(r)n(efer)n(ence)g
(r)n(eceived)h(fr)n(om)g(the)f(network.)264 920 y(2.)45
b(The)18 b(REPOID)h(the)e(ORB)i(is)g(expecting.)25 b(This)18
b(comes)g(fr)n(om)h(the)f(unmarshal)i(function)e(that)377
1032 y(tells)23 b(the)e(ORB)i(to)f(r)n(eceive)h(the)f(object)g(r)n
(efer)n(ence.)291 1273 y(Using)29 b(the)h(REPOID)f(r)n(eceived,)j(the)d
(ORB)h(sear)n(ches)f(its)h(pr)n(oxyObjectFactory)f(list)h(for)g(an)150
1386 y(exact)i(match.)55 b(If)32 b(ther)n(e)f(is)h(an)g(exact)f(match,)
k(all)e(is)f(well)g(because)f(the)g(r)o(untime)h(can)g(use)f(the)150
1499 y Fn(is)p 265 1499 28 4 v 32 w(a)24 b Fr(method)f(of)h(the)g(pr)n
(oxyFactory)f(to)g(check)i(if)g(the)f(expected)e(REPOID)i(is)g(the)g
(same)g(as)h(the)150 1612 y(r)n(eceived)d(REPOID)f(or)h(if)g(it)g(is)g
(that)g(of)g(its)f(base)h(interfaces.)27 b(If)22 b(the)f(answer)g(is)h
(positive,)f(the)g(IOR)150 1725 y(passes)g(the)g(type)g(checking)h
(test)e(and)i(the)g(ORB)g(can)h(pr)n(oceed)e(to)g(cr)n(eate)h(an)h
(object)f(r)n(efer)n(ence)g(in)150 1838 y(its)g(own)g(addr)n(ess)g
(space)g(to)g(r)n(epr)n(esent)f(the)g(IOR.)291 1956 y(However)-7
b(,)33 b(the)f(ORB)f(may)i(fail)h(to)d(\002nd)h(a)h(match)g(in)f(its)g
(pr)n(oxyObjectFactory)f(list.)56 b(This)150 2069 y(means)25
b(that)g(the)f(ORB)h(has)g(no)g(local)i(knowledge)c(of)i(the)f(REPOID.)
h(Ther)n(e)f(ar)n(e)i(thr)n(ee)e(possible)150 2182 y(causes:)264
2422 y(1.)45 b(The)22 b(r)n(emote)g(end)g(is)g(another)g(ORB)g(and)h
(it)g(sends)e(a)i(null)g(string)f(as)h(the)f(REPOID.)264
2633 y(2.)45 b(The)27 b(ORB)h(is)g(expecting)f(an)h(object)g(r)n(efer)n
(ence)f(of)h(interface)g(A.)g(The)f(r)n(emote)g(end)g(sends)377
2745 y(the)j(REPOID)h(of)g(B)f(which)i(is)f(an)g(interface)g(that)g
(inherits)f(fr)n(om)i(A.)e(The)h(stubs)e(of)i(A)g(is)377
2858 y(linked)22 b(into)h(the)f(executable)g(but)g(the)g(stubs)g(of)g
(B)h(is)f(not.)264 3068 y(3.)45 b(The)22 b(r)n(emote)g(end)g(has)g
(sent)g(a)h(duf)n(f)g(IOR.)291 3309 y(T)-8 b(o)22 b(handle)g(this)g
(situation,)g(the)f(ORB)h(must)g(\002nd)g(out)g(the)f(type)g
(information)i(dynamically)-10 b(.)150 3422 y(This)22
b(is)h(explained)f(in)h(the)f(next)g(section.)150 3755
y Fi(6.3)119 b(Interface)28 b(Inheritance)150 3977 y
Fr(When)22 b(the)h(ORB)f(r)n(eceives)h(an)h(IOR)e(of)h(interface)h
(type)d(B)i(when)f(it)h(expects)e(the)i(type)e(to)h(be)h(A,)g(it)150
4090 y(must)g(\002nd)g(out)f(if)i(B)f(inherits)g(fr)n(om)h(A.)f(When)f
(the)h(ORB)g(has)g(no)g(local)i(knowledge)c(of)i(the)g(type)150
4203 y(B,)f(it)h(must)f(work)f(out)h(the)g(type)f(of)i(B)f(dynamically)
-10 b(.)291 4322 y(The)23 b(CORBA)h(speci\002cation)f(de\002nes)f(an)i
(Interface)f(Repository)e(\(IR\))j(fr)n(om)g(which)g(IDL)f(in-)150
4435 y(terfaces)d(can)h(be)g(queried)e(dynamically)-10
b(.)29 b(In)20 b(the)g(above)g(situation,)h(the)e(ORB)i(could)f
(contact)h(the)150 4547 y(IR)d(to)f(\002nd)h(out)g(the)f(type)g(of)h
(B.)g(However)-7 b(,)17 b(this)h(appr)n(oach)h(assumes)e(that)h(an)h
(IR)f(is)g(always)h(avail-)150 4660 y(able)25 b(and)f(contains)g(the)f
(up-to-date)g(information)h(of)g(all)i(the)d(interfaces)h(used)e(in)j
(the)e(domain.)150 4773 y(This)f(assumption)g(may)h(not)f(be)g(valid)i
(in)g(many)e(applications.)291 4892 y(An)c(alternative)h(is)f(to)g(use)
f(the)p 1368 4892 V 50 w Fn(is)p 1510 4892 V 32 w(a)h
Fr(operation)f(to)g(work)h(out)f(the)g(actual)j(type)d(of)h(an)h
(object.)150 5005 y(This)i(appr)n(oach)h(is)g(simpler)f(and)h(mor)n(e)f
(r)n(obust)g(than)g(the)g(pr)n(evious)g(one)g(because)g(no)g(3r)n(d)h
(party)150 5118 y(is)h(involved.)150 5351 y Fc(class)49
b(Object{)349 5450 y(CORBA::Boolean)e(_is_a\(const)h(char*)h
(type_id\);)150 5550 y(};)p eop
%%Page: 56 62
56 61 bop 30 100 a Fr(56)1464 b Fd(CHAPTER)21 b(6.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)171 356 y Fr(The)p
354 356 28 4 v 57 w Fn(is)p 496 356 V 32 w(a)k Fr(operation)f(is)h
(part)g(of)g(the)g Fn(CORBA::Object)19 b Fr(interface)26
b(and)f(must)f(be)h(imple-)30 469 y(mented)17 b(by)h(every)f(object.)26
b(The)17 b(input)h(ar)n(gument)f(is)h(a)h(REPOID.)f(The)f(function)h(r)
n(eturns)f(tr)o(ue\(1\))30 582 y(if)k(the)f(object)g(is)h(r)n(eally)g
(an)g(instance)g(of)f(that)h(type,)e(including)i(if)g(that)f(type)f(is)
i(a)g(base)f(type)f(of)i(the)30 695 y(most)h(derived)f(type)h(of)g
(that)h(object.)171 808 y(In)30 b(the)f(situation)h(above,)i(the)e(ORB)
g(would)f(invoke)h(the)p 2254 808 V 62 w Fn(is)p 2396
808 V 32 w(a)g Fr(operation)f(on)h(the)f(object)30 920
y(and)22 b(ask)g(if)i(the)d(object)i(is)f(of)g(type)f(A)i
Fl(before)g Fr(it)f(pr)n(ocesses)f(any)h(application)i(invocation)f(on)
f(the)30 1033 y(object.)171 1146 y(Notice)30 b(that)g(the)p
817 1146 V 62 w Fn(is)p 959 1146 V 32 w(a)g Fr(call)i(is)e
Fl(not)g Fr(performed)f(when)g(the)h(IOR)g(is)g(unmarshalled.)51
b(It)30 b(is)30 1259 y(performed)h(just)h(prior)h(to)f(the)g(\002rst)g
(application)i(invocation)g(on)e(the)g(object.)59 b(This)32
b(leads)h(to)30 1372 y(some)26 b(inter)n(esting)g(failur)n(e)i(mode)e
(if)i(B)f(r)n(eports)e(that)i(it)g(is)g(not)f(an)i(A.)e(Consider)h(the)
f(following)30 1485 y(example:)30 1781 y Fc(\\\\)49 b(IDL)179
1881 y(interface)g(A)g({)h(...)f(};)179 1980 y(interface)g(B)g(:)h(A)f
({)h(...)f(};)179 2080 y(interface)g(D)g({)h(...)f(};)179
2180 y(interface)g(C)g({)279 2279 y(A)299 b(op1\(\);)279
2379 y(Object)49 b(op2\(\);)179 2478 y(};)30 2678 y(\\\\)g(C++)179
2877 y(C_ptr)g(objC;)179 2977 y(A_ptr)g(objA;)179 3076
y(CORBA::Object_ptr)e(objR;)179 3275 y(objA)i(=)100 b(objC->op1\(\);)
695 b(//)50 b(line)f(1)179 3375 y(\(void\))g(objA->_non_existent\(\);)
245 b(//)50 b(line)f(2)179 3574 y(objR)g(=)100 b(objC->op2\(\);)695
b(//)50 b(line)f(3)179 3674 y(objA)g(=)100 b(A::_narrow\(objR\);)445
b(//)50 b(line)f(4)30 3983 y Fr(If)23 b(the)e(stubs)h(of)h(A,B,C,D)f
(ar)n(e)h(linked)f(into)g(the)g(executable)g(and:)30
4193 y Fl(Case)i(1)46 b Fn(C::op1)27 b Fr(and)k Fn(C::op2)d
Fr(r)n(eturns)h(a)i(B.)f(Line)g(1-4)i(complete)d(successful.)51
b(The)30 b(r)n(emote)257 4306 y(object)23 b(is)f(only)h(contacted)f(at)
g(line)h(2.)30 4492 y Fl(Case)h(2)46 b Fn(C::op1)19 b
Fr(and)j Fn(C::op2)e Fr(r)n(eturns)h(a)i(D.)f(This)g(condition)g(only)g
(occurs)g(if)h(the)f(r)o(untime)g(of)257 4605 y(the)i(r)n(emote)f(end)h
(is)h(buggy)-10 b(.)32 b(The)24 b(ORB)g(raises)g(a)h(CORBA::Marshal)g
(exception)e(at)i(line)g(1)257 4718 y(because)e(it)f(knows)g(it)g(has)h
(r)n(eceived)f(an)h(interface)g(of)g(the)f(wr)n(ong)g(type.)30
4928 y(If)h(only)f(the)g(stub)g(of)g(A)h(is)g(linked)f(into)g(the)g
(executable)g(and:)30 5137 y Fl(Case)i(1)46 b Fr(C::op1)22
b(and)g(C::op2)g(r)n(eturns)g(a)h(B.)e(Line)h(1-4)i(completes)d
(successful.)27 b(When)22 b(line)h(2)g(and)257 5250 y(4)g(is)g
(executed,)e(the)g(object)i(is)g(contacted)e(to)h(ask)h(if)g(it)g(is)g
(a)g(A.)30 5437 y Fl(Case)h(2)46 b Fr(C::op1)21 b(and)g(C::op2)g(r)n
(eturns)f(a)i(D.)g(This)f(condition)g(only)g(occurs)g(if)h(the)e(r)o
(untime)i(of)f(the)257 5550 y(r)n(emote)i(end)g(is)h(buggy)-10
b(.)30 b(Line)23 b(1)h(completes)f(and)h(no)f(exception)f(is)i(raised.)
31 b(At)23 b(line)i(2,)f(the)p eop
%%Page: 57 63
57 62 bop 150 100 a Fd(6.3.)51 b(INTERF)-7 b(ACE)21 b(INHERIT)-7
b(ANCE)1959 b Fr(57)377 356 y(object)23 b(is)f(contacted)g(to)g(ask)g
(if)i(it)f(is)f(a)i(A.)e(If)g(the)g(answer)g(is)h(no,)f(a)h(CORBA::INV)
p 3220 356 28 4 v 31 w(OBJREF)377 469 y(exception)f(is)h(raised.)28
b(The)23 b(application)h(will)g(also)f(see)f(a)h(CORBA::INV)p
2949 469 V 31 w(OBJREF)f(at)i(line)377 582 y(4.)p eop
%%Page: 58 64
58 63 bop 30 100 a Fr(58)1464 b Fd(CHAPTER)21 b(6.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)p eop
%%Page: 59 65
59 64 bop 150 982 a Fk(Chapter)44 b(7)150 1401 y Fm(Connection)52
b(Management)150 1866 y Fr(This)22 b(chapter)h(describes)e(how)h
(omniORB2)h(manages)g(network)d(connections.)150 2186
y Fi(7.1)119 b(Background)150 2404 y Fr(In)27 b(CORBA,)g(the)f(ORB)i
(is)f(the)f(\223middlewar)n(e\224)j(that)e(allows)g(a)h(client)g(to)f
(invoke)f(an)i(operation)150 2517 y(on)f(an)h(object)g(without)e(r)n
(egar)n(d)i(to)e(its)i(implementation)f(or)g(location.)44
b(In)27 b(or)n(der)g(to)g(invoke)g(an)150 2630 y(operation)j(on)g(an)h
(object,)i(a)e(client)g(needs)e(to)i(\223bind\224)h(to)e(the)g(object)g
(by)h(acquiring)h(its)e(object)150 2743 y(r)n(efer)n(ence.)38
b(Such)27 b(a)g(r)n(efer)n(ence)f(may)g(be)h(obtained)f(as)g(the)g(r)n
(esult)f(of)i(an)g(operation)e(on)h(another)150 2856
y(object)k(\(such)g(as)f(a)i(naming)f(service\))g(or)g(by)g(conversion)
f(fr)n(om)h(a)h(stringi\002ed)d(r)n(epr)n(esentation)150
2969 y(pr)n(eviously)20 b(generated)d(by)k(the)e(same)h(ORB.)g(If)g
(the)f(object)h(is)h(in)f(a)h(dif)n(fer)n(ent)f(addr)n(ess)f(space,)h
(the)150 3082 y(binding)f(pr)n(ocess)f(involves)h(the)f(ORB)g(building)
i(a)f(pr)n(oxy)f(object)h(in)g(the)f(client's)h(addr)n(ess)f(space.)150
3194 y(The)24 b(ORB)h(arranges)g(for)g(invocations)g(on)g(the)f(pr)n
(oxy)g(object)h(to)f(be)h(transpar)n(ently)f(mapped)h(to)150
3307 y(equivalent)e(invocations)g(on)f(the)g(implementation)h(object.)
291 3424 y(For)29 b(the)g(sake)f(of)i(inter)n(operability)-10
b(,)31 b(CORBA)e(mandates)g(that)h(all)h(ORBs)e(should)f(support)150
3537 y(IIOP)35 b(as)h(the)f(means)g(to)g(communicate)h(r)n(emote)f
(invocations)g(over)h(a)g(TCP/IP)f(connection.)150 3650
y(IIOP)21 b(is)h(asymmetric)f(with)h(r)n(espect)e(to)h(the)f(r)n(oles)h
(of)h(the)f(parties)f(at)i(the)f(two)f(ends)g(of)i(a)g(connec-)150
3763 y(tion.)32 b(At)23 b(one)g(end)g(is)h(the)f(client)i(which)f(can)h
(only)f(initiate)g(r)n(emote)f(invocations.)33 b(At)23
b(the)g(other)150 3875 y(end)f(is)g(the)g(server)g(which)h(can)g(only)g
(r)n(eceive)g(r)n(emote)e(invocations.)291 3992 y(Notice)33
b(that)h(in)g(CORBA,)g(as)g(in)g(most)f(distributed)g(systems,)h(r)n
(emote)f(bindings)g(ar)n(e)i(es-)150 4105 y(tablished)27
b(implicitly)i(without)e(application)h(intervention.)41
b(This)27 b(pr)n(ovides)g(the)f(illusion)i(that)150 4218
y(all)h(objects)e(ar)n(e)h(local,)i(a)e(pr)n(operty)e(known)g(as)i
(\223location)h(transpar)n(ency\224.)42 b(CORBA)28 b(does)e(not)150
4331 y(specify)20 b(when)g(such)g(bindings)g(should)g(be)g(established)
g(or)g(how)g(they)f(should)g(be)i(multiplexed)150 4443
y(over)29 b(the)h(underlying)e(network)g(connections.)49
b(Instead,)30 b(ORBs)f(ar)n(e)h(fr)n(ee)g(to)f(implement)h(im-)150
4556 y(plicit)24 b(binding)f(by)f(a)h(variety)g(of)g(means.)291
4673 y(The)28 b(r)n(est)f(of)i(this)f(chapter)g(describes)f(how)h
(omniORB2)h(manages)g(network)d(connections)150 4786
y(and)d(the)e(pr)n(ogramming)i(interface)g(to)f(\002ne)g(tune)g(the)g
(management)g(policy)-10 b(.)150 5106 y Fi(7.2)119 b(The)29
b(Model)150 5324 y Fr(OmniORB2)34 b(is)e(designed)f(fr)n(om)i(the)e(gr)
n(ound)h(up)g(to)g(be)g(fully)h(multi-thr)n(eaded.)57
b(The)32 b(objec-)150 5437 y(tive)k(is)f(to)g(maximise)h(the)f(degr)n
(ee)f(of)h(concurr)n(ency)g(and)h(at)f(the)g(same)g(time)h(eliminate)g
(any)150 5550 y(unnecessary)30 b(thr)n(ead)i(over)n(head.)56
b(Another)31 b(objective)h(is)h(to)e(minimise)i(the)f(interfer)n(ence)f
(by)1815 5778 y(59)p eop
%%Page: 60 66
60 65 bop 30 100 a Fr(60)1387 b Fd(CHAPTER)21 b(7.)51
b(CONNECTION)22 b(MANAGEMENT)30 356 y Fr(the)h(activities)i(of)f(other)
f(thr)n(eads)g(on)h(the)f(pr)n(ogr)n(ess)f(of)i(a)h(r)n(emote)e
(invocation.)33 b(In)24 b(other)e(wor)n(ds,)30 469 y(thr)n(ead)h
(\223cr)n(oss-talk\224)g(should)f(be)h(minimised)h(within)f(the)g(ORB.)
f(T)-8 b(o)22 b(achieve)i(these)e(objectives,)30 582
y(the)g(degr)n(ee)f(of)h(multiplexing)h(at)g(every)e(level)j(is)e(kept)
f(to)h(a)i(minimum.)171 698 y(On)f(the)e(client)h(side)f(of)h(a)g
(connection,)g(the)f(thr)n(ead)g(that)h(invokes)f(on)g(a)i(pr)n(oxy)e
(object)h(drives)30 811 y(the)28 b(IIOP)h(pr)n(otocol)g(dir)n(ectly)g
(and)g(blocks)g(on)g(the)f(connection)g(to)h(r)n(eceive)g(the)g(r)n
(eply)-10 b(.)46 b(On)30 b(the)30 924 y(server)20 b(side,)g(a)h
(dedicated)e(thr)n(ead)i(blocks)f(on)g(the)g(connection.)27
b(When)20 b(it)h(r)n(eceives)f(a)i(r)n(equest,)d(it)30
1037 y(performs)k(the)g(up-call)j(to)d(the)g(object)h(and)g(sends)e
(the)i(r)n(eply)f(when)h(the)f(upcall)i(r)n(eturns.)31
b(Ther)n(e)30 1150 y(is)23 b(no)f(thr)n(ead)g(switching)g(along)h(the)f
(call)i(chain.)171 1266 y(W)-5 b(ith)27 b(this)f(design,)g(ther)n(e)g
(is)h(at)g(most)f(one)g(call)i(in-\003ight)g(at)f(any)f(time)h(in)g(a)g
(connection.)40 b(If)30 1379 y(ther)n(e)19 b(is)h(only)f(one)g
(connection,)g(concurr)n(ent)h(invocations)g(to)f(the)g(same)g(r)n
(emote)g(addr)n(ess)f(space)30 1492 y(would)32 b(have)h(to)f(be)h
(serialised.)57 b(T)-8 b(o)32 b(eliminate)i(this)e(limitation,)k
(omniORB2)d(implements)g(a)30 1605 y(dynamic)d(policy-)g(multiple)g
(connections)f(to)g(the)g(same)g(r)n(emote)g(addr)n(ess)f(space)i(ar)n
(e)g(cr)n(eated)30 1718 y(on)22 b(demand)g(and)h(cached)g(when)f(ther)n
(e)f(ar)n(e)i(concurr)n(ent)f(invocations)i(in)f(pr)n(ogr)n(ess.)171
1834 y(T)-8 b(o)26 b(be)g(mor)n(e)h(pr)n(ecise,)g(a)g(network)e
(connection)h(to)g(another)g(addr)n(ess)f(space)h(is)h(only)f(estab-)30
1947 y(lished)d(when)h(a)g(r)n(emote)f(invocation)i(is)f(about)g(to)f
(be)h(made.)31 b(Ther)n(efor)n(e,)23 b(ther)n(e)g(may)h(be)g(one)f(or)
30 2060 y(mor)n(e)e(object)g(r)n(efer)n(ences)f(in)h(one)f(addr)n(ess)g
(space)h(that)f(r)n(efers)h(to)f(objects)g(in)i(a)g(dif)n(fer)n(ent)f
(addr)n(ess)30 2173 y(space)30 b(but)g(unless)f(the)h(application)h
(invokes)e(on)h(these)f(objects,)i(no)f(network)e(connection)i(is)30
2286 y(made.)53 b(The)31 b(maximum)i(number)e(of)g(connections)f
(opened)f(to)h(another)h(addr)n(ess)e(space)i(is)h(5)30
2399 y(by)i(default.)61 b(Since)34 b(2.6.0,)k(this)33
b(parameter)g(can)i(be)f(changed)f(by)h(setting)e(the)h(variable)j
Fn(om-)30 2511 y(niORB::maxTcpCo)o(nn)o(ec)o(ti)o(onP)o(er)o(Se)o(rv)o
(er)16 b Fl(before)24 b Fr(calling)g Fn(ORB)p 2550 2511
28 4 v 31 w(init)p Fr(.)171 2628 y(It)35 b(is)h(wasteful)f(to)g(leave)h
(a)g(connection)g(opened)d(when)i(it)h(has)f(been)g(left)h(unused)e
(for)i(a)30 2741 y(considerable)28 b(time.)43 b(T)-8
b(oo)27 b(many)h(idle)g(connections)f(could)h(block)g(out)f(new)g
(connections)g(to)h(a)30 2854 y(server)i(when)g(it)h(r)o(uns)f(out)g
(of)h(spar)n(e)f(communication)i(channels.)53 b(For)29
b(example,)k(most)d(unix)30 2966 y(platforms)22 b(has)g(a)g(limit)i(on)
e(the)f(number)h(of)g(\002le)g(handles)f(a)i(pr)n(ocess)d(can)j(open.)k
(64)c(is)f(the)f(usual)30 3079 y(default)31 b(limit.)56
b(The)31 b(value)h(can)g(be)g(incr)n(eased)f(to)g(a)h(maximum)h(of)f(a)
g(thousand)e(or)h(mor)n(e)g(by)30 3192 y(changing)23
b(the)f(\223ulimit\224)i(in)f(the)f(shell.)30 3512 y
Fi(7.3)119 b(Idle)29 b(Connection)i(Shutdown)f(and)g(Remote)g(Call)f(T)
-7 b(imeout)30 3730 y Fr(Inside)27 b(the)h(ORB,)g(a)h(thr)n(ead)e(is)i
(dedicated)e(to)h(scan)h(for)f(idle)g(connections.)45
b(The)27 b(thr)n(ead)h(looks)30 3843 y(after)23 b(both)f(the)g
(outgoing)e(connections)i(and)h(the)f(incoming)h(connections.)171
3959 y(When)d(a)i(connection)e(is)h(idled)f(for)h(a)g(period)f(of)h
(time,)g(the)f(connection)g(is)h(shutdown.)k(Simi-)30
4072 y(larly)-10 b(,)20 b(if)f(a)g(r)n(emote)e(call)k(has)d(not)g
(completed)f(within)i(a)g(de\002ned)d(period)i(of)g(time,)h(the)f
(connection)30 4185 y(is)23 b(shutdown)d(and)j(the)f(ORB)g(will)i(r)n
(eturn)e Fn(COMM)p 1763 4185 V 31 w(FAILURE)d Fr(to)j(the)g(client.)171
4301 y(How)57 b(often)f(the)h(internal)g(thr)n(ead)g(scan)h(the)e
(connections)h(is)g(determined)f(by)h(the)30 4414 y(value)c(of)g(the)f
Fq(scan)h(granularity)p Fr(.)121 b(This)52 b(value)i(is)f(default)f(to)
h(5)g(seconds)e(and)i(can)g(be)30 4527 y(changed)27 b(using)g(the)f
(command-line)j(option)d Fn(-ORBscanGranula)o(ri)o(ty)21
b Fr(or)27 b(using)g(the)f Fn(om-)30 4640 y(niORB::scanGran)o(ul)o(ar)o
(it)o(y\(\))19 b Fr(call.)37 b(Notice)25 b(that)g(this)g(value)h
(determines)e(the)g(pr)n(ecision)30 4753 y(the)e(ORB)g(is)h(able)g(to)f
(keep)f(to)h(the)g(value)i(of)e(the)g(idle)h(connection)f(or)g(r)n
(emote)g(call)i(timeout.)171 4869 y(How)19 b(long)g(the)g(ORB)g(will)i
(wait)f(befor)n(e)f(it)h(shuts)e(down)h(an)h(idle)f(connection)g(is)h
(determined)30 4982 y(by)27 b(the)g(idleConnectionPeriods.)39
b(Ther)n(e)26 b(ar)n(e)i(separate)e(values)i(for)f(incoming)h(and)f
(outgoing)30 5095 y(connections.)61 b(The)34 b(default)g(values)g(ar)n
(e)h(180)g(and)f(120)i(seconds)c(for)j(incoming)f(and)g(outgo-)30
5208 y(ing)c(connections)e(r)n(espectively)-10 b(.)48
b(These)28 b(values)h(can)i(be)e(changed)g(using)g(the)g(command-line)
30 5321 y(options)e Fn(-ORBinConScanPe)o(rio)o(d)22 b
Fr(and)29 b Fn(-ORBoutConScanP)o(er)o(iod)o Fr(.)40 b(They)28
b(can)h(also)g(be)30 5433 y(contr)n(olled)22 b(by)h(the)f
Fn(omniORB::idleC)o(on)o(ne)o(ct)o(ion)o(Sc)o(an)o(Pe)o(ri)o(od\()o(\))
16 b Fr(call.)171 5550 y(Similary)-10 b(,)19 b(how)e(long)g(the)g(ORB)g
(will)h(wait)g(for)f(a)h(r)n(emote)e(call)j(to)e(complete)g(is)g
(determined)e(by)p eop
%%Page: 61 67
61 66 bop 150 100 a Fd(7.4.)51 b(INTEROPERABILITY)18
b(CONSIDERA)-7 b(TIONS)1416 b Fr(61)150 356 y(the)18
b(parameter)g(clientCallT)-5 b(imeOutPeriod)20 b(for)f(the)f(client)h
(side)f(and)h(the)f(serverCallT)-5 b(imeOut-)150 469
y(Per)n(oid)23 b(for)h(the)e(server)h(side.)30 b(The)23
b(default)g(values)h(ar)n(e)g(60)h(and)e(90)i(seconds)d(for)h(the)g
(client)h(and)150 582 y(the)19 b(server)g(side)h(r)n(espectively)-10
b(.)25 b(These)19 b(values)h(can)h(be)f(changed)f(using)h(the)f
(command-line)i(op-)150 695 y(tion)46 b Fn(-ORBclientCallT)o(im)o(eO)o
(utP)o(er)o(io)o(d)40 b Fr(and)47 b Fn(-ORBserverCall)o(Ti)o(me)o(Ou)o
(tPe)o(ri)o(od)o Fr(.)150 808 y(They)21 b(can)j(also)f(be)f(contr)n
(olled)g(by)h(the)f Fn(omniORB::callT)o(ime)o(Ou)o(tP)o(er)o(io)o
(d\(\))16 b Fr(call.)150 1089 y Fc(class)49 b(omniORB)f({)150
1288 y(public:)250 1487 y(static)g(void)h
(scanGranularity\(CORBA::ULong)c(sec\);)250 1687 y(static)j
(CORBA::ULong)g(scanGranularity\(\);)250 1886 y(enum)h(idleConnType)e
({)j(idleIncoming,)d(idleOutgoing)h(};)250 2085 y(static)g(void)h
(idleConnectionScanPeriod\(idleConnType)43 b(direction,)2093
2185 y(CORBA::ULong)k(sec\);)250 2384 y(static)h(CORBA::ULong)g
(idleConnectionScanPeriod\(idleConnTy)o(pe)c(direction\);)250
2583 y(enum)49 b(callTimeOutType)e({)i(clientSide,)f(serverSide)g(};)
250 2783 y(static)g(void)h(callTimeOutPeriod\(callTimeOutType)44
b(direction,)1346 2882 y(CORBA::ULong)j(sec\);)250 3081
y(static)h(CORBA::ULong)g(callTimeOutPeriod\(callTimeOutType)c
(direction\);)150 3281 y(};)291 3575 y Fr(The)22 b(scan)h(can)g(be)g
(disabled)g(completely)e(by)i(setting)e(the)h(scan)h(granularity)g(to)f
(0.)150 3871 y Fi(7.4)119 b(Interoperability)28 b(Considerations)150
4082 y Fr(The)j(IIOP)g(speci\002cation)h(allows)g(both)g(the)f(client)h
(and)f(the)g(server)g(to)g(shutdown)f(a)i(connec-)150
4195 y(tion)26 b(unilaterally)-10 b(.)41 b(When)25 b(one)h(end)g(is)g
(about)h(to)e(shutdown)g(a)i(connection,)f(it)h(should)e(send)h(a)150
4308 y(closeConnection)d(message)f(to)g(the)h(other)f(end.)30
b(It)22 b(should)h(also)h(make)f(sur)n(e)g(that)g(the)g(message)150
4421 y(will)h(r)n(each)f(the)f(other)f(end)h(befor)n(e)g(it)h(pr)n
(oceeds)e(to)h(shutdown)f(the)g(connection.)291 4534
y(The)36 b(client)h(should)e(distinguish)h(between)f(an)i(or)n(derly)e
(and)i(an)g(abnormal)h(connection)150 4647 y(shutdown.)25
b(When)20 b(a)h(client)g(r)n(eceives)f(a)h(closeConnection)e(message)g
(befor)n(e)h(the)g(connection)g(is)150 4759 y(closed,)k(the)g
(condition)g(is)h(an)g(or)n(derly)f(shutdown.)31 b(If)25
b(the)f(message)f(is)i(not)e(r)n(eceived,)i(the)f(con-)150
4872 y(dition)j(is)g(an)h(abnormal)g(shutdown.)39 b(In)27
b(an)h(abnormal)g(shutdown,)e(the)g(ORB)h(should)f(raise)i(a)150
4985 y Fn(COMM)p 375 4985 28 4 v 31 w(FAILURE)19 b Fr(exception)h(wher)
n(eas)h(in)i(an)f(or)n(derly)f(shutdown,)e(the)i(ORB)h(should)f
Fl(not)g Fr(raise)150 5098 y(an)i(exception)e(and)i(should)f(try)g(to)g
(r)n(e-establish)g(a)h(new)f(connection)g(transpar)n(ently)-10
b(.)291 5211 y(OmniORB2)40 b(implements)d(this)h(semantics)g
(completely)-10 b(.)74 b(However)-7 b(,)41 b(it)d(is)g(known)f(that)150
5324 y(some)18 b(ORBs)g(ar)n(e)i(not)e(\(yet\))g(able)i(to)e
(distinguish)g(between)f(an)i(or)n(derly)f(and)h(an)g(abnormal)i(shut-)
150 5437 y(down.)30 b(Usually)23 b(this)g(is)h(manifested)f(as)h(the)e
(client)i(in)g(these)e(ORBs)h(seeing)f(a)i Fn(COMM)p
3162 5437 V 31 w(FAILURE)150 5550 y Fr(occasionally)33
b(when)e(connected)g(to)g(an)i(omniORB2)f(server)-7 b(.)55
b(The)31 b(workar)n(ound)g(is)h(either)f(to)p eop
%%Page: 62 68
62 67 bop 30 100 a Fr(62)1387 b Fd(CHAPTER)21 b(7.)51
b(CONNECTION)22 b(MANAGEMENT)30 356 y Fr(catch)28 b(the)f(exception)f
(in)h(the)g(application)h(code)f(and)g(r)n(etries)f(or)h(to)g(turn)f
(of)n(f)i(the)f(idle)g(connec-)30 469 y(tion)22 b(shutdown)f(inside)h
(the)g(omniORB2)h(server)-7 b(.)30 766 y Fi(7.5)119 b(Connection)31
b(Acceptance)30 977 y Fr(OmniORB2)h(pr)n(ovides)e(the)f(hook)h(to)f
(implement)i(a)g(connection)f(acceptance)h(policy)-10
b(.)51 b(Inside)30 1090 y(the)24 b(ORB)g(r)o(untime,)h(a)g(thr)n(ead)f
(is)h(dedicated)e(to)h(r)n(eceive)h(new)f(connections.)33
b(When)24 b(the)g(thr)n(ead)30 1203 y(is)31 b(given)f(the)g(handle)h
(of)g(a)g(new)f(connection)g(by)h(the)f(operating)f(system,)i(it)g
(calls)h(the)e(policy)30 1316 y(module)22 b(to)g(decide)f(if)j(the)d
(connection)h(can)i(be)e(accepted.)27 b(If)c(the)e(answer)h(is)h(yes,)e
(the)g(ORB)i(will)30 1429 y(start)29 b(serving)f(r)n(equests)g(coming)h
(in)h(fr)n(om)g(that)f(connection.)48 b(Otherwise,)30
b(the)e(connection)h(is)30 1542 y(shutdown)21 b(immediately)-10
b(.)171 1655 y(Ther)n(e)35 b(can)i(be)f(a)h(number)f(of)g(policy)g
(module)f(implementations.)68 b(The)35 b(basic)i(one)e(is)i(a)30
1768 y(dummy)22 b(module)g(which)h(just)f(accepts)h(every)e
(connection.)171 1881 y(In)35 b(addition,)i(a)f(host-based)d(access)i
(contr)n(ol)g(module)f(is)h(available)j(on)c(unix)h(platforms.)30
1993 y(The)d(module)f(uses)g(the)h(IP)g(addr)n(ess)f(of)h(the)g(client)
h(to)e(decide)h(if)h(the)f(connection)f(can)j(be)e(ac-)30
2106 y(cepted.)g(The)24 b(module)h(is)f(implemented)g(using)g
Fq(tcp)p 1883 2106 28 4 v 34 w(wrappers)j(7.6)p Fr(.)35
b(The)24 b(access)g(contr)n(ol)h(policy)30 2219 y(can)i(be)f(de\002ned)
f(as)h(r)o(ules)g(in)h(two)f(access)g(contr)n(ol)g(\002les:)35
b Fn(hosts.allow)21 b Fr(and)27 b Fn(hosts.deny)p Fr(.)30
2332 y(The)32 b(syntax)g(of)h(the)f(r)o(ules)g(is)h(described)f(in)h
(the)f(manual)i(page)e Fn(hosts)p 2652 2332 V 31 w(access\(5\))d
Fr(which)30 2445 y(can)23 b(be)f(found)g(in)h(appendix)e(A.)h(The)g
(syntax)f(de\002nes)g(a)h(simple)h(access)f(contr)n(ol)g(language)g
(that)30 2558 y(is)32 b(based)f(on)h(client)g(\(host)f(name/addr)n
(ess,)i(user)e(name\),)j(and)e(server)f(\(pr)n(ocess)g(name,)j(host)30
2671 y(name/addr)n(ess\))e(patterns.)58 b(When)32 b(sear)n(ching)h(for)
g(a)h(match)f(on)g(the)f(server)g(pr)n(ocess)g(name,)30
2784 y(the)e(ORB)i(uses)d(the)i(value)h(of)f Fn(omniORB::server)o(Na)o
(me)o Fr(.)48 b Fn(ORB)p 2418 2784 V 32 w(init)29 b Fr(uses)h(the)h(ar)
n(gument)30 2897 y Fn(argv[0])24 b Fr(to)j(set)f(the)g(default)h(value)
h(of)g(this)e(variable.)44 b(This)27 b(can)h(be)f(overridden)f(by)h
(the)g(ap-)30 3010 y(plication)d(by)e(passing)g(the)g(option:)27
b Fn(-ORBserverName)48 b(<string>)19 b Fr(to)j Fn(ORB)p
2870 3010 V 31 w(init)p Fr(.)171 3123 y(The)i(default)h(location)g(of)g
(the)f(access)h(contr)n(ol)f(\002les)h(is)g Fn(/etc)p
Fr(.)32 b(This)25 b(can)g(be)g(overridden)e(by)30 3235
y(the)f(extra)g(options)f(in)i Fn(omniORB.cfg)p Fr(.)g(For)f(instance:)
30 3428 y Fc(#)50 b(omniORB)e(configuration)g(file)h(-)g(extra)g
(options)30 3527 y(#)30 3726 y(GATEKEEPER_ALLOWFILE)146
b(/project/omni/var/hosts.allow)30 3926 y(GATEKEEPER_DENYFILE)196
b(/project/omni/var/hosts.deny)171 4231 y Fr(As)28 b(each)g(policy)h
(module)e(is)i(implemented)e(as)h(a)h(separate)e(library)-10
b(,)31 b(the)c(choice)i(of)f(policy)30 4344 y(module)22
b(is)h(determined)d(at)j(pr)n(ogram)g(linkage)f(time.)171
4457 y(For)g(instance,)g(if)i(the)d(host-based)h(access)g(contr)n(ol)h
(module)f(is)g(in)i(use:)30 4649 y Fc(\045)50 b(eg1)f(-ORBtraceLevel)e
(2)30 4748 y(omniORB2)h(gateKeeper)g(is)i(tcpwrapGK)e(1.0)h(-)h(based)f
(on)g(tcp_wrappers_7.6)30 4848 y(I)h(said,"Hello!".)d(The)i(Object)g
(said,"Hello!")171 5053 y Fr(Wher)n(eas)22 b(if)h(the)f(dummy)g(module)
g(is)h(in)g(use:)30 5245 y Fc(\045)50 b(eg1)f(-ORBtraceLevel)e(2)30
5345 y(omniORB2)h(gateKeeper)g(is)i(not)f(installed.)f(All)h(incoming)f
(are)i(accepted.)30 5445 y(I)g(said,"Hello!".)d(The)i(Object)g
(said,"Hello!")p eop
%%Page: 63 69
63 68 bop 150 980 a Fk(Chapter)44 b(8)150 1397 y Fm(Proxy)52
b(Objects)150 1860 y Fr(When)27 b(a)i(client)g(acquir)n(es)f(a)h(r)n
(efer)n(ence)e(to)h(an)g(object)g(in)h(another)e(addr)n(ess)g(space,)i
(omniORB2)150 1973 y(cr)n(eates)i(a)g(local)i(r)n(epr)n(esentation)c
(of)i(the)g(object)g(and)g(r)n(eturns)f(a)i(pointer)e(to)g(this)h
(object)g(as)g(its)150 2086 y(object)22 b(r)n(efer)n(ence.)28
b(The)22 b(local)i(r)n(epr)n(esentation)c(is)j(known)f(as)g(the)g(pr)n
(oxy)g(object.)291 2201 y(The)30 b(pr)n(oxy)g(object)g(maps)h(each)g
(IDL)f(operation)g(into)g(a)i(method)d(to)h(deliver)h(invocations)150
2314 y(to)c(the)h(r)n(emote)f(object.)44 b(The)27 b(method)g
(implements)g(ar)n(gument)h(marshalling)i(using)d(the)g(ORB)150
2426 y(r)o(untime.)60 b(When)33 b(the)f(ORB)h(r)o(untime)g(detects)f
(an)h(err)n(or)g(condition,)i(it)f(may)g(raise)f(a)h(system)150
2539 y(exception.)45 b(These)28 b(exceptions)f(will)j(normally)g(be)f
(pr)n(opagated)e(by)i(the)f(pr)n(oxy)g(object)h(to)f(the)150
2652 y(application)f(code.)36 b(However)-7 b(,)25 b(ther)n(e)f(may)i
(be)g(applications)g(that)f(pr)n(efer)g(to)g(have)h(the)f(system)150
2765 y(exceptions)f(trapped)g(in)h(the)g(pr)n(oxy)g(object.)36
b(For)24 b(these)g(applications,)j(it)e(is)h(possible)e(to)h(install)
150 2878 y(exception)c(handlers)g(for)h(individual)i(pr)n(oxy)d(object)
h(or)g(all)h(pr)n(oxy)f(objects.)27 b(The)21 b(API)h(to)f(do)g(this)150
2991 y(will)j(be)e(explained)h(in)g(this)f(chapter)-7
b(.)291 3106 y(As)31 b(described)g(in)h(section)f(6.2,)k(pr)n(oxy)c
(objects)g(ar)n(e)h(cr)n(eated)f(by)h(instances)f(of)h(the)f(pr)n(oxy-)
150 3218 y(ObjectFactory)25 b(class.)35 b(For)24 b(each)i(IDL)e
(interface)i(A,)e(the)g(stubs)g(of)h(A)g(contains)g(a)h(derived)e
(class)150 3331 y(of)29 b(pr)n(oxyObjectFactory)e(\(A)p
1188 3331 28 4 v 33 w(pr)n(oxyObjectFactory\).)46 b(This)28
b(derived)g(class)h(is)g(r)n(esponsible)f(for)150 3444
y(cr)n(eating)34 b(pr)n(oxy)e(objects)h(for)h(A.)f(This)g(pr)n(ocess)f
(is)i(completely)e(transpar)n(ent)h(to)g(the)f(applica-)150
3557 y(tion.)k(However)-7 b(,)25 b(ther)n(e)g(may)h(be)f(applications)i
(that)e(r)n(equir)n(e)h(gr)n(eater)e(contr)n(ol)i(on)f(the)g(cr)n
(eation)150 3670 y(of)d(pr)n(oxy)f(objects)g(or)h(even)f(want)h(to)f
(change)h(the)f(behavior)h(of)g(the)f(pr)n(oxy)g(objects.)27
b(T)-8 b(o)21 b(cater)h(for)150 3783 y(this)28 b(r)n(equir)n(ement,)g
(applications)h(can)g(override)f(the)f(default)h(pr)n
(oxyObjectFactories)f(and)h(in-)150 3896 y(stall)23 b(their)e(own)h
(versions)f(of)h(pr)n(oxyObjectFactories.)k(The)c(way)g(to)f(do)g(this)
h(will)i(be)e(explained)150 4009 y(in)h(this)f(chapter)-7
b(.)150 4318 y Fi(8.1)119 b(System)30 b(Exception)g(Handlers)150
4532 y Fr(By)51 b(default,)60 b(all)54 b(system)c(exceptions,)58
b(with)52 b(the)f(exception)g(of)i(CORBA::TRANSIENT)-7
b(,)150 4645 y(ar)n(e)43 b(pr)n(opagated)e(by)i(the)f(pr)n(oxy)f
(objects)h(to)h(the)e(application)j(code.)87 b(Some)42
b(applications)150 4758 y(may)f(pr)n(efer)f(to)f(trap)i(these)d
(exceptions)h(within)i(the)e(pr)n(oxy)h(objects)g(so)f(that)i(the)e
(applica-)150 4871 y(tion)h(logic)i(does)d(not)h(have)h(to)f(deal)h
(with)g(the)f(err)n(or)g(condition.)82 b(For)40 b(example,)45
b(when)40 b(a)150 4984 y(CORBA::COMM)p 831 4984 V 33
w(F)-7 b(AILURE)26 b(is)i(r)n(eceived,)i(an)e(application)i(may)e(just)
g(want)g(to)g(r)n(etry)f(the)g(in-)150 5097 y(vocation)20
b(until)g(it)g(\002nally)h(succeeds.)k(This)20 b(appr)n(oach)g(is)g
(useful)f(for)h(objects)f(that)h(ar)n(e)g(persistent)150
5209 y(and)j(their)f(operations)f(ar)n(e)i(idempotent.)291
5324 y(OmniORB2)33 b(pr)n(ovides)e(a)i(set)e(of)h(functions)f(to)g
(install)i(exception)e(handlers.)55 b(Once)32 b(they)150
5437 y(ar)n(e)48 b(installed,)54 b(pr)n(oxy)47 b(objects)g(will)i(call)
g(these)d(handlers)i(when)f(the)f(tar)n(get)h(system)f(ex-)150
5550 y(ceptions)38 b(ar)n(e)i(raised)f(by)g(the)f(ORB)h(r)o(untime.)78
b(Exception)38 b(handlers)h(can)h(be)f(installed)g(for)1815
5778 y(63)p eop
%%Page: 64 70
64 69 bop 30 100 a Fr(64)2039 b Fd(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)30 356 y Fr(CORBA::TRANSIENT)-7
b(,)55 b(CORBA::COMM)p 1682 356 28 4 v 33 w(F)-7 b(AILURE)56
b(and)j(CORBA::SystemException.)30 469 y(The)26 b(last)g(handler)h
(covers)f(all)i(system)c(exceptions)h(other)g(than)i(the)e(two)h(cover)
n(ed)g(by)g(the)g(\002rst)30 582 y(two)e(handlers.)35
b(An)25 b(exception)f(handler)h(can)h(be)f(installed)h(for)f
(individual)i(pr)n(oxy)d(object)h(or)g(it)30 695 y(can)e(be)g
(installed)g(for)f(all)i(pr)n(oxy)e(objects)g(in)h(the)f(addr)n(ess)f
(space.)30 948 y Fh(8.1.1)99 b(CORBA::TRANSIENT)24 b(handlers)30
1125 y Fr(When)46 b(a)i(CORBA::TRANSIENT)43 b(exception)j(is)h(raised)g
(by)g(the)f(ORB)h(r)o(untime,)52 b(the)47 b(de-)30 1238
y(fault)k(behaviour)f(of)g(the)g(pr)n(oxy)f(objects)g(is)i(to)e(r)n
(etry)g(inde\002nitely)g(until)i(the)e(operation)30 1351
y(succeeds.)100 b(Successive)46 b(r)n(etries)h(will)h(be)f(delayed)f
(pr)n(ogr)n(essively)g(by)h(multiples)g(of)g Fn(om-)30
1463 y(niORB::defaultT)o(ra)o(ns)o(ie)o(ntR)o(et)o(ry)o(De)o(la)o(yIn)o
(cr)o(em)o(en)o(t)p Fr(.)54 b(The)33 b(delay)g(will)i(be)f(limited)30
1576 y(to)21 b(a)h(maximum)h(speci\002ed)e(by)g Fn(omniORB::default)o
(Tr)o(an)o(si)o(en)o(tRe)o(tr)o(yD)o(el)o(ay)o(Max)o(im)o(um)o
Fr(.)30 1689 y(The)h(unit)g(of)h(both)f(values)h(ar)n(e)g(in)g
(seconds.)171 1802 y(The)33 b(ORB)h(r)o(untime)g(will)i(raised)d
(CORBA::TRANSIENT)d(under)j(the)h(following)g(condi-)30
1915 y(tions:)144 2118 y(1.)45 b(When)20 b(a)g Fl(cached)h
Fr(network)d(connection)i(is)g(br)n(oken)g(while)g(an)h(invocation)g
(is)f(in)g(pr)n(ogr)n(ess.)257 2231 y(The)i(ORB)h(will)h(try)d(to)h
(open)g(a)h(new)f(connection)g(at)h(the)f(next)f(invocation.)144
2415 y(2.)45 b(When)32 b(the)f(pr)n(oxy)g(object)h(has)g(been)g(r)n
(edir)n(ected)f(by)h(a)h(location)f(forwar)n(d)g(message)f(by)257
2528 y(the)23 b(r)n(emote)g(object)h(to)f(a)i(new)e(location)i(and)e
(the)h(object)f(at)h(the)f(new)h(location)g(cannot)g(be)257
2641 y(contacted.)38 b(In)25 b(addition)h(to)g(the)f(CORBA::TRANSIENT)d
(exception,)k(the)f(pr)n(oxy)g(object)257 2754 y(also)33
b(r)n(esets)e(its)i(internal)g(state)f(so)g(that)g(the)h(next)e
(invocation)j(will)g(be)f(dir)n(ected)f(at)h(the)257
2867 y(original)24 b(location)f(of)g(the)f(r)n(emote)f(object.)144
3052 y(3.)45 b(When)22 b(the)g(r)n(emote)g(object)g(r)n(eports)f
(CORBA::TRANSIENT)-7 b(.)171 3255 y(Applications)23 b(can)h(override)d
(the)h(default)h(behaviour)g(by)g(installing)h(their)e(own)g(exception)
30 3368 y(handler)-7 b(.)28 b(The)22 b(API)g(to)g(do)g(so)g(is)g
(summarised)g(below:)30 3657 y Fc(class)49 b(omniORB)f({)30
3856 y(public:)30 4055 y(typedef)g(CORBA::Boolean)g
(\(*transientExceptionHandler_t\)\(voi)o(d*)c(cookie,)2421
4155 y(CORBA::ULong)k(n_retries,)2421 4255 y(const)h(CORBA::TRANSIENT&)
e(ex\);)30 4454 y(static)i(void)g(installTransientExceptionHandler\(v)o
(oid*)43 b(cookie,)2272 4554 y(transientExceptionHan-)30
4653 y(dler_t)49 b(fn\);)30 4852 y(static)g(void)g
(installTransientExceptionHandler\(C)o(ORBA:)o(:Objec)o(t_ptr)43
b(obj,)2272 4952 y(void*)48 b(cookie,)2272 5052 y
(transientExceptionHan-)30 5151 y(dler_t)h(fn\);)30 5351
y(static)g(CORBA::ULong)e(defaultTransientRetryDelayIncrement;)30
5450 y(static)i(CORBA::ULong)e(defaultTransientRetryDelayMaximum;)p
eop
%%Page: 65 71
65 70 bop 150 100 a Fd(8.1.)51 b(SYSTEM)21 b(EXCEPTION)h(HANDLERS)1704
b Fr(65)150 356 y Fc(})291 661 y Fr(The)20 b(overloaded)f(functions)i
Fn(installTransie)o(nt)o(Ex)o(ce)o(pti)o(on)o(Ha)o(nd)o(le)o(r)15
b Fr(can)21 b(be)g(used)150 774 y(to)h(install)i(the)d(exception)h
(handlers)g(for)g(CORBA::TRANSIENT)-7 b(.)291 887 y(T)f(wo)18
b(overloaded)g(forms)h(ar)n(e)h(available.)30 b(The)18
b(\002rst)h(form)g(install)h(an)g(exception)e(handler)h(for)150
1000 y(all)k(object)e(r)n(efer)n(ences)g(except)f(for)h(those)f(which)i
(have)g(an)g(exception)f(handler)g(installed)g(by)h(the)150
1113 y(second)e(form,)h(which)h(takes)e(an)i(addition)e(ar)n(gument)h
(to)g(identify)f(the)h(tar)n(get)f(object)h(r)n(efer)n(ence.)150
1226 y(The)d(ar)n(gument)g Fn(cookie)d Fr(is)k(an)g(opaque)e(pointer)h
(which)h(will)g(be)g(passed)e(on)h(by)g(the)g(ORB)g(when)150
1339 y(it)23 b(calls)h(the)e(exception)f(handler)-7 b(.)291
1452 y(An)29 b(exception)e(handler)i(will)h(be)f(called)g(by)g(pr)n
(oxy)f(objects)g(with)h(thr)n(ee)e(ar)n(guments.)46 b(The)150
1565 y Fn(cookie)30 b Fr(is)i(the)g(opaque)f(pointer)g(r)n(egister)n
(ed)g(by)h Fn(installTransien)o(tE)o(xce)o(pt)o(io)o(nH)o(an)o(-)150
1678 y(dler)p Fr(.)25 b(The)20 b(ar)n(gument)g Fn(n)p
1063 1678 28 4 v 32 w(retries)d Fr(is)k(the)e(number)i(of)f(times)g
(the)f(pr)n(oxy)h(has)g(called)h(this)f(han-)150 1791
y(dler)27 b(for)h(the)f(same)h(invocation.)44 b(The)27
b(ar)n(gument)g Fn(ex)g Fr(is)h(the)f(value)h(of)g(the)f(exception)g
(caught.)150 1903 y(The)17 b(exception)g(handler)h(is)g(expected)e(to)h
(do)h(whatever)f(is)h(appr)n(opriate)g(and)g(r)n(eturns)e(a)j(boolean)
150 2016 y(value.)27 b(If)19 b(the)e(r)n(eturn)h(value)h(is)g
(TRUE\(1\),)g(the)e(pr)n(oxy)h(object)g(would)g(r)n(etry)f(the)h
(operation)f(again.)150 2129 y(If)23 b(the)g(r)n(eturn)f(value)j(is)e
(F)-7 b(ALSE\(0\),)23 b(the)f(CORBA::TRANSIENT)e(exception)i(would)h
(be)g(pr)n(opa-)150 2242 y(gated)e(into)i(the)f(application)h(code.)291
2355 y(The)j(following)h(sample)f(code)g(installs)h(a)g(simple)f
(exception)g(handler)g(for)g(all)i(objects)e(and)150
2468 y(for)d(a)g(speci\002c)f(object:)150 2760 y Fc(CORBA::Boolean)47
b(my_transient_handler1)f(\(void*)j(cookie,)2043 2860
y(CORBA::ULong)e(retries,)2043 2960 y(const)i(CORBA::TRANSIENT&)d(ex\))
150 3059 y({)299 3159 y(cerr)k(<<)f(''transient)f(handler)g(1)i
(called.'')e(<<)h(endl;)299 3258 y(return)g(1;)548 b(//)49
b(retry)g(immediately.)150 3358 y(})150 3557 y(CORBA::Boolean)e
(my_transient_handler2)f(\(void*)j(cookie,)2043 3657
y(CORBA::ULong)e(retries,)2043 3757 y(const)i(CORBA::TRANSIENT&)d(ex\))
150 3856 y({)299 3956 y(cerr)k(<<)f(''transient)f(handler)g(2)i
(called.'')e(<<)h(endl;)299 4055 y(return)g(1;)548 b(//)49
b(retry)g(immediately.)150 4155 y(})150 4454 y(static)g(Echo_ptr)f
(myobj;)150 4653 y(void)h(installhandlers\(\))150 4753
y({)299 4852 y(omniORB::installTransientExceptionHand)o(ler\(0)o(,my_t)
o(ransie)o(nt_ha)o(ndler)o(1\);)299 4952 y(//)h(All)f(proxy)g(objects)g
(will)g(call)g(my_transient_handler1)d(from)j(now)g(on.)299
5151 y(omniORB::installTransientExceptionHand)o(ler\(m)o(yobj,)o
(0,my_t)o(ransi)o(ent_h)o(andler)o(2\);)299 5251 y(//)h(The)f(proxy)g
(object)g(of)g(myobj)g(will)g(call)g(my_transient_handler2)d(from)j
(now)g(on.)150 5351 y(})p eop
%%Page: 66 72
66 71 bop 30 100 a Fr(66)2039 b Fd(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)30 356 y Fh(8.1.2)99 b(CORBA::COMM)p
1111 356 30 4 v 35 w(F)-5 b(AILURE)30 533 y Fr(When)17
b(the)g(ORB)g(r)o(untime)h(fails)h(to)e(establish)g(a)h(network)e
(connection)h(to)g(the)g(r)n(emote)g(object)g(and)30
646 y(none)26 b(of)h(the)f(conditions)g(listed)g(above)i(for)e(raising)
i(a)f(CORBA::TRANSIENT)d(is)j(applicable,)30 759 y(it)c(raises)f(a)h
(CORBA::COMM)p 1109 759 28 4 v 33 w(F)-7 b(AILURE)21
b(exception.)171 872 y(The)32 b(default)g(behaviour)h(of)f(the)g(pr)n
(oxy)f(objects)h(is)h(to)f(pr)n(opagate)f(this)h(exception)f(to)h(the)
30 984 y(application.)171 1097 y(Applications)23 b(can)h(override)d
(the)h(default)h(behaviour)g(by)g(installing)h(their)e(own)g(exception)
30 1210 y(handlers.)27 b(The)22 b(API)g(to)g(do)g(so)g(is)h(summarised)
f(below:)30 1495 y Fc(class)49 b(omniORB)f({)30 1695
y(public:)30 1894 y(typedef)g(CORBA::Boolean)g
(\(*commFailureExceptionHan-)30 1993 y(dler_t\)\(void*)f(cookie,)2421
2093 y(CORBA::ULong)h(n_retries,)2421 2193 y(const)h
(CORBA::COMM_FAILURE&)d(ex\);)30 2392 y(static)j(void)g
(installCommFailureExceptionHandler)o(\(void)o(*)44 b(cookie,)2272
2492 y(commFailureException-)30 2591 y(Handler_t)k(fn\);)30
2790 y(static)h(void)g(installCommFailureExceptionHandler)o(\(CORB)o
(A::Obj)o(ect_p)o(tr)44 b(obj,)2272 2890 y(void*)k(cookie,)2272
2990 y(commFailureExceptionHandler_t)2272 3089 y(fn\);)30
3189 y(})171 3388 y Fr(The)22 b(functions)g(ar)n(e)h(equivalent)g(to)f
(their)g(counterparts)f(for)i(CORBA::TRANSIENT)-7 b(.)30
3640 y Fh(8.1.3)99 b(CORBA::SystemException)30 3817 y
Fr(T)-8 b(o)26 b(r)n(eport)g(an)i(err)n(or)f(condition,)h(the)e(ORB)h
(r)o(untime)h(may)f(raise)h(other)e(SystemExceptions.)38
b(If)30 3930 y(the)17 b(exception)g(is)i(neither)e(CORBA::TRANISENT)e
(nor)i(CORBA::COMM)p 2719 3930 V 33 w(F)-7 b(AILURE,)16
b(the)i(de-)30 4043 y(fault)23 b(behaviour)g(of)g(the)f(pr)n(oxy)g
(objects)g(is)g(to)g(pr)n(opagate)g(this)g(exception)f(to)h(the)g
(application.)171 4156 y(Application)27 b(can)h(override)d(the)h
(default)h(behaviour)g(by)f(installing)i(their)e(own)g(exception)30
4269 y(handlers.)h(The)22 b(API)g(to)g(do)g(so)g(is)h(summarised)f
(below:)30 4554 y Fc(class)49 b(omniORB)f({)30 4753 y(public:)30
4952 y(typedef)g(CORBA::Boolean)g(\(*systemExceptionHandler_t\)\(void*)
43 b(cookie,)2222 5052 y(CORBA::ULong)k(n_retries,)2222
5151 y(const)i(CORBA::SystemException&)c(ex\);)30 5351
y(static)k(void)g(installSystemExceptionHandler\(void)o(*)44
b(cookie,)2122 5450 y(systemExceptionHan-)30 5550 y(dler_t)49
b(fn\);)p eop
%%Page: 67 73
67 72 bop 150 100 a Fd(8.2.)51 b(PROXY)22 b(OBJECT)h(F)-7
b(ACT)n(ORIES)1955 b Fr(67)150 456 y Fc(static)49 b(void)g
(installSystemExceptionHandler\(CORB)o(A::Ob)o(ject_p)o(tr)44
b(obj,)2242 555 y(void*)49 b(cookie,)2242 655 y(systemExceptionHan-)150
754 y(dler_t)g(fn\);)150 854 y(})291 1073 y Fr(The)22
b(functions)g(ar)n(e)h(equivalent)g(to)f(their)g(counterparts)f(for)i
(CORBA::TRANSIENT)-7 b(.)150 1379 y Fi(8.2)119 b(Proxy)30
b(Object)f(Factories)150 1593 y Fr(This)f(section)g(describes)f(how)h
(an)h(application)h(can)f(contr)n(ol)g(the)f(cr)n(eation)h(or)f(change)
g(the)g(be-)150 1706 y(haviour)23 b(of)g(pr)n(oxy)f(objects.)150
1968 y Fh(8.2.1)99 b(Background)150 2148 y Fr(For)165
b(each)h(interface)g(A,)f(its)h(stub)f(contains)h(a)g(pr)n(oxy)f
(factory)150 2261 y(class-)152 b Fn(A)p 581 2261 28 4
v 33 w(proxyObjectFac)o(to)o(ry)o Fr(.)410 b(This)151
b(class)h(is)g(derived)f(fr)n(om)150 2374 y Fn(CORBA::proxyObj)o(ec)o
(tF)o(ac)o(tor)o(y)16 b Fr(and)23 b(implements)f(thr)n(ee)g(virtual)h
(functions:)150 2680 y Fc(class)49 b(A_proxyObjectFactory)d(:)k(public)
e(virtual)h(CORBA::proxyObjectFactory)c({)150 2780 y(public:)250
2979 y(virtual)j(const)h(char)g(*irRepoId\(\))f(const;)250
3178 y(virtual)g(_CORBA_Boolean)97 b(is_a\(const)48 b(char)h
(*base_repoId\))f(const;)250 3377 y(virtual)g(CORBA::Object_ptr)f
(newProxyObject\(Rope)f(*r,)2292 3477 y(CORBA::Octet)i(*key,)2292
3577 y(size_t)h(keysize,)2292 3676 y(IOP::TaggedProfileList)2292
3776 y(*profiles,)2292 3875 y(CORBA::Boolean)e(release\);)150
4075 y(};)291 4393 y Fr(As)29 b(described)e(in)j(chapter)e(6,)j(the)d
(functions)h(allow)h(the)e(ORB)h(r)o(untime)g(to)f(perform)h(type)150
4506 y(checking.)49 b(The)29 b(function)h Fn(newProxyObject)23
b Fr(cr)n(eates)30 b(a)g(pr)n(oxy)f(object)g(for)h(A)g(based)f(on)g
(its)150 4619 y(input)k(ar)n(guments.)58 b(The)32 b(r)n(eturn)g(value)i
(is)f(a)g(pointer)f(to)g(the)h(class)p 2639 4619 V 66
w Fn(proxy)p 2947 4619 V 30 w(A)g Fr(which)g(is)g(au-)150
4732 y(tomatically)d(r)n(e-casted)e(into)g(a)h Fn(CORBA::Object)p
2000 4732 V 26 w(ptr)p Fr(.)p 2259 4732 V 77 w Fn(proxy)p
2566 4732 V 31 w(A)f Fr(implements)f(the)h(pr)n(oxy)150
4845 y(object)22 b(for)h(A:)150 5052 y Fc(class)49 b(_proxy_A)f(:)100
b(public)48 b(virtual)h(A)g({)150 5151 y(public:)250
5351 y(_proxy_A)f(\(Rope)h(*r,)748 5450 y(CORBA::Octet)e(*key,)748
5550 y(size_t)h(keysize,IOP::TaggedProfileList)d(*profiles,)p
eop
%%Page: 68 74
68 73 bop 30 100 a Fr(68)2039 b Fd(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)628 356 y Fc(CORBA::Boolean)47 b(release\);)130
456 y(virtual)h(\230_proxy_A\(\);)130 655 y(//)h(plus)g(other)g
(internal)f(functions.)30 854 y(};)171 1062 y Fr(The)28
b(stub)h(of)g(A)g(guarantees)e(that)i(exactly)g Fl(one)g
Fr(instance)g(of)g Fn(A)p 2441 1062 28 4 v 32 w(proxyObjectFact)o(or)o
(y)30 1175 y Fr(is)92 b(instantiated)f(when)f(an)j(application)f(is)g
(executed.)233 b(The)91 b(constr)o(uctor)f(of)30 1288
y Fn(A)p 90 1288 V 32 w(proxyObjectFact)o(ory)o Fr(,)65
b(via)e(its)e(base)g(class)h Fn(proxyObjectFact)o(or)o(y)55
b Fr(links)62 b(the)30 1401 y(instance)23 b(into)f(the)g(ORB's)g(pr)n
(oxy)g(factory)g(list.)171 1514 y(Newly)33 b(instantiated)g(pr)n(oxy)g
(object)h(factories)g(ar)n(e)g(always)g(enter)n(ed)e(at)i(the)f(fr)n
(ont)h(of)g(the)30 1627 y(ORB's)41 b(pr)n(oxy)f(factory)h(list.)83
b(Mor)n(eover)-7 b(,)45 b(when)40 b(the)h(ORB)f(sear)n(ches)h(for)g(a)g
(match)h(on)f(the)30 1740 y(type,)34 b(it)f(always)g(stops)e(at)i(the)f
(\002rst)g(match.)59 b(In)32 b(other)g(wor)n(ds,)i(when)e(additional)i
(instances)30 1853 y(of)23 b Fn(A)p 193 1853 V 32 w(proxyObjectFacto)o
(ry)16 b Fr(or)23 b(derived)f(classes)h(of)g(it)g(ar)n(e)h(cr)n(eated,)
e(the)h(last)g(instantiation)30 1966 y(will)h(override)e(earlier)i
(instantiations)e(to)h(be)g(the)f(pr)n(oxy)g(factory)h(selected)e(to)i
(cr)n(eate)g(pr)n(oxy)f(ob-)30 2079 y(jects)i(of)h(A.)g(This)g(pr)n
(operty)e(can)j(be)e(used)g(by)h(an)g(application)i(to)d(install)i(its)
f(own)f(pr)n(oxy)g(object)30 2192 y(factories.)30 2446
y Fh(8.2.2)99 b(An)24 b(Example)30 2622 y Fr(Using)e(the)g
Fn(Echo)e Fr(example)j(in)g(chapter)f(2)h(as)g(the)f(basis,)g(one)g
(can)h(tell)g(the)f(ORB)g(to)g(use)g(a)h(modi-)30 2735
y(\002ed)f(pr)n(oxy)g(object)g(class)h(to)f(cr)n(eate)h(pr)n(oxy)e
(objects.)28 b(The)21 b(steps)g(involved)i(ar)n(e)g(as)g(follows:)30
2986 y Fl(8.2.2.1)92 b(De\002ne)22 b(a)i(new)e(proxy)g(class)30
3163 y Fr(W)-8 b(e)21 b(de\002ne)f(a)i(new)f(pr)n(oxy)g(class)h(to)f
(cache)h(the)f(r)n(esult)g(of)h(the)f(last)h(invocation)g(of)g
Fn(echoString)p Fr(.)30 3358 y Fc(class)49 b(_new_proxy_Echo)e(:)j
(public)e(virtual)h(_proxy_Echo)e({)30 3458 y(public:)130
3557 y(_new_proxy_Echo)g(\(Rope)i(*r,)927 3657 y(CORBA::Octet)e(*key,)
927 3757 y(size_t)h(keysize,IOP::TaggedProfileList)d(*profiles,)927
3856 y(CORBA::Boolean)i(release\))478 3956 y(:)j
(_proxy_Echo\(r,key,keysize,profiles,)o(relea)o(se\),)578
4055 y(omniObject\(Echo_IntfRepoID,r,key,ke)o(ysize)o(,profi)o(les,r)o
(eleas)o(e\))179 4155 y({)279 4255 y(//)f(You)h(have)f(to)g(look)g(at)h
(the)f(_proxy_Echo)f(class)h(and)g(copy)g(from)g(its)279
4354 y(//)g(ctor)h(all)f(the)g(explicit)f(ctor)h(calls)g(to)h(its)f
(base)g(member.)179 4454 y(})179 4554 y(virtual)g
(\230_new_proxy_Echo\(\))d({})179 4852 y(virtual)j(char*)g
(echoString\(const)e(char*)i(mesg\))f({)279 4952 y(//)279
5052 y(//)h(Only)h(calls)e(the)i(remote)e(object)h(if)h(the)f(argument)
f(is)i(differ-)30 5151 y(ent)f(from)g(the)279 5251 y(//)g(last)h
(invocation.)279 5450 y(omni_mutex_lock)d(sync\(lock\);)279
5550 y(if)i(\(\(char*\)last_arg\))e({)p eop
%%Page: 69 75
69 74 bop 150 100 a Fd(8.2.)51 b(PROXY)22 b(OBJECT)h(F)-7
b(ACT)n(ORIES)1955 b Fr(69)499 356 y Fc(if)49 b
(\(strcmp\(mesg,\(char*\)last_arg\))c(==)k(0\))g({)648
456 y(return)g(CORBA::string_dup\(last_result\);)499
555 y(})399 655 y(})399 754 y(char*)g(res)g(=)h
(_proxy_Echo::echoString\(mesg\);)399 854 y(last_arg)e(=)i(mesg;)399
954 y(last_result)e(=)h(\(const)g(char*\))g(res;)399
1053 y(return)g(res;)299 1153 y(})150 1352 y(private:)250
1452 y(omni_mutex)396 b(lock;)250 1551 y(CORBA::String_var)46
b(last_arg;)250 1651 y(CORBA::String_var)g(last_result;)150
1751 y(};)150 2013 y Fl(8.2.2.2)92 b(De\002ne)22 b(a)i(new)e(proxy)g
(factory)i(class)150 2193 y Fr(Next,)j(we)g(de\002ne)g(a)h(new)f(pr)n
(oxy)g(factory)g(class)h(to)f(instantiate)p 2447 2193
28 4 v 61 w Fn(new)p 2645 2193 V 31 w(proxy)p 2951 2193
V 30 w(Echo)f Fr(as)i(pr)n(oxy)150 2306 y(objects)22
b(for)h Fn(Echo)p Fr(.)150 2516 y Fc(class)49 b
(_new_Echo_proxyObjectFactory)44 b(:)50 b(public)f(vir-)150
2615 y(tual)g(Echo_proxyObjectFactory)150 2715 y({)150
2814 y(public:)299 2914 y(_new_Echo_proxyObjectFactory)c(\(\))k({})299
3014 y(virtual)g(\230_new_Echo_proxyObjectFactory\(\))44
b({})299 3213 y(//)50 b(Only)f(have)g(to)g(override)g(newProxyObject)
299 3313 y(virtual)g(CORBA::Object_ptr)e(newProxyObject\(Rope)f(*r,)
2342 3412 y(CORBA::Octet)h(*key,)2342 3512 y(size_t)h(keysize,)2342
3611 y(IOP::TaggedProfileList)d(*pro-)150 3711 y(files,)2342
3811 y(CORBA::Boolean)i(re-)150 3910 y(lease\))i({)449
4010 y(_new_proxy_Echo)e(*p)i(=)h(new)f
(_new_proxy_Echo\(r,key,keysize,profil)o(es,rel)o(ease\))o(;)449
4110 y(return)g(p;)299 4209 y(})150 4309 y(};)291 4530
y Fr(Finally)-10 b(,)36 b(we)c(have)h(to)f(instantiate)g(a)h(single)f
(instance)h(of)f(the)g(new)g(pr)n(oxy)f(factory)i(in)g(the)150
4643 y(application)24 b(code.)150 4852 y Fc(int)49 b(main\(int)g(argc,)
f(char**)h(argv\))150 4952 y({)299 5052 y(//)h(Other)f(initialisation)e
(steps)299 5251 y(_new_Echo_proxyObjectFactory*)e(f)k(=)100
b(new)49 b(_new_Echo_proxyObjectFactory;)299 5450 y(//)h(Use)f(the)g
(new)h(operator)e(to)h(instantiate)f(the)h(proxy)g(fac-)150
5550 y(tory)g(and)g(never)p eop
%%Page: 70 76
70 75 bop 30 100 a Fr(70)2039 b Fd(CHAPTER)21 b(8.)51
b(PROXY)22 b(OBJECTS)179 356 y Fc(//)50 b(call)f(the)g(delete)g
(operator)f(on)i(this)f(instance.)179 555 y(//)h(From)f(this)g(point)g
(onwards,)f(_new_proxy_Echo)f(will)i(be)h(used)f(to)g(create)179
655 y(//)h(proxy)f(objects)f(for)i(Echo.)30 854 y(})30
1109 y Fh(8.2.3)99 b(Further)24 b(Considerations)30 1286
y Fr(Notice)17 b(that)h(the)g(ORB)g(may)g(call)i Fn(newProxyObject)12
b Fr(multiple)18 b(times)g(to)f(cr)n(eate)i(pr)n(oxy)e(objects)30
1399 y(for)33 b(the)f(same)g(r)n(emote)g(object.)58 b(In)32
b(other)g(wor)n(ds,)i(the)e(ORB)g(does)f(not)h(guarantee)g(that)g(only)
30 1512 y(one)c(pr)n(oxy)f(object)i(is)f(cr)n(eated)g(for)h(each)g(r)n
(emote)e(object.)46 b(For)27 b(applications)j(that)e(r)n(equir)n(e)g
(this)30 1624 y(guarantee,)f(it)g(is)g(necessary)f(to)g(check)h(within)
g Fn(newProxyObject)21 b Fr(whether)26 b(a)h(pr)n(oxy)f(object)30
1737 y(has)34 b(alr)n(eady)g(been)f(cr)n(eated)h(for)g(the)f(curr)n
(ent)g(r)n(equest.)60 b(If)34 b(the)f(ar)n(gument)g Fn(Rope*)53
b(r)33 b Fr(points)30 1850 y(to)e(the)f(same)h(str)o(uctur)n(e)f(and)h
(the)f(content)g(of)h(the)g(sequence)e Fn(CORBA::Octet*)49
b(key)30 b Fr(is)h(the)30 1963 y(same,)24 b(then)g(an)g(existing)g(pr)n
(oxy)f(object)h(can)h(be)f(r)n(eturned)f(to)g(satisfy)h(the)f(curr)n
(ent)h(r)n(equest.)31 b(Do)30 2076 y(not)22 b(for)n(get)g(to)g(call)i
Fn(CORBA::duplicat)o(e\()o(\))17 b Fr(befor)n(e)22 b(r)n(eturning)g
(the)f(object)i(r)n(efer)n(ence.)171 2189 y Fn(newProxyObject)34
b Fr(may)40 b(be)g(called)h(concurr)n(ently)e(by)h(dif)n(fer)n(ent)g
(thr)n(eads)f(within)h(the)30 2302 y(ORB.)22 b(Needless)e(to)i(say)-10
b(,)22 b(the)g(function)h(must)f(be)g(thr)n(ead-safe.)p
eop
%%Page: 71 77
71 76 bop 150 979 a Fk(Chapter)44 b(9)150 1395 y Fm(T)-19
b(ype)52 b(Any)g(and)g(T)-19 b(ypeCode)150 1858 y Fr(The)32
b(CORBA)h(speci\002cation)h(pr)n(ovides)e(for)h(a)g(type)f(that)g(can)i
(hold)f(the)f(value)i(of)f(any)g(OMG)150 1971 y(IDL)26
b(type.)39 b(This)27 b(type)e(is)i(known)f(as)h(type)e(Any)-10
b(.)40 b(The)26 b(OMG)i(also)f(speci\002es)e(a)j(pseudo-object,)150
2084 y(T)-8 b(ypeCode,)20 b(that)i(can)i(encode)d(a)i(description)f(of)
g(any)h(type)e(speci\002able)i(in)g(OMG)h(IDL.)291 2197
y(In)h(this)h(chapter)-7 b(,)26 b(an)g(example)f(demonstrating)f(the)h
(use)f(of)i(type)e(Any)h(is)g(pr)n(esented.)34 b(This)150
2310 y(is)c(followed)f(by)g(sections)f(describing)h(the)g(behaviour)h
(of)g(type)d(Any)i(and)h(T)-8 b(ypeCode)27 b(in)j(om-)150
2423 y(niORB2.)e(For)19 b(further)h(information)h(on)e(type)g(Any)-10
b(,)20 b(r)n(efer)g(to)g(the)f(C++)i(Mapping)f(section)g(of)g(the)150
2536 y(CORBA)e(2)g(speci\002cation)g([OMG99a)s(],)h(and)f(for)f(mor)n
(e)h(information)h(on)e(T)-8 b(ypeCode,)16 b(r)n(efer)i(to)f(the)150
2649 y(Interface)j(Repository)e(chapter)i(in)h(the)f(CORBA)h(cor)n(e)f
(section)g(of)h(the)e(CORBA)i(2)g(speci\002cation.)291
2763 y Fl(W)-8 b(ARNING:)62 b Fr(Since)32 b(2.8.0,)j(omniORB2)d(has)g
(been)f(updated)f(to)i(CORBA)g(2.3.)56 b(In)31 b(or)n(der)150
2876 y(to)k(comply)g(with)h(the)e(2.3)i(speci\002cation,)j(it)c(is)h
(necessary)e(to)g(change)i(the)e(semantics)h(of)h Fq(the)150
2989 y(extraction)f(of)f(string,)j(object)d(r)n(efer)n(ence)i(and)d
(typecode)j(fr)n(om)e(an)f(Any)p Fr(.)59 b(The)32 b(memory)g(of)h(the)f
(ex-)150 3101 y(tracted)22 b(values)i(of)f(these)f(types)f(now)h
(belong)h(to)g(the)f(Any)h(value.)30 b(The)22 b(storage)g(is)h(fr)n
(eed)g(when)150 3214 y(the)32 b(Any)g(value)h(is)g(deallocated.)57
b(Pr)n(eviously)33 b(the)f(extracted)f(value)i(is)g(a)g(copy)f(and)h
(the)f(ap-)150 3327 y(plication)e(is)g(r)n(esponsible)e(to)g(r)n
(elease)h(the)g(storage.)46 b(It)28 b(is)i(not)e(possible)h(to)f
(detect)g(the)g(old)h(us-)150 3440 y(age)j(at)h(compile)g(time.)58
b(In)32 b(particular)-7 b(,)36 b(unmodi\002ed)c(code)f(that)i(uses)e
(the)h(af)n(fected)g(Any)g(ex-)150 3553 y(traction)j(operators)e(would)
i(most)f(certainly)i(cause)f(r)o(untime)g(err)n(ors)f(to)g(occur)-7
b(.)66 b(T)-8 b(o)34 b(smooth)150 3666 y(the)k(transition)h(fr)n(om)g
(the)f(old)h(usage)f(to)g(the)g(new)-8 b(,)42 b(an)d(ORB)g
(con\002guration)f(variable)j Fn(om-)150 3779 y(niORB::omniORB)p
925 3779 28 4 v 26 w(27)p 1061 3779 V 32 w(CompatibleAnyEx)o(tr)o(act)o
(io)o(n)15 b Fr(can)22 b(be)f(set)f(to)g(r)n(evert)h(the)f(any)h(ex-)
150 3892 y(traction)i(operators)d(to)i(the)g(old)h(semantics.)150
4196 y Fi(9.1)119 b(Example)29 b(using)i(type)f(Any)150
4408 y Fr(Befor)n(e)i(going)g(thr)n(ough)g(this)h(example,)j(you)c
(should)g(make)h(sur)n(e)f(that)h(you)g(have)g(r)n(ead)g(and)150
4521 y(understood)24 b(the)j(examples)f(in)i(chapter)f(2.)43
b(The)26 b(sour)n(ce)h(code)f(for)i(this)f(example)g(is)g(included)150
4634 y(in)g(the)f(omniORB2)h(distribution,)f(in)h(the)f(dir)n(ectory)f
(sr)n(c/examples/anyExample.)39 b(A)26 b(listing)150
4747 y(of)d(the)e(sour)n(ce)h(code)g(is)h(pr)n(ovided)f(at)g(the)g(end)
g(of)h(this)f(chapter)-7 b(.)150 5007 y Fh(9.1.1)99 b(T)-9
b(ype)25 b(Any)g(in)g(IDL)150 5172 y Fr(T)-8 b(ype)33
b(Any)i(allows)g(one)f(to)g(delay)h(the)f(decision)h(on)f(the)g(type)g
(used)f(in)i(an)h(operation)e(until)150 5272 y(r)o(un-time.)28
b(T)-8 b(o)22 b(use)f(type)g(any)i(in)g(IDL,)f(use)g(the)g(keywor)n(d)e
Fn(any)p Fr(,)h(as)i(in)g(the)f(following)h(example:)150
5550 y Fc(//)49 b(IDL)1815 5778 y Fr(71)p eop
%%Page: 72 78
72 77 bop 30 100 a Fr(72)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 456 y Fc(interface)48
b(anyExample)g({)130 555 y(any)h(testOp\(in)f(any)h(mesg\);)30
655 y(};)171 927 y Fr(The)29 b(operation)f Fn(testOp\(\))d
Fr(in)30 b(this)f(example)g(can)h(now)f(take)f(any)i(value)g(expr)n
(essible)e(in)30 1040 y(OMG)c(IDL)e(as)h(an)g(ar)n(gument,)f(and)g(can)
i(also)e(r)n(eturn)g(any)h(type)e(expr)n(essible)g(in)j(OMG)f(IDL.)171
1152 y(T)-8 b(ype)20 b(Any)g(is)i(mapped)e(into)h(C++)h(as)f(the)g
(type)e Fn(CORBA::Any)p Fr(.)k(When)e(passed)f(as)h(an)h(ar)n(gu-)30
1265 y(ment)g(or)g(as)h(a)g(r)n(esult)f(of)h(an)g(operation,)e(the)h
(following)h(r)o(ules)f(apply:)221 1369 y Fa(In)863 b(InOut)417
b(Out)599 b(Return)p 171 1402 3039 4 v 221 1472 a Fc(const)49
b(CORBA::Any&)97 b(CORBA::Any&)h(CORBA::Any*&)147 b(CORBA::Any*)171
1742 y Fr(So,)22 b(the)g(above)h(IDL)f(would)g(map)h(to)f(the)g
(following)h(C++)30 2022 y Fc(//)49 b(C++)30 2221 y(class)g
(anyExample_i)e(:)j(public)f(virtual)f(_sk_anyExample)f({)30
2321 y(public:)130 2421 y(anyExample_i\(\))g({)i(})130
2520 y(virtual)f(\230anyExample_i\(\))f({)j(})130 2620
y(virtual)e(CORBA::Any*)g(testOp\(const)f(CORBA::Any&)h(a\);)30
2719 y(};)30 3071 y Fh(9.1.2)99 b(Inserting)25 b(and)f(Extracting)h
(Basic)h(T)-9 b(ypes)26 b(from)e(an)h(Any)30 3248 y Fr(The)20
b(question)f(now)i(arises)f(as)h(to)f(how)g(values)h(ar)n(e)g(inserted)
e(into)i(and)g(r)n(emoved)f(fr)n(om)h(an)g(Any)-10 b(.)30
3361 y(This)22 b(is)h(achieved)g(using)f(two)g(overloaded)f(operators:)
26 b Fn(<<=)53 b(and)g(>>=)h Fr(.)171 3473 y(T)-8 b(wo)22
b(insert)g(a)h(value)g(into)f(an)i(Any)-10 b(,)21 b(the)h
Fn(<<=)53 b Fr(operator)21 b(is)i(used,)e(as)i(in)g(this)f(example:)30
3754 y Fc(//)49 b(C++)30 3953 y(CORBA::Any)f(an_any;)30
4053 y(CORBA::Long)g(l)h(=)h(100;)30 4152 y(an_any)f(<<=)g(l;)171
4446 y Fr(Note)21 b(that)i(the)e(overloaded)h Fn(<<=)53
b Fr(operator)21 b(has)i(a)g(r)n(eturn)f(type)f(of)h
Fn(void)p Fr(.)171 4559 y(T)-8 b(o)29 b(extract)g(a)h(value,)i(the)d
Fn(>>=)53 b Fr(operator)28 b(is)i(used,)f(as)h(in)g(this)f(example)h
(\(wher)n(e)f(the)g(Any)30 4672 y(contains)23 b(a)g(long\):)30
4952 y Fc(//)49 b(C++)30 5151 y(CORBA::Long)f(l;)30 5251
y(an_any)h(>>=)g(l;)30 5450 y(cout)g(<<)g("This)g(is)h(a)f(long:)g(")h
(<<)f(l)h(<<)f(endl;)p eop
%%Page: 73 79
73 78 bop 150 100 a Fd(9.1.)51 b(EXAMPLE)21 b(USING)h(TYPE)f(ANY)1906
b Fr(73)291 356 y(The)27 b(overloaded)g Fn(>>=)53 b Fr(operator)27
b(r)n(eturns)f(a)j(CORBA::Boolean.)42 b(If)28 b(an)g(attempt)f(is)h
(made)150 469 y(to)e(extract)h(a)g(value)h(fr)n(om)f(an)h(Any)e(when)g
(it)h(contains)g(a)g(dif)n(fer)n(ent)g(value)h(\(e.g.)40
b(an)27 b(attempt)f(to)150 582 y(extract)i(a)i(long)f(fr)n(om)g(an)g
(Any)g(containing)g(a)h(double\),)f(the)g(overloaded)e
Fn(>>=)53 b Fr(operator)28 b(will)150 695 y(r)n(eturn)i(False;)35
b(otherwise)29 b(it)i(will)i(r)n(eturn)d(T)-8 b(r)o(ue.)52
b(Thus,)32 b(a)g(common)f(tactic)h(to)e(extract)h(values)150
808 y(fr)n(om)23 b(an)g(Any)f(is)h(as)g(follows:)150
1094 y Fc(//)49 b(C++)150 1393 y(CORBA::Long)f(l;)150
1493 y(CORBA::Double)f(d;)150 1592 y(const)i(char*)g(str;)248
b(//)50 b(From)f(CORBA)f(2.3)i(onwards,)e(uses)h(const)g(char*)1196
1692 y(//)h(instead)e(of)h(char*.)150 1891 y(if)g(\(an_any)g(>>=)g(l\))
h({)349 1991 y(cout)f(<<)h("Long:)e(")i(<<)g(l)f(<<)h(endl;)150
2091 y(})150 2190 y(else)f(if)h(\(an_any)e(>>=)h(d\))h({)349
2290 y(cout)f(<<)h("Double:)e(")i(<<)f(d)h(<<)f(endl;)150
2389 y(})150 2489 y(else)g(if)h(\(an_any)e(>>=)h(str\))g({)349
2589 y(cout)g(<<)h("String:)e(")i(<<)f(str)g(<<)h(endl;)349
2688 y(//)g(Since)f(2.8.0)f(the)i(storage)e(of)i(the)f(extracted)f
(string)h(is)g(still)349 2788 y(//)h(owned)f(by)g(the)g(any.)349
2888 y(//)h(In)f(pre-omniORB)f(2.8.0)h(releases,)f(the)h(string)g
(returned)f(is)i(a)f(copy.)150 2987 y(})150 3087 y(else)g({)349
3186 y(cout)g(<<)h("Unknown)e(value.")h(<<)g(endl;)150
3286 y(})150 3638 y Fh(9.1.3)99 b(Inserting)25 b(and)f(Extracting)h
(Constructed)h(T)-9 b(ypes)25 b(from)g(an)f(Any)150 3815
y Fr(It)d(is)g(also)h(possible)f(to)f(insert)h(and)g(extract)g(constr)o
(ucted)f(types)g(and)h(object)g(r)n(efer)n(ences)g(fr)n(om)h(an)150
3928 y(Any)-10 b(.)34 b Fn(omniidl2)51 b Fr(will)27 b(generate)c
(insertion)h(and)h(extraction)g(operators)e(for)i(the)f(constr)o(ucted)
150 4041 y(type.)60 b(Note)32 b(that)h(it)h(is)g(necessary)e(to)h
(specify)g(the)g Fn(-a)g Fr(command-line)i(\003ag)f(when)f(r)o(unning)
150 4154 y(omniidl2)c(in)f(or)n(der)e(to)h(generate)e(these)h
(operators.)40 b(The)27 b(following)h(example)f(illustrates)g(the)150
4267 y(use)22 b(of)g(constr)o(ucted)f(types)g(with)h(type)f(Any:)150
4554 y Fc(//)49 b(IDL)150 4753 y(struct)g(testStruct)f({)250
4852 y(long)h(l;)250 4952 y(short)g(s;)150 5052 y(};)150
5351 y(interface)f(anyExample)g({)250 5450 y(any)h(testOp\(in)f(any)h
(mesg\);)150 5550 y(};)p eop
%%Page: 74 80
74 79 bop 30 100 a Fr(74)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)171 557 y Fr(Upon)e(compiling)h(the)f
(above)h(IDL)f(with)h Fn(omniidl2)51 b(-a)p Fr(,)19 b(the)h(following)h
(overloaded)e(op-)30 670 y(erators)i(ar)n(e)i(generated:)144
870 y(1.)45 b Fn(void)53 b(operator<<=\(COR)o(BA)o(::)o(An)o(y&,)48
b(const)k(testStruct&)d(\))144 1054 y Fr(2.)c Fn(void)53
b(operator<<=\(COR)o(BA)o(::)o(An)o(y&,)48 b(testStruct*)h(\))144
1238 y Fr(3.)c Fn(CORBA::Boolean)j(operator>>=\(cons)o(t)g
(CORBA::Any&,)h(const)k(test-)257 1351 y(Struct*&\))171
1551 y Fr(Operators)22 b(of)g(this)g(form)h(ar)n(e)g(generated)e(for)h
(all)i(constr)o(ucted)d(types,)g(and)h(for)h(interfaces.)171
1651 y(The)e(\002rst)f(operator)-7 b(,)20 b Fq(\(1\))j
Fr(,)e(copies)g(the)f(constr)o(ucted)g(type,)g(and)h(inserts)f(it)i
(into)f(the)f(Any)-10 b(.)27 b(The)30 1751 y(second)e(operator)-7
b(,)25 b Fq(\(2\))j Fr(,)e(inserts)f(the)h(constr)o(ucted)e(type)h
(into)g(the)h(Any)-10 b(,)26 b(and)g(then)f(manages)h(it.)30
1850 y(Note)c(that)h(if)h(the)e(second)g(operator)f(is)j(used,)d(the)h
(Any)h(consumes)f(the)g(constr)o(ucted)g(type,)f(and)30
1950 y(the)h(caller)i(should)d(not)h(used)f(the)h(pointer)f(to)h
(access)g(the)g(data)h(after)f(insertion.)27 b(The)22
b(following)30 2050 y(is)h(an)g(example)f(of)h(how)f(to)g(insert)g(a)h
(value)g(into)g(an)g(Any)f(using)g(operator)f Fq(\(1\))j
Fr(:)30 2314 y Fc(//)49 b(C++)30 2513 y(CORBA::Any)f(an_any;)30
2712 y(testStruct)g(t;)30 2812 y(t.l)h(=)h(456;)30 2912
y(t.s)f(=)h(8;)30 3111 y(an_any)f(<<=)g(t;)171 3388 y
Fr(The)25 b(thir)n(d)h(operator)-7 b(,)26 b Fq(\(3\))h
Fr(,)g(is)f(used)e(to)i(extract)f(the)h(constr)o(ucted)e(type)g(fr)n
(om)j(the)e(Any)-10 b(,)26 b(and)30 3501 y(can)d(be)g(used)e(as)i
(follows:)30 3788 y Fc(const)49 b(testStruct*)f(tp;)149
b(//)49 b(From)g(CORBA)g(2.3)g(onwards,)f(use)1226 3888
y(//)h(const)g(testStruct*)f(instead)g(of)i(testStruct*)30
4087 y(if)f(\(an_any)g(>>=)g(tp\))g({)229 4187 y(cout)g(<<)h
("testStruct:)d(l:)j(")f(<<)h(tp->l)f(<<)g(endl;)229
4286 y(cout)g(<<)h(")597 b(s:)50 b(")f(<<)h(tp->s)f(<<)g(endl;)30
4386 y(})30 4486 y(else)g({)229 4585 y(cout)g(<<)h("Unknown)e(value)h
(contained)f(in)i(Any.")e(<<)i(endl;)30 4685 y(})171
4985 y Fr(As)23 b(with)g(basic)i(types,)c(if)j(an)g(attempt)f(is)g
(made)g(to)g(extract)g(a)h(type)e(fr)n(om)i(an)g(Any)f(that)g(does)30
5098 y(not)f(contain)h(a)h(value)f(of)g(that)f(type,)f(the)h
(extraction)g(operator)g(r)n(eturns)f(False.)28 b(If)23
b(the)f(Any)g(does)30 5211 y(contain)k(that)f(type,)f(the)h(extraction)
g(operator)f(r)n(eturns)g(T)-8 b(r)o(ue.)35 b(If)26 b(the)e(extraction)
h(is)h(successful,)30 5324 y(the)j(caller)7 b('s)30 b(pointer)e(will)j
(point)d(to)h(memory)g(managed)g(by)g(the)g(Any)-10 b(.)47
b(The)28 b(caller)j(must)e(not)30 5437 y(delete)21 b(or)i(otherwise)e
(change)h(this)h(storage,)e(and)i(should)e(not)i(use)e(this)i(storage)e
(after)i(the)f(con-)30 5550 y(tents)g(of)h(the)g(Any)g(ar)n(e)h(r)n
(eplaced)f(\(either)g(by)h(insertion)e(or)h(assignment\),)g(or)g(after)
h(the)e(Any)h(has)p eop
%%Page: 75 81
75 80 bop 150 100 a Fd(9.2.)51 b(TYPE)22 b(ANY)f(IN)h(OMNIORB2)2037
b Fr(75)150 356 y(been)22 b(destr)n(oyed.)27 b(In)22
b(particular)-7 b(,)25 b(management)e(of)g(the)f(pointer)g(should)g
(not)g(be)h(assigned)f(to)h(a)p 150 469 28 4 v 177 469
a Fn(var)f Fr(type.)291 583 y Fl(W)-8 b(ARNING!!!)61
b Fr(In)34 b(pr)n(e-omniORB)f(2.8.0)i(r)n(eleases,)g(it)f(is)g(unclear)
h(in)f(the)f(CORBA)h(spec-)150 696 y(i\002cation)g(whether)e(or)g(not)h
(object)g(r)n(efer)n(ences)f(should)g(be)h(managed)g(by)g(an)h(Any)-10
b(.)58 b(The)33 b(om-)150 809 y(niORB2)h(implementation)g(leaves)f
(management)h(of)f(an)h(extracted)f(object)g(r)n(efer)n(ence)g(to)g
(the)150 922 y(caller)-7 b(.)65 b(Ther)n(efor)n(e,)36
b(the)e(pr)n(ogrammer)g(should)g(r)n(elease)g(object)g(r)n(efer)n
(ences)f(and)i(T)-8 b(ypeCodes)150 1035 y(that)34 b(have)i(been)e
(extracted)f(fr)n(om)i(an)g(Any)-10 b(.)64 b(The)34 b(same)g(also)h
(applies)g(to)f(string)g(extraction.)150 1148 y(CORBA)26
b(2.3)h(has)f(clari\002ed)h(this)f(issue)f(and)h(decr)n(eed)f(that)h
(the)f(management)h(of)g(an)g(extracted)150 1261 y(object)i(r)n(efer)n
(ence)g(still)g(belongs)g(to)f(the)g(Any!)45 b(Since)28
b(2.8.0,)i(the)d(omniORB2)i(implementation)150 1374 y(conforms)i(to)g
(the)g(CORBA)h(2.3)g(speci\002cation.)55 b(For)31 b(backwar)n(d)h
(compatibility)-10 b(,)35 b(the)c(r)o(untime)150 1487
y(variable)37 b Fn(omniORB::omniOR)o(B)p 1394 1487 V
26 w(27)p 1530 1487 V 32 w(CompatibleAnyEx)o(tr)o(act)o(io)o(n)29
b Fr(can)35 b(be)g(set)f(to)g(1)i(to)150 1600 y(get)24
b(back)i(the)e(old)h(behaviour)-7 b(.)35 b(Notice)24
b(that)h(this)g(should)f(be)h(used)e(as)i(a)h(transitional)g(measur)n
(e)150 1713 y(and)d(in)g(the)f(long)g(r)o(un,)g(applications)i(should)d
(be)i(written)e(to)h(use)g(the)g(new)g(behaviour)-7 b(.)291
1827 y(If)23 b(the)f(extraction)g(fails,)h(the)f(caller)7
b('s)24 b(pointer)d(will)j(be)f(set)e(to)h(point)g(to)g(null.)291
1942 y(Note)c(that)g(ther)n(e)g(ar)n(e)h(special)h(r)o(ules)e(for)h
(inserting)f(and)h(extracting)g(arrays)f(\(using)p 3215
1942 V 52 w Fn(forany)150 2055 y Fr(types\),)25 b(and)g(for)h
(inserting)f(and)h(extracting)f(booleans,)h(octets,)e(chars,)j(and)f
(bounded)e(strings.)150 2167 y(Please)f(r)n(efer)h(to)f(the)g(C++)h
(Mapping)g(chapter)f(of)h(the)f(CORBA)g(2)i(speci\002cation)f([OMG99a)r
(])g(for)150 2280 y(further)e(information.)150 2589 y
Fi(9.2)119 b(T)-11 b(ype)30 b(Any)h(in)e(omniORB2)150
2803 y Fr(This)21 b(section)f(contains)h(some)f(notes)g(on)g(the)h(use)
f(and)h(behaviour)g(of)g(type)f(Any)g(in)i(omniORB2.)150
3065 y Fl(Generating)d(Insertion)g(and)e(Extraction)j(Operators.)91
b Fr(T)-8 b(o)18 b(generate)e(type)h(Any)g(insertion)g(and)150
3178 y(extraction)27 b(operators)e(for)j(constr)o(ucted)d(types)g(and)j
(interfaces,)g(the)e Fn(-a)54 b Fr(command)28 b(line)g(\003ag)150
3291 y(should)22 b(be)g(speci\002ed)g(when)f(r)o(unning)i
Fn(omniidl2)p Fr(.)150 3552 y Fl(T)-8 b(ypeCode)22 b(comparison)j(when)
e(extracting)j(from)f(an)f(Any)-8 b(.)89 b Fr(When)24
b(an)g(attempt)f(is)i(made)f(to)150 3665 y(extract)e(a)g(type)f(fr)n
(om)h(an)h(Any)-10 b(,)21 b(the)g(T)-8 b(ypeCode)20 b(of)i(the)f(type)g
(is)h(checked)f(for)h Fl(equivalence)h Fr(with)150 3778
y(the)29 b(T)-8 b(ypeCode)28 b(of)i(the)f(type)f(stor)n(ed)g(by)i(the)g
(Any)-10 b(.)49 b(The)29 b(equivalent\(\))i(test)d(in)i(the)g(T)-8
b(ypeCode)150 3891 y(interface)23 b(is)g(used)e(for)h(this)h(purpose)
1467 3858 y Fj(1)1502 3891 y Fr(.)291 4006 y(Examples:)150
4314 y Fc(//)49 b(IDL)h(1)150 4514 y(typedef)f(double)f(Double1;)150
4713 y(struct)h(Test1)g({)150 4813 y(Double1)g(a;)150
4912 y(};)150 5211 y(------)p 150 5279 1368 4 v 255 5335
a Fg(1)284 5367 y Ff(In)21 b(pr)o(e-omniORB)c(2.8.0)j(r)o(eleases,)e
(omniORB2)h(performs)e(an)k(equality)e(test)g(and)h(will)f(ignor)o(e)f
(any)i(alias)g(T)-7 b(ype-)150 5458 y(Codes)17 b(\()p
Fb(tk)p 494 5458 23 4 v 26 w(alias)p Ff(\))g(when)h(making)g(this)g
(comparison.)k(The)17 b(semantics)h(is)f(similar)g(to)h(the)g
(equivalent\(\))g(test)f(in)h(the)150 5550 y(T)-7 b(ypeCode)17
b(interface)i(of)f(CORBA)g(2.3.)p eop
%%Page: 76 82
76 81 bop 30 100 a Fr(76)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 555 y Fc(//)49 b(IDL)h(2)30
754 y(typedef)e(double)h(Double2;)30 954 y(struct)g(Test1)g({)130
1053 y(Double2)f(a;)30 1153 y(};)171 1458 y Fr(If)32
b(an)g(attempt)f(is)h(made)g(to)f(extract)h(the)f(type)f
Fn(Test1)53 b Fr(de\002ned)30 b(in)i(IDL)g(1)g(fr)n(om)g(an)h(Any)30
1571 y(containing)23 b(the)g Fn(Test1)52 b Fr(de\002ned)21
b(in)i(IDL)g(2,)h(this)e(will)i(succeed)e(\(and)i(vice-versa\),)g(as)f
(the)f(two)30 1684 y(types)f(dif)n(fer)i(only)f(by)h(an)g(alias.)30
1934 y Fl(Object)j(references.)94 b(W)-8 b(ARNING!!)37
b Fr(In)25 b(pr)n(e-omniORB)h(2.8.0)g(r)n(eleases,)g(the)f(type)f(Any)h
(does)30 2047 y(not)32 b(manage)h(object)g(r)n(efer)n(ence)f(types)e(-)
j(it)g(was)g(unclear)g(in)h(the)d(pr)n(e-2.3)j(CORBA)e(speci\002ca-)30
2160 y(tion)f(whether)e(this)i(is)h(r)n(equir)n(ed)e(or)h(not.)53
b(Ther)n(efor)n(e,)32 b(the)e(pr)n(ogrammer)h(should)f(r)n(elease)h
(ob-)30 2272 y(ject)25 b(r)n(efer)n(ences)f(and)i(pseudo-objects)c
(\(such)k(as)f(T)-8 b(ypeCode\))23 b(that)i(have)h(been)f(extracted)f
(fr)n(om)30 2385 y(an)39 b(Any)-10 b(.)76 b(T)-8 b(ype)38
b(Any)g(will,)44 b(however)-7 b(,)42 b(manage)d(constr)o(ucted)e(types)
g(\(as)j(per)e(the)g(CORBA)30 2498 y(2)h(speci\002cation\))g(-)f
(constr)o(ucted)f(types)g(extracted)g(fr)n(om)i(an)f(Any)g(should)f
(not)h(be)g(deleted,)30 2611 y(as)j(they)f(will)j(be)e(deleted)e(by)i
(the)g(Any)f(when)h(it)h(is)f(destr)n(oyed.)81 b(CORBA)41
b(2.3)h(has)f(clari-)30 2724 y(\002ed)f(this)g(issue)g(and)g(decr)n
(eed)f(that)h(the)g(management)g(of)h(an)g(extracted)e(object)i(r)n
(efer)n(ence)30 2837 y(still)f(belongs)e(to)g(the)g(Any!)77
b(Since)39 b(2.8.0,)44 b(the)38 b(omniORB2)i(implementation)f(conforms)
g(to)30 2950 y(the)28 b(CORBA)h(2.3)h(speci\002cation.)47
b(For)29 b(backwar)n(d)g(compatibility)-10 b(,)32 b(the)c(r)o(untime)h
(variable)i Fn(om-)30 3063 y(niORB::omniORB)p 805 3063
28 4 v 26 w(27)p 941 3063 V 32 w(CompatibleAnyEx)o(tr)o(act)o(io)o(n)21
b Fr(can)27 b(be)g(set)f(to)g(1)h(to)g(get)e(back)j(the)30
3176 y(old)22 b(behaviour)-7 b(.)30 3426 y Fl(T)d(op-level)20
b(aliases.)93 b Fr(When)19 b(a)h(type)e(is)i(inserted)d(into)j(an)g
(Any)-10 b(,)19 b(the)g(Any)g(stor)n(es)e(both)j(the)e(value)30
3539 y(of)30 b(the)f(type)f(and)h(the)g(T)-8 b(ypeCode)27
b(for)j(that)f(type.)48 b(The)29 b(tr)n(eatment)f(of)i(top-level)f
(aliases)i(fr)n(om)30 3652 y(omniORB)23 b(2.8.0)g(onwar)n(ds)f(is)h
(dif)n(fer)n(ent)f(fr)n(om)i(pr)n(e-omniORB)e(2.8.0)i(r)n(eleases.)171
3765 y(In)i(pr)n(e-omniORB)f(2.8.0)i(r)n(eleases,)f(if)g(ther)n(e)f(ar)
n(e)i(any)f(top-level)f Fn(tk)p 2571 3765 V 32 w(alias)f
Fr(T)-8 b(ypeCodes)23 b(in)30 3878 y(the)g(T)-8 b(ypeCode,)22
b(they)h(will)i(be)g(r)n(emoved)e(fr)n(om)i(the)e(T)-8
b(ypeCode)22 b(stor)n(ed)g(in)j(the)e(Any)-10 b(.)32
b(Note)22 b(that)30 3991 y(this)31 b(does)e(not)i(af)n(fect)h(the)p
1002 3991 V 63 w Fn(tc)p 1145 3991 V 86 w Fr(T)-8 b(ypeCode)29
b(generated)f(to)j(r)n(epr)n(esent)e(the)h(type)g(\(see)g(section)30
4103 y(on)25 b(T)-8 b(ypeCode,)24 b(below\).)38 b(This)25
b(behaviour)h(is)g(necessary)-10 b(,)25 b(as)h(two)f(types)f(that)h
(dif)n(fer)h(only)g(by)g(a)30 4216 y(top-level)i(alias)h(can)g(use)e
(the)h(same)g(insertion)f(and)h(extraction)g(operators.)42
b(If)28 b(the)f Fn(tk)p 3150 4216 V 32 w(alias)30 4329
y Fr(is)33 b(not)g(r)n(emoved,)h(one)e(of)i(the)e(types)f(could)i(be)g
(transmitted)f(with)h(an)g(incorr)n(ect)g Fn(tk)p 3150
4329 V 32 w(alias)30 4442 y Fr(T)-8 b(ypeCode.)25 b(Example:)30
4734 y Fc(//)49 b(IDL)h(3)30 4933 y(typedef)e(sequence<double>)f
(seqDouble1;)30 5033 y(typedef)h(sequence<double>)f(seqDouble2;)30
5132 y(typedef)h(seqDouble2)347 b(seqDouble3;)171 5437
y Fr(If)28 b(either)e(seqDouble1)h(or)g(seqDouble2)g(is)h(inserted)e
(into)h(an)h(Any)-10 b(,)27 b(the)g(T)-8 b(ypeCode)25
b(stor)n(ed)30 5550 y(will)f(be)e(for)h(a)g Fn(sequence<double)o(>)p
Fr(,)16 b(and)23 b(not)f(for)g(an)i(alias)g(to)e(a)h
Fn(sequence<doubl)o(e>)p Fr(.)p eop
%%Page: 77 83
77 82 bop 150 100 a Fd(9.2.)51 b(TYPE)22 b(ANY)f(IN)h(OMNIORB2)2037
b Fr(77)291 356 y(Fr)n(om)23 b(omniORB)f(2.8.0)i(onwar)n(ds,)d(ther)n
(e)h(ar)n(e)h(two)f(changes.)27 b(Firstly)-10 b(,)22
b(in)h(the)e(example,)i(seq-)150 469 y(Double1)h(and)g(seqDouble2)g(ar)
n(e)g(now)f(distinct)h(types)d(and)j(ther)n(efor)n(e)f(each)h(has)g
(its)f(own)g(set)g(of)150 582 y(C++)f(operators)e(for)i(Any)e
(insertion)h(and)h(extraction.)27 b(Secondly)-10 b(,)20
b(the)h(top)g(level)h(aliases)g(ar)n(e)g(not)150 695
y(r)n(emoved.)42 b(For)26 b(example,)i(if)h(seqDouble3)e(is)g(inserted)
f(into)h(an)h(Any)-10 b(,)27 b(the)g(insertion)g(operator)150
808 y(for)22 b(seqDouble2)h(is)f(invoked)g(\(because)g(seqDouble3)h(is)
f(just)g(a)h(C++)h(typedef)c(of)i(seqDouble2\).)150 920
y(Ther)n(efor)n(e,)33 b(the)f(typecode)d(in)k(the)e(Any)h(would)f(be)h
(that)g(of)h(seqDouble2.)56 b(If)32 b(this)g(is)g(not)g(de-)150
1033 y(sirable,)c(one)e(can)i(use)e(the)g(new)g(member)h(function)g
('void)g(type\(T)-8 b(ypeCode)p 2909 1033 28 4 v 29 w(ptr\)')27
b(of)g(the)f(Any)150 1146 y(interface)d(to)f(explicitly)h(set)e(the)h
(typecode)e(to)i(the)g(corr)n(ect)h(one.)150 1451 y Fl(Removing)j
(aliases)k(from)d(T)-8 b(ypeCodes.)90 b Fr(Some)26 b(ORBs)h(\(e.g.)41
b(Orbix\))29 b(will)f(not)f(accept)g(T)-8 b(ype-)150
1564 y(Codes)24 b(containing)i Fn(tk)p 995 1564 V 32
w(alias)d Fr(T)-8 b(ypeCodes.)32 b(When)25 b(using)g(type)e(Any)i
(while)g(inter)n(operating)150 1677 y(with)20 b(these)f(ORBs,)g(it)i
(is)f(necessary)f(to)g(r)n(emove)h Fn(tk)p 1962 1677
V 32 w(alias)e Fr(T)-8 b(ypeCodes)17 b(fr)n(om)k(thr)n(oughout)d(the)
150 1790 y(T)-8 b(ypeCode)20 b(r)n(epr)n(esenting)h(a)i(constr)o(ucted)
e(type.)291 1912 y(T)-8 b(o)42 b(r)n(emove)g(all)i Fn(tk)p
1032 1912 V 32 w(alias)c Fr(T)-8 b(ypeCodes)39 b(fr)n(om)k(T)-8
b(ypeCodes)40 b(stor)n(ed)h(in)h(Anys,)k(supply)150 2025
y(the)31 b Fn(-ORBtcAliasExpa)o(nd)48 b(1)86 b Fr(command-line)33
b(\003ag)f(when)f(r)o(unning)h(an)g(omniORB2)g(ex-)150
2138 y(ecutable.)h(Ther)n(e)24 b(will)h(be)g(some)e(\(small\))j
(performance)e(penalty)g(when)f(inserting)h(values)g(into)150
2251 y(an)f(Any)-10 b(.)291 2372 y(Note)20 b(that)i(the)p
844 2372 V 53 w Fn(tc)p 986 2372 V 87 w Fr(T)-8 b(ypeCodes)18
b(generated)i(for)h(all)i(constr)o(ucted)d(types)g(will)j(contain)f
(the)150 2485 y(complete)i(T)-8 b(ypeCode)23 b(for)h(the)g(type)g
(\(including)h(any)g Fn(tk)p 2203 2485 V 32 w(alias)e
Fr(T)-8 b(ypeCodes\),)22 b(r)n(egar)n(dless)i(of)150
2598 y(whether)d(the)h Fn(-ORBtcAliasExp)o(and)16 b Fr(\003ag)23
b(is)g(set)e(to)h(1)h(or)f(not.)150 2890 y Fl(Recursive)35
b(T)-8 b(ypeCodes.)89 b Fr(omniORB2)34 b(does)e(now)i(\(as)g(of)g
(version)f(2.7\))i(support)c(r)n(ecursive)150 2990 y(T)-8
b(ypeCodes.)33 b(This)25 b(means)g(that)g(types)e(such)i(as)h(the)e
(following)i(can)g(be)f(inserted)f(or)g(extracted)150
3089 y(fr)n(om)f(an)g(Any:)150 3407 y Fc(//)49 b(IDL)h(4)150
3606 y(struct)f(Test4)g({)250 3706 y(sequence<Test4>)e(a;)150
3805 y(};)150 4210 y Fl(T)-8 b(ype-unsafe)27 b(construction)g(and)g
(insertion.)92 b Fr(If)27 b(using)f(the)h(type-unsafe)e(Any)h(constr)o
(uctor)-7 b(,)150 4323 y(or)27 b(the)f Fn(CORBA::Any::rep)o(la)o(ce)o
(\(\))21 b Fr(member)27 b(function,)h(ensur)n(e)e(that)h(the)f(value)i
(r)n(eturned)150 4436 y(by)22 b(the)f Fn(CORBA::Any::va)o(lue)o(\(\))15
b Fr(member)22 b(function)g(and)g(the)f(T)-8 b(ypeCode)19
b(r)n(eturned)h(by)i(the)150 4549 y Fn(CORBA::Any::typ)o(e\()o(\))13
b Fr(member)19 b(function)g(ar)n(e)g(used)e(as)i(ar)n(guments)f(to)h
(the)f(constr)o(uctor)f(or)150 4662 y(function.)26 b(Using)17
b(other)f(values)i(or)f(T)-8 b(ypeCodes)14 b(may)k(r)n(esult)f(in)h(a)g
(mismatch,)h(and)f(is)f(unde\002ned)150 4775 y(behaviour)-7
b(.)291 4883 y(Note)21 b(that)i(a)g(non-CORBA)f(2)h(function,)299
5101 y Fc(CORBA::ULong)48 b(CORBA::Any::NP_length\(\))e(const)291
5324 y Fr(is)24 b(supplied.)29 b(This)24 b(member)f(function)h(r)n
(eturns)e(the)h(length)g(of)g(the)g(value)h(r)n(eturned)e(by)i(the)150
5437 y Fn(CORBA::Any::val)o(ue)o(\(\))48 b Fr(member)23
b(function.)29 b(It)23 b(may)g(be)g(necessary)f(to)g(use)g(this)h
(function)150 5550 y(if)g(the)f(Any's)g(value)h(is)g(to)f(be)h(stor)n
(ed)e(in)i(a)g(\002le.)p eop
%%Page: 78 84
78 83 bop 30 100 a Fr(78)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 356 y Fl(Threads)h(and)f(type)g
(Any)-8 b(.)89 b Fr(Inserting)21 b(and)h(extracting)g(simultaneously)f
(fr)n(om)i(the)f(same)g(Any)30 469 y(\(in)h(2)h(dif)n(fer)n(ent)e(thr)n
(eads\))g(is)h(unde\002ned)d(behaviour)-7 b(.)171 582
y(Extracting)21 b(simultaneously)g(fr)n(om)h(the)f(same)h(Any)f(\(in)h
(2)g(or)g(mor)n(e)f(dif)n(fer)n(ent)h(thr)n(eads\))f(also)30
695 y(leads)30 b(to)g(unde\002ned)e(behaviour)-7 b(.)52
b(It)30 b(was)g(decided)g(not)f(to)h(pr)n(otect)f(the)h(Any)g(with)g(a)
h(mutex,)30 808 y(as)24 b(this)g(condition)f(should)g(rar)n(ely)h
(arise,)g(and)g(adding)f(a)i(mutex)e(would)g(lead)h(to)g(performance)30
920 y(penalties.)30 1218 y Fi(9.3)119 b(T)-11 b(ypeCode)31
b(in)e(omniORB2)30 1429 y Fr(This)20 b(section)f(contains)h(some)f
(notes)g(on)g(the)h(use)f(and)h(behaviour)g(of)g(T)-8
b(ypeCode)18 b(in)j(omniORB2)30 1666 y Fl(T)-8 b(ypeCodes)20
b(in)h(IDL.)90 b Fr(When)21 b(using)g(T)-8 b(ypeCodes)18
b(in)k(IDL,)e(note)g(that)h(they)f(ar)n(e)i(de\002ned)d(in)j(the)30
1766 y(CORBA)h(scope.)j(Ther)n(efor)n(e,)21 b(CORBA::T)-8
b(ypeCode)20 b(should)i(be)g(used.)27 b(Example:)30 1935
y Fc(//)49 b(IDL)h(5)30 2134 y(struct)f(Test5)g({)130
2234 y(long)g(length;)130 2334 y(CORBA::TypeCode)e(desc;)30
2433 y(};)30 2684 y Fl(orb.idl)90 b Fr(Inclusion)28 b(of)f(the)g
(\002le)h Fn(orb.idl)51 b Fr(in)28 b(IDL)f(using)g(CORBA::T)-8
b(ypeCode)25 b(is)i(optional.)30 2796 y(An)22 b(empty)g(orb.idl)g
(\002le)h(is)g(pr)n(ovided)f(for)g(compatibility)i(purposes.)30
3047 y Fl(Generating)41 b(T)-8 b(ypeCodes)40 b(for)g(constructed)i
(types.)91 b Fr(T)-8 b(o)39 b(generate)g(a)i(T)-8 b(ypeCode)38
b(for)j(con-)30 3160 y(str)o(ucted)27 b(types,)g(specify)h(the)g
Fn(-a)g Fr(command-line)h(\003ag)g(when)f(r)o(unning)g(omniidl2.)47
b(This)28 b(will)30 3273 y(generate)e(a)p 482 3273 28
4 v 62 w Fn(tc)p 625 3273 V 60 w Fr(T)-8 b(ypeCode)26
b(describing)h(the)h(type,)f(at)i(the)e(same)h(scope)f(as)h(the)g(type)
e(\(as)j(per)30 3386 y(the)22 b(CORBA)g(2)i(speci\002cation\).)k
(Example:)30 3579 y Fc(//)49 b(IDL)h(6)30 3778 y(struct)f(Test6)g({)80
3878 y(double)f(a;)80 3977 y(sequence<long>)f(b;)30 4077
y(};)171 4283 y Fr(A)25 b(T)-8 b(ypeCode,)p 729 4283
V 55 w Fn(tc)p 872 4283 V 31 w(Test6)p Fr(,)23 b(will)j(be)e(generated)
f(to)h(describe)f(the)h(str)o(uct)g Fn(Test6)p Fr(.)32
b(The)23 b(op-)30 4396 y(erations)j(de\002ned)f(in)i(the)e(T)-8
b(ypeCode)24 b(interface)j(\(see)f(section)g(6.7.1)h(of)g(the)e(CORBA)i
(2)g(speci\002-)30 4509 y(cation)c([OMG99a)s(])g(\))g(can)g(be)g(used)e
(to)h(query)f(the)h(T)-8 b(ypeCode)20 b(about)j(the)f(type)f(it)i(r)n
(epr)n(esents.)30 4759 y Fl(T)-8 b(ypeCode)51 b(equality)-8
b(.)91 b Fr(The)52 b(behaviour)h(of)g Fn(CORBA::TypeCode)o(::)o(eq)o
(ual)o(\(\))46 b Fr(member)30 4872 y(function)k(fr)n(om)h(omniORB)g
(2.8.0)g(onwar)n(ds)e(is)i(dif)n(fer)n(ent)f(fr)n(om)h(pr)n(e-omniORB)f
(2.8.0)h(r)n(e-)30 4985 y(leases.)80 b(In)39 b(summary)-10
b(,)45 b(the)39 b(pr)n(e-omniORB)h(2.8.0)h(is)f(close)g(to)g(the)f
(semantics)h(of)g(the)g(new)30 5098 y Fn(CORBA::TypeCode)o(::)o(eq)o
(ui)o(val)o(en)o(t\()o(\))17 b Fr(member)22 b(function.)28
b(Details)23 b(ar)n(e)g(as)g(follows:)171 5211 y(The)g
Fn(CORBA::TypeCode)o(::)o(equ)o(al)o(\(\))17 b Fr(member)24
b(function)g(will)h(r)n(eturn)e(tr)o(ue)g(only)g(if)i(the)30
5324 y(two)d(T)-8 b(ypeCodes)20 b(ar)n(e)j Fl(exactly)i
Fr(the)d(same.)28 b Fn(tk)p 1659 5324 V 32 w(alias)20
b Fr(T)-8 b(ypeCodes)20 b(ar)n(e)j(included)g(in)g(this)f(com-)30
5437 y(parison,)36 b(unlike)e(the)f(comparison)h(made)g(when)f(values)i
(ar)n(e)f(extracted)f(fr)n(om)h(an)h(Any)e(\(see)30 5550
y(section)22 b(on)g(Any)-10 b(,)22 b(above\).)p eop
%%Page: 79 85
79 84 bop 150 100 a Fd(9.3.)51 b(TYPECODE)23 b(IN)f(OMNIORB2)2004
b Fr(79)291 356 y(In)20 b(pr)n(e-omniORB)g(2.8.0)h(r)n(eleases,)e
(equality)h(test)f(would)g(ignor)n(e)h(the)f(optional)h(\002elds)g
(when)150 469 y(one)35 b(of)h(the)f(\002elds)g(in)h(the)g(two)f
(typecodes)e(is)j(empty)-10 b(.)66 b(For)35 b(example,)k(if)d(one)f(of)
h(the)f(T)-8 b(ype-)150 582 y(Codes)32 b(being)i(checked)e(is)i(a)g
Fn(tk)p 1346 582 28 4 v 32 w(struct)p Fr(,)g Fn(tk)p
1875 582 V 31 w(union)p Fr(,)g Fn(tk)p 2348 582 V 32
w(enum)p Fr(,)g(or)g Fn(tk)p 2887 582 V 32 w(alias)p
Fr(,)f(and)h(has)150 695 y(an)27 b(empty)f(r)n(epository)e(ID)j
(parameter)-7 b(,)28 b(then)e(the)f(r)n(epository)g(ID)i(parameter)f
(will)i(be)f(ignor)n(ed)150 808 y(when)j(checking)g(for)g(equality)-10
b(.)50 b(Similarly)-10 b(,)34 b(if)d(the)e Fn(name)53
b Fr(or)30 b Fn(member)p 2709 808 V 30 w(name)53 b Fr(parameters)29
b(of)150 920 y(a)h(T)-8 b(ypeCode)27 b(ar)n(e)j(empty)e(strings,)h
(they)f(will)j(be)e(ignor)n(ed)f(for)i(equality)f(checking)g(purposes.)
150 1033 y(This)22 b(is)g(because)g(a)h(CORBA)g(2)g(ORB)f(does)e(not)i
(have)h(to)e(include)i(these)d(parameters)i(in)h(a)f(T)-8
b(ype-)150 1146 y(Code)22 b(\(see)g(the)h(Inter)n(operability)f
(section)g(of)h(the)f(CORBA)i(2)f(speci\002cation)g([OMG99a)s(]\).)30
b(Note)150 1259 y(that)22 b(these)f(\(optional\))i(parameters)f(ar)n(e)
h(included)f(in)h(T)-8 b(ypeCodes)20 b(generated)h(by)h(omniORB2.)291
1372 y(Since)g(CORBA)f(2.3,)h(the)f(issue)f(of)i(typecode)d(equality)i
(has)h(been)e(clari\002ed.)29 b(Ther)n(e)20 b(is)i(now)f(a)150
1485 y(new)d(member)g Fn(CORBA::TypeCod)o(e:)o(:e)o(qui)o(va)o(le)o(nt)
o(\(\))12 b Fr(which)18 b(pr)n(ovides)g(the)f(semantics)h(of)150
1598 y(the)29 b Fn(CORBA::TypeCod)o(e:)o(:e)o(qu)o(al\()o(\))23
b Fr(as)30 b(implemented)e(in)i(pr)n(e-omniORB)f(2.8.0)h(r)n(eleases.)
150 1711 y(So)i(fr)n(om)i(omniORB)e(2.8.0)i(onwar)n(ds,)g(the)e
Fn(CORBA::TypeCode)o(::e)o(qu)o(al)o(\(\))26 b Fr(function)33
b(has)150 1824 y(been)23 b(changed)h(to)f(enfor)n(ce)g(strict)h
(equality)-10 b(.)31 b(The)23 b(pr)n(e-2.8.0)i(behaviour)f(can)h(be)f
(obtained)f(with)150 1937 y Fn(equivalent\(\))p Fr(.)p
eop
%%Page: 80 86
80 85 bop 30 100 a Fr(80)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 356 y Fi(9.4)119
b(Source)30 b(Listing)30 590 y Fh(9.4.1)99 b(anyExample)p
895 590 30 4 v 35 w(impl.cc)30 768 y Fc(//)49 b(anyExample_impl.cc)e(-)
j(This)f(is)g(the)g(source)g(code)g(of)g(the)h(exam-)30
867 y(ple)f(used)g(in)30 967 y(//)1096 b(Chapter)48 b(9)i("Type)f(Any)g
(and)g(Type-)30 1067 y(Code")g(of)g(the)h(omniORB2)30
1166 y(//)1096 b(users)48 b(guide.)30 1266 y(//)30 1365
y(//)747 b(This)49 b(is)g(the)h(object)e(implementation.)30
1465 y(//)30 1565 y(//)h(Usage:)g(anyExample_impl)30
1664 y(//)30 1764 y(//)398 b(On)50 b(startup,)e(the)h(object)g
(reference)f(is)h(registered)f(with)h(the)30 1864 y(//)398
b(COS)49 b(naming)g(service.)f(The)i(client)e(uses)h(the)h(naming)e
(service)h(to)30 1963 y(//)398 b(locate)49 b(this)g(object.)30
2063 y(//)30 2163 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e(is)
i(bound)f(to)g(is)g(as)h(follows:)30 2262 y(//)697 b(root)99
b([context])30 2362 y(//)747 b(|)30 2461 y(//)697 b(text)99
b([context])48 b(kind)h([my_context])30 2561 y(//)747
b(|)30 2661 y(//)697 b(anyExample)98 b([object])g(kind)49
b([Object])30 2760 y(//)30 2960 y(#include)f(<iostream.h>)30
3159 y(#include)g("anyExample.hh")30 3458 y(static)h(CORBA::Boolean)e
(bindObjectToName\(CORBA::ORB_ptr,COR)o(BA::O)o(bject)o(_ptr\);)30
3757 y(class)i(anyExample_i)e(:)j(public)f(virtual)f(_sk_anyExample)f
({)30 3856 y(public:)130 3956 y(anyExample_i\(\))g({)i(})130
4055 y(virtual)f(\230anyExample_i\(\))f({)j(})130 4155
y(virtual)e(CORBA::Any*)g(testOp\(const)f(CORBA::Any&)h(a\);)30
4255 y(};)30 4554 y(CORBA::Any*)30 4653 y(anyExample_i::testOp\(const)d
(CORBA::Any&)j(a\))h({)130 4852 y(cout)g(<<)g("Any)g(received,)f
(containing:)g(")i(<<)f(endl;)30 5052 y(#ifndef)f(NO_FLOAT)130
5151 y(CORBA::Double)f(d;)30 5251 y(#endif)130 5450 y(CORBA::Long)g(l;)
130 5550 y(const)h(char*)h(str;)299 b(//)49 b(From)g(CORBA)g(2.3)g
(onwards,)f(uses)i(const)e(char*)p eop
%%Page: 81 87
81 86 bop 150 100 a Fd(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(81)1346 356 y Fc(//)49 b(instead)f(of)i(char*.)250
555 y(const)f(testStruct*)e(tp;)149 b(//)50 b(From)f(CORBA)g(2.3)g
(onwards,)f(use)1445 655 y(//)i(const)e(testStruct*)g(in-)150
754 y(stead)h(of)g(testStruct*)250 1053 y(if)g(\(a)h(>>=)f(l\))g({)349
1153 y(cout)g(<<)h("Long:)e(")i(<<)g(l)f(<<)h(endl;)250
1253 y(})150 1352 y(#ifndef)f(NO_FLOAT)250 1452 y(else)g(if)g(\(a)h
(>>=)f(d\))g({)349 1551 y(cout)g(<<)h("Double:)e(")i(<<)f(d)h(<<)f
(endl;)250 1651 y(})150 1751 y(#endif)250 1850 y(else)g(if)g(\(a)h(>>=)
f(str\))g({)349 1950 y(cout)g(<<)h("String:)e(")i(<<)f(str)g(<<)h
(endl;)349 2050 y(//)g(Since)f(2.8.0)f(the)i(storage)e(of)i(the)f
(extracted)f(string)h(is)g(still)349 2149 y(//)h(owned)f(by)g(the)g
(any.)349 2249 y(//)h(In)f(pre-omniORB)f(2.8.0)h(releases,)f(the)h
(string)g(returned)f(is)i(a)f(copy.)250 2348 y(})250
2448 y(else)g(if)g(\(a)h(>>=)f(tp\))g({)349 2548 y(cout)g(<<)h
("testStruct:)d(l:)j(")f(<<)h(tp->l)f(<<)g(endl;)349
2647 y(cout)g(<<)h(")597 b(s:)50 b(")f(<<)h(tp->s)f(<<)g(endl;)250
2747 y(})250 2847 y(else)g({)349 2946 y(cout)g(<<)h("Unknown)e(value.")
h(<<)g(endl;)250 3046 y(})250 3245 y(CORBA::Any*)e(ap)j(=)f(new)h
(CORBA::Any;)250 3444 y(*ap)f(<<=)g(\(CORBA::ULong\))e(314;)250
3644 y(cout)i(<<)g("Returning)f(Any)h(containing:)f(ULong:)h(314\\n")f
(<<)i(endl;)250 3743 y(return)e(ap;)150 3843 y(})150
4142 y(int)150 4241 y(main\(int)g(argc,)h(char)g(**argv\))150
4341 y({)250 4441 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)250 4540
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)250 4740 y(anyExample_i)d(*myobj)i(=)h(new)f
(anyExample_i\(\);)250 4839 y(myobj->_obj_is_ready\(boa\);)250
5038 y({)349 5138 y(anyExample_var)e(myobjRef)i(=)g(myobj->_this\(\);)
349 5238 y(if)h(\(!bindObjectToName\(orb,myobjRef\)\))43
b({)449 5337 y(return)49 b(1;)349 5437 y(})250 5537 y(})p
eop
%%Page: 82 88
82 87 bop 30 100 a Fr(82)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)130 456 y Fc(boa->impl_is_ready\(\);)
130 555 y(//)49 b(Tell)g(the)g(BOA)h(we)f(are)g(ready.)g(The)g(BOA's)g
(default)g(be-)30 655 y(haviour)f(is)i(to)f(block)130
754 y(//)g(on)g(this)h(call)f(indefinitely.)130 954 y(return)f(0;)30
1053 y(})30 1352 y(static)30 1452 y(CORBA::Boolean)30
1551 y(bindObjectToName\(CORBA::ORB_ptr)c(orb,CORBA::Object_ptr)i
(obj\))30 1651 y({)130 1751 y(CosNaming::NamingContext_var)e
(rootContext;)130 1950 y(try)49 b({)229 2050 y(//)h(Obtain)e(a)i
(reference)e(to)i(the)f(root)g(context)f(of)i(the)f(Name)g(service:)229
2149 y(CORBA::Object_var)e(initServ;)229 2249 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)229
2448 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))229 2548 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)229 2647 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)229
2747 y(if)g(\(CORBA::is_nil\(rootContext\)\))329 2847
y({)428 2946 y(cerr)g(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)428 3046 y(return)f(0;)329 3145 y(})130 3245
y(})130 3345 y(catch\(CORBA::ORB::InvalidName&)44 b(ex\))49
b({)229 3444 y(cerr)g(<<)h("Service)e(required)g(is)i(invalid)e([does)h
(not)g(exist].")g(<<)g(endl;)229 3544 y(return)g(0;)130
3644 y(})130 3942 y(try)g({)229 4042 y(//)h(Bind)f(a)g(context)g
(called)g("test")f(to)i(the)f(root)g(context:)229 4241
y(CosNaming::Name)e(contextName;)229 4341 y(contextName.length\(1\);)
229 4441 y(contextName[0].id)147 b(=)49 b(\(const)g(char*\))g("test";)
197 b(//)50 b(string)f(copied)229 4540 y(contextName[0].kind)e(=)i
(\(const)g(char*\))g("my_context";)e(//)i(string)g(copied)229
4640 y(//)h(Note)f(on)g(kind:)g(The)g(kind)g(field)g(is)h(used)f(to)g
(indicate)g(the)g(type)229 4740 y(//)h(of)f(the)g(object.)g(This)g(is)g
(to)h(avoid)f(conventions)e(such)j(as)f(that)g(used)229
4839 y(//)h(by)f(files)g(\(name.type)f(--)h(e.g.)g(test.ps)g(=)h
(postscript)e(etc.\))229 5038 y(CosNaming::NamingContext_var)d
(testContext;)229 5138 y(try)k({)329 5238 y(//)g(Bind)g(the)h(context)e
(to)i(root,)e(and)i(assign)e(testContext)g(to)i(it:)329
5337 y(testContext)e(=)h(rootContext->bind_new_context\(context)o
(Name\))o(;)229 5437 y(})229 5537 y
(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o(nd&)44
b(ex\))49 b({)p eop
%%Page: 83 89
83 88 bop 150 100 a Fd(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(83)449 356 y Fc(//)49 b(If)h(the)f(context)g(already)f(exists,)h
(this)g(excep-)150 456 y(tion)g(will)g(be)h(raised.)449
555 y(//)f(In)h(this)f(case,)g(just)g(resolve)f(the)i(name)f(and)g
(assign)g(testContext)449 655 y(//)g(to)h(the)f(object)g(returned:)449
754 y(CORBA::Object_var)e(tmpobj;)449 854 y(tmpobj)i(=)g
(rootContext->resolve\(contextName\);)449 954 y(testContext)f(=)h
(CosNaming::NamingContext::_narrow\(tmp)o(obj\);)449
1053 y(if)g(\(CORBA::is_nil\(testContext\)\))c({)549
1153 y(cerr)k(<<)g("Failed)g(to)g(narrow)g(naming)f(context.")g(<<)i
(endl;)549 1253 y(return)e(0;)449 1352 y(})349 1452 y(})349
1651 y(//)i(Bind)f(the)g(object)g(\(obj\))g(to)g(testContext,)f(naming)
g(it)i(anyExample:)349 1751 y(CosNaming::Name)d(objectName;)349
1850 y(objectName.length\(1\);)349 1950 y(objectName[0].id)147
b(=)49 b(\(const)g(char*\))g("anyExam-)150 2050 y(ple";)149
b(//)49 b(string)g(copied)349 2149 y(objectName[0].kind)e(=)i(\(const)g
(char*\))g("Object";)f(//)h(string)g(copied)349 2448
y(//)h(Bind)f(obj)g(with)g(name)g(anyExample)f(to)i(the)f(testContext:)
349 2548 y(try)h({)449 2647 y(testContext->bind\(objectName,obj\);)349
2747 y(})349 2847 y(catch\(CosNaming::NamingContext::Alrea)o(dyBou)o
(nd&)44 b(ex\))49 b({)449 2946 y(testContext->rebind\(objectName,obj\))
o(;)349 3046 y(})349 3145 y(//)h(Note:)f(Using)f(rebind\(\))h(will)g
(overwrite)f(any)h(Object)g(previ-)150 3245 y(ously)g(bound)349
3345 y(//)349 b(to)49 b(/test/anyExample)e(with)i(obj.)349
3444 y(//)349 b(Alternatively,)47 b(bind\(\))h(can)i(be)f(used,)g
(which)g(will)g(raise)g(a)349 3544 y(//)349 b
(CosNaming::NamingContext::Already)o(Bound)43 b(excep-)150
3644 y(tion)49 b(if)h(the)f(name)349 3743 y(//)349 b(supplied)48
b(is)h(already)g(bound)g(to)g(an)h(object.)250 3843 y(})250
3942 y(catch)f(\(CORBA::COMM_FAILURE&)c(ex\))50 b({)349
4042 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 4142 y(tact)f(the)g(")598 4241
y(<<)h("naming)e(service.")g(<<)i(endl;)349 4341 y(return)f(0;)250
4441 y(})250 4540 y(catch)g(\(omniORB::fatalException&)c(ex\))k({)349
4640 y(throw;)250 4740 y(})250 4839 y(catch)g(\(...\))f({)349
4939 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)150 5038 y(vice."<<)g(endl;)349
5138 y(return)h(0;)250 5238 y(})250 5337 y(return)f(1;)150
5437 y(})p eop
%%Page: 84 90
84 89 bop 30 100 a Fr(84)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 356 y Fh(9.4.2)99
b(anyExample)p 895 356 30 4 v 35 w(clt.cc)30 568 y Fc(//)49
b(anyExample_clt.cc)e(-)100 b(This)49 b(is)g(the)g(source)g(code)g(of)g
(the)h(exam-)30 668 y(ple)f(used)g(in)30 768 y(//)1096
b(Chapter)48 b(9)i("Type)f(Any)g(and)g(Type-)30 867 y(Code")g(of)g(the)
h(omniORB2)30 967 y(//)1096 b(users)48 b(guide.)30 1067
y(//)30 1166 y(//)697 b(This)49 b(is)h(the)f(client.)f(It)i(uses)f(the)
g(COSS)g(naming)g(service)30 1266 y(//)697 b(to)49 b(obtain)g(the)g
(object)g(reference.)30 1365 y(//)30 1465 y(//)g(Usage:)g
(anyExample_clt)30 1565 y(//)30 1664 y(//)30 1764 y(//)398
b(On)50 b(startup,)e(the)h(client)g(lookup)g(the)g(object)f(refer-)30
1864 y(ence)h(from)g(the)30 1963 y(//)398 b(COS)49 b(naming)g(service.)
30 2063 y(//)30 2163 y(//)398 b(The)49 b(name)g(which)g(the)h(object)e
(is)i(bound)f(to)g(is)g(as)h(follows:)30 2262 y(//)697
b(root)99 b([context])30 2362 y(//)747 b(|)30 2461 y(//)697
b(text)99 b([context])48 b(kind)h([my_context])30 2561
y(//)747 b(|)30 2661 y(//)697 b(anyExample)98 b([object])g(kind)49
b([Object])30 2760 y(//)30 2960 y(#include)f(<iostream.h>)30
3059 y(#include)g("anyExample.hh")30 3258 y(static)h(CORBA::Object_ptr)
d(getObjectReference\(CORBA::ORB_ptr)e(orb\);)30 3358
y(static)49 b(void)g(invokeOp\(anyExample_ptr&)c(tobj,)k(const)g
(CORBA::Any&)f(a\);)30 3557 y(int)30 3657 y(main)h(\(int)g(argc,)g
(char)g(**argv\))30 3757 y({)130 3856 y(CORBA::ORB_ptr)e(orb)i(=)h
(CORBA::ORB_init\(argc,argv,"omniORB)o(2"\);)130 3956
y(CORBA::BOA_ptr)d(boa)i(=)h(orb->BOA_init\(argc,argv,"omniORB2_)o
(BOA"\))o(;)130 4055 y(CORBA::Object_var)c(obj;)130 4255
y(try)j({)229 4354 y(obj)g(=)h(getObjectReference\(orb\);)130
4454 y(})130 4554 y(catch\(CORBA::COMM_FAILURE&)45 b(ex\))k({)229
4653 y(cerr)g(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)30 4753 y(tact)f(the)g(")478 4852
y(<<)h("object.")e(<<)h(endl;)229 4952 y(return)g(-1;)130
5052 y(})130 5151 y(catch\(omniORB::fatalException&)44
b(ex\))49 b({)229 5251 y(cerr)g(<<)h("Caught)e(omniORB2)h
(fatalException.)e(This)i(indi-)30 5351 y(cates)g(a)g(bug)h(is)f
(caught)g(")478 5450 y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h
(bug)f(report.\\n")478 5550 y(<<)h("The)f(exception)f(was)h(thrown)g
(in)g(file:)g(")h(<<)f(ex.file\(\))f(<<)i("\\n")p eop
%%Page: 85 91
85 90 bop 150 100 a Fd(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(85)598 356 y Fc(<<)50 b(")1394 b(line:)49 b(")h(<<)f(ex.line\(\))f
(<<)i("\\n")598 456 y(<<)g("The)f(error)g(message)f(is:)h(")h(<<)g
(ex.errmsg\(\))d(<<)j(endl;)349 555 y(return)f(-1;)250
655 y(})250 754 y(catch\(...\))f({)349 854 y(cerr)h(<<)h("Caught)e(a)i
(system)f(exception.")e(<<)j(endl;)349 954 y(return)f(-1;)250
1053 y(})250 1352 y(anyExample_ptr)e(tobj)i(=)h
(anyExample::_narrow\(obj\);)250 1551 y(if)f(\(CORBA::is_nil\(tobj\)\))
d({)349 1651 y(cerr)j(<<)h("Can't)e(narrow)h(object)g(reference)f(to)h
(type)g(anyExam-)150 1751 y(ple.")g(<<)g(endl;)349 1850
y(return)g(-1;)250 1950 y(})250 2249 y(CORBA::Any)f(a;)250
2448 y(try)h({)349 2548 y(//)h(Sending)e(Long)349 2647
y(CORBA::Long)g(l)i(=)f(100;)349 2747 y(a)h(<<=)f(l;)349
2847 y(cout)g(<<)h("Sending)e(Any)h(containing)f(Long:)h(")h(<<)f(l)h
(<<)f(endl;)349 2946 y(invokeOp\(tobj,a\);)349 3145 y(//)h(Sending)e
(Double)150 3245 y(#ifndef)h(NO_FLOAT)349 3345 y(CORBA::Double)f(d)h(=)
h(1.2345;)349 3444 y(a)g(<<=)f(d;)349 3544 y(cout)g(<<)h("Sending)e
(Any)h(containing)f(Double:)h(")g(<<)h(d)f(<<)h(endl;)349
3644 y(invokeOp\(tobj,a\);)150 3743 y(#endif)349 3942
y(//)g(Sending)e(String)349 4042 y(const)h(char*)g(str)g(=)h("Hello";)
349 4142 y(a)g(<<=)f(str;)349 4241 y(cout)g(<<)h("Sending)e(Any)h
(containing)f(String:)h(")g(<<)h(str)f(<<)h(endl;)349
4341 y(invokeOp\(tobj,a\);)349 4540 y(//)g(Sending)e(testStruct)98
b([Struct)48 b(defined)h(in)g(IDL])349 4640 y(testStruct)f(t;)349
4740 y(t.l)i(=)f(456;)349 4839 y(t.s)h(=)f(8;)349 4939
y(a)h(<<=)f(t;)349 5038 y(cout)g(<<)h("Sending)e(Any)h(containing)f
(testStruct:)g(l:)h(")h(<<)g(t.l)f(<<)g(endl;)349 5138
y(cout)g(<<)h(")1743 b(s:)49 b(")h(<<)g(t.s)f(<<)g(endl;)349
5238 y(invokeOp\(tobj,a\);)250 5337 y(})250 5437 y
(catch\(CORBA::COMM_FAILURE&)c(ex\))k({)349 5537 y(cerr)g(<<)h("Caught)
e(system)h(exception)f(COMM_FAILURE,)f(unable)i(to)h(con-)p
eop
%%Page: 86 92
86 91 bop 30 100 a Fr(86)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)30 356 y Fc(tact)49
b(the)g(")478 456 y(<<)h("object.")e(<<)h(endl;)229 555
y(return)g(-1;)130 655 y(})130 754 y(catch\(omniORB::fatalException&)44
b(ex\))49 b({)229 854 y(cerr)g(<<)h("Caught)e(omniORB2)h
(fatalException.)e(This)i(indi-)30 954 y(cates)g(a)g(bug)h(is)f(caught)
g(")478 1053 y(<<)h("within)e(omniORB2.\\nPlease)f(send)i(a)h(bug)f
(report.\\n")478 1153 y(<<)h("The)f(exception)f(was)h(thrown)g(in)g
(file:)g(")h(<<)f(ex.file\(\))f(<<)i("\\n")478 1253 y(<<)g(")1394
b(line:)49 b(")h(<<)f(ex.line\(\))f(<<)i("\\n")478 1352
y(<<)g("The)f(error)g(message)f(is:)h(")h(<<)g(ex.errmsg\(\))d(<<)j
(endl;)229 1452 y(return)f(-1;)130 1551 y(})130 1651
y(catch\(...\))f({)229 1751 y(cerr)h(<<)h("Caught)e(a)i(system)f
(exception.")e(<<)j(endl;)229 1850 y(return)f(-1;)130
1950 y(})130 2149 y(return)f(0;)30 2249 y(})30 2448 y(static)30
2548 y(CORBA::Object_ptr)30 2647 y(getObjectReference\(CORBA::ORB_ptr)c
(orb\))30 2747 y({)130 2847 y(CosNaming::NamingContext_var)g
(rootContext;)130 3046 y(try)49 b({)229 3145 y(//)h(Obtain)e(a)i
(reference)e(to)i(the)f(root)g(context)f(of)i(the)f(Name)g(service:)229
3245 y(CORBA::Object_var)e(initServ;)229 3345 y(initServ)i(=)g
(orb->resolve_initial_references\("Nam)o(eServi)o(ce"\);)229
3544 y(//)h(Narrow)e(the)i(object)e(returned)h(by)g
(resolve_initial_references\(\))229 3644 y(//)h(to)f(a)h
(CosNaming::NamingContext)45 b(object:)229 3743 y(rootContext)j(=)i
(CosNaming::NamingContext::_narrow)o(\(initS)o(erv\);)229
3843 y(if)g(\(CORBA::is_nil\(rootContext\)\))329 3942
y({)428 4042 y(cerr)g(<<)f("Failed)g(to)g(narrow)g(naming)f(context.")g
(<<)i(endl;)428 4142 y(return)f(CORBA::Object::_nil\(\);)329
4241 y(})130 4341 y(})130 4441 y(catch\(CORBA::ORB::InvalidName&)44
b(ex\))49 b({)229 4540 y(cerr)g(<<)h("Service)e(required)g(is)i
(invalid)e([does)h(not)g(exist].")g(<<)g(endl;)229 4640
y(return)g(CORBA::Object::_nil\(\);)130 4740 y(})130
5038 y(//)g(Create)g(a)g(name)g(object,)g(containing)f(the)h(name)g
(test/context:)130 5138 y(CosNaming::Name)e(name;)130
5238 y(name.length\(2\);)130 5437 y(name[0].id)147 b(=)50
b(\(const)f(char*\))f("test";)348 b(//)49 b(string)g(copied)130
5537 y(name[0].kind)e(=)j(\(const)f(char*\))f("my_context";)g(//)h
(string)g(copied)p eop
%%Page: 87 93
87 92 bop 150 100 a Fd(9.4.)51 b(SOURCE)23 b(LISTING)2381
b Fr(87)250 356 y Fc(name[1].id)147 b(=)50 b(\(const)f(char*\))f
("anyExample";)250 456 y(name[1].kind)f(=)j(\(const)f(char*\))f
("Object";)250 555 y(//)h(Note)g(on)h(kind:)e(The)i(kind)f(field)g(is)g
(used)g(to)h(indicate)e(the)h(type)250 655 y(//)g(of)h(the)f(object.)f
(This)h(is)h(to)f(avoid)g(conventions)f(such)h(as)g(that)g(used)250
754 y(//)g(by)h(files)e(\(name.type)g(--)i(e.g.)f(test.ps)f(=)i
(postscript)e(etc.\))250 1053 y(CORBA::Object_ptr)e(obj;)250
1153 y(try)j({)349 1253 y(//)h(Resolve)e(the)h(name)h(to)f(an)g(object)
g(reference,)f(and)h(as-)150 1352 y(sign)g(the)g(reference)349
1452 y(//)h(returned)e(to)h(a)h(CORBA::Object:)349 1551
y(obj)g(=)f(rootContext->resolve\(name\);)250 1651 y(})250
1751 y(catch\(CosNaming::NamingContext::N)o(otFoun)o(d&)44
b(ex\))349 1850 y({)449 1950 y(//)49 b(This)g(exception)g(is)g(thrown)g
(if)g(any)g(of)h(the)f(components)f(of)h(the)449 2050
y(//)g(path)g([contexts)g(or)g(the)g(object])g(aren't)f(found:)449
2149 y(cerr)h(<<)g("Context)g(not)g(found.")f(<<)i(endl;)449
2249 y(return)f(CORBA::Object::_nil\(\);)349 2348 y(})250
2448 y(catch)g(\(CORBA::COMM_FAILURE&)c(ex\))50 b({)349
2548 y(cerr)f(<<)h("Caught)e(system)h(exception)f(COMM_FAILURE,)f
(unable)i(to)h(con-)150 2647 y(tact)f(the)g(")598 2747
y(<<)h("naming)e(service.")g(<<)i(endl;)349 2847 y(return)f
(CORBA::Object::_nil\(\);)250 2946 y(})250 3046 y
(catch\(omniORB::fatalException&)44 b(ex\))49 b({)349
3145 y(throw;)250 3245 y(})250 3345 y(catch)g(\(...\))f({)349
3444 y(cerr)h(<<)h("Caught)e(a)i(system)f(exception)f(while)h(using)f
(the)i(naming)e(ser-)150 3544 y(vice."<<)g(endl;)349
3644 y(return)h(CORBA::Object::_nil\(\);)250 3743 y(})250
3843 y(return)f(obj;)150 3942 y(})150 4241 y(static)h(void)150
4341 y(invokeOp\(anyExample_ptr&)c(tobj,)k(const)g(CORBA::Any&)f(a\))
150 4441 y({)250 4540 y(CORBA::Any_var)f(bp;)250 4740
y(cout)i(<<)g("Invoking)f(operation.")g(<<)h(endl;)250
4839 y(bp)g(=)h(tobj->testOp\(a\);)250 5038 y(cout)f(<<)g("Operation)f
(completed.)g(Returned)g(Any:)h(";)250 5138 y(CORBA::ULong)e(ul;)250
5337 y(if)i(\(bp)g(>>=)h(ul\))f({)349 5437 y(cout)g(<<)h("ULong:)e(")i
(<<)f(ul)h(<<)f("\\n")g(<<)h(endl;)250 5537 y(})p eop
%%Page: 88 94
88 93 bop 30 100 a Fr(88)1543 b Fd(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)130 356 y Fc(else)49
b({)229 456 y(cout)g(<<)h("Unknown)e(value.")h(<<)g("\\n")g(<<)h(endl;)
130 555 y(})30 655 y(})p eop
%%Page: 89 95
89 94 bop 150 979 a Fk(Chapter)44 b(10)150 1394 y Fm(Dynamic)51
b(Management)h(of)g(Any)150 1643 y(V)-23 b(alues)150
2088 y Fr(In)30 b(CORBA)h(speci\002cation)g(2.2,)j(a)d(new)f(facility-)
j Fl(DynAny)c Fr(is)i(intr)n(oduced.)51 b(Pr)n(eviously)-10
b(,)32 b(it)f(is)150 2201 y(not)j(possible)h(to)f(insert)g(or)h
(extract)g(constr)o(ucted)e(and)i(other)f(complex)h(types)e(fr)n(om)j
(an)f Fl(any)150 2314 y Fr(without)22 b(using)g(the)g(stub)h(code)f
(generated)e(by)j(an)h(idl)f(compiler)g(for)g(these)e(types.)27
b(This)c(makes)150 2427 y(it)d(impossible)f(to)g(write)h(generic)f
(servers)f(\(bridges,)h(event)g(channels)g(supporting)f(\002ltering)h
(etc\))150 2539 y(because)i(these)f(servers)g(can)i(not)f(have)h
(static)f(knowledge)e(of)j(all)h(the)e(possible)f(data)i(types)d(that)
150 2652 y(they)i(have)i(to)f(handle.)291 2765 y(T)-8
b(o)21 b(\002ll)h(this)f(gap,)h(the)e Fl(DynAny)f Fr(facility)24
b(is)d(de\002ned)f(to)h(enable)h(traversal)f(of)h(the)f(data)g(value)
150 2878 y(associated)j(with)g(an)h Fl(any)f Fr(at)g(r)o(untime)g(and)h
(extraction)f(of)g(its)g(constituents.)31 b(This)24 b(facility)i(also)
150 2991 y(enables)e(the)f(constr)o(uction)g(of)g(an)i
Fl(any)e Fr(at)h(r)o(untime,)g(without)f(having)h(static)g(knowledge)e
(of)h(its)150 3104 y(types.)291 3217 y(This)k(chapter)f(explains)h(how)
g Fl(DynAny)d Fr(may)j(be)g(used.)40 b(For)26 b(completeness,)f(you)h
(should)150 3330 y(also)g(r)n(ead)g(the)g(DynAny)f(speci\002cation)h
(de\002ned)e(in)j(Chapter)f(7)g(of)h(the)e(CORBA)h(speci\002cation)150
3443 y(2.2.)50 b(Wher)n(e)29 b(possible,)h(the)f(implementation)h(in)g
(omniORB2)g(adher)n(es)f(closely)g(to)g(the)g(speci-)150
3556 y(\002cation.)44 b(However)-7 b(,)28 b(ther)n(e)f(ar)n(e)h(ar)n
(eas)g(in)h(the)e(speci\002cation)h(that)g(ar)n(e)g(ambiguous)g(or)f
(lacking)150 3669 y(in)e(details.)34 b(A)25 b(number)f(of)h(these)e
(issues)g(ar)n(e)j(curr)n(ently)e(opened)f(with)h(the)g(ORB)h(r)n
(evision)g(task)150 3781 y(for)n(ce.)32 b(Until)25 b(the)e(issues)f(ar)
n(e)j(r)n(esolved,)e(it)h(is)g(possible)f(that)h(a)h(dif)n(fer)n(ent)f
(implementation)g(may)150 3894 y(choose)g(to)h(intepr)n(et)f(the)h
(speci\002cation)g(dif)n(fer)n(ently)-10 b(.)36 b(This)25
b(chapter)g(pr)n(ovides)g(clari\002cations)i(to)150 4007
y(the)g(speci\002cation,)i(explains)f(the)g(interpr)n(etation)e(used)h
(and)h(of)n(fers)g(some)f(advice)i(and)f(warn-)150 4120
y(ings)22 b(on)g(potential)h(portability)f(pr)n(oblems.)291
4233 y(Notice)30 b(that)h(the)f Fl(DynAny)f Fr(interface)i(has)g(been)g
(changed)f(in)h(CORBA)g(2.3,)j(particularly)150 4346
y(with)h(the)g(addition)g(of)g(the)g(support)e(for)i(the)g(IDL)g(type)f
Fn(valuetype)p Fr(.)62 b(Futur)n(e)34 b(r)n(eleases)g(of)150
4459 y(omniORB)23 b(will)h(be)e(updated)f(to)h(implement)h(the)e
(interface)i(as)g(de\002ned)e(in)i(CORBA)f(2.3.)150 4754
y Fi(10.1)119 b(C++)31 b(mapping)250 5052 y Fc(//)49
b(namespace)f(CORBA)250 5251 y(class)h(ORB)g({)250 5351
y(public:)349 5450 y(...)1815 5778 y Fr(89)p eop
%%Page: 90 96
90 95 bop 30 100 a Fr(90)770 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)229
356 y Fc(class)49 b(InconsistentTypeCode)d(:)k(public)f(UserException)e
({)j(...)f(};)229 555 y(DynAny_ptr)f(create_dyn_any\(const)e(Any&)j
(value\);)229 754 y(DynAny_ptr)f(create_basic_dyn_any\(TypeCode_ptr)c
(tc\);)229 954 y(DynStruct_ptr)k(create_dyn_struct\(TypeCode_ptr)c
(tc\);)229 1153 y(DynSequence_ptr)j(create_dyn_sequence\(TypeCode_ptr)d
(tc\);)229 1352 y(DynArray_ptr)k(create_dyn_array\(TypeCode_ptr)c
(tc\);)229 1551 y(DynUnion_ptr)k(create_dyn_union\(TypeCode_ptr)c
(tc\);)229 1751 y(DynEnum_ptr)k(create_dyn_enum\(TypeCode_ptr)d(tc\);)
130 1950 y(};)130 2149 y(typedef)j(DynAny*)h(DynAny_ptr;)130
2249 y(class)f(DynAny_var)g({)i(...)f(};)130 2448 y(class)f(DynAny)h({)
130 2548 y(public:)229 2747 y(class)g(Invalid)g(:)g(public)g
(UserException)e({)j(...)f(};)229 2847 y(class)g(InvalidValue)f(:)h
(public)g(UserException)e({)j(...)f(};)229 2946 y(class)g(TypeMismatch)
f(:)h(public)g(UserException)e({)j(...)f(};)229 3046
y(class)g(InvalidSeq)f(:)i(public)e(UserException)g({)h(...)h(};)229
3245 y(typedef)f(_CORBA_Unbounded_Sequence__Octet)44
b(OctetSeq;)229 3444 y(TypeCode_ptr)k(type\(\))h(const;)229
3644 y(void)g(assign\(DynAny_ptr)e(dyn_any\))h
(throw\(Invalid,SystemException\);)229 3743 y(void)h(from_any\(const)f
(Any&)h(value\))f(throw\(Invalid,SystemException\);)229
3843 y(Any*)h(to_any\(\))g(throw\(Invalid,SystemException\);)229
3942 y(void)g(destroy\(\);)229 4042 y(DynAny_ptr)f(copy\(\);)229
4241 y(DynAny_ptr)g(current_component\(\);)229 4341 y(Boolean)h
(next\(\);)229 4441 y(Boolean)g(seek\(Long)f(index\);)229
4540 y(void)h(rewind\(\);)229 4740 y(void)g(insert_boolean\(Boolean)d
(value\))j(throw\(InvalidValue,SystemException)o(\);)229
4839 y(void)g(insert_octet\(Octet)e(value\))h
(throw\(InvalidValue,SystemException\);)229 4939 y(void)h
(insert_char\(Char)e(value\))i(throw\(InvalidValue,SystemException)o
(\);)229 5038 y(void)g(insert_short\(Short)e(value\))h
(throw\(InvalidValue,SystemException\);)229 5138 y(void)h
(insert_ushort\(UShort)d(value\))j
(throw\(InvalidValue,SystemException\);)229 5238 y(void)g
(insert_long\(Long)e(value\))i(throw\(InvalidValue,SystemException)o
(\);)229 5337 y(void)g(insert_ulong\(ULong)e(value\))h
(throw\(InvalidValue,SystemException\);)229 5437 y(void)h
(insert_float\(Float)e(value\))h
(throw\(InvalidValue,SystemException\);)229 5537 y(void)h
(insert_double\(Double)d(value\))j
(throw\(InvalidValue,SystemException\);)p eop
%%Page: 91 97
91 96 bop 150 100 a Fd(10.1.)52 b(C++)23 b(MAPPING)2456
b Fr(91)349 356 y Fc(void)49 b(insert_string\(const)e(char*)h(value\))h
(throw\(InvalidValue,SystemException\);)349 456 y(void)g
(insert_reference\(Object_ptr)c(v\))50 b
(throw\(InvalidValue,SystemExceptio)o(n\);)349 555 y(void)f
(insert_typecode\(TypeCode_ptr)c(v\))k
(throw\(InvalidValue,SystemException\);)349 655 y(void)g
(insert_any\(const)e(Any&)i(value\))g
(throw\(InvalidValue,SystemException\))o(;)349 854 y(Boolean)g
(get_boolean\(\))e(throw\(TypeMismatch,SystemException\);)349
954 y(Octet)i(get_octet\(\))f(throw\(TypeMismatch,SystemException\))o
(;)349 1053 y(Char)h(get_char\(\))f
(throw\(TypeMismatch,SystemException\);)349 1153 y(Short)h
(get_short\(\))f(throw\(TypeMismatch,SystemException\))o(;)349
1253 y(UShort)h(get_ushort\(\))f(throw\(TypeMismatch,SystemExceptio)o
(n\);)349 1352 y(Long)h(get_long\(\))f
(throw\(TypeMismatch,SystemException\);)349 1452 y(ULong)h
(get_ulong\(\))f(throw\(TypeMismatch,SystemException\))o(;)349
1551 y(Float)h(get_float\(\))f(throw\(TypeMismatch,SystemException\))o
(;)349 1651 y(Double)h(get_double\(\))f
(throw\(TypeMismatch,SystemExceptio)o(n\);)349 1751 y(char*)h
(get_string\(\))f(throw\(TypeMismatch,SystemException)o(\);)349
1850 y(Object_ptr)g(get_reference\(\))f
(throw\(TypeMismatch,SystemException\);)349 1950 y(TypeCode_ptr)h
(get_typecode\(\))f(throw\(TypeMismatch,SystemException\))o(;)349
2050 y(Any*)i(get_any\(\))f(throw\(TypeMismatch,SystemException\);)349
2249 y(static)h(DynAny_ptr)f(_duplicate\(DynAny_ptr\);)349
2348 y(static)h(DynAny_ptr)f(_narrow\(DynAny_ptr\);)349
2448 y(static)h(DynAny_ptr)f(_nil\(\);)250 2548 y(};)250
2747 y(//)h(DynFixed)f(is)i(not)f(supported.)250 2946
y(typedef)f(DynEnum*)g(DynEnum_ptr;)250 3046 y(class)h(DynEnum_var)e({)
j(...)f(};)250 3245 y(class)g(DynEnum)f(:)99 b(public)49
b(DynAny)g({)250 3345 y(public:)349 3544 y(char*)g
(value_as_string\(\);)349 3644 y(void)g(value_as_string\(const)d(char*)
j(value\);)349 3743 y(ULong)g(value_as_ulong\(\);)349
3843 y(void)g(value_as_ulong\(ULong)d(value\);)349 4042
y(static)j(DynEnum_ptr)f(_duplicate\(DynEnum_ptr\);)349
4142 y(static)h(DynEnum_ptr)f(_narrow\(DynAny_ptr\);)349
4241 y(static)h(DynEnum_ptr)f(_nil\(\);)250 4341 y(};)250
4540 y(typedef)g(char*)h(FieldName;)250 4640 y(typedef)f(String_var)g
(FieldName_var;)250 4839 y(struct)g(NameValuePair)g({)349
4939 y(String_member)g(id;)349 5038 y(Any)i(value;)250
5138 y(};)250 5337 y(typedef)e(_CORBA_ConstrType_Variable_Var<NameV)o
(alueP)o(air>)c(NameValuePair_var;)250 5437 y(typedef)k
(_CORBA_Unbounded_Sequence<NameValueP)o(air)c(>)49 b(NameValuePairSeq;)
p eop
%%Page: 92 98
92 97 bop 30 100 a Fr(92)770 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)130
356 y Fc(typedef)48 b(DynStruct*)g(DynStruct_ptr;)130
456 y(class)g(DynStruct_var)g({)i(...)f(};)130 655 y(class)f(DynStruct)
h(:)99 b(public)49 b(DynAny)f({)130 754 y(public:)229
954 y(char*)99 b(current_member_name\(\);)229 1053 y(TCKind)49
b(current_member_kind\(\);)229 1153 y(NameValuePairSeq*)e
(get_members\(\);)229 1253 y(void)i(set_members\(const)e
(NameValuePairSeq&)g(NVSeqVal\))1076 1352 y
(throw\(InvalidSeq,SystemException\);)229 1551 y(static)i
(DynStruct_ptr)e(_duplicate\(DynStruct_ptr\);)229 1651
y(static)i(DynStruct_ptr)e(_narrow\(DynAny_ptr\);)229
1751 y(static)i(DynStruct_ptr)e(_nil\(\);)130 1850 y(};)130
2050 y(typedef)h(DynUnion*)g(DynUnion_ptr;)130 2149 y(class)g
(DynUnion_var)g({)i(...)f(};)130 2348 y(class)f(DynUnion)h(:)99
b(public)49 b(DynAny)g({)130 2448 y(public:)229 2647
y(Boolean)g(set_as_default\(\);)229 2747 y(void)g
(set_as_default\(Boolean)d(value\);)229 2847 y(DynAny_ptr)i
(discriminator\(\);)229 2946 y(TCKind)h(discriminator_kind\(\);)229
3046 y(DynAny_ptr)f(member\(\);)229 3145 y(char*)99 b(member_name\(\);)
229 3245 y(void)49 b(member_name\(const)e(char*)i(value\);)229
3345 y(TCKind)g(member_kind\(\);)229 3544 y(static)g(DynUnion_ptr)f
(_duplicate\(DynUnion_ptr\);)229 3644 y(static)h(DynUnion_ptr)f
(_narrow\(DynAny_ptr\);)229 3743 y(static)h(DynUnion_ptr)f(_nil\(\);)
130 3843 y(};)130 4042 y(typedef)g(_CORBA_Unbounded_Sequence<Any)d(>)k
(AnySeq;)130 4241 y(typedef)f(DynSequence*)g(DynSequence_ptr;)130
4341 y(class)g(DynSequence_var)g({)h(...)g(};)130 4540
y(class)f(DynSequence)g(:)100 b(public)48 b(DynAny)h({)130
4640 y(public:)229 4839 y(ULong)g(length\(\);)229 4939
y(void)g(length)g(\(ULong)g(value\);)229 5038 y(AnySeq*)g
(get_elements\(\);)229 5138 y(void)g(set_elements\(const)e(AnySeq&)h
(value\))h(throw\(InvalidValue,SystemException\))o(;)229
5337 y(static)g(DynSequence_ptr)e(_duplicate\(DynSequence_ptr\);)229
5437 y(static)i(DynSequence_ptr)e(_narrow\(DynAny_ptr\);)229
5537 y(static)i(DynSequence_ptr)e(_nil\(\);)p eop
%%Page: 93 99
93 98 bop 150 100 a Fd(10.2.)52 b(THE)21 b(DYNANY)h(INTERF)-7
b(ACE)1935 b Fr(93)250 356 y Fc(};)250 555 y(typedef)48
b(DynArray*)g(DynArray_ptr;)250 655 y(class)h(DynArray_var)e({)j(...)f
(};)250 854 y(class)g(DynArray)f(:)h(public)g(DynAny)g({)250
954 y(public:)349 1153 y(AnySeq*)g(get_elements\(\);)349
1253 y(void)g(set_elements\(const)e(AnySeq&)h(value\))h
(throw\(InvalidValue,SystemException\))o(;)349 1452 y(static)g
(DynArray_ptr)f(_duplicate\(DynArray_ptr\);)349 1551
y(static)h(DynArray_ptr)f(_narrow\(DynAny_ptr\);)349
1651 y(static)h(DynArray_ptr)f(_nil\(\);)250 1751 y(};)150
2145 y Fi(10.2)119 b(The)29 b(DynAny)i(Interface)150
2359 y Fh(10.2.1)99 b(Example:)29 b(extract)c(data)g(values)g(from)f
(an)h(Any)150 2536 y Fr(If)17 b(an)h Fl(any)f Fr(contains)g(a)h(value)g
(of)g(one)e(of)i(the)e(basic)j(data)e(types,)f(its)h(value)h(can)h(be)e
(extracted)f(using)150 2649 y(the)31 b(pr)n(e-de\002ned)e(operators)h
(in)i(the)f(Any)g(interface.)55 b(When)31 b(the)g(value)h(is)g(a)g(str)
o(uct)f(or)g(other)150 2762 y(non-basic)24 b(types,)c(one)i(can)h(use)f
(the)g(DynAny)f(interface)i(to)f(extract)g(its)h(constituent)e(values.)
291 2875 y(In)k(this)g(section,)h(we)f(use)f(a)i(str)o(uct)f(as)h(an)g
(example)f(to)g(illustrate)h(how)f(the)f(DynAny)h(inter)n(-)150
2988 y(face)e(can)h(be)e(used.)291 3101 y(The)g(example)h(str)o(uct)e
(is)i(as)g(follows:)349 3276 y Fc(//)50 b(IDL)349 3476
y(struct)f(exampleStruct1)e({)449 3575 y(string)i(s;)449
3675 y(double)g(d;)449 3774 y(long)149 b(l;)349 3874
y(};)291 4163 y Fr(T)-8 b(o)22 b Fl(create)j Fr(a)e(DynAny)f(fr)n(om)h
(an)g(Any)f(value,)h(one)f(uses)f(the)h Fn(create)p 2768
4163 28 4 v 30 w(dyn)p 2963 4163 V 31 w(any)g Fr(method:)349
4338 y Fc(//)50 b(C++)349 4537 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
4737 y(Any)h(v;)349 4836 y(...)348 b(//)50 b(Initialise)e(v)h(to)h
(contain)e(a)i(value)f(of)g(type)g(exampleStruct1.)349
5035 y(CORBA::DynAny_var)e(dv)i(=)h(orb->create_dyn_any\(v\);)291
5324 y Fr(Like)23 b(CORBA)g(object)g(and)g(pseudo)e(object)i(r)n(efer)n
(ences,)f(a)i Fn(DynAny)p 2705 5324 V 30 w(ptr)e Fr(can)i(be)f(managed)
150 5437 y(by)f(a)p 346 5437 V 55 w(var)h(type)d(\()p
Fn(DynAny)p 1093 5437 V 30 w(var)p Fr(\))h(which)h(will)h(r)n(elease)f
(the)f Fn(DynAny)p 2562 5437 V 30 w(ptr)f Fr(automatically)k(when)150
5550 y(the)e(variable)i(goes)d(out)h(of)h(scope.)p eop
%%Page: 94 100
94 99 bop 30 100 a Fr(94)770 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)30
356 y Fl(10.2.1.1)92 b(Iterate)26 b(through)21 b(the)i(components)30
533 y Fr(Once)f(the)e(DynAny)g(object)h(is)g(cr)n(eated,)g(we)g(can)h
(use)e(the)g(DynAny)g(interface)i(to)e(extract)h(the)f(in-)30
646 y(dividual)28 b(components)d(in)i Fn(exampleStruct1)o
Fr(.)34 b(The)26 b(DynAny)g(interface)h(pr)n(ovides)f(a)h(num-)30
759 y(ber)f(of)g(functions)g(to)f(extract)h(and)g(insert)g(component)e
(values.)39 b(These)25 b(functions)g(ar)n(e)i(de\002ned)30
872 y(to)22 b(operate)f(on)h(the)g(component)f(identi\002ed)h(by)g(the)
g Fl(current)i(component)d Fr(pointer)-7 b(.)171 985
y(A)34 b Fl(current)h(component)e Fr(pointer)g(is)h(an)h(internal)f
(state)f(of)h(a)h(DynAny)e(object.)62 b(When)34 b(a)30
1098 y(DynAny)26 b(object)i(is)f(cr)n(eated,)h(the)e(pointer)g(is)i
(initialised)g(to)f(point)f(to)h(the)g(\002rst)f(component)g(of)30
1210 y(the)c(any)g(value.)171 1323 y(The)27 b(pointer)f(can)i(be)g
(advanced)g(to)e(the)h(next)g(component)f(with)h(the)g
Fn(next\(\))d Fr(operation.)30 1436 y(The)d(function)h(r)n(eturns)e(F)
-7 b(ALSE)20 b(\(0\))j(if)g(ther)n(e)d(ar)n(e)i(no)g(mor)n(e)f
(components.)26 b(Otherwise)20 b(it)i(r)n(eturns)30 1549
y(TRUE)27 b(\(1\).)46 b(When)28 b(the)f(any)h(value)h(in)g(the)f
(DynAny)f(object)h(contains)g(only)g(one)g(component,)30
1662 y(the)22 b Fn(next\(\))e Fr(operation)h(always)i(r)n(eturns)f(F)-7
b(ALSE\(0\).)171 1775 y(Another)28 b(way)h(of)g(adjusting)g(the)f
(pointer)h(is)g(the)f Fn(seek\(\))f Fr(operation.)47
b(The)28 b(function)i(r)n(e-)30 1888 y(turns)25 b(F)-7
b(ALSE)24 b(\(0\))j(if)g(ther)n(e)e(is)h(no)g(component)e(at)i(the)f
(speci\002ed)g(index.)37 b(Otherwise)25 b(it)h(r)n(eturns)30
2001 y(TRUE)35 b(\(1\).)68 b(The)35 b(index)g(value)h(of)g(the)f
(\002rst)g(component)f(is)i(zer)n(o.)67 b(Ther)n(efor)n(e,)38
b(a)e Fn(seek\(0\))30 2114 y Fr(call)28 b(r)n(ewinds)e(the)g(pointer)f
(to)h(the)g(\002rst)g(component,)g(this)g(is)h(also)g(equivalent)f(to)g
(a)i(call)g(to)e(the)30 2227 y Fn(rewind\(\))19 b Fr(operation.)171
2340 y(For)25 b(completeness,)g(we)g(should)g(also)i(mention)e(her)n(e)
h(the)f Fn(current)p 2665 2340 28 4 v 29 w(component\(\))c
Fr(op-)30 2453 y(eration.)64 b(This)35 b(operation)f(causes)g(the)g
(DynAny)h(object)f(to)h(r)n(eturn)f(a)h(r)n(efer)n(ence)g(to)f(another)
30 2566 y(DynAny)40 b(object)i(that)f(can)h(be)f(used)f(to)h(access)g
(the)f(curr)n(ent)h(component.)83 b(It)40 b(is)i(possible)30
2679 y(that)e(the)f(curr)n(ent)h(component)e(pointer)h(is)h(not)g
(pointing)f(to)h(a)g(valid)i(component,)g(for)e(in-)30
2791 y(stance,)f(the)c Fn(next\(\))f Fr(operation)h(has)h(been)g
(invoked)f(and)h(ther)n(e)g(is)g(no)g(mor)n(e)g(component.)30
2904 y(Under)g(this)i(cir)n(cumstance,)k(the)37 b Fn(current)p
1657 2904 V 29 w(component\(\))c Fr(operation)k(r)n(eturns)f(a)i(nil)h
(Dy-)30 3017 y(nAny)22 b(object)h(r)n(efer)n(ence)905
2984 y Fj(1)942 3017 y Fr(.)29 b(For)22 b(components)f(which)j(ar)n(e)f
(just)g(basic)h(data)f(types,)e(calling)k Fn(cur-)30
3130 y(rent)p 255 3130 V 31 w(component\(\))e Fr(is)k(an)i(overkill)f
(because)f(we)g(can)i(just)e(use)g(the)f(basic)j(type)e(extraction)30
3243 y(and)c(insertion)e(functions)i(dir)n(ectly)-10
b(.)30 3495 y Fl(10.2.1.2)92 b(Extract)25 b(basic)f(type)e(components)
30 3672 y Fr(In)g(our)g(example,)h(the)e(component)h(values)h(can)g(be)
g(extracted)e(as)i(follows:)229 3872 y Fc(CORBA::String_var)47
b(s)j(=)f(dv->get_string\(\);)229 3971 y(CORBA::Double)247
b(d)50 b(=)f(dv->get_double\(\);)229 4071 y(CORBA::Long)347
b(l)50 b(=)f(dv->get_long\(\);)171 4284 y Fr(Each)25
b(get)f(basic)h(type)f(operation)f(has)i(the)f(side-ef)n(fect)g(of)g
(advancing)i(the)e(curr)n(ent)g(compo-)30 4397 y(nent)e(pointer)-7
b(.)27 b(For)21 b(instance:)229 4596 y Fc(CORBA::String_var)47
b(s)j(=)f(dv->get_string\(\);)171 4809 y Fr(is)23 b(equivalent)g(to:)
229 5009 y Fc(CORBA::DynAny_var)47 b(temp)i(=)h
(dv->current_component\(\);)229 5109 y(CORBA::String_var)d(s)j(=)f
(temp->get_string\(\);)229 5208 y(dv->next\(\);)p 30
5279 1368 4 v 135 5335 a Fg(1)164 5367 y Ff(T)-7 b(esting)26
b(a)h(nil)f(DynAny)g(object)h(with)g(CORBA::is)p 1676
5367 23 4 v 25 w(nil\(\))f(r)o(eturns)f(TRUE\(1\).)44
b(The)27 b(CORBA)e(2.2)i(speci\002cation)30 5458 y(does)17
b(not)h(specify)e(what)j(is)e(the)h(r)o(eturn)f(value)h(of)f(this)h
(function)h(when)f(the)h(curr)o(ent)e(component)h(pointer)f(is)g
(invalid.)30 5550 y(T)-7 b(o)18 b(ensur)o(e)g(portability)-8
b(,)17 b(it)i(is)f(best)h(to)g(avoid)f(calling)h Fb(current)p
1883 5550 V 26 w(component\(\))e Ff(under)h(this)h(condition.)p
eop
%%Page: 95 101
95 100 bop 150 100 a Fd(10.2.)52 b(THE)21 b(DYNANY)h(INTERF)-7
b(ACE)1935 b Fr(95)291 356 y(The)30 b(get)g(operations)f(ensur)n(e)g
(that)i(the)e(curr)n(ent)i(component)e(is)i(of)g(the)e(same)i(type)e
(as)i(r)n(e-)150 469 y(quested.)74 b(Otherwise,)41 b(the)d(object)h
(thr)n(ows)f(a)h(T)-8 b(ypeMismatch)38 b(exception.)75
b(If)39 b(the)f(curr)n(ent)150 582 y(component)30 b(pointer)h(is)g
(invalid)j(when)d(a)h(get)e(operation)h(is)h(called,)i(the)d(object)g
(also)h(thr)n(ows)150 695 y(a)23 b(T)-8 b(ypeMismatch)22
b(exception)1226 662 y Fj(2)1262 695 y Fr(.)291 808 y(T)-8
b(o)27 b(r)n(epeatedly)f(access)i(the)f(components,)g(one)f(can)j(use)e
(the)g Fn(rewind\(\))d Fr(or)j Fn(seek\(\))e Fr(op-)150
921 y(eration)32 b(to)h(manipulate)g(the)f(curr)n(ent)g(component)g
(pointer)-7 b(.)57 b(For)32 b(instance,)j(to)d(access)h(the)e
Fn(d)150 1034 y Fr(member)23 b(in)g Fn(exampleStruct1)16
b Fr(dir)n(ectly:)349 1238 y Fc(dv->seek\(1\);)496 b(//)50
b(position)e(current)g(component)h(to)g(member)g(d.)349
1338 y(CORBA::Double)247 b(d)50 b(=)f(dv->get_double\(\);)150
1594 y Fl(10.2.1.3)92 b(Extract)25 b(complex)e(components)150
1772 y Fr(When)28 b(a)h(component)e(is)i(not)f(one)f(of)i(the)e(basic)j
(data)f(types,)f(it)g(is)h(not)f(possible)f(to)h(extract)g(its)150
1885 y(value)20 b(using)f(the)g(get)f(operations.)26
b(Instead,)18 b(a)i(DynAny)f(object)g(has)h(to)f(be)g(cr)n(eated)g(fr)n
(om)i(which)150 1998 y(the)h(component)f(is)i(accessed.)291
2112 y(Consider)f(this)g(example:)349 2316 y Fc(//)50
b(IDL)349 2515 y(struct)f(exampleStruct2)e({)449 2615
y(string)i(m1;)449 2714 y(exampleStruct1)e(m2;)349 2814
y(};)291 3030 y Fr(In)29 b(or)n(der)f(to)h(extract)g(the)f(data)h
(members)g(within)g Fn(m2)g Fr(\(of)g(type)f Fn(exampleStruct1)p
Fr(\),)d(we)150 3143 y(use)d Fn(current)p 700 3143 28
4 v 29 w(component\(\))c Fr(as)23 b(follows:)349 3347
y Fc(//)50 b(C++)349 3546 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
3646 y(Any)h(v;)349 3745 y(...)348 b(//)50 b(Initialise)e(v)h(to)h
(contain)e(a)i(value)f(of)g(type)g(exampleStruct2.)349
3945 y(CORBA::DynAny_var)e(dv)i(=)h(orb->create_dyn_any\(v\);)349
4144 y(CORBA::String_var)d(m1)i(=)h(dv->get_string\(\);)96
b(//)50 b(extract)e(member)h(m1)349 4244 y(CORBA::DynAny_var)e(dm)i(=)h
(dv->current_component\(\);)45 b(//)50 b(DynAny)e(refer-)150
4343 y(ence)h(to)h(m2)349 4443 y(CORBA::String_var)d(s)j(=)f
(dm->get_string\(\);)146 b(//)50 b(m2.s)349 4542 y(CORBA::Double)247
b(d)50 b(=)f(dm->get_double\(\);)146 b(//)50 b(m2.d)349
4642 y(CORBA::Long)347 b(l)50 b(=)f(dm->get_long\(\);)246
b(//)50 b(m2.l)150 4898 y Fl(10.2.1.4)92 b(Clean-up)150
5077 y Fr(Now)34 b(we)g(\002nish)g(of)n(f)h(this)f(example)h(with)f(a)h
(description)e(on)h(destr)n(oying)e(DynAny)i(objects.)150
5190 y(Ther)n(e)22 b(ar)n(e)h(two)f(points)f(to)h(r)n(emember:)p
150 5280 1368 4 v 255 5335 a Fg(2)284 5367 y Ff(The)g(CORBA)g(2.2)g
(speci\002cation)g(does)f(not)h(de\002ne)g(the)g(behavior)g(of)g(this)g
(err)o(or)d(condition.)33 b(T)-7 b(o)21 b(ensur)o(e)g(porta-)150
5458 y(bility)-8 b(,)22 b(it)h(is)f(best)g(to)h(avoid)f(calling)h(the)g
(get)f(operations)g(when)i(the)f(curr)o(ent)f(component)h(pointer)f(is)
g(known)h(to)g(be)150 5550 y(invalid.)p eop
%%Page: 96 102
96 101 bop 30 100 a Fr(96)770 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)144
356 y Fr(1.)45 b(A)26 b(DynAny)f(r)n(efer)n(ence)h(\()p
Fn(DynAny)p 1486 356 28 4 v 30 w(ptr)p Fr(\))f(is)h(like)h(any)f(CORBA)
g(object)g(or)f(psuedo)f(object)257 469 y(r)n(efer)n(ence)h(and)h
(should)f(be)h(handled)f(in)h(the)f(same)h(way)-10 b(.)37
b(In)26 b(particular)-7 b(,)27 b(one)e(has)h(to)f(call)257
582 y(the)33 b Fn(CORBA::release)28 b Fr(operation)33
b(to)g(indicate)i(that)e(a)i(DynAny)e(r)n(efer)n(ence)g(will)i(no)257
695 y(longer)22 b(be)h(accessed.)j(In)d(the)e(example,)i(this)f(is)h
(done)e(automatically)j(by)f Fn(DynAny)p 3208 695 V 30
w(var)p Fr(.)144 885 y(2.)45 b(A)e(DynAny)e(object)h(and)h(its)f(r)n
(efer)n(ences)g(ar)n(e)g(separate)g(entities,)k(just)41
b(as)i(a)g(CORBA)257 998 y(object)e(implementation)f(and)g(its)h
(object)f(r)n(efer)n(ences)f(ar)n(e)i(dif)n(fer)n(ent)g(entities.)80
b(While)257 1111 y Fn(CORBA::release)13 b Fr(will)21
b(r)n(elease)d(any)i(r)n(esour)n(ce)e(associated)h(with)g(a)h
Fn(DynAny)p 3073 1111 V 30 w(ptr)p Fr(,)e(one)257 1223
y(has)25 b(to)f(separately)f(destr)n(oy)f(the)i(DynAny)f(object)h(to)g
(avoid)h(any)g(memory)e(leak.)34 b(This)24 b(is)257 1336
y(done)e(by)g(calling)j(the)c Fn(destroy\(\))e Fr(operation.)171
1552 y(In)j(the)g(example,)g(the)g(DynAny)g(object)g(can)i(be)e(destr)n
(oyed)e(as)j(follows:)229 1755 y Fc(//)50 b(C++)229 1854
y(...)229 1954 y(CORBA::DynAny_var)d(dv)i(=)h
(orb->create_dyn_any\(v\);)229 2054 y(...)229 2153 y(dv->destroy\(\);)
229 2353 y(//)g(From)f(now)g(on,)g(one)h(should)e(not)h(invoke)g(any)g
(operation)g(in)g(dv.)g(Oth-)30 2452 y(erwise)g(the)229
2552 y(//)h(behavior)e(is)h(undefined.)30 2910 y Fh(10.2.2)99
b(Example:)29 b(insert)c(data)g(values)g(into)h(an)e(Any)30
3088 y Fr(Using)31 b(the)f(DynAny)h(interface,)j(one)c(can)j(cr)n(eate)
e(an)h(Any)f(value)h(fr)n(om)g(scratch.)55 b(In)31 b(this)g(ex-)30
3201 y(ample,)c(we)f(ar)n(e)g(going)f(to)h(cr)n(eate)g(an)g(Any)g
(containing)g(the)f(value)i(of)f(the)f Fn(exampleStruct1)30
3314 y Fr(type.)171 3427 y(Firstly)-10 b(,)40 b(we)d(have)h(to)f(cr)n
(eate)h(a)g(DynAny)f(to)g(stor)n(e)f(the)h(value)i(using)e(one)f(of)i
(the)f Fn(cre-)30 3540 y(ate)p 200 3540 V 31 w(dyn)e
Fr(functions.)69 b(Because)35 b Fn(exampleStruct1)30
b Fr(is)36 b(a)h(str)o(uct)f(type,)h(we)f(use)f(the)h
Fn(cre-)30 3653 y(ate)p 200 3653 V 31 w(dyn)p 396 3653
V 32 w(struct\(\))19 b Fr(operation.)229 3856 y Fc(//)50
b(C++)229 4055 y(CORBA::ORB_ptr)d(orb;)99 b(//)50 b(orb)f(initialised)f
(by)h(CORBA::ORB_init.)229 4255 y(//)h(create)e(the)i(TypeCode)e(for)h
(exampleStruct.)229 4354 y(StructMemberSeq)e(tc_members;)229
4454 y(tc_members.length\(3\);)229 4554 y(tc_members[0].name)g(=)i
(\(const)g(char*\)"s";)229 4653 y(tc_members[0].type)e(=)i
(CORBA::TypeCode::_duplicate\(CORBA::_t)o(c_str)o(ing\);)229
4753 y(tc_members[0].type_def)d(=)k(CORBA::IDLType::_nil\(\);)229
4852 y(tc_members[1].name)d(=)i(\(const)g(char*\)"d";)229
4952 y(tc_members[1].type)e(=)i(CORBA::TypeCode::_duplicate\(CORBA::_t)
o(c_dou)o(ble\);)229 5052 y(tc_members[1].type_def)d(=)k
(CORBA::IDLType::_nil\(\);)229 5151 y(tc_members[2].name)d(=)i(\(const)
g(char*\)"l";)229 5251 y(tc_members[2].type)e(=)i
(CORBA::TypeCode::_duplicate\(CORBA::_t)o(c_lon)o(g\);)229
5351 y(tc_members[2].type_def)d(=)k(CORBA::IDLType::_nil\(\);)229
5450 y(CORBA::TypeCode_var)d(tc)i(=)h
(orb->create_struct_tc\("IDL:exampl)o(eStru)o(ct1:1.)o(0",)2570
5550 y("exampleStruct1",)p eop
%%Page: 97 103
97 102 bop 150 100 a Fd(10.2.)52 b(THE)21 b(DYNANY)h(INTERF)-7
b(ACE)1935 b Fr(97)2690 356 y Fc(tc_members\);)349 555
y(//)50 b(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g(any)g
(value)349 655 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_struct\(tc\);)150 906 y Fl(10.2.2.1)92
b(Insert)24 b(basic)g(type)f(components)150 1083 y Fr(Once)34
b(the)f(DynAny)f(object)i(is)f(cr)n(eated,)j(we)d(can)h(use)e(the)h
(DynAny)g(interface)g(to)g(insert)g(the)150 1196 y(components.)j(The)26
b(DynAny)f(interface)h(pr)n(ovides)f(a)i(number)f(of)g(insert)f
(operations)g(to)g(insert)150 1308 y(basic)g(types)c(into)i(the)g(any)h
(value.)31 b(In)23 b(our)g(example,)g(the)g(component)f(values)i(can)g
(be)g(inserted)150 1421 y(as)f(follows:)349 1618 y Fc
(CORBA::String_var)47 b(s)j(=)f(\(const)g(char*\)"Hello";)349
1717 y(CORBA::Double)247 b(d)50 b(=)f(3.1416;)349 1817
y(CORBA::Long)347 b(l)50 b(=)f(1;)349 2016 y(dv->insert_string\(s\);)
349 2116 y(dv->insert_double\(d\);)349 2215 y(dv->insert_long\(l\);)291
2425 y Fr(Each)25 b(insert)f(basic)i(type)d(operation)h(has)h(the)e
(side-ef)n(fect)i(of)f(advancing)i(the)e(curr)n(ent)g(com-)150
2538 y(ponent)d(pointer)-7 b(.)27 b(For)22 b(instance:)349
2734 y Fc(dv->insert_string\(s\);)291 2944 y Fr(is)h(equivalent)g(to:)
349 3140 y Fc(CORBA::DynAny_var)47 b(temp)i(=)h
(dv->current_component\(\);)349 3239 y(temp->insert_string\(s\);)349
3339 y(dv->next\(\);)291 3549 y Fr(The)21 b(insert)h(operations)e
(ensur)n(e)h(that)h(the)f(curr)n(ent)g(component)g(is)h(of)g(the)f
(same)h(type)f(as)h(the)150 3662 y(inserted)i(value.)40
b(Otherwise,)26 b(the)f(object)h(thr)n(ows)g(a)g(InvalidV)-8
b(alue)27 b(exception.)38 b(If)26 b(the)g(curr)n(ent)150
3774 y(component)18 b(pointer)h(is)h(invalid)h(when)e(an)h(insert)f
(operation)g(is)h(called,)h(the)e(object)g(also)h(thr)n(ows)150
3887 y(a)j(InvalidV)-8 b(alue)23 b(exception)1146 3854
y Fj(3)1182 3887 y Fr(.)291 4000 y(Sometimes,)33 b(one)e(may)h(just)f
(want)h(to)f(modify)h(one)f(component)g(in)h(an)g(Any)g(value.)56
b(For)150 4113 y(instance,)39 b(one)d(may)g(just)g(want)g(to)g(change)g
(the)f(value)i(of)f(the)g(double)f(member)i(in)f Fn(exam-)150
4226 y(pleStruct1)p Fr(.)23 b(This)g(can)g(be)g(done)e(as)i(follows:)
349 4422 y Fc(//)50 b(C++)349 4622 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
4821 y(Any)h(v;)349 4920 y(...)348 b(//)50 b(Initialise)e(v)h(to)h
(contain)e(a)i(value)f(of)g(type)g(exampleStruct1.)349
5120 y(CORBA::Double)f(d)h(=)h(6.28;)p 150 5280 1368
4 v 255 5335 a Fg(3)284 5367 y Ff(The)22 b(CORBA)g(2.2)g
(speci\002cation)g(does)f(not)h(de\002ne)g(the)g(behavior)g(of)g(this)g
(err)o(or)d(condition.)33 b(T)-7 b(o)21 b(ensur)o(e)g(porta-)150
5458 y(bility)-8 b(,)17 b(it)h(is)f(best)h(to)g(avoid)g(calling)f(the)i
(insert)e(operations)g(when)i(the)g(curr)o(ent)e(component)i(pointer)e
(is)g(known)i(to)f(be)150 5550 y(invalid.)p eop
%%Page: 98 104
98 103 bop 30 100 a Fr(98)770 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)229
356 y Fc(CORBA::DynAny_var)47 b(dv)i(=)h(orb->create_dyn_any\(v\);)229
555 y(dv->seek\(1\);)229 655 y(dv->insert_double\(d\);)196
b(//)49 b(Change)g(the)g(value)g(of)g(the)h(member)e(d.)171
819 y Fr(Finally)-10 b(,)20 b(the)d(any)h(value)h(can)g(be)f(obtained)g
(fr)n(om)g(the)g(DynAny)f(object)h(using)f(the)g Fn(to)p
3150 819 28 4 v 32 w(any\(\))30 932 y Fr(operation:)229
1083 y Fc(CORBA::Any_var)47 b(v)j(=)g(dv->to_any\(\);)197
b(//)49 b(Obtain)g(the)g(any)g(value.)30 1327 y Fl(10.2.2.2)92
b(Insert)24 b(complex)g(components)30 1503 y Fr(When)30
b(a)i(component)e(is)h(not)f(one)h(of)g(the)f(basic)i(data)g(types,)f
(it)g(is)g(not)f(possible)h(to)f(insert)g(its)30 1616
y(value)23 b(using)f(the)g(insert)f(operations.)26 b(Instead,)21
b(a)i(DynAny)e(object)i(has)f(to)g(be)g(cr)n(eated)g(thr)n(ough)30
1729 y(which)h(the)f(component)f(can)j(be)e(inserted.)171
1842 y(In)29 b(our)f(example,)j(one)d(can)i(insert)e(component)g
(values)h(into)g Fn(exampleStruct2)23 b Fr(as)29 b(fol-)30
1955 y(lows:)229 2106 y Fc(//)50 b(C++)229 2306 y(CORBA::ORB_ptr)d
(orb;)99 b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)229
2505 y(CORBA::TypeCode_var)e(tc;)229 2604 y(//)j(create)e(the)i
(TypeCode)e(for)h(exampleStruct2.)229 2704 y(...)229
2804 y(//)h(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g
(any)g(value)229 2903 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_struct\(tc\);)229 3103 y(CORBA::String_var)d(m1)99
b(=)50 b(\(const)e(char*\)"Greetings";)229 3202 y(CORBA::String_var)f
(m2s)i(=)h(\(const)e(char*\)"Hello";)229 3302 y(CORBA::Double)247
b(m2d)49 b(=)h(3.1416;)229 3401 y(CORBA::Long)347 b(m2l)49
b(=)h(1;)229 3601 y(dv->insert_string\(m1\);)146 b(//)49
b(insert)g(member)f(m1)229 3700 y(CORBA::DynAny_var)f(dm)i(=)h
(dv->current_component\(\);)45 b(//)50 b(DynAny)e(refer-)30
3800 y(ence)h(to)g(m2)229 3900 y(dm->insert_string\(m2s\);)96
b(//)49 b(insert)g(member)f(m2.s)229 3999 y(dm->insert_double\(m2d\);)
96 b(//)49 b(insert)g(member)f(m2.d)229 4099 y(dm->insert_long\(m2l\);)
196 b(//)49 b(insert)g(member)f(m2.l)229 4298 y(CORBA::Any_var)f(v)j(=)
g(dv->to_any\(\);)97 b(//)49 b(obtain)g(the)g(any)h(value)229
4497 y(dv->destroy\(\);)496 b(//)49 b(destroy)g(the)g(DynAny)g(object.)
1425 4597 y(//)g(No)h(operation)e(should)g(be)i(invoked)e(on)i(dv)1425
4697 y(//)f(from)g(this)g(point)g(on)h(ex-)30 4796 y(cept)f
(CORBA::release.)171 4961 y Fr(In)28 b(addition)f(to)g(the)g(DynAny)g
(interface,)i(a)f(number)g(of)g(derived)f(interfaces)g(ar)n(e)h
(de\002ned.)30 5074 y(These)f(interfaces)i(ar)n(e)g(specialisation)g
(of)g(the)f(DynAny)f(interface)i(to)f(facilitate)j(the)d(handling)30
5186 y(of)g(any)h(values)f(containing)h(non-basic)g(types:)37
b(str)o(uct,)29 b(sequence,)e(array)-10 b(,)30 b(enum)e(and)g(union)
3390 5153 y Fj(4)3427 5186 y Fr(.)30 5299 y(The)22 b(next)g(few)g
(sections)f(will)j(pr)n(ovide)e(mor)n(e)h(details)f(on)h(these)d
(interfaces.)p 30 5370 1368 4 v 135 5427 a Fg(4)164 5458
y Ff(In)f(the)f(CORBA)f(2.2)h(speci\002cation,)g(the)g(DynFixed)e
(interface)i(is)f(de\002ned)g(to)h(handle)g(the)g(\002xed)f(data)h
(type.)k(This)30 5550 y(is)c(not)h(supported)f(in)h(this)g
(implementation.)p eop
%%Page: 99 105
99 104 bop 150 100 a Fd(10.3.)52 b(THE)21 b(DYNSTRUCT)h(INTERF)-7
b(ACE)1787 b Fr(99)150 356 y Fi(10.3)119 b(The)29 b(DynStruct)h
(Interface)150 570 y Fr(When)37 b(a)g(DynAny)f(object)h(is)h(cr)n
(eated)e(thr)n(ough)g(the)h Fn(create)p 2460 570 28 4
v 30 w(dyn)p 2655 570 V 31 w(any\(\))e Fr(operation)h(and)150
683 y(the)50 b(any)i(value)g(contains)f(a)h(str)o(uct)e(type,)57
b(a)52 b(DynStr)o(uct)f(object)g(is)g(cr)n(eated.)113
b(The)51 b(Dy-)150 796 y(nAny)j(r)n(efer)n(ence)f(r)n(eturned)g(can)i
(be)f(narr)n(owed)g(to)g(a)h(DynStr)o(uct)e(r)n(efer)n(ence)h(using)g
(the)150 908 y Fn(CORBA::DynStruc)o(t:)o(:)p 1143 908
V 27 w(narrow\(\))19 b Fr(operation.)291 1023 y(In)56
b(the)g(pr)n(evious)g(example,)65 b(the)56 b(components)f(ar)n(e)i
(extracted)e(using)h(the)g(get)f(op-)150 1136 y(erations.)108
b(Alternatively)-10 b(,)55 b(the)49 b(DynStr)o(uct)g(interface)g(pr)n
(ovides)g(an)h(addition)f(operation)150 1249 y(\()p Fn(get)p
350 1249 V 32 w(members\(\))p Fr(\))26 b(to)j(r)n(eturn)f(all)k(the)c
(components)g(in)i(a)h(single)e(call.)50 b(The)29 b(r)n(eturned)f
(value)150 1362 y(is)h(a)g(sequence)e(of)i(name)g(value)g(pair)-7
b(.)47 b(The)28 b(member)h(name)g(is)g(given)g(in)g(the)f(name)h
(\002eld)f(and)150 1474 y(its)e(value)h(is)g(r)n(eturned)d(as)j(an)g
(Any)e(value.)40 b(For)25 b(example,)i(an)g(alternative)g(way)f(to)g
(extract)g(the)150 1587 y(components)21 b(in)i(the)f(pr)n(evious)g
(example)g(is)h(as)g(follows:)349 1795 y Fc(//)50 b(C++)349
1994 y(CORBA::ORB_ptr)d(orb;)99 b(//)50 b(orb)f(initialised)f(by)h
(CORBA::ORB_init.)349 2094 y(Any)h(v;)349 2194 y(...)348
b(//)50 b(Initialise)e(v)h(to)h(contain)e(a)i(value)f(of)g(type)g
(exampleStruct1.)349 2293 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_any\(v\);)349 2492 y(CORBA::DynStruct_var)c(ds)k(=)f
(CORBA::DynStruct::_narrow\(dv\);)349 2692 y(CORBA::NameValuePairSeq*)d
(sq)j(=)h(ds->get_members\(\);)349 2891 y(char*)448 b(s;)349
2991 y(CORBA::Double)48 b(d;)349 3090 y(CORBA::Long)148
b(l;)349 3289 y(\(*sq\)[0].value)47 b(>>=)j(s;)398 b(//)49
b(1st)h(element)e(contains)g(member)h(s)349 3389 y(\(*sq\)[1].value)e
(>>=)j(d;)398 b(//)49 b(2nd)h(element)e(contains)g(member)h(d)349
3489 y(\(*sq\)[2].value)e(>>=)j(l;)398 b(//)49 b(3rd)h(element)e
(contains)g(member)h(l)291 3708 y Fr(Similarly)-10 b(,)140
b(the)115 b(DynStr)o(uct)g(interface)h(pr)n(ovides)f(an)h(addition)f
(operation)150 3821 y(\()p Fn(set)p 350 3821 V 32 w(members\(\))p
Fr(\))36 b(to)j(insert)g(all)i(the)e(components)f(in)j(a)f(single)f
(call.)82 b(The)39 b(following)h(is)150 3934 y(an)33
b(alternative)g(way)f(to)g(insert)f(the)h(components)e(of)j(the)e(type)
g Fn(exampleStruct1)26 b Fr(into)33 b(an)150 4047 y(Any)22
b(value:)349 4255 y Fc(//)50 b(C++)349 4454 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
4653 y(CORBA::TypeCode_var)e(tc;)349 4753 y(//)j(create)e(the)i
(TypeCode)e(for)h(exampleStruct1.)349 4852 y(...)349
4952 y(//)h(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g
(any)g(value)349 5052 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_struct\(tc\);)349 5251 y(CORBA::String_var)d(s)j(=)f
(\(const)g(char*\)"Hello";)349 5351 y(CORBA::Double)247
b(d)50 b(=)f(3.1416;)349 5450 y(CORBA::Long)347 b(l)50
b(=)f(1;)p eop
%%Page: 100 106
100 105 bop 30 100 a Fr(100)725 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)229
356 y Fc(CORBA::NameValuePairSeq)46 b(sq;)229 456 y(sq.length\(3\);)229
555 y(sq[0].id)j(=)g(\(const)g(char*\)"s";)229 655 y(sq[0].value)f(<<=)
h(CORBA::Any::from_string\(s,0\);)1823 754 y(//)h(1st)f(element)f
(contains)h(member)f(s)229 854 y(sq[1].id)h(=)g(\(const)g(char*\)"d";)
229 954 y(sq[1].value)f(<<=)h(d;)647 b(//)50 b(2nd)f(element)g
(contains)f(member)h(d)229 1053 y(sq[2].id)g(=)g(\(const)g(char*\)"l";)
229 1153 y(sq[2].value)f(<<=)h(l;)647 b(//)50 b(3rd)f(element)g
(contains)f(member)h(l)229 1352 y(dv->set_members\(sq\);)171
1571 y Fr(Notice)21 b(that)g(the)g(name-value)i(pairs)f(in)g(the)f(ar)n
(gument)g(to)g Fn(set)p 2437 1571 28 4 v 32 w(members\(\))c
Fr(must)k(match)30 1684 y(the)g(members)g(of)h(the)f(str)o(uct)h
(exactly)g(or)f(the)g(object)h(would)f(thr)n(ow)h(the)f(InvalidSeq)h
(exception.)171 1798 y(In)c(addition)h(to)f(the)f Fn(current)p
1266 1798 V 30 w(component\(\))d Fr(operation,)k(the)g(DynStr)o(uct)f
(interface)i(pr)n(o-)30 1911 y(vides)j(two)g(operations:)k
Fn(current)p 1313 1911 V 29 w(member)p 1672 1911 V 30
w(name\(\))20 b Fr(and)j Fn(current)p 2614 1911 V 29
w(member)p 2973 1911 V 30 w(kind\(\))p Fr(,)d(to)30 2024
y(r)n(eturn)i(information)h(about)g(the)e(curr)n(ent)i(component.)30
2331 y Fi(10.4)119 b(The)29 b(DynSequence)h(Interface)30
2544 y Fr(Like)24 b(str)o(uct)g(values,)h(sequence)e(values)i(can)h(be)
f(traversed)e(using)h(the)g(operations)f(intr)n(oduced)30
2657 y(in)k(section)e(10.2.)40 b(The)26 b(\002rst)f(sequence)g(element)
g(can)i(be)f(accessed)g(as)g(the)g(\002rst)f(DynAny)g(com-)30
2770 y(ponent,)c(the)h(second)f(sequence)g(element)g(as)i(the)f(second)
f(DynAny)h(component)f(and)i(so)f(on.)171 2884 y(T)-8
b(o)20 b(extract)h(component)f(values)i(fr)n(om)g(an)f(Any)g
(containing)g(a)h(sequence,)e(the)g(length)h(of)g(the)30
2997 y(sequence)c(can)i(be)f(obtained)g(using)g(the)f(get)g(length)h
(operation)f(in)i(the)f(DynSequence)e(interface.)30 3110
y(Her)n(e)22 b(is)g(an)i(example)e(to)g(extract)g(the)g(components)f
(of)i(a)g(sequence)e(of)h(long:)229 3317 y Fc(//)50 b(C++)229
3516 y(CORBA::ORB_ptr)d(orb;)99 b(//)50 b(orb)f(initialised)f(by)h
(CORBA::ORB_init.)229 3616 y(Any)g(v;)229 3716 y(...)348
b(//)50 b(Initialise)e(v)h(to)h(contain)e(a)i(value)f(of)g(a)h(se-)30
3815 y(quence)f(of)g(long)229 3915 y(CORBA::DynAny_var)e(dv)i(=)h
(orb->create_dyn_any\(v\);)229 4114 y(CORBA::DynSequence_var)c(ds)j(=)h
(CORBA::DynSequence::_narrow\(dv\);)229 4214 y(CORBA::ULong)e(len)h(=)h
(ds->length\(\);)246 b(//)50 b(ex-)30 4313 y(tract)f(the)g(length)g(of)
g(the)h(sequence)229 4413 y(CORBA::ULong)e(index;)229
4513 y(for)h(\(index)g(=)h(0;)f(index)g(<)h(len;)f(index++\))f({)329
4612 y(CORBA::Long)g(v)h(=)h(ds->get_long\(\);)329 4712
y(cerr)f(<<)g("[")h(<<)f(index)g(<<)g("])h(=)f(")h(<<)g(v)f(<<)h(endl;)
229 4812 y(})171 5031 y Fr(Conversely)-10 b(,)24 b(the)g(set)f(length)h
(operation)f(is)i(pr)n(ovided)f(to)g(set)f(the)h(length)g(of)g(the)g
(sequence.)30 5144 y(Her)n(e)e(is)g(an)i(example)e(to)g(insert)g(the)g
(components)e(of)j(a)g(sequence)e(of)i(long:)229 5351
y Fc(//)50 b(C++)229 5550 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)p
eop
%%Page: 101 107
101 106 bop 150 100 a Fd(10.5.)52 b(THE)21 b(DYNARRA)-10
b(Y)21 b(INTERF)-7 b(ACE)1784 b Fr(101)349 456 y Fc
(CORBA::TypeCode_var)47 b(tc;)349 555 y(//)j(create)e(the)i(TypeCode)e
(for)h(a)h(sequence)e(of)i(long.)349 655 y(...)349 754
y(//)g(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g(any)g
(value)349 854 y(CORBA::DynSequence_var)d(ds)j(=)h
(orb->create_dyn_sequence\(tc\);)349 1053 y(CORBA::ULong)e(len)h(=)h
(3;)349 1253 y(ds->length\(len\);)645 b(//)49 b(set)h(the)f(length)f
(of)i(the)f(sequence)349 1452 y(CORBA::ULong)f(index;)349
1551 y(for)i(\(index)e(=)i(0;)f(index)g(<)h(len;)f(index++\))f({)449
1651 y(ds->insert_long\(index\);)195 b(//)49 b(insert)g(a)h(sequence)e
(element)349 1751 y(})291 1974 y Fr(Similar)25 b(to)d(the)h(DynStr)o
(uct)f(interface,)h(the)f Fn(get)p 2002 1974 28 4 v 32
w(elements\(\))c Fr(operation)k(is)i(pr)n(ovided)e(to)150
2087 y(r)n(eturn)k(all)i(the)d(sequence)g(elements)g(and)i(the)f
Fn(set)p 1989 2087 V 31 w(elements\(\))c Fr(operation)j(is)i(pr)n
(ovided)f(to)150 2200 y(insert)c(all)i(the)e(sequence)f(elements.)150
2512 y Fi(10.5)119 b(The)29 b(DynArray)g(Interface)150
2728 y Fr(Array)f(values)g(ar)n(e)g(handled)f(by)h(the)f(DynArray)h
(interface.)43 b(The)27 b(DynArray)h(interface)g(is)g(the)150
2841 y(same)k(as)f(the)g(DynSequence)f(interface)i(except)e(that)h(the)
g(former)g(does)f(not)h(pr)n(ovide)g(the)g(set)150 2954
y(length)22 b(and)g(get)g(length)g(operations.)150 3266
y Fi(10.6)119 b(The)29 b(DynEnum)i(Interface)150 3482
y Fr(Enum)c(values)g(ar)n(e)h(handled)e(by)h(the)g(DynEnum)f
(interface.)42 b(A)27 b(DynEnum)f(object)h(contains)h(a)150
3594 y(single)20 b(component)e(which)j(is)f(the)g(enum)g(value.)27
b(This)20 b(value)h(cannot)f(be)g(extracted)f(or)h(inserted)150
3707 y(using)32 b(the)h(get)f(and)h(insert)f(operations)f(of)i(the)g
(DynAny)f(interface.)59 b(Instead,)34 b(two)e(pairs)h(of)150
3820 y(operations)21 b(ar)n(e)i(pr)n(ovided)f(to)g(handle)g(this)h
(value.)291 3935 y(The)34 b Fn(value)p 758 3935 V 31
w(as)p 899 3935 V 31 w(string)f Fr(operations)g(allow)j(the)e(enum)g
(value)i(to)e(be)g(extracted)g(or)g(in-)150 4048 y(serted)27
b(as)h(a)i(string.)45 b(The)28 b Fn(value)p 1377 4048
V 30 w(as)p 1517 4048 V 32 w(ulong)e Fr(operations)h(allow)j(the)e
(enum)g(value)i(to)e(be)g(ex-)150 4161 y(tracted)22 b(or)g(inserted)f
(as)i(an)g(unsigned)e(long.)150 4474 y Fi(10.7)119 b(The)29
b(DynUnion)i(Interface)150 4689 y Fr(Union)24 b(values)h(ar)n(e)g
(handled)f(by)g(the)g(DynUnion)g(interface.)33 b(Unfortunately)-10
b(,)23 b(the)h(CORBA)g(2.2)150 4802 y(speci\002cation)g(does)f(not)h
(de\002ne)f(the)g(DynUnion)h(interface)h(in)g(suf)n(\002cent)f(details)
g(to)f(nail)j(down)150 4915 y(its)i(intended)e(usage)895
4882 y Fj(5)931 4915 y Fr(.)44 b(In)28 b(this)f(section,)h(we)g(try)f
(to)g(\002ll)i(in)g(the)e(gaps)g(and)h(describe)f(a)i(sensible)150
5028 y(way)23 b(to)g(use)f(the)h(DynUnion)f(interface.)30
b(Wher)n(e)23 b(necessary)-10 b(,)21 b(the)i(semantics)g(of)g(the)g
(operations)150 5141 y(is)g(clari\002ed.)29 b(It)22 b(is)h(possible)f
(that)g(the)g(behavior)i(of)e(this)h(interface)g(in)g(another)f(ORB)g
(is)h(dif)n(fer)n(ent)150 5254 y(fr)n(om)j(this)f(implmentation.)36
b(Wher)n(e)25 b(appr)n(opriate,)g(we)g(give)h(warnings)f(on)g(usage)f
(that)h(might)150 5366 y(cause)d(pr)n(oblems)h(with)f(portability)-10
b(.)p 150 5462 1368 4 v 255 5518 a Fg(5)284 5550 y Ff(This)19
b(interface)g(is)f(curr)o(ently)f(an)j(open)e(issue)g(with)i(the)f(ORB)
f(r)o(evision)f(task)i(for)o(ce.)p eop
%%Page: 102 108
102 107 bop 30 100 a Fr(102)725 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)171
356 y Fr(In)20 b(r)n(elation)g(to)g(the)f(curr)n(ent)h(component)f
(pointer)f(\(10.2.1.1\),)23 b(a)e(DynUnion)e(object)h(contains)30
469 y(two)i(components.)28 b(The)23 b(\002rst)f(component)g(\(with)i
(the)e(index)h(value)h(equals)f(0\))h(is)f(the)g(discrimi-)30
582 y(nator)h(value,)i(the)d(second)g(one)h(is)h(the)e(member)i(value.)
34 b(Ther)n(efor)n(e,)23 b(one)h(can)i(use)d(the)h Fn(seek\(\))30
695 y Fr(and)h Fn(current)p 599 695 28 4 v 30 w(component\(\))20
b Fr(operations)k(to)g(obtain)i(a)g(r)n(efer)n(ence)e(to)h(the)f
(DynAny)h(objects)30 808 y(that)i(handle)g(the)f(two)h(components.)39
b(However)-7 b(,)27 b(it)g(is)h(better)d(to)i(use)f(the)g(operations)g
(de\002ned)30 920 y(in)33 b(the)e(DynUnion)h(interface)h(to)e
(manipulate)i(these)e(components)g(as)h(the)f(semantics)i(of)f(the)30
1033 y(operations)21 b(is)i(easier)f(to)g(understand.)30
1288 y Fh(10.7.1)99 b(Three)24 b(Categories)i(of)f(Union)30
1464 y Fr(Befor)n(e)19 b(we)g(continue,)h(it)g(is)g(important)g(to)f
(understand)f(that)h(unions)h(can)g(be)g(classi\002ed)g(into)g(the)30
1577 y(following)j(categories:)144 1786 y(1.)45 b(One)33
b(that)g(has)g(a)g(default)g(branch)h(de\002ned)d(in)i(the)f(IDL.)h
(This)f(will)i(be)f(called)h Fl(explicit)257 1899 y(default)24
b(union)d Fr(in)i(the)f(r)n(est)g(of)g(this)h(section.)144
2086 y(2.)45 b(One)22 b(that)f(has)g(no)g(default)g(branch)i(and)e(not)
g(all)i(the)d(possible)h(values)g(of)h(the)e(discrimina-)257
2199 y(tor)j(type)e(ar)n(e)j(cover)n(ed)e(by)h(the)g(branch)h(labels)g
(in)g(the)e(IDL.)g(This)h(will)i(be)e(called)h Fl(implicit)257
2312 y(default)g(union)p Fr(.)144 2498 y(3.)45 b(One)28
b(that)g(has)g(no)g(default)g(branch)h(but)f(all)i(the)d(possible)h
(values)g(of)g(the)f(discriminator)257 2611 y(type)21
b(ar)n(e)i(cover)n(ed.)28 b(This)22 b(will)i(be)e(called)i
Fl(no)e(default)h(union)p Fr(.)171 2820 y(Of)i(the)e(thr)n(ee)g
(categories,)f(the)h(implicit)j(default)d(union)h(is)g(inter)n(esting)e
(because)i(by)f(de\002ni-)30 2933 y(tion)j(if)i(the)e(discriminator)h
(value)h(is)e(not)g(equal)h(to)f(any)h(of)g(the)f(branch)h(labels,)i
(the)d(union)g(has)30 3046 y Fl(no)c Fr(member)-7 b(.)28
b(That)22 b(is,)h(the)f(union)g(value)h(consists)f(solely)g(of)g(the)g
(discriminator)h(value.)30 3300 y Fh(10.7.2)99 b(Example:)29
b(extract)c(data)g(values)g(from)f(a)h(union)30 3477
y Fl(10.7.2.1)92 b(Explicit)24 b(default)g(union)30 3654
y Fr(Consider)e(a)h(union)f(of)h(the)f(following)h(type:)229
3850 y Fc(//)50 b(IDL)229 4049 y(union)f(exampleUnion1)f
(switch\(boolean\))f({)229 4149 y(case)i(TRUE:)g(long)g(l;)229
4248 y(default:)148 b(double)49 b(d;)229 4348 y(};)171
4557 y Fr(The)22 b(most)g(straightforwar)n(d)g(way)g(to)g(extract)g
(the)g(member)h(value)g(is)g(as)f(follows:)229 4753 y
Fc(//)50 b(C++)229 4952 y(CORBA::ORB_ptr)d(orb;)99 b(//)50
b(orb)f(initialised)f(by)h(CORBA::ORB_init.)229 5151
y(Any)g(v;)229 5251 y(...)348 b(//)50 b(Initialise)e(v)h(to)h(contain)e
(a)i(value)f(of)g(type)g(exampleUnion1.)229 5450 y(CORBA::DynAny_var)e
(dv)i(=)h(orb->create_dyn_any\(v\);)229 5550 y(CORBA::DynUnion_var)d
(du)i(=)h(CORBA::DynUnion::_narrow\(dv\);)p eop
%%Page: 103 109
103 108 bop 150 100 a Fd(10.7.)52 b(THE)21 b(DYNUNION)h(INTERF)-7
b(ACE)1773 b Fr(103)349 456 y Fc(CORBA::String_var)47
b(di)i(=)h(du->member_name\(\);)349 555 y(CORBA::DynAny_var)d(dm)i(=)h
(du->member\(\);)349 754 y(if)g(\(strcmp\(\(const)d(char*\)di,"l"\))g
(==)j(0\))f({)449 854 y(//)g(branch)g(label)g(is)g(TRUE)449
954 y(CORBA::Long)f(v)h(=)h(dm->get_long\(\);)449 1053
y(cerr)f(<<)g("l)h(=)f(")h(<<)g(v)f(<<)h(endl;)349 1153
y(})349 1352 y(if)g(\(strcmp\(\(const)d(char*\)di,"d"\))g(==)j(0\))f({)
449 1452 y(//)g(Is)h(default)e(branch)449 1551 y(CORBA::Double)f(v)j(=)
g(dm->get_double\(\);)449 1651 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h
(endl;)349 1751 y(})291 1947 y Fr(In)21 b(the)f(example,)g(the)g
(operation)g Fn(member)p 1818 1947 28 4 v 30 w(name\(\))e
Fr(is)j(used)e(to)i(determine)e(which)i(branch)150 2060
y(the)d(union)g(has)h(been)f(instantiated.)26 b(The)18
b(operation)f Fn(member\(\))e Fr(is)k(used)e(to)h(obtain)i(a)f(r)n
(efer)n(ence)150 2172 y(to)j(the)g(DynAny)g(object)g(that)g(handles)g
(the)g(member)-7 b(.)291 2285 y(Alternatively)d(,)22
b(the)g(branch)h(can)h(be)e(determined)f(by)i(r)n(eading)f(the)g
(discriminator)h(value:)349 2468 y Fc(//)50 b(C++)349
2667 y(CORBA::DynAny_var)d(di)i(=)h(du->discriminator\(\);)349
2767 y(CORBA::DynAny_var)d(dm)i(=)h(du->member\(\);)349
2966 y(CORBA::Boolean)d(di_v)j(=)f(di->get_boolean\(\);)349
3165 y(switch)g(\(di_v\))g({)349 3265 y(case)g(1:)449
3365 y(CORBA::Long)f(v)h(=)h(dm->get_long\(\);)449 3464
y(cerr)f(<<)g("l)h(=)f(")h(<<)g(v)f(<<)h(endl;)449 3564
y(break;)349 3664 y(default:)449 3763 y(CORBA::Double)d(v)j(=)g
(dm->get_double\(\);)449 3863 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h
(endl;)349 3962 y(})291 4158 y Fr(The)19 b(operation)f
Fn(discriminator\(\))13 b Fr(is)20 b(used)e(to)h(obtain)h(the)f(value)h
(of)g(the)e(discriminator)-7 b(.)291 4271 y(Finally)d(,)23
b(the)f(thir)n(d)h(way)f(to)g(determine)f(the)h(branch)i(is)e(to)g
(test)f(if)j(the)e(default)g(is)h(selected:)349 4454
y Fc(//)50 b(C++)349 4653 y(switch)f(\(dv->set_as_default\(\)\))d({)349
4753 y(case)j(1:)449 4852 y(CORBA::Double)e(v)j(=)g
(dm->get_double\(\);)449 4952 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h
(endl;)449 5052 y(break;)349 5151 y(default:)449 5251
y(CORBA::Long)e(v)h(=)h(dm->get_long\(\);)449 5351 y(cerr)f(<<)g("l)h
(=)f(")h(<<)g(v)f(<<)h(endl;)349 5450 y(})p eop
%%Page: 104 110
104 109 bop 30 100 a Fr(104)725 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)171
356 y Fr(The)21 b(operation)g Fn(set)p 925 356 28 4 v
31 w(as)p 1066 356 V 32 w(default\(\))d Fr(r)n(eturns)i(TRUE)h(\(1\))h
(if)h(the)e(discriminator)h(has)g(been)30 469 y(assigned)f(a)i(valid)h
(default)f(value.)30 719 y Fl(10.7.2.2)92 b(Implicit)24
b(default)g(union)30 896 y Fr(Consider)e(a)h(union)f(of)h(the)f
(following)h(type:)229 1087 y Fc(//)50 b(IDL)229 1286
y(union)f(exampleUnion2)f(switch\(long\))f({)229 1385
y(case)i(1:)h(long)f(l;)229 1485 y(case)g(2:)h(double)e(d;)229
1585 y(};)171 1789 y Fr(This)32 b(example)f(is)h(similar)i(to)d(the)g
(pr)n(evious)g(one)g(but)h(ther)n(e)f(is)g(no)h(default)g(branch.)56
b(The)30 1902 y(description)29 b(above)h(also)h(applies)f(to)f(this)h
(example.)50 b(However)-7 b(,)31 b(the)e(discriminator)i(may)f(be)30
2015 y(set)g(to)g(neither)g(1)i(nor)e(2.)54 b(Under)30
b(this)g(condition,)j(the)d(implicit)j(default)e(is)g(selected)e(and)i
(the)30 2128 y(union)22 b(value)i(contains)e(the)g(discriminator)i
(only!)171 2241 y(When)33 b(the)f(discriminator)i(contains)f(an)h
(implicit)h(default)e(value,)k(one)32 b(might)h(ask)g(what)30
2353 y(is)28 b(the)g(value)g(r)n(eturned)f(by)h(the)f
Fn(member)p 1524 2353 V 30 w(name\(\))f Fr(and)i Fn(member\(\))d
Fr(operation.)43 b(Since)28 b(ther)n(e)30 2466 y(is)f(no)g(member)f(in)
i(the)e(union)h(value,)h(omniORB2)g(r)n(eturns)d(a)j(null)g(string)e
(and)h(a)g(nil)h(DynAny)30 2579 y(r)n(efer)n(ence)e(r)n(espectively)-10
b(.)38 b(This)27 b(behavior)g(is)g(not)e(speci\002ed)h(in)h(the)e
(CORBA)i(2.2)g(speci\002cation.)30 2692 y(T)-8 b(o)23
b(ensur)n(e)g(that)h(your)e(application)k(is)e(portable,)f(it)i(is)f
(best)f(to)g(avoid)i(calling)g(these)e(operations)30
2805 y(when)f(the)g(DynUnion)g(object)g(might)h(contain)g(an)g
(implicit)i(default)d(value.)30 3055 y Fl(10.7.2.3)92
b(No)22 b(default)i(union)30 3232 y Fr(This)e(is)h(the)f(last)h(union)f
(category)-10 b(.)27 b(For)21 b(instance:)229 3423 y
Fc(//)50 b(IDL)229 3622 y(union)f(exampleUnion3)f(switch\(boolean\))f
({)229 3722 y(case)i(TRUE:)g(long)g(l;)229 3821 y(case)g(FALSE:)g
(double)g(d;)229 3921 y(};)171 4125 y Fr(In)27 b(this)g(example,)h(all)
g(the)f(possible)f(values)i(of)f(the)f(discriminator)i(ar)n(e)g(used)d
(as)j(union)f(la-)30 4238 y(bels.)46 b(Ther)n(e)28 b(is)h(no)g(default)
f(branch.)47 b(The)28 b(only)h(dif)n(fer)n(ence)g(between)e(this)i
(category)e(and)i(the)30 4351 y(explicit)20 b(default)f(union)g(is)g
(that)g(the)f Fn(set)p 1481 4351 V 31 w(as)p 1622 4351
V 32 w(default\(\))d Fr(operation)j(always)i(r)n(eturns)e(F)-7
b(ALSE)30 4464 y(\(0\).)30 4717 y Fh(10.7.3)99 b(Example:)29
b(insert)c(data)g(values)g(into)h(a)e(union)30 4894 y
Fr(W)-7 b(riting)34 b(into)f(a)h(union)g(involves)g(selecting)e(the)h
(union)g(branch)i(with)e(the)g(appr)n(opriate)g(dis-)30
5007 y(criminator)26 b(value)f(and)g(then)e(writing)i(the)f(member)g
(value.)35 b(Ther)n(e)24 b(ar)n(e)h(thr)n(ee)e(ways)h(to)g(set)g(the)30
5120 y(discriminator)f(value:)144 5324 y(1.)45 b(Use)25
b(the)h Fn(member)p 924 5324 V 30 w(name\(\))d Fr(write)j(operation)f
(to)g(specify)h(the)f(union)h(branch)h(by)f(speci-)257
5437 y(fying)21 b(the)g(union)g(member)g(dir)n(ectly)-10
b(.)27 b(This)21 b(operation)f(has)i(the)e(side)h(ef)n(fect)g(of)g
(setting)f(the)257 5550 y(discriminator)k(to)e(the)f(label)j(value)g
(of)e(the)g(branch.)p eop
%%Page: 105 111
105 110 bop 150 100 a Fd(10.7.)52 b(THE)21 b(DYNUNION)h(INTERF)-7
b(ACE)1773 b Fr(105)264 356 y(2.)45 b(W)-7 b(rite)23
b(the)g(label)h(value)g(of)f(a)h(union)f(branch)h(into)f(the)g(DynAny)f
(object)h(that)g(handles)g(the)377 469 y(discriminator)-7
b(.)264 659 y(3.)45 b(If)53 b(the)f(union)g(has)h(a)g(default)g
(branch,)60 b(either)52 b(explicitly)h(or)g(implicitly)-10
b(,)61 b(use)52 b(the)377 772 y Fn(set)p 547 772 28 4
v 32 w(as)p 689 772 V 31 w(default\(\))25 b Fr(write)j(operation)g(to)g
(set)g(the)f(discriminator)j(to)e(a)h(valid)h(default)377
885 y(value.)291 1101 y(The)22 b(following)h(example)f(shows)g(the)f
(thr)n(ee)h(ways)g(of)h(writing)f(into)h(a)g(union:)349
1304 y Fc(//)50 b(C++)349 1503 y(CORBA::ORB_ptr)d(orb;)99
b(//)50 b(orb)f(initialised)f(by)h(CORBA::ORB_init.)349
1702 y(CORBA::TypeCode_var)e(tc;)349 1802 y(//)j(create)e(the)i
(TypeCode)e(for)h(exampleUnion1.)349 1902 y(...)349 2001
y(//)h(create)e(the)i(DynAny)e(object)h(to)g(represent)g(the)g(any)g
(value)349 2101 y(CORBA::DynUnion_var)e(dv)i(=)h
(orb->create_dyn_union\(tc\);)349 2300 y(CORBA::Any_var)d(v;)349
2400 y(DynAny_ptr)h(dm;)349 2599 y(//)i(Use)f(member_name)f(to)h
(select)g(the)g(union)g(branch)349 2699 y(dv->member_name\("l"\);)349
2798 y(dm)h(=)f(dv->member\(\);)349 2898 y(dm->insert_long\(10\);)349
2997 y(v)h(=)g(dv->to_any\(\);)495 b(//)50 b(transfer)e(to)h(an)h(Any)
349 3097 y(CORBA::release\(dm\);)349 3296 y(//)g(Setting)e(the)h
(discriminator)f(value)h(to)g(select)g(the)g(union)g(branch)349
3396 y(CORBA::DynAny_var)e(di)i(=)h(dv->discriminator\(\);)349
3496 y(di->insert_boolean\(1\);)245 b(//)50 b(set)f(discriminator)e(to)
j(label)f(TRUE)349 3595 y(dm)h(=)f(dv->member\(\);)349
3695 y(dm->insert_long\(20\);)349 3794 y(v)h(=)g(dv->to_any\(\);)495
b(//)50 b(transfer)e(to)h(an)h(Any)349 3894 y(CORBA::release\(dm\);)349
4093 y(//)g(Use)f(set_as_default)e(to)j(select)e(the)i(default)e(union)
h(branch)349 4193 y(dv->set_as_default\(1\);)349 4293
y(dm)h(=)f(dv->member\(\);)349 4392 y(dm->insert_double\(3.14\);)349
4492 y(v)h(=)g(dv->to_any\(\);)495 b(//)50 b(transfer)e(to)h(an)h(Any)
349 4591 y(CORBA::release\(dm\);)349 4791 y(dv->destroy\(\);)150
5146 y Fl(10.7.3.1)92 b(Ambiguous)21 b(usage)264 5324
y Fr(1.)45 b(When)25 b(the)f(discriminator)h(is)g(set)f(to)g(a)h(dif)n
(fer)n(ent)g(value,)h(a)g(dif)n(fer)n(ent)e(member)h(branch)h(is)377
5437 y(selected.)36 b(Suppose)24 b(the)h(application)i(has)f(pr)n
(eviously)g(obtained)f(a)i(DynAny)e(r)n(efer)n(ence)377
5550 y(to)h(a)i(union)e(member)h(when)f(it)h(changes)f(the)g
(discriminator)i(value.)41 b(As)26 b(a)h(r)n(esult)f(of)h(the)p
eop
%%Page: 106 112
106 111 bop 30 100 a Fr(106)725 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)257
356 y Fr(value)27 b(change,)g(the)e(union)h(is)g(now)f(instantiated)h
(to)f(another)g(union)h(branch,)i(i.e.)38 b(a)26 b(call)257
469 y(to)j(the)f Fn(member\(\))d Fr(operation)j(will)j(now)d(r)n(eturn)
g(a)i(r)n(efer)n(ence)e(to)h(a)g(dif)n(fer)n(ent)g(DynAny)257
582 y(object.)f(If)22 b(the)g(application)h(continues)f(to)f(access)i
(the)e(DynAny)h(object)g(of)h(the)e(old)h(union)257 695
y(member)-7 b(,)39 b(the)34 b(behavior)i(of)f(the)g(ORB)g(under)f(this)
h(condition)g(is)h(not)e(de\002ned)g(by)h(the)257 808
y(CORBA)25 b(2.2)h(speci\002cation.)35 b(W)-5 b(ith)25
b(omniORB2,)h(the)e(DynAny)g(object)h(of)g(the)g(old)f(union)257
920 y(member)18 b(is)g(detached)f(fr)n(om)h(the)g(union)f(when)h(a)g
(new)f(union)h(branch)h(is)f(selected.)25 b(Ther)n(e-)257
1033 y(for)n(e)d(r)n(eading)f(or)g(writing)h(this)f(object)h(will)h
(not)e(have)h(any)f(r)n(elation)h(to)f(the)g(curr)n(ent)g(value)257
1146 y(of)31 b(the)f(union.)53 b(T)-8 b(o)30 b(avoid)h(this)g
(ambiguity)-10 b(,)33 b(the)d(r)n(efer)n(ence)g(to)h(the)f(old)g(union)
h(member)257 1259 y(should)22 b(be)g(r)n(eleased)g(befor)n(e)g(a)i(dif)
n(fer)n(ent)e(union)h(branch)g(is)g(selected.)144 1464
y(2.)45 b(The)32 b(write)f(operation)g Fn(set)p 1275
1464 28 4 v 31 w(as)p 1416 1464 V 32 w(default\(\))d
Fr(takes)j(a)i(boolean)f(ar)n(gument.)55 b(It)32 b(is)g(am-)257
1576 y(biguous)k(to)h(call)h(this)f(function)g(with)g(the)f(ar)n
(gument)g(set)g(to)g(F)-7 b(ALSE)35 b(\(0\).)72 b(W)-5
b(ith)37 b(om-)257 1689 y(niORB2,)23 b(such)g(a)g(call)h(will)g(be)f
(silently)f(ignor)n(ed.)144 1894 y(3.)45 b(It)25 b(is)h(also)g
(ambiguous)f(to)g(pass)g(the)g(value)i(TRUE)d(\(1\))j(to)e(the)g
Fn(set)p 2631 1894 V 31 w(as)p 2772 1894 V 32 w(default\(\))c
Fr(op-)257 2007 y(eration)28 b(when)f(the)g(union)h(is)g(a)h(no)f
(default)f(union)h(\(10.7.1\).)46 b(W)-5 b(ith)28 b(omniORB2,)i(such)e
(a)257 2119 y(call)d(will)f(be)e(silently)g(ignor)n(ed.)144
2324 y(4.)45 b(When)24 b(the)f(discriminator)h(value)h(is)f(not)g(set,)
f(calling)i(the)e Fn(member\(\))e Fr(operation)i(is)h(am-)257
2437 y(biguous.)37 b(W)-5 b(ith)25 b(omniORB2,)i(such)f(a)g(call)i
(will)f(r)n(eturn)e(a)h(nil)h(DynAny)e(r)n(efer)n(ence.)36
b(Sim-)257 2550 y(ilarly)-10 b(,)32 b(a)e(call)h(to)e(the)f
Fn(member)p 1354 2550 V 30 w(kind\(\))f Fr(operation)h(under)g(this)h
(condition)f(will)j(r)n(eturn)257 2662 y Fn(tk)p 372
2662 V 32 w(null)p Fr(.)171 2896 y(T)-8 b(o)27 b(ensur)n(e)g
(portability)-10 b(,)30 b(it)e(is)g(best)f(to)h(avoid)g(using)g(the)f
(DynUnion)h(interface)g(and)g(not)g(to)30 3009 y(r)n(ely)23
b(on)f(the)g(ORB)g(to)g(behave)h(as)g(omniORB2)g(does)e(under)g(these)g
(ambiguous)i(conditions.)30 3333 y Fi(10.8)119 b(Duplicate)28
b(DynAny)j(References)30 3552 y Fr(Like)22 b(any)g(CORBA)g(object)g
(and)h(psuedo)d(object)i(r)n(efer)n(ences,)f(a)i(DynAny)e(r)n(efer)n
(ence)h(can)h(be)f(du-)30 3665 y(plicated)d(using)e(the)p
763 3665 V 51 w Fn(duplicate\(\))c Fr(operations.)25
b(When)18 b(an)h(application)h(has)e(obtained)g(mul-)30
3778 y(tiple)23 b(DynAny)e(r)n(efer)n(ences)h(to)g(the)g(same)h(DynAny)
f(object,)g(it)h(should)f(be)g(noted)f(that)i(a)g(change)30
3891 y(made)e(to)f(the)g(object)g(by)h(invoking)f(on)h(one)e(r)n(efer)n
(ence)h(is)h(also)g(visible)h(thr)n(ough)e(the)f(other)h(r)n(efer)n(-)
30 4004 y(ences.)30 b(In)24 b(particular)-7 b(,)25 b(if)g(a)f(call)i
(thr)n(ough)d(one)g(r)n(efer)n(ence)g(has)h(caused)f(the)g(curr)n(ent)g
(component)30 4117 y(pointer)j(to)g(be)i(changed,)f(subsequent)e(calls)
j(thr)n(ough)e(other)g(r)n(efer)n(ences)g(will)j(operate)c(on)i(the)30
4230 y(new)22 b(curr)n(ent)g(component)f(pointer)-7 b(.)30
4554 y Fi(10.9)119 b(Other)28 b(Operations)30 4773 y
Fr(The)k(following)i(is)f(a)g(short)f(summary)h(of)g(the)g(other)e
(operations)h(in)h(the)g(DynAny)f(interface)30 4886 y(which)23
b(have)g(not)f(been)g(cover)n(ed)g(in)h(pr)n(evious)f(sections:)30
5120 y Fn(assign\(\))42 b Fr(initialises)25 b(a)f(DynAny)f(object)h
(with)g(another)f(DynAny)g(object.)31 b(The)24 b(two)f(objects)257
5233 y(must)f(have)h(the)f(same)h(typecode.)30 5437 y
Fn(from)p 255 5437 V 31 w(any\(\))43 b Fr(initialises)30
b(a)f(DynAny)e(object)i(fr)n(om)g(the)f(value)h(in)g(an)g(any)-10
b(.)46 b(The)28 b(typecode)e(in)257 5550 y(the)c(two)g(objects)g(must)g
(be)g(the)g(same.)p eop
%%Page: 107 113
107 112 bop 150 100 a Fd(10.9.)52 b(OTHER)22 b(OPERA)-7
b(TIONS)2120 b Fr(107)150 356 y Fn(copy\(\))43 b Fr(cr)n(eates)25
b(a)h(new)f(DynAny)f(object)i(whose)e(value)i(is)g(a)g(deep)e(copy)g
(of)i(the)f(curr)n(ent)g(ob-)377 469 y(ject.)150 656
y Fn(type\(\))43 b Fr(r)n(eturns)21 b(the)h(typecode)e(associated)i
(with)h(the)e(DynAny)h(object.)p eop
%%Page: 108 114
108 113 bop 30 100 a Fr(108)725 b Fd(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)i(ANY)e(V)-10 b(ALUES)p
eop
%%Page: 109 115
109 114 bop 150 982 a Fk(Chapter)44 b(1)-6 b(1)150 1401
y Fm(The)52 b(Dynamic)f(Invocation)h(Interface)150 1866
y Fr(The)30 b(Dynamic)i(Invocation)f(Interface)g(\(or)f(DII\))h(allows)
g(applications)h(to)e(invoke)h(operations)150 1979 y(on)g(CORBA)h
(objects)f(about)h(which)g(they)f(have)h(no)f(static)h(information.)56
b(That)32 b(is)f(to)h(say)f(the)150 2092 y(application)26
b(has)e(not)g(been)f(linked)h(with)h(stub)e(code)h(which)h(performs)e
(the)h(r)n(emote)f(operation)150 2205 y(invocation.)53
b(Thus)30 b(using)g(the)f(DII)i(applications)g(may)g(invoke)g
(operations)e(on)h Fq(any)h Fr(CORBA)150 2318 y(object,)e(possibly)e
(determining)g(the)g(object's)g(interface)i(dynamically)g(by)f(using)f
(an)i(Interface)150 2431 y(Repository)-10 b(.)291 2547
y(This)44 b(chapter)g(pr)n(esents)e(an)i(overview)g(of)g(the)g(Dynamic)
h(Invocation)g(Interface.)91 b(An)150 2660 y(toy)47 b(example)g(use)g
(of)h(the)f(DII)g(can)i(be)e(found)g(in)h(the)f(omniORB2)i
(distribution)e(in)h(the)150 2773 y Fn(<top>/src/examp)o(le)o(s/)o(di)o
(i)34 b Fr(dir)n(ectory)-10 b(.)79 b(The)39 b(DII)h(makes)g(extensive)e
(use)h(of)h(the)g(type)150 2886 y(Any)-10 b(,)43 b(so)d(ensur)n(e)e
(that)i(you)f(have)h(r)n(ead)g(chapter)g(9.)80 b(For)39
b(mor)n(e)h(information)h(r)n(efer)f(to)f(the)150 2999
y(Dynamic)e(Invocation)e(Interface)g(and)g(C++)i(Mapping)e(sections)f
(of)h(the)g(CORBA)g(2)h(speci\002-)150 3112 y(cation)23
b([OMG99a)s(].)150 3433 y Fi(1)l(1.1)118 b(Overview)150
3652 y Fr(T)-8 b(o)26 b(invoke)g(an)i(operation)d(on)i(a)g(CORBA)g
(object)g(an)g(application)h(needs)d(an)i(object)g(r)n(efer)n(ence,)150
3765 y(the)16 b(name)i(of)f(the)g(operation)f(and)h(a)h(list)f(of)h
(the)e(parameters.)25 b(In)17 b(addition)g(the)f(application)j(must)150
3877 y(know)25 b(whether)g(the)g(operation)g(is)i(one-way)-10
b(,)26 b(what)g(user)n(-de\002ned)e(exceptions)g(it)j(may)f(thr)n(ow)-8
b(,)150 3990 y(any)22 b(user)n(-context)d(strings)h(which)j(must)e(be)g
(supplied,)f(a)i('context')f(to)g(take)g(these)f(values)i(fr)n(om)150
4103 y(and)33 b(the)f(type)f(of)i(the)f(r)n(eturned)f(value.)59
b(This)33 b(information)g(is)g(given)g(by)f(the)g(IDL)h(interface)150
4216 y(declaration,)22 b(and)g(so)e(is)i(normally)g(made)g(available)j
(to)c(the)f(application)j(via)g(the)e(stub)g(code.)26
b(In)150 4329 y(the)c(DII)g(this)g(information)i(is)e(encapsulated)g
(in)h(the)f Fn(CORBA::Request)16 b Fr(pseudo-object.)291
4446 y(T)-8 b(o)28 b(perform)h(an)h(operation)e(invocation)i(the)e
(application)i(must)f(obtain)h(an)f(instance)g(of)h(a)150
4559 y Fn(Request)24 b Fr(object,)29 b(supply)d(the)h(information)h
(listed)f(above)h(and)f(call)j(one)d(of)g(the)g(methods)f(to)150
4671 y(actually)e(make)e(the)g(invocation.)29 b(If)23
b(the)f(invocation)h(causes)f(an)h(exception)f(to)g(be)g(thr)n(own)g
(then)150 4784 y(this)g(may)h(be)g(r)n(etrieved)e(and)i(inspected,)e
(or)h(the)g(r)n(eturn)g(value)h(on)f(success.)150 5106
y Fi(1)l(1.2)118 b(Pseudo)31 b(Objects)150 5324 y Fr(The)d(DII)h
(de\002nes)e(a)i(number)g(of)g(psuedo-object)e(types,)h(all)i
(de\002ned)e(in)h(the)f(CORBA)h(names-)150 5437 y(pace.)41
b(These)25 b(objects)i(behave)g(in)g(many)g(ways)g(like)g(CORBA)g
(objects.)40 b(They)26 b(should)g(only)g(be)150 5550
y(accessed)18 b(by)g(r)n(efer)n(ence)h(\(thr)n(ough)e
Fn(foo)p 1563 5550 28 4 v 32 w(ptr)g Fr(or)i Fn(foo)p
2047 5550 V 31 w(var)p Fr(\),)f(may)h(not)f(be)h(instantiated)f(dir)n
(ectly)1792 5778 y(109)p eop
%%Page: 110 116
110 115 bop 30 100 a Fr(1)-5 b(10)839 b Fd(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)30 356 y Fr(and)23 b(should)f(be)h(r)n(eleased)f(by)h
(calling)i Fn(CORBA::release\()o(\))2274 323 y Fj(1)2305
356 y Fr(.)k(A)23 b(nil)h(r)n(efer)n(ence)e(should)g(only)30
469 y(be)h(r)n(epr)n(esented)c(by)k Fn(foo::)p 1047 469
28 4 v 30 w(nil\(\))p Fr(.)171 584 y(These)g(pseudo)g(objects,)h
(although)h(de\002ned)e(in)i(pseudo-IDL)d(in)k(the)e(speci\002cation)h
(do)f(not)30 697 y(follow)30 b(the)g(normal)g(mapping)h(for)e(CORBA)i
(objects.)49 b(In)30 b(particular)h(the)e(memory)h(manage-)30
810 y(ment)d(r)o(ules)g(ar)n(e)h(dif)n(fer)n(ent)f(-)h(see)e(the)h
(CORBA)g(2)h(speci\002cation)g([OMG99a)r(])g(for)f(mor)n(e)h(details.)
30 923 y(New)19 b(instances)g(of)h(these)e(objects)h(may)h(only)f(be)h
(cr)n(eated)f(by)h(the)f(ORB.)g(A)h(number)f(of)h(methods)30
1036 y(ar)n(e)j(de\002ned)e(in)i Fn(CORBA::ORB)18 b Fr(to)k(do)g(this.)
30 1305 y Fh(1)l(1.2.1)99 b(Request)30 1487 y Fr(A)26
b Fn(Request)e Fr(encapsulates)i(a)h(single)f(operation)f(invocation.)
41 b(It)26 b(may)h Fq(not)g Fr(be)f(r)n(e-used)g(-)h(even)30
1599 y(for)c(another)e(call)k(with)d(the)g(same)h(ar)n(guments.)30
1813 y Fc(class)49 b(Request)f({)30 1912 y(public:)130
2012 y(virtual)g(Object_ptr)397 b(target\(\))48 b(const;)130
2112 y(virtual)g(const)h(char*)348 b(operation\(\))48
b(const;)130 2211 y(virtual)g(NVList_ptr)397 b(arguments\(\);)130
2311 y(virtual)48 b(NamedValue_ptr)197 b(result\(\);)130
2411 y(virtual)48 b(Environment_ptr)147 b(env\(\);)130
2510 y(virtual)48 b(ExceptionList_ptr)f(exceptions\(\);)130
2610 y(virtual)h(ContextList_ptr)147 b(contexts\(\);)130
2709 y(virtual)48 b(Context_ptr)347 b(ctxt\(\))48 b(const;)130
2809 y(virtual)g(void)697 b(ctx\(Context_ptr\);)130 3008
y(virtual)48 b(Any&)h(add_in_arg\(\);)130 3108 y(virtual)f(Any&)h
(add_in_arg\(const)e(char*)i(name\);)130 3208 y(virtual)f(Any&)h
(add_inout_arg\(\);)130 3307 y(virtual)f(Any&)h(add_inout_arg\(const)d
(char*)j(name\);)130 3407 y(virtual)f(Any&)h(add_out_arg\(\);)130
3506 y(virtual)f(Any&)h(add_out_arg\(const)e(char*)i(name\);)130
3706 y(virtual)f(void)h(set_return_type\(TypeCode_ptr)c(tc\);)130
3805 y(virtual)j(Any&)h(return_value\(\);)130 4005 y(virtual)f(Status)
99 b(invoke\(\);)130 4104 y(virtual)48 b(Status)99 b(send_oneway\(\);)
130 4204 y(virtual)48 b(Status)99 b(send_deferred\(\);)130
4303 y(virtual)48 b(Status)99 b(get_response\(\);)130
4403 y(virtual)48 b(Boolean)h(poll_response\(\);)130
4602 y(static)f(Request_ptr)g(_duplicate\(Request_ptr\);)130
4702 y(static)g(Request_ptr)g(_nil\(\);)30 4802 y(};)30
5071 y Fh(1)l(1.2.2)99 b(NamedV)-11 b(alue)30 5252 y
Fr(A)28 b(pair)h(consisting)f(of)g(a)h(string)e(and)i(a)g(value)g(-)f
(encapsulated)g(in)h(an)f(Any)-10 b(.)45 b(The)27 b(name)i(is)f(op-)30
5365 y(tional.)g(This)23 b(type)e(is)i(used)e(to)h(encapsulate)g
(parameters)g(and)g(r)n(eturned)f(values.)p 30 5462 1368
4 v 135 5518 a Fg(1)164 5550 y Ff(if)e(not)g(managed)g(by)g(a)p
845 5550 23 4 v 45 w Fb(var)g Ff(type.)p eop
%%Page: 111 117
111 116 bop 150 100 a Fd(1)-5 b(1.2.)52 b(PSEUDO)22 b(OBJECTS)2292
b Fr(1)-5 b(1)g(1)150 356 y Fc(class)49 b(NamedValue)f({)150
456 y(public:)250 555 y(virtual)g(const)h(char*)g(name\(\))g(const;)250
655 y(//)g(Retains)g(ownership)f(of)h(return)g(value.)250
854 y(virtual)f(Any*)h(value\(\))g(const;)250 954 y(//)g(Retains)g
(ownership)f(of)h(return)g(value.)250 1153 y(virtual)f(Flags)h
(flags\(\))g(const;)250 1352 y(static)f(NamedValue_ptr)g
(_duplicate\(NamedValue_ptr\);)250 1452 y(static)g(NamedValue_ptr)g
(_nil\(\);)150 1551 y(};)150 1811 y Fh(1)l(1.2.3)99 b(NVList)150
1989 y Fr(A)22 b(list)h(of)g Fn(NamedValue)18 b Fr(objects.)150
2192 y Fc(class)49 b(NVList)g({)150 2292 y(public:)250
2392 y(virtual)f(ULong)h(count\(\))g(const;)250 2491
y(virtual)f(NamedValue_ptr)f(add\(Flags\);)250 2591 y(virtual)h
(NamedValue_ptr)f(add_item\(const)h(char*,)g(Flags\);)250
2691 y(virtual)g(NamedValue_ptr)f(add_value\(const)g(char*,)i(const)g
(Any&,)g(Flags\);)250 2790 y(virtual)f(NamedValue_ptr)f
(add_item_consume\(char*,Flags\);)250 2890 y(virtual)h(NamedValue_ptr)f
(add_value_consume\(char*,)f(Any*,)j(Flags\);)250 2989
y(virtual)f(NamedValue_ptr)f(item\(ULong)h(index\);)250
3089 y(virtual)g(Status)h(remove)g(\(ULong\);)250 3288
y(static)f(NVList_ptr)g(_duplicate\(NVList_ptr\);)250
3388 y(static)g(NVList_ptr)g(_nil\(\);)150 3488 y(};)150
3747 y Fh(1)l(1.2.4)99 b(Context)150 3925 y Fr(Repr)n(esents)24
b(a)k(set)f(of)g(context)f(strings.)41 b(User)26 b(contexts)g(ar)n(e)i
(not)e(supported)f(by)i(the)g(omniidl2)150 4038 y(IDL)k(compiler)h(-)g
(and)f(so)g(cannot)h(be)f(used)f(with)h(statically)i(de\002ned)d
(operations.)53 b(However)150 4151 y(they)21 b(ar)n(e)i(supported)d(in)
j(the)f(DII.)150 4354 y Fc(class)49 b(Context)f({)150
4454 y(public:)250 4554 y(virtual)g(const)h(char*)g(context_name\(\))e
(const;)250 4653 y(virtual)h(CORBA::Context_ptr)f(parent\(\))h(const;)
250 4753 y(virtual)g(CORBA::Status)g(create_child\(const)e(char*,)j
(Context_out\);)250 4852 y(virtual)f(CORBA::Status)g
(set_one_value\(const)e(char*,)i(const)h(CORBA::Any&\);)250
4952 y(virtual)f(CORBA::Status)g(set_values\(CORBA::NVList_ptr\);)250
5052 y(virtual)g(CORBA::Status)g(delete_values\(const)e(char*\);)250
5151 y(virtual)i(CORBA::Status)g(get_values\(const)e(char*)j
(start_scope,)1893 5251 y(CORBA::Flags)f(op_flags,)1893
5351 y(const)h(char*)g(pattern,)1893 5450 y(CORBA::NVList_out)e
(values\);)250 5550 y(//)i(Throws)g(BAD_CONTEXT)f(if)h(<start_scope>)e
(is)j(not)f(found.)p eop
%%Page: 112 118
112 117 bop 30 100 a Fr(1)-5 b(12)839 b Fd(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)130 356 y Fc(//)49 b(Returns)g(a)g(nil)g(NVList)g(in)
h(<values>)e(if)h(no)h(matches)e(are)i(found.)130 555
y(static)e(Context_ptr)g(_duplicate\(Context_ptr\);)130
655 y(static)g(Context_ptr)g(_nil\(\);)30 754 y(};)30
1007 y Fh(1)l(1.2.5)99 b(ContextList)30 1184 y Fr(A)35
b Fn(ContextList)29 b Fr(is)35 b(a)h(list)f(of)f(strings,)j(and)d(is)h
(used)e(to)i(specify)f(which)h(strings)f(fr)n(om)h(the)30
1297 y('context')22 b(should)g(be)g(sent)f(with)i(an)g(operation.)30
1486 y Fc(class)49 b(ContextList)f({)30 1586 y(public:)130
1685 y(virtual)g(ULong)h(count\(\))g(const;)130 1785
y(virtual)f(void)h(add\(const)f(char*)h(ctxt\);)130 1884
y(virtual)f(void)h(add_consume\(char*)e(ctxt\);)130 1984
y(//)i(consumes)f(ctxt)130 2183 y(virtual)g(const)h(char*)g
(item\(ULong)f(index\);)130 2283 y(//)h(retains)g(ownership)f(of)h
(return)g(value)130 2482 y(virtual)f(Status)h(remove\(ULong)e(index\);)
130 2681 y(static)h(ContextList_ptr)f(_duplicate\(ContextList_ptr\);)
130 2781 y(static)h(ContextList_ptr)f(_nil\(\);)30 2881
y(};)30 3134 y Fh(1)l(1.2.6)99 b(ExceptionList)30 3311
y Fn(ExceptionList)p Fr(s)22 b(contain)28 b(a)h(list)f(of)h(T)-8
b(ypeCodes)25 b(-)j(and)h(ar)n(e)f(used)f(to)g(specify)h(which)h(user)n
(-)30 3424 y(de\002ned)21 b(exceptions)g(an)i(operation)e(may)i(thr)n
(ow)-8 b(.)30 3612 y Fc(class)49 b(ExceptionList)e({)30
3712 y(public:)130 3812 y(virtual)h(ULong)h(count\(\))g(const;)130
3911 y(virtual)f(void)h(add\(TypeCode_ptr)e(tc\);)130
4011 y(virtual)h(void)h(add_consume\(TypeCode_ptr)d(tc\);)130
4110 y(//)j(Consumes)f(<tc>.)130 4310 y(virtual)g(TypeCode_ptr)g
(item\(ULong)g(index\);)130 4409 y(//)h(Retains)g(ownership)f(of)h
(return)g(value.)130 4609 y(virtual)f(Status)h(remove\(ULong)e
(index\);)130 4808 y(static)h(ExceptionList_ptr)f
(_duplicate\(ExceptionList_ptr\);)130 4907 y(static)h
(ExceptionList_ptr)f(_nil\(\);)30 5007 y(};)30 5260 y
Fh(1)l(1.2.7)99 b(UnknownUserException)30 5437 y Fr(When)31
b(a)h(user)n(-de\002ned)d(exception)h(is)h(thr)n(own)g(by)g(an)h
(operation)e(it)h(is)h(unmarshalled)f(into)h(a)30 5550
y(value)d(of)f(type)e(Any)-10 b(.)43 b(This)28 b(is)g(encapsulated)e
(in)j(an)f Fn(UnknownUserExce)o(pti)o(on)o Fr(.)38 b(This)28
b(type)p eop
%%Page: 113 119
113 118 bop 150 100 a Fd(1)-5 b(1.3.)52 b(CREA)-7 b(TING)21
b(REQUESTS)2096 b Fr(1)-5 b(13)150 356 y(follows)26 b(all)i(the)d
(usual)h(r)o(ules)g(for)g(user)n(-de\002ned)d(exceptions)i(-)h(it)h(is)
f(not)f(a)i(pseudo)d(object,)i(and)150 469 y(its)c(r)n(esour)n(ces)g
(may)h(be)f(r)n(eleased)g(by)g(using)g Fn(delete)p Fr(.)150
673 y Fc(class)49 b(UnknownUserException)d(:)k(public)e(UserException)g
({)150 773 y(public:)250 872 y(UnknownUserException\(Any*)d(ex\);)250
972 y(//)k(Consumes)f(<ex>)h(which)g(MUST)g(be)h(a)f(UserException.)250
1171 y(virtual)f(\230UnknownUserException\(\);)250 1370
y(Any&)h(exception\(\);)250 1570 y(virtual)f(void)h(_raise\(\);)250
1669 y(static)f(const)h(UnknownUserException*)d(_downcast\(const)h
(Exception*\);)250 1769 y(static)h(UnknownUserException*)e
(_downcast\(Exception*\);)250 1869 y(static)i(UnknownUserException*)e
(_narrow\(Exception*\);)250 1968 y(//)j(_narrow)g(is)g(a)h(deprecated)e
(function)g(from)h(CORBA)g(2.2,)250 2068 y(//)g(use)g(_downcast)f
(instead.)150 2167 y(};)150 2427 y Fh(1)l(1.2.8)99 b(Environment)150
2606 y Fr(An)43 b Fn(Environment)38 b Fr(is)43 b(used)f(to)h(hold)f(an)
i(instance)f(of)g(a)h(system)d(exception)h(or)h(an)g
Fn(Un-)150 2719 y(knownUserExcept)o(io)o(n)p Fr(.)150
2923 y Fc(class)49 b(Environment)f({)250 3023 y(virtual)g(void)h
(exception\(Exception*\);)250 3122 y(virtual)f(Exception*)g
(exception\(\))g(const;)250 3222 y(virtual)g(void)h(clear\(\);)250
3421 y(static)f(Environment_ptr)f(_duplicate\(Environment_ptr\);)250
3521 y(static)h(Environment_ptr)f(_nil\(\);)150 3620
y(};)150 3924 y Fi(1)l(1.3)118 b(Creating)30 b(Requests)150
4137 y Fn(CORBA::Object)18 b Fr(de\002nes)j(thr)n(ee)i(methods)f(which)
i(may)g(be)f(used)f(to)h(cr)n(eate)g(a)h Fn(Request)d
Fr(ob-)150 4250 y(ject)i(which)g(may)g(be)f(used)f(to)h(perform)g(a)i
(single)e(operation)f(invocation)j(on)e(that)g(object:)150
4454 y Fc(class)49 b(Object)g({)250 4554 y(...)250 4653
y(Status)f(_create_request\(Context_ptr)d(ctx,)1395 4753
y(const)k(char*)g(operation,)1395 4852 y(NVList_ptr)f(arg_list,)1395
4952 y(NamedValue_ptr)g(result,)1395 5052 y(Request_out)g(request,)1395
5151 y(Flags)h(req_flags\);)250 5351 y(Status)f
(_create_request\(Context_ptr)d(ctx,)1395 5450 y(const)k(char*)g
(operation,)1395 5550 y(NVList_ptr)f(arg_list,)p eop
%%Page: 114 120
114 119 bop 30 100 a Fr(1)-5 b(14)839 b Fd(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)1275 356 y Fc(NamedValue_ptr)48 b(result,)1275
456 y(ExceptionList_ptr)f(exceptions,)1275 555 y(ContextList_ptr)g
(ctxlist,)1275 655 y(Request_out)h(request,)1275 754
y(Flags)h(req_flags\);)130 954 y(Request_ptr)e(_request\(const)h(char*)
g(operation\);)130 1053 y(...)30 1153 y(};)171 1368 y
Fn(operation)19 b Fr(is)k(the)f(name)h(of)g(the)f(operation)g(-)h
(which)g(is)g(the)f(same)h(as)g(the)f(name)h(given)g(in)30
1480 y(IDL.)f(T)-8 b(o)22 b(access)g(attributes)g(the)g(name)h(should)e
(be)i(pr)n(e\002xed)e(by)p 2324 1480 28 4 v 55 w Fn(get)p
2521 1480 V 54 w Fr(or)p 2684 1480 V 55 w Fn(set)p 2881
1480 V 32 w Fr(.)171 1594 y(In)26 b(the)f(\002rst)g(two)g(cases)g
(above)i(the)e(list)h(of)g(parameters)f(may)h(be)g(supplied.)36
b(If)26 b(the)f(param-)30 1707 y(eters)h(ar)n(e)i(not)f(supplied)f(in)j
(these)d(cases,)i(or)p 1663 1707 V 60 w Fn(request\(\))c
Fr(is)j(used)g(then)f(the)h(parameters)g(\(if)30 1820
y(any\))i(may)g(be)g(speci\002ed)e(using)h(the)g Fn(add)p
1529 1820 V 32 w(*)p 1616 1820 V 32 w(arg\(\))f Fr(methods)g(on)h(the)g
Fn(Request)p Fr(.)43 b(Y)-8 b(ou)28 b(must)30 1933 y(use)f(one)h
(method)f(or)h(the)g(other)f(-)i(not)f(a)h(mixtur)n(e)f(of)h(the)f
(two.)44 b(For)28 b Fq(in)p Fr(/)p Fq(inout)g Fr(ar)n(guments)g(the)30
2045 y(value)22 b(must)e(be)h(initialised,)h(for)f Fq(out)g
Fr(ar)n(guments)f(only)g(the)g(type)g(need)f(be)i(given.)27
b(Similarly)c(the)30 2158 y(type)f(of)h(the)f(r)n(esult)g(may)i(be)f
(speci\002ed)f(by)h(passing)f(a)i Fn(NamedValue)18 b
Fr(which)24 b(contains)f(an)h(Any)30 2271 y(which)g(has)f(been)f
(initialised)i(to)f(contain)g(a)h(value)g(of)f(that)g(type,)e(or)i(it)g
(may)h(be)f(speci\002ed)f(using)30 2384 y(the)g Fn(set)p
349 2384 V 31 w(return)p 710 2384 V 30 w(type\(\))e Fr(method)h(of)i
Fn(Request)p Fr(.)171 2497 y(When)31 b(using)p 702 2497
V 63 w Fn(create)p 1065 2497 V 30 w(request\(\))p Fr(,)e(the)h
(management)h(of)g(any)g(pseudo-object)e(r)n(efer)n(-)30
2610 y(ences)e(passed)g(in)i(r)n(emains)g(the)e(r)n(esponsibility)h(of)
g(the)g(application.)46 b(That)28 b(is,)i(the)d(values)i(ar)n(e)30
2723 y(not)22 b(consumed)g(-)h(and)g(must)f(be)h(r)n(eleased)f(using)g
Fn(CORBA::release\()o(\))p Fr(.)h(The)f(CORBA)h(spec-)30
2836 y(i\002cation)29 b(is)f(unclear)h(about)f(when)f(these)g(values)h
(may)h(be)f(r)n(eleased,)g(so)f(to)h(be)g(sur)n(e)f(of)h(porta-)30
2949 y(bility)f(do)e(not)g(r)n(elease)h(them)f(until)h(after)g(the)f(r)
n(equest)f(has)i(been)g(r)n(eleased.)36 b(V)-8 b(alues)25
b(which)i(ar)n(e)30 3062 y(not)22 b(needed)f(need)g(not)h(be)h
(supplied)f(-)h(so)f(if)i(no)e(parameters)g(ar)n(e)h(speci\002ed)f
(then)g(it)h(defaults)f(to)30 3175 y(an)h(empty)f(parameter)g(list.)29
b(If)23 b(no)g(r)n(esult)f(type)f(is)i(speci\002ed)f(then)g(it)h
(defaults)f(to)g(void.)29 b(A)23 b Fn(Con-)30 3288 y(text)f
Fr(need)h(only)g(be)h(given)g(if)g(a)h(non-empty)d Fn(ContextList)d
Fr(is)24 b(speci\002ed.)30 b(The)23 b Fn(req)p 3151 3288
V 31 w(flags)30 3401 y Fr(ar)n(gument)f(is)h(not)f(used)f(in)i(the)f
(C++)h(mapping.)30 3658 y Fh(1)l(1.3.1)99 b(Examples)30
3836 y Fr(An)22 b(operation)g(might)g(be)h(speci\002ed)e(in)i(IDL)g
(as:)30 4038 y Fc(short)49 b(anOpn\(in)f(string)h(a\);)30
4252 y Fr(An)22 b(operation)g(invocation)h(may)g(be)g(cr)n(eated)f(as)h
(follows:)30 4454 y Fc(CORBA::ORB_var)47 b(orb)i(=)h
(CORBA::ORB_init\(argc,)c(argv,)j("omniORB2"\);)30 4554
y(...)30 4653 y(CORBA::NVList_var)e(args;)30 4753 y
(orb->create_list\(1,)f(args\);)30 4852 y
(*\(args->add\(CORBA::ARG_IN\)->value\(\))o(\))e(<<=)49
b(\(const)g(char*\))g("Hello)f(World!";)30 5052 y
(CORBA::NamedValue_var)e(result;)30 5151 y
(orb->create_named_value\(result\);)30 5251 y
(result->value\(\)->replace\(CORBA::_tc)o(_short)o(,)e(0\);)30
5450 y(CORBA::Request_var)i(req)k(=)f
(obj->_create_request\(CORBA::Context::)o(_nil\()o(\),)2023
5550 y("anOpn",)f(args,)h(result,)f(0\);)p eop
%%Page: 115 121
115 120 bop 150 100 a Fd(1)-5 b(1.4.)52 b(INVOKING)21
b(OPERA)-7 b(TIONS)1965 b Fr(1)-5 b(15)150 356 y(or)22
b(alternatively)h(and)g(much)g(mor)n(e)g(concisely:)150
574 y Fc(CORBA::Request_var)46 b(req)k(=)f(obj->_request\("anOpn"\);)
150 674 y(req->add_in_arg\(\))e(<<=)i(\(const)g(char*\))f("Hello)h
(World!";)150 774 y(req->set_return_type\(CORBA::_tc_sho)o(rt\);)150
1092 y Fi(1)l(1.4)118 b(Invoking)31 b(Operations)150
1309 y Fr(Once)18 b(the)e Fn(Request)e Fr(object)j(has)h(been)e(pr)n
(operly)g(constr)o(ucted)g(the)g(operation)g(may)i(be)f(invoked)150
1422 y(by)23 b(calling)h(one)e(of)g(the)g(following)h(methods)e(on)h
(the)g(r)n(equest)f(object:)150 1680 y Fl(invoke\(\))90
b Fr(blocks)22 b(until)g(the)g(r)n(equest)e(has)i(completed.)k(The)21
b(application)i(should)e(then)g(test)g(to)150 1780 y(see)27
b(if)j(an)f(exception)e(was)i(raised.)45 b(Since)29 b(the)f(CORBA)g
(spec)g(is)h(not)f(clear)h(about)f(whether)f(or)150 1879
y(not)i(system)e(exceptions)h(should)g(be)i(thr)n(own)e(fr)n(om)i(this)
f(method,)h(a)f(r)o(untime)h(con\002guration)150 1979
y(variable)25 b(is)d(supplied)g(so)g(that)g(you)g(can)h(specify)f(the)g
(behavior:)150 2169 y Fc(namespace)48 b(omniORB)h({)250
2269 y(...)250 2369 y(CORBA::Boolean)e(diiThrowsSysExceptions;)250
2468 y(...)150 2568 y(};)291 2768 y Fr(If)38 b(this)g(is)g(F)-7
b(ALSE,)37 b(and)h(the)f(application)j(should)d(call)j(the)d
Fn(env\(\))f Fr(method)h(of)i(the)e(r)n(e-)150 2881 y(quest)43
b(to)h(r)n(etrieve)g(an)h(exception)e(\(it)i(r)n(eturns)f(0)h(\(nil\))h
(if)f(no)g(exception)e(was)h(generated\).)150 2994 y(If)k(it)f(is)h
(TRUE)e(then)h(system)f(exceptions)f(will)k(be)f(thr)n(own)e(out)h(of)h
Fn(invoke\(\))p Fr(.)99 b(User)n(-)150 3107 y(de\002ned)34
b(exceptions)g(ar)n(e)i(always)g(passed)e(via)k Fn(env\(\))p
Fr(,)e(which)g(will)i(r)n(eturn)c(a)j(pointer)d(to)i(a)150
3220 y Fn(CORBA::UnknownU)o(se)o(rE)o(xc)o(ept)o(io)o(n)p
Fr(.)55 b(The)33 b(application)h(can)h(determine)d(which)i(type)e(of)
150 3333 y(exception)21 b(was)h(r)n(eturned)f(by)h Fn(env\(\))e
Fr(by)i(calling)i(the)p 2101 3333 28 4 v 54 w Fn(narrow\(\))19
b Fr(method)i(de\002ned)g(for)h(each)150 3446 y(exception)f(type.)291
3562 y Fl(W)-8 b(ARNING!!)29 b Fr(In)23 b(pr)n(e-omniORB)g(2.8.0)i(r)n
(eleases,)d(the)g(default)h(value)h(of)f Fn(diiThrowsSy-)150
3675 y(sExceptions)18 b Fr(is)k(F)-7 b(ALSE.)21 b(Fr)n(om)i(omniORB)f
(2.8.0)i(onwar)n(ds,)e(the)f(default)i(value)g(is)g(TRUE.)291
3791 y(After)g(determining)f(that)h(no)f(exception)g(was)i(thr)n(own)e
(the)g(application)j(may)e(r)n(etrieve)g(any)150 3904
y(r)n(eturned)e(values)i(by)f(calling)j Fn(return)p 1556
3904 V 30 w(value\(\))19 b Fr(and)k Fn(arguments\(\))p
Fr(.)150 4175 y Fl(send)p 352 4175 V 33 w(oneway\(\))90
b Fr(has)30 b(the)f(same)g(semantics)g(as)h(a)g Fq(oneway)g
Fr(IDL)g(operation.)47 b(It)29 b(is)g(important)150 4288
y(to)21 b(note)g(that)h(oneway)f(operations)g(have)h(at-most-once)g
(semantics,)g(and)g(it)g(is)g(not)g(guaranteed)150 4401
y(that)h(they)f(will)i(not)f(block.)30 b(Any)22 b(operation)g(may)i(be)
f(invoked)f('oneway')h(using)g(the)f(DII,)h(even)150
4514 y(if)30 b(it)g(was)g(not)f(declar)n(ed)g(as)h('oneway')f(in)h
(IDL.)f(A)g(system)f(exception)g(may)i(be)g(generated,)f(in)150
4627 y(which)h(case)g(it)g(will)h(either)e(be)g(thr)n(own)g(or)h(may)g
(be)g(r)n(etrieved)e(using)h Fn(env\(\))f Fr(depending)f(on)150
4740 y Fn(diiThrowsSysExc)o(ep)o(ti)o(on)o(s)17 b Fr(as)22
b(above.)150 5011 y Fl(send)p 352 5011 V 33 w(deferred\(\))93
b Fr(initiates)33 b(the)f(invocation,)37 b(and)c(then)f(r)n(eturns)g
(without)g(waiting)i(for)f(the)150 5124 y(r)n(esult.)68
b(At)36 b(some)f(point)h(in)h(the)e(futur)n(e)h(the)g(application)h
(must)f(r)n(etrieve)f(the)h(r)n(esult)g(of)g(the)150
5236 y(operation)19 b(-)h(but)g(other)e(than)i(testing)e(for)i
(completion)f(of)h(the)f(operation)g(the)g(application)i(must)150
5349 y(not)h(call)i(any)f(of)g(the)e(r)n(equest's)g(methods)g(in)i(the)
f(meantime.)286 5550 y Fo(\017)46 b Fn(get)p 547 5550
V 32 w(response\(\))18 b Fr(blocks)k(until)h(the)f(r)n(eply)g(is)h(r)n
(eceived.)p eop
%%Page: 116 122
116 121 bop 30 100 a Fr(1)-5 b(16)839 b Fd(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)166 356 y Fo(\017)46 b Fn(poll)p 482
356 28 4 v 31 w(response\(\))23 b Fr(r)n(eturns)i(TRUE)h(if)i(the)e(r)n
(eply)h(has)g(been)f(r)n(eceived,)i(and)f(F)-7 b(ALSE)25
b(if)257 469 y(not.)i(It)22 b(does)f(not)h(block.)30
671 y(Once)30 b Fn(poll)p 493 671 V 31 w(response\(\))c
Fr(has)k(r)n(eturned)e(TRUE,)g(or)i Fn(get)p 2223 671
V 31 w(response\(\))c Fr(has)k(been)f(called)30 784 y(and)e(r)n
(eturned,)f(the)f(application)j(may)f(test)f(for)g(an)h(exception)f
(and)h(r)n(etrieve)f(r)n(eturned)f(values)30 897 y(as)33
b(above.)61 b(If)33 b Fn(diiThrowsSysExc)o(ept)o(io)o(ns)27
b Fr(is)33 b(tr)o(ue,)i(then)e(a)h(system)d(exception)h(may)i(be)30
1010 y(thr)n(own)26 b(fr)n(om)h Fn(get)p 743 1010 V 31
w(response\(\))p Fr(.)36 b(Fr)n(om)26 b(omniORB)h(2.8.0)g(onwar)n(ds,)g
Fn(poll)p 2879 1010 V 31 w(response\(\))30 1123 y Fr(will)33
b(raise)f(a)h(system)d(exception)h(if)i(one)e(has)h(occur)n(ed)f
(during)h(the)f(invocation.)57 b(Pr)n(eviously)-10 b(,)30
1236 y Fn(poll)p 255 1236 V 31 w(response\(\))15 b Fr(will)22
b(not)d(raise)h(an)g(exception,)f(so)g(if)i(polling,)f(the)f
(application)j(must)d(also)30 1349 y(call)i(another)e(method)f(to)h
(give)h(the)e(r)n(equest)g(an)i(opportunity)d(to)i(raise)h(the)e
(exception.)26 b(This)19 b(can)30 1461 y(be)k(one)e(of)i(the)f(methods)
f(to)h(r)n(etrieve)g(values)h(fr)n(om)g(the)f(r)n(equest,)e(or)j
Fn(get)p 2641 1461 V 31 w(response\(\))p Fr(.)30 1783
y Fi(1)l(1.5)118 b(Multiple)29 b(Requests)30 2001 y Fr(The)j(following)
i(methods)d(ar)n(e)i(pr)n(ovided)f(by)h(the)f(ORB)h(to)f(enable)i
(multiple)f(r)n(equests)e(to)h(be)30 2114 y(invoked)22
b(asynchr)n(onously)-10 b(.)30 2335 y Fc(namespace)48
b(CORBA)h({)130 2435 y(...)130 2534 y(class)f(ORB)i({)130
2634 y(public:)229 2734 y(...)229 2833 y(Status)f
(send_multiple_requests_oneway\(const)43 b(RequestSeq&\);)229
2933 y(Status)49 b(send_multiple_requests_deferred\(con)o(st)44
b(RequestSeq&\);)229 3032 y(Boolean)49 b(poll_next_response\(\);)229
3132 y(Status)g(get_next_response\(Request_out\);)229
3232 y(...)130 3331 y(};)130 3431 y(...)30 3531 y(};)30
3804 y Fl(send)p 232 3804 V 33 w(multiple)p 623 3804
V 33 w(requests)p 1003 3804 V 34 w(oneway\(\))91 b Fr(is)26
b(used)g(to)g(invoke)g(a)h(number)g(of)g(oneway)e(r)n(equests.)30
3917 y(An)17 b(attempt)f(will)j(be)e(made)h(to)e(invoke)h(each)h(of)g
(the)e(r)n(equests,)g(even)h(if)h(one)f(or)g(mor)n(e)g(of)h(the)e
(early)30 4030 y(r)n(equests)23 b(fails.)38 b(The)25
b(application)i(may)f(check)f(for)h(failur)n(e)g(of)g(any)g(of)f(the)g
(r)n(equests)e(by)j(testing)30 4143 y(the)c(r)n(equest's)f
Fn(env\(\))f Fr(method.)27 b(System)21 b(exceptions)f(ar)n(e)j(never)f
(raised)h(by)f(this)g(method.)30 4417 y Fl(send)p 232
4417 V 33 w(multiple)p 623 4417 V 33 w(requests)p 1003
4417 V 34 w(deferred\(\))93 b Fr(will)34 b(initiate)f(an)g(invocation)g
(of)g(each)g(of)f(the)g(given)30 4530 y(r)n(equests,)f(and)g(r)n(eturn)
g(without)f(waiting)i(for)f(the)f(r)n(eply)-10 b(.)53
b(At)31 b(some)f(point)h(in)h(the)e(futur)n(e)h(the)30
4643 y(application)23 b(must)e(r)n(etrieve)h(the)f(r)n(eply)g(by)h
(calling)h Fn(get)p 2022 4643 V 32 w(next)p 2274 4643
V 31 w(response\(\))p Fr(,)17 b(which)22 b(r)n(eturns)30
4756 y(a)32 b(completed)e(r)n(equest.)53 b(If)32 b(no)f(r)n(equests)f
(have)i(yet)e(completed)g(it)i(will)h(block.)55 b(This)31
b(method)30 4869 y(never)26 b(thr)n(ows)g(exceptions)f(-)i(the)f(r)n
(equest's)f Fn(env\(\))f Fr(method)i(must)g(be)h(used)e(to)h(determine)
f(if)30 4982 y(an)e(exception)e(was)i(generated.)j(If)c(not)g(then)g
(any)g(r)n(eturned)f(values)i(may)g(then)f(be)h(queried.)171
5098 y Fn(poll)p 396 5098 V 31 w(next)p 647 5098 V 31
w(response\(\))44 b Fr(r)n(eturns)j(TRUE)g(if)i(ther)n(e)e(ar)n(e)h
(any)h(completed)d(r)n(equests,)30 5211 y(and)38 b(F)-7
b(ALSE)35 b(otherwise,)40 b(without)c(blocking.)73 b(If)37
b(this)g(r)n(eturns)g(tr)o(ue)f(then)h(the)g(next)f(call)k(to)30
5324 y Fn(get)p 200 5324 V 31 w(next)p 451 5324 V 31
w(response\(\))20 b Fr(will)26 b(not)e(block.)34 b(However)-7
b(,)24 b(if)h(another)f(thr)n(ead)g(may)h(also)g(be)f(call-)30
5437 y(ing)33 b Fn(get)p 363 5437 V 32 w(next)p 615 5437
V 31 w(response\(\))c Fr(then)j(it)i(could)f(r)n(etrieve)g(the)f
(completed)g(message)g(\002rst)h(-)h(in)30 5550 y(which)23
b(case)g(this)f(thr)n(ead)g(might)h(block.)p eop
%%Page: 117 123
117 122 bop 150 100 a Fd(1)-5 b(1.5.)52 b(MUL)-7 b(TIPLE)20
b(REQUESTS)2114 b Fr(1)-5 b(17)291 356 y(Ther)n(e)19
b(ar)n(e)h(no)f(guarantee)g(as)h(to)f(the)g(or)n(der)f(in)i(which)h(r)n
(eplies)e(will)i(be)e(r)n(eceived.)27 b(If)20 b(multiple)150
469 y(thr)n(eads)f(ar)n(e)g(using)g(this)g(interface)h(then)f(it)g(is)h
(not)f(even)g(guaranteed)f(that)h(a)h(thr)n(ead)f(will)i(r)n(eceive)150
582 y(r)n(eplies)j(to)g(the)g(r)n(equests)e(it)j(sent.)33
b(Any)24 b(thr)n(ead)g(may)h(r)n(eceive)g(r)n(eplies)f(to)g(r)n
(equests)e(sent)i(by)g(any)150 695 y(other)k(thr)n(ead.)46
b(It)28 b(is)h(legal)g(to)f(call)j Fn(get)p 1572 695
28 4 v 31 w(next)p 1823 695 V 31 w(response\(\))25 b
Fr(even)j(if)i(no)e(r)n(equests)f(have)i(yet)150 808
y(been)24 b(invoked)f(-)i(in)g(which)f(case)h(the)e(calling)j(thr)n
(ead)e(blocks)g(until)h(another)e(thr)n(ead)h(invokes)g(a)150
920 y(r)n(equest)d(and)i(the)e(r)n(eply)i(is)f(r)n(eceived.)p
eop
%%Page: 118 124
118 123 bop 30 100 a Fr(1)-5 b(18)839 b Fd(CHAPTER)21
b(1)-5 b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22
b(INTERF)-7 b(ACE)p eop
%%Page: 119 125
119 124 bop 150 981 a Fk(Chapter)44 b(12)150 1398 y Fm(The)52
b(Dynamic)f(Skeleton)h(Interface)150 1862 y Fr(The)32
b(Dynamic)h(Skeleton)e(Interface)h(\(or)g(DSI\))g(allows)h
(applications)g(to)f(pr)n(ovide)g(implemen-)150 1974
y(tations)27 b(of)h(the)f(operations)f(on)i(CORBA)f(objects)h(without)e
(static)i(knowledge)e(of)h(the)g(object's)150 2087 y(interface.)h(It)22
b(is)h(the)f(server)n(-side)f(equivalent)i(of)f(the)g(Dynamic)i
(Invocation)f(Interface.)291 2202 y(This)36 b(chapter)f(pr)n(esents)f
(the)h(Dynamic)i(Skeleton)d(Interface)h(and)h(explains)g(how)f(to)g
(use)150 2315 y(it.)90 b(An)43 b(toy)g(example)g(use)f(of)i(the)e(DSI)h
(can)i(be)e(found)f(in)i(the)f(omniORB2)h(distribution)150
2428 y(in)35 b(the)f Fn(<top>/src/exampl)o(es)o(/d)o(si)28
b Fr(dir)n(ectory)-10 b(.)64 b(For)34 b(further)g(information)h(r)n
(efer)g(to)f(the)150 2541 y(Dynamic)j(Skeleton)c(Interface)i(and)g(C++)
h(Mapping)f(sections)f(of)i(the)e(CORBA)h(2)h(speci\002ca-)150
2654 y(tion)22 b([OMG99a)s(].)291 2769 y(The)k(DSI)g(interface)h(has)f
(changed)g(in)h(CORBA)f(2.3.)41 b(The)25 b(implementation)i(described)e
(be-)150 2882 y(low)e(conforms)f(to)g(CORBA)h(2.1)g(or)f(2.2.)150
3193 y Fi(12.1)119 b(Overview)150 3409 y Fr(When)23 b(an)h(ORB)g(r)n
(eceives)g(an)g(invocation)h(r)n(equest,)d(the)h(information)h
(includes)g(the)f(object)h(r)n(ef-)150 3522 y(er)n(ence)h(and)h(the)f
(name)h(of)g(the)f(operation.)37 b(T)-8 b(ypically)26
b(this)g(information)g(is)g(used)e(by)i(the)f(ORB)150
3635 y(to)32 b(select)h(an)g(instance)g(of)g(an)h(object)f(and)g(call)i
(into)e(the)f(implementation)h(of)g(the)f(operation)150
3747 y(\(which)d(knows)e(how)h(to)g(unmarshal)h(the)f(parameters)g
(etc.\).)44 b(The)28 b(Dynamic)i(Skeleton)d(Inter)n(-)150
3860 y(face)i(however)d(makes)i(this)g(information)g(dir)n(ectly)g
(available)j(to)c(the)g(application)j(-)e(so)f(that)h(it)150
3973 y(can)19 b(implement)e(the)g(operation)g(\(or)g(pass)g(it)h(on)g
(to)f(another)g(server\))g(without)g(static)g(knowledge)150
4086 y(of)22 b(the)g(interface.)28 b(In)22 b(fact)h(it)f(is)h(not)e
(even)h(necessary)f(for)h(the)f(server)g(to)h(always)h(implement)f(the)
150 4199 y(same)h(interface)f(on)h(any)f(particular)i(object!)291
4314 y(T)-8 b(o)30 b(pr)n(ovide)g(an)h(implementation)g(for)g(one)f(or)
g(mor)n(e)h(objects)f(an)h(application)h(must)e(sub-)150
4427 y(class)e Fn(DynamicImplemen)o(tat)o(io)o(n)22 b
Fr(and)27 b(override)g(the)g(method)g Fn(invoke\(\))p
Fr(.)40 b(An)27 b(instance)150 4540 y(of)20 b(this)g(class)h(is)f(r)n
(egister)n(ed)e(with)j(the)e(BOA)h(and)g(is)h(assigned)e(an)h(object)g
(r)n(efer)n(ence)g(\(see)f(below\).)150 4653 y(When)25
b(the)g(ORB)h(r)n(eceives)g(a)g(r)n(equest)f(for)h(that)f(object)h(the)
f Fn(invoke\(\))e Fr(method)h(is)i(called)h(and)150 4766
y(will)d(be)e(passed)f(a)j Fn(ServerRequest)16 b Fr(object)23
b(which)g(pr)n(ovides:)286 4962 y Fo(\017)46 b Fr(the)22
b(operation)g(name)286 5158 y Fo(\017)46 b Fr(context)22
b(strings)286 5354 y Fo(\017)46 b Fr(access)23 b(to)f(the)g(parameters)
286 5550 y Fo(\017)46 b Fr(a)23 b(way)g(to)f(set)f(the)h(r)n(eturned)f
(values)1794 5778 y(1)-5 b(19)p eop
%%Page: 120 126
120 125 bop 30 100 a Fr(120)952 b Fd(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)166
356 y Fo(\017)46 b Fr(a)23 b(way)g(to)f(thr)n(ow)g(user)n(-de\002ned)e
(exceptions.)30 667 y Fi(12.2)119 b(DSI)29 b(T)-11 b(ypes)30
885 y Fh(12.2.1)99 b(DynamicImplementation)30 1066 y
Fr(This)30 b(class)h(must)f(be)h(sub-classed)f(by)g(the)g(application)i
(to)e(pr)n(ovide)g(an)h(implementation)f(for)30 1179
y(DSI)22 b(objects.)28 b(The)22 b(method)f Fn(invoke\(\))e
Fr(will)24 b(be)e(called)i(for)e(each)h(operation)f(invocation.)30
1390 y Fc(namespace)48 b(CORBA)h({)130 1490 y(...)130
1590 y(class)f(BOA)i({)229 1689 y(...)229 1789 y(class)f
(DynamicImplementation)d({)229 1888 y(public:)329 1988
y(DynamicImplementation\(\);)329 2088 y(virtual)i
(\230DynamicImplementation\(\);)329 2287 y(virtual)g(void)h
(invoke\(ServerRequest_ptr)d(request,)1325 2387 y(Environment&)i(env\))
h(throw\(\))f(=)i(0;)229 2586 y(protected:)329 2685 y(Object_ptr)e
(_this\(\);)329 2785 y(//)h(Must)g(only)g(be)h(called)f(from)g(within)f
(invoke\(\).)g(Caller)h(must)g(release)329 2885 y(//)g(the)h(reference)
e(returned.)329 3084 y(BOA_ptr)g(_boa\(\);)329 3184 y(//)h(Must)g(only)
g(be)h(called)f(from)g(within)f(invoke\(\).)g(Caller)h(must)g(NOT)329
3283 y(//)g(release)g(the)g(reference)f(returned.)229
3383 y(};)229 3482 y(...)130 3582 y(};)130 3682 y(...)30
3781 y(};)30 4048 y Fh(12.2.2)99 b(ServerRequest)30 4229
y Fr(A)22 b Fn(ServerRequest)16 b Fr(object)22 b(pr)n(ovides)f(the)g
(interface)i(between)d(a)j(dynamic)f(implementation)30
4342 y(and)h(the)e(ORB.)30 4554 y Fc(namespace)48 b(CORBA)h({)130
4653 y(...)130 4753 y(class)f(ServerRequest)g({)130 4852
y(public:)229 4952 y(virtual)h(const)g(char*)298 b(op_name\(\);)229
5052 y(virtual)49 b(OperationDef_ptr)e(op_def\(\);)229
5151 y(virtual)i(Context_ptr)297 b(ctx\(\);)229 5251
y(virtual)49 b(void)647 b(params\(NVList_ptr)46 b(parameters\);)229
5351 y(virtual)j(void)647 b(result\(Any*)47 b(value\);)229
5450 y(virtual)i(void)647 b(exception\(Any*)47 b(value\);)p
eop
%%Page: 121 127
121 126 bop 150 100 a Fd(12.3.)52 b(CREA)-7 b(TING)21
b(DYNAMIC)i(IMPLEMENT)-7 b(A)g(TIONS)1174 b Fr(121)349
356 y Fc(static)49 b(ServerRequest_ptr)e
(_duplicate\(ServerRequest_ptr\);)349 456 y(static)i(ServerRequest_ptr)
e(_nil\(\);)250 555 y(};)250 655 y(...)150 754 y(};)150
1060 y Fi(12.3)119 b(Creating)29 b(Dynamic)h(Implementations)150
1273 y Fr(The)21 b(application)h(must)f(override)f(the)h
Fn(invoke\(\))c Fr(method)j(of)i Fn(DynamicImpleme)o(nt)o(at)o(io)o(n)
150 1386 y Fr(to)g(pr)n(ovide)g(an)h(implementation)g(for)f(DSI)h
(objects.)k(This)22 b(method)g(must)g(behave)g(as)h(follows:)286
1605 y Fo(\017)46 b Fr(It)26 b(may)g(be)g(called)h(concurr)n(ently)e
(by)h(multiple)h(thr)n(eads)e(of)h(execution,)f(and)h(so)g(must)f(be)
377 1717 y(thr)n(ead-safe.)286 1910 y Fo(\017)46 b Fr(It)23
b(may)h(not)e(thr)n(ow)h(any)g(exceptions.)29 b(User)n(-de\002ned)21
b(exceptions)g(ar)n(e)j(passed)e(in)h(a)h(value)377 2023
y(of)i(type)e(Any)h(and)h(given)f(to)h Fn(ServerRequest:)o(:e)o(xc)o
(ep)o(tio)o(n\()o(\))p Fr(.)31 b(In)25 b(pr)n(e-omniORB)377
2135 y(2.8.0)32 b(r)n(eleases,)f(system)e(exceptions)g(may)i(be)g
(passed)e(via)j(the)e Fn(env)f Fr(parameter)-7 b(.)52
b(Fr)n(om)377 2248 y(omniORB)35 b(2.8.0)h(onwar)n(ds,)h(system)c
(exceptions)g(can)j(be)f(inserted)e(into)i(an)g(Any)f(and)377
2361 y(given)j(to)f Fn(ServerRequest:)o(:ex)o(ce)o(pt)o(io)o(n\()o(\))
31 b Fr(in)37 b(the)f(same)g(way)h(as)f(user)n(-de\002ned)377
2474 y(exceptions.)51 b(Since)31 b(the)e(methods)g(pr)n(ovided)h(by)h
Fn(ServerRequest)25 b Fr(may)31 b(thr)n(ow)f(sys-)377
2587 y(tem)35 b(exceptions,)i(the)e(application)i(must)e(catch)h(any)g
(such)f(exception,)i(passed)d(it)i(via)377 2700 y Fn(ServerRequest::)o
(exc)o(ep)o(ti)o(on)o(\(\))o Fr(.)286 2892 y Fo(\017)46
b Fr(The)20 b(operations)f(on)h(the)g Fn(ServerRequest)15
b Fr(object)20 b(must)g(be)h(carried)g(out)e(in)j(the)d(corr)n(ect)377
3005 y(or)n(der)-7 b(,)22 b(as)h(described)e(below)-8
b(.)150 3267 y Fh(12.3.1)99 b(Operations)25 b(on)g(the)g(ServerRequest)
150 3446 y Fn(op)p 265 3446 28 4 v 32 w(name\(\))32 b
Fr(will)k(r)n(eturn)e(the)g(name)h(of)g(the)f(operation,)i(and)f(may)g
(be)g(called)h(at)f(any)f(time.)150 3559 y(For)26 b(attribute)g(access)
h(the)f(operation)g(name)h(is)g(the)f(IDL)g(name)h(of)g(the)f
(attribute,)h(pr)n(e\002xed)e(by)p 150 3672 V 177 3672
a Fn(get)p 347 3672 V 59 w Fr(or)p 519 3672 V 60 w Fn(set)p
717 3672 V 31 w Fr(.)42 b(If)27 b(the)f(operation)g(name)i(is)f(not)f
(r)n(ecognised)g(a)i Fn(CORBA::BAD)p 3056 3672 V 28 w(OPERATION)150
3785 y Fr(exception)23 b(should)h(be)g(passed)f(back)j(thr)n(ough)d
Fn(env)p Fr(.)32 b(This)25 b(will)h(allow)f(the)f(ORB)g(to)g(then)g
(see)f(if)150 3898 y(it)g(is)g(one)e(of)i(the)f(standar)n(d)g(object)g
(operations.)291 4012 y(Firstly)i Fn(params\(\))c Fr(must)k(be)g
(called)i(passing)d(a)i Fn(CORBA::NVList)2759 3979 y
Fj(1)2815 4012 y Fr(which)g(must)f(be)g(ini-)150 4125
y(tialised)19 b(to)f(contain)i(the)e(type)f(and)i(mode)f(of)h(the)g
(parameters.)25 b(The)18 b(ORB)h(consumes)f(this)g(value)150
4238 y(and)29 b(will)i(r)n(elease)e(it)g(when)g(the)g(operation)f(is)h
(complete.)47 b(At)29 b(this)g(point)g(any)g Fq(in)p
Fr(/)p Fq(inout)h Fr(ar)n(gu-)150 4350 y(ments)d(will)i(be)f
(unmarshalled,)h(and)f(when)f(this)g(operation)g(r)n(eturns)f(their)i
(values)g(will)h(be)f(in)150 4463 y(the)23 b Fn(NVList)p
Fr(.)29 b(The)24 b(application)h(may)f(set)f(the)g(value)i(of)f
Fq(inout)p Fr(/)p Fq(out)g Fr(ar)n(guments)f(by)h(modifying)150
4576 y(this)e(parameter)g(list.)291 4690 y(If)36 b(the)f(operation)g
(has)h(user)n(-context)e(information,)40 b(then)35 b
Fn(ctx\(\))e Fr(must)j(be)f(called)i(after)150 4803 y
Fn(params\(\))19 b Fr(to)j(r)n(etrieve)g(it.)291 4917
y Fn(result\(\))d Fr(must)i(then)g(be)h(called)h(exactly)f(once)f(if)i
(the)e(operation)g(has)h(a)g(non-void)g(r)n(eturn)150
5030 y(value)27 b(\(unless)f(an)h(exception)e(is)h(thr)n(own\).)39
b(The)25 b(value)j(passed)c(should)i(be)g(an)h(Any)e(allocated)150
5143 y(with)e Fn(new)p Fr(,)e(and)h(will)i(be)f(fr)n(eed)f(by)g(the)g
(ORB.)291 5257 y(At)32 b(any)h(point)f(in)h(the)e(above)i(sequence)e
Fn(exception\(\))c Fr(may)33 b(be)g(called)g(to)f(set)f(a)j(user)n(-)
150 5370 y(de\002ned)27 b(exception)g(or)h(a)i(system)c(exception.)45
b(If)28 b(this)h(happens)e(then)h(no)g(further)g(operations)p
150 5462 1368 4 v 255 5518 a Fg(1)284 5550 y Ff(obtained)20
b(by)e(calling)h Fb(CORBA::ORB::create)p 1749 5550 23
4 v 24 w(list\(\))p eop
%%Page: 122 128
122 127 bop 30 100 a Fr(122)952 b Fd(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)30
356 y Fr(should)19 b(be)g(invoked)g(on)g(the)g Fn(ServerRequest)14
b Fr(object,)19 b(and)h(the)f Fn(invoke\(\))d Fr(method)i(should)30
469 y(r)n(eturn.)171 582 y(W)-5 b(ithin)29 b(the)f Fn(invoke\(\))d
Fr(method)p 1439 582 28 4 v 60 w Fn(this\(\))h Fr(and)p
2011 582 V 61 w Fn(boa\(\))g Fr(may)j(be)g(called)g(to)f(obtain)h(the)
30 695 y(object)f(r)n(efer)n(ence)f(and)h(BOA)f(r)n(efer)n(ence)h(r)n
(espectively)-10 b(.)42 b(These)26 b(methods)g(may)j(not)e(be)g(used)g
(at)30 808 y(any)c(other)e(time.)30 1106 y Fi(12.4)119
b(Registering)30 b(Dynamic)f(Objects)30 1316 y Fr(T)-8
b(o)20 b(use)h(a)h Fn(DynamicImpleme)o(nt)o(at)o(ion)14
b Fr(a)22 b(CORBA)g(object)f(must)f(be)i(cr)n(eated)e(and)i(associated)
30 1429 y(with)f(the)f(implementation.)28 b(The)20 b(way)h(in)h(which)g
(this)e(is)i(done)e(is)h(not)f(de\002ned)g(by)h(the)f(CORBA)30
1542 y(2.0)j(speci\002cation,)g(so)f(the)g(following)g(method)g(is)g
(omniORB2)i(speci\002c:)30 1737 y Fc(namespace)48 b(CORBA)h({)130
1837 y(...)130 1937 y(class)f(BOA)i({)229 2036 y(...)229
2136 y(Object_ptr)e(create_dynamic_object\(DynamicImpleme)o(ntatio)o
(n_ptr)43 b(dir,)1873 2235 y(const)49 b(char*)g(intfRepoId\);)229
2335 y(...)130 2435 y(};)130 2534 y(...)30 2634 y(};)171
2842 y Fr(Ownership)33 b(of)g(the)g Fn(DynamicImplemen)o(ta)o(ti)o(on)
27 b Fr(object)33 b(is)h(taken)e(over)i(by)f(the)g(ORB,)30
2955 y(and)f(it)g(will)h(be)f(deleted)d(when)i(associated)g(the)g
(object)h(is)g(destr)n(oyed.)52 b(The)31 b(r)n(eturned)f(object)30
3068 y(may)j(then)f(be)h(enter)n(ed)e(into)h(the)g(object)h(table)g
(with)g(a)g(call)i(to)d Fn(BOA::obj)p 2785 3068 V 29
w(is)p 2924 3068 V 32 w(ready\(\))e Fr(as)30 3181 y(usual,)23
b(and)f(will)i(then)e(start)g(accepting)g(operation)g(invocations.)171
3294 y(For)j(some)f(applications)j(it)e(will)i(not)e(be)g(possible)g
(to)g(r)n(egister)f(all)j(DSI)e(objects)g(in)h(advance)30
3407 y(of)c(invocations)g(arriving.)29 b(In)21 b(this)g(case)h(DSI)g
(objects)f(can)i(be)e(cr)n(eated)g(on)h(demand)f(in)h(the)f(same)30
3520 y(way)i(as)f(normal)i(objects)e(-)h(see)e(section)h(5.6.)30
3818 y Fi(12.5)119 b(Example)30 4028 y Fr(This)36 b(implementation)g
(of)g Fn(DynamicImplemen)o(ta)o(ti)o(on:)o(:i)o(nv)o(ok)o(e\()o(\))30
b Fr(is)37 b(taken)e(fr)n(om)i(an)30 4141 y(example)59
b(which)g(can)h(be)f(found)f(in)h(the)g(omniORB2)g(distribution.)136
b(The)58 b(operation)30 4254 y(\223echoString\224)22
b(is)h(declar)n(ed)f(in)i(IDL)e(as:)30 4449 y Fc(string)49
b(echoString\(in)e(string)i(mesg\);)30 4657 y Fr(Her)n(e)22
b(is)g(the)g(Dynamic)i(Implementation)e(Routine:)30 4852
y Fc(void)30 4952 y(MyDynImpl::invoke\(CORBA::ServerRequ)o(est_pt)o(r)
44 b(re-)30 5052 y(quest,)49 b(CORBA::Environment&)d(env\))130
5151 y(throw\(\))30 5251 y({)130 5351 y(try)j({)229 5450
y(if\()g(strcmp\(request->op_name\(\),)c("echoString"\))j(\))329
5550 y(throw)h(CORBA::BAD_OPERATION\(0,)c(CORBA::COMPLETED_NO\);)p
eop
%%Page: 123 129
123 128 bop 150 100 a Fd(12.5.)52 b(EXAMPLE)2610 b Fr(123)349
456 y Fc(CORBA::NVList_ptr)47 b(args;)349 555 y(orb->create_list\(0,)g
(args\);)349 655 y(CORBA::Any)h(a;)349 754 y
(a.replace\(CORBA::_tc_string,)d(0\);)349 854 y(args->add_value\("",)i
(a,)i(CORBA::ARG_IN\);)349 1053 y(request->params\(args\);)349
1253 y(CORBA::Any&)f(input_any)g(=)i(*\(args->item\(0\)->value\(\)\);)
349 1352 y(CORBA::String_var)d(input;)349 1452 y(input_any)h(>>=)i
(input.out\(\);)349 1651 y(CORBA::Any*)e(result)h(=)g(new)h
(CORBA::Any\(\);)349 1751 y(*result)f(<<=)g
(CORBA::Any::from_string\(input._retn)o(\(\),)44 b(0\);)349
1850 y(request->result\(result\);)250 1950 y(})250 2050
y(catch\(CORBA::Exception&)h(ex\))k({)349 2149 y(CORBA::Any*)f(v)i(=)f
(new)h(CORBA::Any;)349 2249 y(::operator<<=\(*v,ex\);)349
2348 y(request->exception\(v\);)250 2448 y(})250 2548
y(//)f(In)h(pre-omniORB)d(2.8.0,)i(one)g(has)g(to)h(do)f(this:)250
2647 y(//)99 b(catch\(CORBA::SystemException&)44 b(ex\){)250
2747 y(//)99 b(env.exception\(CORBA::Exception::_du)o(plica)o(te\(&e)o
(x\)\);)250 2847 y(//)g(})250 2946 y(catch\(...\){)349
3046 y(cout)49 b(<<)h("echo_dsiimpl:)d(MyDynImpl::invoke)g(-)i(caught)g
(an")549 3145 y(")g(unknown)g(exception.")e(<<)j(endl;)349
3245 y(env.exception\(new)d(CORBA::UNKNOWN\(0,)g
(CORBA::COMPLETED_NO\)\);)250 3345 y(})150 3444 y(})p
eop
%%Page: 124 130
124 129 bop 30 100 a Fr(124)952 b Fd(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)p
eop
%%Page: 125 131
125 130 bop 150 980 a Fk(Appendix)44 b(A)150 1397 y Fm(hosts)p
656 1397 62 4 v 74 w(access\(5\))150 1847 y Fh(DESCRIPTION)150
2027 y Fr(This)29 b(manual)i(page)d(describes)g(a)i(simple)f(access)g
(contr)n(ol)h(language)f(that)g(is)g(based)g(on)g(client)150
2140 y(\(host)22 b(name/addr)n(ess,)g(user)g(name\),)h(and)h(server)e
(\(pr)n(ocess)g(name,)h(host)f(name/addr)n(ess\))g(pat-)150
2253 y(terns.)41 b(Examples)27 b(ar)n(e)h(given)f(at)h(the)e(end.)42
b(The)26 b(impatient)i(r)n(eader)f(is)g(encouraged)f(to)h(skip)g(to)150
2366 y(the)22 b(EXAMPLES)e(section)i(for)h(a)g(quick)g(intr)n
(oduction.)291 2480 y(An)65 b(extended)e(version)i(of)g(the)g(access)g
(contr)n(ol)g(language)g(is)h(described)e(in)i(the)150
2593 y(hosts)p 366 2593 28 4 v 31 w(options\(5\))29 b(document.)48
b(The)29 b(extensions)f(ar)n(e)i(turned)e(on)i(at)f(pr)n(ogram)h(build)
g(time)g(by)150 2706 y(building)23 b(with)g(-DPROCESS)p
1232 2706 V 33 w(OPTIONS.)291 2820 y(In)c(the)g(following)h(text,)e
Fq(daemon)i Fr(is)g(the)f(the)f(pr)n(ocess)g(name)i(of)f(a)h(network)e
(daemon)h(pr)n(ocess,)150 2933 y(and)25 b Fq(client)g
Fr(is)g(the)f(name)h(and/or)f(addr)n(ess)f(of)i(a)g(host)f(r)n
(equesting)f(service.)33 b(Network)23 b(daemon)150 3046
y(pr)n(ocess)e(names)i(ar)n(e)g(speci\002ed)e(in)i(the)f(inetd)g
(con\002guration)g(\002le.)150 3311 y Fh(ACCESS)i(CONTROL)h(FILES)150
3491 y Fr(The)d(access)g(contr)n(ol)h(softwar)n(e)f(consults)g(two)f
(\002les.)28 b(The)22 b(sear)n(ch)h(stops)d(at)j(the)f(\002rst)g
(match:)286 3712 y Fo(\017)46 b Fr(Access)37 b(will)h(be)f(granted)f
(when)h(a)h(\(daemon,client\))f(pair)h(matches)f(an)g(entry)f(in)i(the)
377 3824 y Fn(/etc/hosts.allo)o(w)17 b Fr(\002le.)286
4018 y Fo(\017)46 b Fr(Otherwise,)24 b(access)h(will)h(be)f(denied)e
(when)h(a)h(\(daemon,client\))g(pair)h(matches)e(an)h(entry)377
4131 y(in)e(the)f Fn(/etc/hosts.deny)16 b Fr(\002le.)286
4325 y Fo(\017)46 b Fr(Otherwise,)22 b(access)g(will)i(be)f(granted.)
291 4546 y(A)f(non-existing)f(access)g(contr)n(ol)h(\002le)g(is)g(tr)n
(eated)f(as)h(if)g(it)h(wer)n(e)e(an)h(empty)f(\002le.)27
b(Thus,)21 b(access)150 4659 y(contr)n(ol)i(can)g(be)g(turned)e(of)n(f)
i(by)g(pr)n(oviding)f(no)g(access)h(contr)n(ol)g(\002les.)150
4923 y Fh(ACCESS)h(CONTROL)h(RULES)150 5103 y Fr(Each)d(access)f(contr)
n(ol)g(\002le)g(consists)f(of)h(zer)n(o)h(or)e(mor)n(e)h(lines)h(of)f
(text.)26 b(These)20 b(lines)h(ar)n(e)g(pr)n(ocessed)150
5216 y(in)i(or)n(der)f(of)g(appearance.)28 b(The)22 b(sear)n(ch)h
(terminates)f(when)f(a)j(match)f(is)g(found.)286 5437
y Fo(\017)46 b Fr(A)35 b(newline)f(character)h(is)g(ignor)n(ed)e(when)h
(it)h(is)f(pr)n(eceded)f(by)h(a)h(backslash)g(character)-7
b(.)377 5550 y(This)23 b(permits)e(you)h(to)g(br)n(eak)h(up)f(long)g
(lines)h(so)f(that)g(they)g(ar)n(e)h(easier)f(to)g(edit.)1792
5778 y(125)p eop
%%Page: 126 132
126 131 bop 30 100 a Fr(126)1862 b Fd(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))166 356 y
Fo(\017)h Fr(Blank)26 b(lines)f(or)g(lines)h(that)f(begin)g(with)g(a)h
Fn(#)f Fr(character)h(ar)n(e)g(ignor)n(ed.)35 b(This)25
b(permits)g(you)257 469 y(to)d(insert)g(comments)g(and)h(whitespace)e
(so)h(that)g(the)g(tables)h(ar)n(e)g(easier)f(to)g(r)n(ead.)166
676 y Fo(\017)46 b Fr(All)27 b(other)e(lines)h(should)f(satisfy)h(the)f
(following)h(format,)h(things)e(between)g([])i(being)e(op-)257
789 y(tional:)k Fn(daemon)p 874 789 V 30 w(list)52 b(:)109
b(client)p 1670 789 V 30 w(list)53 b([)h(:)109 b(shell)p
2521 789 V 30 w(command)51 b(])171 1026 y(daemon)p 506
1026 V 30 w(list)27 b Fr(is)h(a)h(list)f(of)g(one)g(or)g(mor)n(e)g
(daemon)f(pr)n(ocess)g(names)h(\(ar)n(gv[0])j(values\))d(or)30
1139 y(wildcar)n(ds)23 b(\(see)f(below\).)171 1257 y
Fn(client)p 506 1257 V 30 w(list)c Fr(is)i(a)g(list)g(of)g(one)f(or)g
(mor)n(e)h(host)e(names,)i(host)e(addr)n(esses,)g(patterns)g(or)h
(wild-)30 1370 y(car)n(ds)k(\(see)f(below\))g(that)h(will)h(be)e
(matched)h(against)f(the)g(client)h(host)f(name)h(or)f(addr)n(ess.)171
1487 y(The)d(mor)n(e)h(complex)g(forms)g Fn(daemon@host)15
b Fr(and)20 b Fn(user@host)c Fr(ar)n(e)k(explained)g(in)g(the)f(sec-)30
1600 y(tions)j(on)g(server)g(endpoint)f(patterns)g(and)h(on)h(client)g
(username)e(lookups,)g(r)n(espectively)-10 b(.)171 1718
y(List)22 b(elements)f(should)h(be)g(separated)f(by)i(blanks)g(and/or)f
(commas.)171 1836 y(W)-5 b(ith)20 b(the)f(exception)f(of)i(NIS)f
(\(YP\))g(netgr)n(oup)f(lookups,)h(all)i(access)e(contr)n(ol)h(checks)f
(ar)n(e)h(case)30 1949 y(insensitive.)30 2234 y Fh(P)-7
b(A)e(TTERNS)30 2420 y Fr(The)22 b(access)g(contr)n(ol)h(language)g
(implements)f(the)f(following)i(patterns:)166 2657 y
Fo(\017)46 b Fr(A)36 b(string)e(that)i(begins)f(with)g(a)h
Fn(.)67 b Fr(character)-7 b(.)68 b(A)35 b(host)g(name)h(is)f(matched)h
(if)g(the)f(last)257 2770 y(components)27 b(of)i(its)g(name)g(match)h
(the)e(speci\002ed)g(pattern.)46 b(For)28 b(example,)i(the)e(pattern)
257 2883 y Fn(.tue.nl)20 b Fr(matches)i(the)g(host)g(name)g
Fn(wzv.win.tue.nl)p Fr(.)166 3090 y Fo(\017)46 b Fr(A)35
b(string)g(that)g(ends)f(with)h(a)h Fn(.)66 b Fr(character)-7
b(.)67 b(A)35 b(host)f(addr)n(ess)g(is)h(matched)h(if)g(its)f(\002rst)
257 3203 y(numeric)k(\002elds)f(match)i(the)d(given)i(string.)75
b(For)38 b(example,)k(the)c(pattern)g Fn(131.155.)257
3316 y Fr(matches)33 b(the)g(addr)n(ess)e(of)j(\(almost\))g(every)e
(host)g(on)h(the)f(Eindhoven)g(University)h(net-)257
3429 y(work)22 b(\()p Fn(131.155.x.x)p Fr(\).)166 3636
y Fo(\017)46 b Fr(A)30 b(string)f(that)g(begins)g(with)h(an)60
b(character)30 b(is)g(tr)n(eated)f(as)g(an)i(NIS)d(\(formerly)i(YP\))g
(net-)257 3749 y(gr)n(oup)j(name.)62 b(A)33 b(host)g(name)h(is)g
(matched)f(if)i(it)f(is)g(a)g(host)f(member)h(of)f(the)g(speci\002ed)
257 3862 y(netgr)n(oup.)47 b(Netgr)n(oup)27 b(matches)i(ar)n(e)h(not)f
(supported)e(for)i(daemon)g(pr)n(ocess)f(names)h(or)257
3975 y(for)23 b(client)g(user)e(names.)166 4182 y Fo(\017)46
b Fr(An)29 b(expr)n(ession)e(of)h(the)g(form)h Fn(n.n.n.n/m.m.m.m)22
b Fr(is)29 b(interpr)n(eted)e(as)i(a)g(\223net/mask\224)257
4295 y(pair)-7 b(.)182 b(A)73 b(host)g(addr)n(ess)f(is)i(matched)f(if)i
(\223net\224)f(is)f(equal)h(to)f(the)g(bitwise)257 4408
y(AND)54 b(of)g(the)f(addr)n(ess)f(and)i(the)f(\223mask\224.)122
b(For)53 b(example,)61 b(the)53 b(net/mask)g(pat-)257
4521 y(tern)44 b Fn(131.155.72.0/2)o(55.)o(25)o(5.)o(25)o(4.)o(0)38
b Fr(matches)45 b(every)e(addr)n(ess)g(in)i(the)f(range)257
4634 y Fn(131.155.72.0)18 b Fr(thr)n(ough)j Fn(131.155.73.255)p
Fr(.)30 4919 y Fh(WILDCARDS)30 5106 y Fr(The)h(access)g(contr)n(ol)h
(language)g(supports)d(explicit)j(wildcar)n(ds:)30 5343
y Fn(ALL)44 b Fr(The)22 b(universal)h(wildcar)n(d,)h(always)f(matches.)
30 5550 y Fn(LOCAL)43 b Fr(Matches)22 b(any)h(host)e(whose)h(name)h
(does)e(not)g(contain)j(a)f(dot)e(character)-7 b(.)p
eop
%%Page: 127 133
127 132 bop 3434 100 a Fr(127)150 356 y Fn(UNKNOWN)42
b Fr(Matches)28 b(any)g(user)f(whose)f(name)i(is)g(unknown,)g(and)g
(matches)g(any)g(host)f(whose)377 469 y(name)35 b(or)g(addr)n(ess)e(ar)
n(e)i(unknown.)63 b(This)35 b(pattern)f(should)f(be)i(used)f(with)g
(car)n(e:)53 b(host)377 582 y(names)23 b(may)g(be)f(unavailable)j(due)d
(to)g(temporary)f(name)i(server)e(pr)n(oblems.)28 b(A)22
b(network)377 695 y(addr)n(ess)29 b(will)i(be)f(unavailable)i(when)e
(the)f(softwar)n(e)g(cannot)h(\002gur)n(e)f(out)g(what)h(type)e(of)377
808 y(network)21 b(it)i(is)g(talking)f(to.)150 1005 y
Fn(KNOWN)43 b Fr(Matches)25 b(any)g(user)f(whose)g(name)i(is)f(known,)f
(and)i(matches)f(any)g(host)f(whose)g(name)377 1118 y(and)e(addr)n(ess)
e(ar)n(e)h(known.)27 b(This)21 b(pattern)f(should)g(be)h(used)f(with)h
(car)n(e:)28 b(host)21 b(names)g(may)377 1231 y(be)f(unavailable)i(due)
d(to)g(temporary)f(name)i(server)f(pr)n(oblems.)26 b(A)20
b(network)e(addr)n(ess)g(will)377 1343 y(be)28 b(unavailable)j(when)d
(the)f(softwar)n(e)h(cannot)g(\002gur)n(e)f(out)g(what)i(type)d(of)i
(network)f(it)h(is)377 1456 y(talking)23 b(to.)150 1654
y Fn(PARANOID)42 b Fr(Matches)32 b(any)g(host)f(whose)g(name)i(does)e
(not)g(match)i(its)f(addr)n(ess.)56 b(When)32 b(tcpd)377
1766 y(is)27 b(built)h(with)f(-DP)-8 b(ARANOID)26 b(\(default)h
(mode\),)g(it)g(dr)n(ops)f(r)n(equests)f(fr)n(om)i(such)g(clients)377
1879 y(even)j(befor)n(e)f(looking)h(at)g(the)f(access)h(contr)n(ol)g
(tables.)50 b(Build)30 b(without)f(-DP)-8 b(ARANOID)377
1992 y(when)22 b(you)g(want)g(mor)n(e)h(contr)n(ol)g(over)f(such)g(r)n
(equests.)150 2262 y Fh(OPERA)-9 b(TORS)150 2443 y Fn(EXCEPT)43
b Fr(Intended)49 b(use)i(is)i(of)f(the)f(form:)87 b Fn(list)p
2087 2443 28 4 v 31 w(1)54 b(EXCEPT)e(list)p 2829 2443
V 31 w(2)p Fr(;)66 b(this)52 b(constr)o(uct)377 2556
y(matches)25 b(anything)f(that)g(matches)h Fn(list)p
1882 2556 V 31 w(1)f Fr(unless)g(it)h(matches)f Fn(list)p
2928 2556 V 31 w(2)p Fr(.)34 b(The)24 b Fn(EXCEPT)377
2669 y Fr(operator)17 b(can)i(be)f(used)e(in)j Fn(daemon)p
1652 2669 V 30 w(lists)d Fr(and)i(in)h Fn(client)p 2573
2669 V 30 w(lists)p Fr(.)24 b(The)17 b Fn(EXCEPT)e Fr(op-)377
2782 y(erator)25 b(can)g(be)g(nested:)31 b(if)26 b(the)e(contr)n(ol)h
(language)g(would)g(permit)f(the)h(use)f(of)h(par)n(enthe-)377
2895 y(ses,)c Fn(a)54 b(EXCEPT)e(b)i(EXCEPT)e(c)22 b
Fr(would)g(parse)g(as)h Fn(\(a)54 b(EXCEPT)d(\(b)j(EXCEPT)e(c\)\))p
Fr(.)150 3164 y Fh(SHELL)24 b(COMMANDS)150 3346 y Fr(If)32
b(the)e(\002rst-matched)h(access)h(contr)n(ol)f(r)o(ule)h(contains)g(a)
g(shell)f(command,)k(that)c(command)h(is)150 3459 y(subjected)26
b(to)g Fn(\045<letter>)d Fr(substitutions)i(\(see)i(next)f(section\).)
40 b(The)27 b(r)n(esult)f(is)h(executed)f(by)h(a)150
3572 y(/bin/sh)c(child)g(pr)n(ocess)e(with)h(standar)n(d)g(input,)f
(output)g(and)h(err)n(or)g(connected)e(to)i(/dev/null.)150
3685 y(Specify)27 b(an)g Fn(&)g Fr(at)g(the)g(end)f(of)h(the)f(command)
i(if)g(you)e(do)g(not)h(want)g(to)f(wait)i(until)f(it)g(has)g(com-)150
3798 y(pleted.)291 3913 y(Shell)44 b(commands)g(should)f(not)g(r)n(ely)
h(on)g(the)f(P)-8 b(A)h(TH)43 b(setting)f(of)i(the)f(inetd.)91
b(Instead,)150 4026 y(they)55 b(should)g(use)g(absolute)h(path)f
(names,)64 b(or)56 b(they)f(should)g(begin)h(with)g(an)h(explicit)150
4139 y(P)-8 b(A)h(TH=whatever)21 b(statement.)291 4254
y(The)37 b(hosts)p 697 4254 V 31 w(options\(5\))g(document)g(describes)
f(an)j(alternative)f(language)f(that)h(uses)e(the)150
4367 y(shell)23 b(command)g(\002eld)f(in)h(a)g(dif)n(fer)n(ent)g(and)g
(incompatible)g(way)-10 b(.)150 4636 y Fh(\045)24 b(EXP)-7
b(ANSIONS)150 4818 y Fr(The)22 b(following)h(expansions)e(ar)n(e)i
(available)j(within)d(shell)f(commands:)-50 5043 y Fn(\045a)54
b(\(\045A\))43 b Fr(The)22 b(client)h(\(server\))f(host)g(addr)n(ess.)
223 5240 y Fn(\045c)44 b Fr(Client)30 b(information:)43
b(user@host,)28 b(user@addr)n(ess,)h(a)h(host)e(name,)k(or)d(just)g(an)
h(addr)n(ess,)377 5353 y(depending)21 b(on)h(how)g(much)h(information)g
(is)g(available.)223 5550 y Fn(\045d)44 b Fr(The)22 b(daemon)g(pr)n
(ocess)g(name)g(\(ar)n(gv[0])j(value\).)p eop
%%Page: 128 134
128 133 bop 30 100 a Fr(128)1862 b Fd(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))-170 356 y
Fn(\045h)54 b(\(\045H\))43 b Fr(The)22 b(client)h(\(server\))f(host)g
(name)h(or)f(addr)n(ess,)f(if)i(the)f(host)g(name)h(is)f(unavailable.)
-170 546 y Fn(\045n)54 b(\(\045N\))43 b Fr(The)22 b(client)h
(\(server\))f(host)g(name)h(\(or)f(\224unknown\224)g(or)h
(\224paranoid\224\).)103 736 y Fn(\045p)44 b Fr(The)22
b(daemon)g(pr)n(ocess)g(id.)103 926 y Fn(\045s)44 b Fr(Server)30
b(information:)46 b(daemon@host,)30 b(daemon@addr)n(ess,)h(or)g(just)f
(a)i(daemon)e(name,)257 1039 y(depending)21 b(on)h(how)g(much)h
(information)g(is)g(available.)103 1229 y Fn(\045u)44
b Fr(The)22 b(client)h(user)f(name)h(\(or)f(\224unknown\224\).)103
1419 y Fn(\045\045)44 b Fr(Expands)22 b(to)g(a)h(single)f
Fn(\045)g Fr(character)-7 b(.)171 1635 y(Characters)37
b(in)h(\045)f(expansions)f(that)g(may)i(confuse)e(the)g(shell)h(ar)n(e)
g(r)n(eplaced)g(by)g(under)n(-)30 1748 y(scor)n(es.)30
2006 y Fh(SER)-7 b(VER)24 b(ENDPOINT)g(P)-7 b(A)e(TTERNS)30
2185 y Fr(In)29 b(or)n(der)f(to)g(distinguish)g(clients)h(by)g(the)f
(network)f(addr)n(ess)g(that)i(they)f(connect)g(to,)i(use)e(pat-)30
2297 y(terns)21 b(of)i(the)f(form:)171 2411 y Fn(process)p
561 2411 V 30 w(name@host)p 1086 2411 V 28 w(pattern)52
b(:)108 b(client)p 2044 2411 V 30 w(list)53 b(...)171
2525 y Fr(Patterns)22 b(like)i(these)e(can)j(be)e(used)f(when)h(the)g
(machine)i(has)f(dif)n(fer)n(ent)f(internet)f(addr)n(esses)30
2637 y(with)i(dif)n(fer)n(ent)h(internet)e(hostnames.)32
b(Service)25 b(pr)n(oviders)e(can)i(use)f(this)g(facility)i(to)e(of)n
(fer)h(FTP)-12 b(,)30 2750 y(GOPHER)29 b(or)h(WWW)f(ar)n(chives)i(with)
f(internet)e(names)i(that)f(may)i(even)e(belong)g(to)g(dif)n(fer)n(ent)
30 2863 y(or)n(ganisations.)57 b(See)31 b(also)i(the)f(\223twist\224)g
(option)g(in)h(the)f(hosts)p 2276 2863 V 31 w(options\(5\))g(document.)
56 b(Some)30 2976 y(systems)25 b(\(Solaris,)j(Fr)n(eeBSD\))e(can)h
(have)h(mor)n(e)e(than)h(one)f(internet)g(addr)n(ess)f(on)i(one)f
(physical)30 3089 y(interface;)21 b(with)g(other)f(systems)f(you)h(may)
h(have)h(to)e(r)n(esort)g(to)g(SLIP)g(or)h(PPP)g(pseudo)d(interfaces)30
3202 y(that)34 b(live)h(in)g(a)f(dedicated)f(network)g(addr)n(ess)f
(space.)62 b(.sp)34 b(The)f Fn(host)p 2615 3202 V 31
w(pattern)e Fr(obeys)i(the)30 3315 y(same)g(syntax)f(r)o(ules)g(as)h
(host)f(names)g(and)h(addr)n(esses)e(in)i Fn(client)p
2474 3315 V 30 w(list)e Fr(context.)57 b(Usually)-10
b(,)30 3428 y(server)22 b(endpoint)f(information)i(is)g(available)i
(only)d(with)h(connection-oriented)d(services.)30 3686
y Fh(CLIENT)25 b(USERNAME)e(LOOKUP)30 3865 y Fr(When)29
b(the)g(client)h(host)e(supports)f(the)i(RFC)h(931)h(pr)n(otocol)e(or)g
(one)g(of)g(its)h(descendants)d(\(T)-7 b(AP)-12 b(,)30
3977 y(IDENT)-7 b(,)29 b(RFC)g(1413\))j(the)d(wrapper)f(pr)n(ograms)h
(can)i(r)n(etrieve)e(additional)h(information)g(about)30
4090 y(the)f(owner)h(of)g(a)h(connection.)50 b(Client)31
b(username)e(information,)k(when)c(available,)35 b(is)c(logged)30
4203 y(together)20 b(with)j(the)e(client)j(host)d(name,)i(and)f(can)i
(be)e(used)f(to)h(match)i(patterns)d(like:)171 4317 y
Fn(daemon)p 506 4317 V 30 w(list)53 b(:)108 b(...)g(user)p
1465 4317 V 31 w(pattern@host)p 2156 4317 V 27 w(pattern)52
b(...)171 4430 y Fr(The)27 b(daemon)g(wrappers)f(can)i(be)g(con\002gur)
n(ed)e(at)i(compile)g(time)f(to)g(perform)g(r)o(ule-driven)30
4543 y(username)18 b(lookups)g(\(default\))i(or)f(to)f(always)i(interr)
n(ogate)e(the)g(client)i(host.)26 b(In)19 b(the)f(case)h(of)h(r)o(ule-)
30 4656 y(driven)28 b(username)g(lookups,)g(the)f(above)i(r)o(ule)g
(would)f(cause)g(username)f(lookup)h(only)g(when)30 4769
y(both)22 b(the)g Fn(daemon)p 719 4769 V 30 w(list)f
Fr(and)i(the)e Fn(host)p 1535 4769 V 31 w(pattern)f Fr(match.)171
4883 y(A)g(user)f(pattern)g(has)h(the)f(same)h(syntax)f(as)h(a)g
(daemon)g(pr)n(ocess)e(pattern,)h(so)g(the)h(same)f(wild-)30
4995 y(car)n(ds)35 b(apply)g(\(netgr)n(oup)e(membership)i(is)g(not)f
(supported\).)62 b(One)35 b(should)f(not)g(get)g(carried)30
5108 y(away)23 b(with)g(username)e(lookups,)g(though.)166
5324 y Fo(\017)46 b Fr(The)39 b(client)h(username)e(information)i
(cannot)f(be)g(tr)o(usted)f(when)g(it)i(is)f(needed)e(most,)257
5437 y(i.e.)91 b(when)43 b(the)g(client)h(system)e(has)i(been)f(compr)n
(omised.)90 b(In)43 b(general,)48 b(ALL)43 b(and)257
5550 y(\(UN\)KNOWN)22 b(ar)n(e)h(the)f(only)g(user)g(name)h(patterns)e
(that)h(make)h(sense.)p eop
%%Page: 129 135
129 134 bop 3434 100 a Fr(129)286 356 y Fo(\017)46 b
Fr(Username)29 b(lookups)g(ar)n(e)h(possible)f(only)h(with)g(TCP-based)
g(services,)h(and)f(only)g(when)377 469 y(the)18 b(client)i(host)d(r)o
(uns)i(a)g(suitable)g(daemon;)h(in)f(all)h(other)e(cases)h(the)f(r)n
(esult)g(is)h(\223unknown\224.)286 696 y Fo(\017)46 b
Fr(A)c(well-known)f(UNIX)f(kernel)h(bug)g(may)h(cause)g(loss)f(of)h
(service)f(when)g(username)377 809 y(lookups)25 b(ar)n(e)i(blocked)e
(by)h(a)h(\002r)n(ewall.)40 b(The)26 b(wrapper)f(README)g(document)g
(describes)377 921 y(a)e(pr)n(ocedur)n(e)f(to)g(\002nd)g(out)g(if)h
(your)f(kernel)g(has)g(this)g(bug.)286 1148 y Fo(\017)46
b Fr(Username)30 b(lookups)g(may)i(cause)f(noticeable)g(delays)g(for)g
(non-UNIX)e(users.)52 b(The)31 b(de-)377 1261 y(fault)e(timeout)f(for)g
(username)g(lookups)e(is)j(10)g(seconds:)37 b(too)28
b(short)f(to)h(cope)f(with)i(slow)377 1374 y(networks,)20
b(but)j(long)f(enough)f(to)h(irritate)h(PC)g(users.)291
1635 y(Selective)33 b(username)g(lookups)e(can)j(alleviate)h(the)e
(last)g(pr)n(oblem.)60 b(For)33 b(example,)i(a)f(r)o(ule)150
1748 y(like:)291 1871 y Fn(daemon)p 626 1871 28 4 v 30
w(list)53 b(:)109 b(@pcnetgroup)49 b(ALL@ALL)291 1994
y Fr(would)26 b(match)h(members)f(of)h(the)f(pc)g(netgr)n(oup)f
(without)g(doing)h(username)g(lookups,)f(but)150 2107
y(would)d(perform)g(username)g(lookups)f(with)h(all)i(other)e(systems.)
150 2422 y Fh(DETECTING)j(ADDRESS)f(SPOOFING)h(A)-9 b(TT)g(ACKS)150
2618 y Fr(A)29 b(\003aw)i(in)f(the)f(sequence)e(number)j(generator)e
(of)h(many)h(TCP/IP)g(implementations)f(allows)150 2731
y(intr)o(uders)k(to)h(easily)g(impersonate)f(tr)o(usted)f(hosts)h(and)h
(to)g(br)n(eak)g(in)h(via,)j(for)c(example,)j(the)150
2844 y(r)n(emote)22 b(shell)h(service.)28 b(The)22 b(IDENT)g(\(RFC931)i
(etc.\))29 b(service)22 b(can)i(be)f(used)e(to)h(detect)g(such)g(and)
150 2957 y(other)f(host)h(addr)n(ess)f(spoo\002ng)g(attacks.)291
3080 y(Befor)n(e)j(accepting)i(a)g(client)g(r)n(equest,)e(the)h
(wrappers)f(can)i(use)e(the)h(IDENT)f(service)i(to)f(\002nd)150
3193 y(out)18 b(that)g(the)g(client)h(did)f(not)g(send)f(the)h(r)n
(equest)f(at)i(all.)27 b(When)18 b(the)g(client)h(host)f(pr)n(ovides)f
(IDENT)150 3305 y(service,)j(a)g(negative)f(IDENT)f(lookup)g(r)n(esult)
h(\(the)g(client)h(matches)f Fn(UNKNOWN@host)p Fr(\))c(is)k(str)n(ong)
150 3418 y(evidence)j(of)h(a)g(host)e(spoo\002ng)g(attack.)291
3541 y(A)e(positive)g(IDENT)g(lookup)f(r)n(esult)h(\(the)g(client)g
(matches)h Fn(KNOWN@host)p Fr(\))15 b(is)20 b(less)e(tr)o(ustwor)n(-)
150 3654 y(thy)-10 b(.)43 b(It)27 b(is)h(possible)f(for)h(an)h(intr)o
(uder)e(to)g(spoof)g(both)g(the)g(client)i(connection)e(and)h(the)f
(IDENT)150 3767 y(lookup,)j(although)e(doing)h(so)f(is)i(much)g(har)n
(der)f(than)g(spoo\002ng)e(just)i(a)h(client)f(connection.)48
b(It)150 3880 y(may)23 b(also)g(be)f(that)h(the)f(client's)g(IDENT)g
(server)g(is)g(lying.)291 4003 y(Note:)k(IDENT)c(lookups)f(don't)h
(work)f(with)i(UDP)g(services.)150 4317 y Fh(EXAMPLES)150
4514 y Fr(The)32 b(language)h(is)f(\003exible)i(enough)d(that)h(dif)n
(fer)n(ent)h(types)e(of)h(access)h(contr)n(ol)g(policy)g(can)g(be)150
4627 y(expr)n(essed)27 b(with)j(a)h(minimum)g(of)f(fuss.)49
b(Although)29 b(the)g(language)h(uses)e(two)h(access)h(contr)n(ol)150
4740 y(tables,)k(the)d(most)g(common)h(policies)f(can)i(be)f
(implemented)e(with)i(one)f(of)h(the)f(tables)g(being)150
4853 y(trivial)24 b(or)f(even)f(empty)-10 b(.)291 4975
y(When)24 b(r)n(eading)h(the)f(examples)g(below)g(it)h(is)g(important)g
(to)f(r)n(ealise)h(that)f(the)g(allow)i(table)f(is)150
5088 y(scanned)d(befor)n(e)h(the)f(deny)g(table,)h(that)g(the)f(sear)n
(ch)h(terminates)f(when)h(a)g(match)h(is)f(found,)f(and)150
5201 y(that)g(access)h(is)g(granted)e(when)h(no)g(match)h(is)g(found)f
(at)h(all.)291 5324 y(The)29 b(examples)g(use)f(host)h(and)g(domain)h
(names.)48 b(They)28 b(can)j(be)e(impr)n(oved)g(by)h(including)150
5437 y(addr)n(ess)j(and/or)i(network/netmask)d(information,)38
b(to)d(r)n(educe)f(the)g(impact)i(of)e(temporary)150
5550 y(name)23 b(server)e(lookup)h(failur)n(es.)p eop
%%Page: 130 136
130 135 bop 30 100 a Fr(130)1862 b Fd(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))30 356 y Fh(MOSTL)-9
b(Y)25 b(CLOSED)30 542 y Fr(In)19 b(this)g(case,)h(access)f(is)h
(denied)e(by)i(default.)26 b(Only)20 b(explicitly)g(authorised)e(hosts)
g(ar)n(e)i(permitted)30 655 y(access.)171 772 y(The)i(default)g(policy)
h(\(no)g(access\))g(is)f(implemented)g(with)g(a)i(trivial)g(deny)d
(\002le:)30 998 y Fc(/etc/hosts.deny:)229 1098 y(ALL:)49
b(ALL)171 1332 y Fr(This)29 b(denies)e(all)j(service)f(to)f(all)i
(hosts,)f(unless)e(they)h(ar)n(e)h(permitted)e(access)i(by)f(entries)g
(in)30 1445 y(the)22 b(allow)h(\002le.)171 1563 y(The)f(explicitly)h
(authorised)e(hosts)g(ar)n(e)i(listed)f(in)h(the)f(allow)i(\002le.)k
(For)21 b(example:)30 1789 y Fc(/etc/hosts.allow:)179
1888 y(ALL:)49 b(LOCAL)g(@some_netgroup)179 1988 y(ALL:)g(.foobar.edu)f
(EXCEPT)h(terminalserver.foobar.edu)171 2223 y Fr(The)21
b(\002rst)h(r)o(ule)g(permits)f(access)h(fr)n(om)g(hosts)f(in)h(the)f
(local)j(domain)e(\(no)g(.)28 b(in)22 b(the)g(host)f(name\))30
2335 y(and)i(fr)n(om)h(members)f(of)g(the)g Fn(some)p
1299 2335 V 31 w(netgroup)d Fr(netgr)n(oup.)28 b(The)22
b(second)g(r)o(ule)i(permits)e(access)30 2448 y(fr)n(om)f(all)h(hosts)d
(in)j(the)d Fn(foobar.edu)e Fr(domain)k(\(notice)f(the)g(leading)h
(dot\),)f(with)g(the)g(exception)30 2561 y(of)j Fn(terminalserver)o(.f)
o(oo)o(bar)o(.e)o(du)o Fr(.)30 2843 y Fh(MOSTL)-9 b(Y)25
b(OPEN)30 3029 y Fr(Her)n(e,)c(access)i(is)g(granted)e(by)i(default;)f
(only)g(explicitly)h(speci\002ed)f(hosts)f(ar)n(e)i(r)n(efused)e
(service.)171 3147 y(The)e(default)h(policy)g(\(access)g(granted\))f
(makes)g(the)g(allow)i(\002le)f(r)n(edundant)f(so)g(that)g(it)h(can)h
(be)30 3260 y(omitted.)27 b(The)22 b(explicitly)h(non-authorised)e
(hosts)g(ar)n(e)i(listed)f(in)h(the)e(deny)h(\002le.)28
b(For)21 b(example:)30 3485 y Fc(/etc/hosts.deny:)179
3585 y(ALL:)49 b(some.host.name,)f(.some.domain)179 3685
y(ALL)i(EXCEPT)e(in.fingerd:)g(other.host.name,)f(.other.domain)171
3919 y Fr(The)35 b(\002rst)g(r)o(ule)g(denies)f(some)h(hosts)f(and)h
(domains)h(all)h(services;)k(the)35 b(second)f(r)o(ule)h(still)30
4032 y(permits)22 b(\002nger)f(r)n(equests)g(fr)n(om)i(other)e(hosts)g
(and)i(domains.)30 4314 y Fh(BOOBY)j(TRAPS)30 4500 y
Fr(The)35 b(next)f(example)h(permits)g(tftp)f(r)n(equests)f(fr)n(om)j
(hosts)e(in)i(the)e(local)j(domain)f(\(notice)f(the)30
4613 y(leading)25 b(dot\).)32 b(Requests)22 b(fr)n(om)j(any)g(other)e
(hosts)g(ar)n(e)i(denied.)32 b(Instead)23 b(of)i(the)e(r)n(equested)f
(\002le,)30 4726 y(a)h(\002nger)f(pr)n(obe)g(is)h(sent)e(to)h(the)g(of)
n(fending)g(host.)27 b(The)22 b(r)n(esult)g(is)g(mailed)i(to)e(the)g
(super)o(user)-7 b(.)30 5052 y Fc(/etc/hosts.allow:)179
5151 y(in.tftpd:)49 b(LOCAL,)f(.my.domain)30 5351 y(/etc/hosts.deny:)
179 5450 y(in.tftpd:)h(ALL:)g(\(/some/where/safe\\_finger)c(-l)k
(@\045h)g(|)h(\\)379 5550 y(/usr/ucb/mail)d(-s)j(\045d-\045h)e(root\))h
(&)p eop
%%Page: 131 137
131 136 bop 3434 100 a Fr(131)291 356 y(The)37 b Fn(safe)p
706 356 28 4 v 31 w(finger)f Fr(command)i(comes)g(with)g(the)f(tcpd)g
(wrapper)g(and)h(should)f(be)h(in-)150 469 y(stalled)33
b(in)i(a)f(suitable)g(place.)62 b(It)33 b(limits)h(possible)f(damage)h
(fr)n(om)g(data)g(sent)f(by)g(the)g(r)n(emote)150 582
y(\002nger)22 b(server)-7 b(.)27 b(It)22 b(gives)g(better)f(pr)n
(otection)h(than)g(the)g(standar)n(d)g(\002nger)g(command.)291
695 y(The)36 b(expansion)g(of)h(the)f(\045h)h(\(client)h(host\))e(and)h
(\045d)g(\(service)g(name\))g(sequences)e(is)i(de-)150
808 y(scribed)22 b(in)h(the)f(section)g(on)g(shell)h(commands.)291
920 y(W)-8 b(arning:)27 b(do)21 b(not)g(booby-trap)g(your)g(\002nger)g
(daemon,)g(unless)f(you)h(ar)n(e)h(pr)n(epar)n(ed)f(for)g(in\002-)150
1033 y(nite)h(\002nger)g(loops.)291 1146 y(On)34 b(network)d(\002r)n
(ewall)k(systems)c(this)i(trick)g(can)h(be)f(carried)h(even)f(further)
-7 b(.)59 b(The)32 b(typical)150 1259 y(network)24 b(\002r)n(ewall)j
(only)f(pr)n(ovides)f(a)h(limited)h(set)e(of)h(services)f(to)g(the)h
(outer)e(world.)38 b(All)26 b(other)150 1372 y(services)h(can)i(be)f
(\224bugged\224)g(just)f(like)i(the)e(above)h(tftp)g(example.)44
b(The)27 b(r)n(esult)h(is)g(an)h(excellent)150 1485 y(early-warning)23
b(system.)150 1740 y Fh(DIAGNOSTICS)150 1917 y Fr(An)i(err)n(or)g(is)h
(r)n(eported)d(when)i(a)h(syntax)e(err)n(or)h(is)g(found)g(in)h(a)g
(host)e(access)i(contr)n(ol)f(r)o(ule;)i(when)150 2030
y(the)i(length)f(of)h(an)h(access)g(contr)n(ol)f(r)o(ule)g(exceeds)f
(the)g(capacity)j(of)e(an)h(internal)g(buf)n(fer;)j(when)150
2143 y(an)h(access)f(contr)n(ol)g(r)o(ule)h(is)f(not)g(terminated)f(by)
h(a)h(newline)f(character;)39 b(when)33 b(the)f(r)n(esult)h(of)150
2255 y(expansion)25 b(would)g(over\003ow)f(an)i(internal)g(buf)n(fer;)i
(when)c(a)j(system)c(call)28 b(fails)f(that)e(shouldn)3519
2241 y(\264)3519 2255 y(t.)150 2368 y(All)e(pr)n(oblems)g(ar)n(e)g(r)n
(eported)d(via)k(the)e(syslog)f(daemon.)150 2623 y Fh(FILES)150
2800 y Fn(/etc/hosts.allo)o(w)p Fr(,)16 b(\(daemon,client\))23
b(pairs)g(that)f(ar)n(e)h(granted)e(access.)150 2913
y Fn(/etc/hosts.deny)o Fr(,)c(\(daemon,client\))22 b(pairs)h(that)f(ar)
n(e)h(denied)f(access.)150 3168 y Fh(SEE)j(ALSO)150 3345
y Fr(tcpd\(8\))e(tcp/ip)f(daemon)h(wrapper)e(pr)n(ogram.)150
3457 y(tcpdchk\(8\),)h(tcpdmatch\(8\),)i(test)d(pr)n(ograms.)150
3712 y Fh(BUGS)150 3889 y Fr(If)29 b(a)h(name)f(server)f(lookup)g
(times)h(out,)g(the)f(host)g(name)i(will)g(not)e(be)h(available)j(to)d
(the)f(access)150 4002 y(contr)n(ol)23 b(softwar)n(e,)e(even)h(though)g
(the)f(host)h(is)h(r)n(egister)n(ed.)291 4115 y(Domain)37
b(name)e(server)g(lookups)f(ar)n(e)h(case)h(insensitive;)41
b(NIS)34 b(\(formerly)i(YP\))f(netgr)n(oup)150 4228 y(lookups)21
b(ar)n(e)i(case)g(sensitive.)150 4483 y Fh(AUTHOR)150
4660 y Fr(W)-5 b(ietse)21 b(V)-10 b(enema)22 b(\(wietse@wzv)-10
b(.win.tue.nl\))150 4772 y(Department)22 b(of)g(Mathematics)h(and)g
(Computing)f(Science)150 4885 y(Eindhoven)g(University)f(of)i(T)-8
b(echnology)150 4998 y(Den)23 b(Dolech)g(2,)f(P)-12 b(.O.)23
b(Box)f(513,)150 5111 y(5600)j(MB)d(Eindhoven,)f(The)h(Netherlands)p
eop
%%Page: 132 138
132 137 bop 30 100 a Fr(132)1862 b Fd(APPENDIX)21 b(A.)45
b(HOSTS)p 2966 100 28 4 v 32 w(ACCESS\(5\))p eop
%%Page: 133 139
133 138 bop 150 1020 a Fm(Bibliography)150 1482 y Fr([OMG99a])48
b Fq(The)30 b(Common)g(Object)g(Request)h(Br)n(oker:)44
b(Ar)n(chitectur)n(e)32 b(and)f(Speci\002cation)p Fr(,)h(Revision)434
1595 y(2.3,)23 b(OMG,)g(Final)h(publication)f(expected)e(in)i(1999.)150
1783 y([OMG99b])48 b Fq(CORBAservices:)36 b(Common)26
b(Object)i(Services)g(Speci\002cation)p Fr(,)h(OMG,)e(Updated)e(July)
434 1896 y(1996.)150 2083 y([Richar)n(dson96a])47 b Fq(The)30
b(OMNI)f(Thr)n(ead)i(Abstraction)p Fr(,)h(T)-8 b(ristan)29
b(Richar)n(dson,)h(ORL,)f(22)h(October)434 2196 y(1996.)150
2384 y([Richar)n(dson96b])47 b Fq(The)26 b(OMNI)e(Development)j(Envir)n
(onment)f(V)-8 b(ersion)26 b(4.0)p Fr(,)g(T)-8 b(ristan)24
b(Richar)n(dson,)434 2497 y(ORL,)e(5)h(November)f(1996.)1792
5778 y(133)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
